(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var Pt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function im(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function om(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var md={exports:{}},ci={},pd={exports:{}},he={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ws=Symbol.for("react.element"),lm=Symbol.for("react.portal"),cm=Symbol.for("react.fragment"),um=Symbol.for("react.strict_mode"),dm=Symbol.for("react.profiler"),hm=Symbol.for("react.provider"),fm=Symbol.for("react.context"),mm=Symbol.for("react.forward_ref"),pm=Symbol.for("react.suspense"),gm=Symbol.for("react.memo"),xm=Symbol.for("react.lazy"),Ac=Symbol.iterator;function ym(t){return t===null||typeof t!="object"?null:(t=Ac&&t[Ac]||t["@@iterator"],typeof t=="function"?t:null)}var gd={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xd=Object.assign,yd={};function Hr(t,e,n){this.props=t,this.context=e,this.refs=yd,this.updater=n||gd}Hr.prototype.isReactComponent={};Hr.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Hr.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function vd(){}vd.prototype=Hr.prototype;function yl(t,e,n){this.props=t,this.context=e,this.refs=yd,this.updater=n||gd}var vl=yl.prototype=new vd;vl.constructor=yl;xd(vl,Hr.prototype);vl.isPureReactComponent=!0;var Oc=Array.isArray,bd=Object.prototype.hasOwnProperty,bl={current:null},wd={key:!0,ref:!0,__self:!0,__source:!0};function jd(t,e,n){var r,a={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)bd.call(e,r)&&!wd.hasOwnProperty(r)&&(a[r]=e[r]);var l=arguments.length-2;if(l===1)a.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)a[r]===void 0&&(a[r]=l[r]);return{$$typeof:Ws,type:t,key:i,ref:o,props:a,_owner:bl.current}}function vm(t,e){return{$$typeof:Ws,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function wl(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ws}function bm(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var $c=/\/+/g;function Ai(t,e){return typeof t=="object"&&t!==null&&t.key!=null?bm(""+t.key):e.toString(36)}function Na(t,e,n,r,a){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ws:case lm:o=!0}}if(o)return o=t,a=a(o),t=r===""?"."+Ai(o,0):r,Oc(a)?(n="",t!=null&&(n=t.replace($c,"$&/")+"/"),Na(a,e,n,"",function(u){return u})):a!=null&&(wl(a)&&(a=vm(a,n+(!a.key||o&&o.key===a.key?"":(""+a.key).replace($c,"$&/")+"/")+t)),e.push(a)),1;if(o=0,r=r===""?".":r+":",Oc(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Ai(i,l);o+=Na(i,e,n,c,a)}else if(c=ym(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Ai(i,l++),o+=Na(i,e,n,c,a);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ta(t,e,n){if(t==null)return t;var r=[],a=0;return Na(t,r,"","",function(i){return e.call(n,i,a++)}),r}function wm(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var at={current:null},_a={transition:null},jm={ReactCurrentDispatcher:at,ReactCurrentBatchConfig:_a,ReactCurrentOwner:bl};function kd(){throw Error("act(...) is not supported in production builds of React.")}he.Children={map:ta,forEach:function(t,e,n){ta(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ta(t,function(){e++}),e},toArray:function(t){return ta(t,function(e){return e})||[]},only:function(t){if(!wl(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};he.Component=Hr;he.Fragment=cm;he.Profiler=dm;he.PureComponent=yl;he.StrictMode=um;he.Suspense=pm;he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jm;he.act=kd;he.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=xd({},t.props),a=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=bl.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)bd.call(e,c)&&!wd.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Ws,type:t.type,key:a,ref:i,props:r,_owner:o}};he.createContext=function(t){return t={$$typeof:fm,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:hm,_context:t},t.Consumer=t};he.createElement=jd;he.createFactory=function(t){var e=jd.bind(null,t);return e.type=t,e};he.createRef=function(){return{current:null}};he.forwardRef=function(t){return{$$typeof:mm,render:t}};he.isValidElement=wl;he.lazy=function(t){return{$$typeof:xm,_payload:{_status:-1,_result:t},_init:wm}};he.memo=function(t,e){return{$$typeof:gm,type:t,compare:e===void 0?null:e}};he.startTransition=function(t){var e=_a.transition;_a.transition={};try{t()}finally{_a.transition=e}};he.unstable_act=kd;he.useCallback=function(t,e){return at.current.useCallback(t,e)};he.useContext=function(t){return at.current.useContext(t)};he.useDebugValue=function(){};he.useDeferredValue=function(t){return at.current.useDeferredValue(t)};he.useEffect=function(t,e){return at.current.useEffect(t,e)};he.useId=function(){return at.current.useId()};he.useImperativeHandle=function(t,e,n){return at.current.useImperativeHandle(t,e,n)};he.useInsertionEffect=function(t,e){return at.current.useInsertionEffect(t,e)};he.useLayoutEffect=function(t,e){return at.current.useLayoutEffect(t,e)};he.useMemo=function(t,e){return at.current.useMemo(t,e)};he.useReducer=function(t,e,n){return at.current.useReducer(t,e,n)};he.useRef=function(t){return at.current.useRef(t)};he.useState=function(t){return at.current.useState(t)};he.useSyncExternalStore=function(t,e,n){return at.current.useSyncExternalStore(t,e,n)};he.useTransition=function(){return at.current.useTransition()};he.version="18.3.1";pd.exports=he;var v=pd.exports;const me=im(v);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var km=v,Nm=Symbol.for("react.element"),_m=Symbol.for("react.fragment"),Sm=Object.prototype.hasOwnProperty,Cm=km.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Em={key:!0,ref:!0,__self:!0,__source:!0};function Nd(t,e,n){var r,a={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Sm.call(e,r)&&!Em.hasOwnProperty(r)&&(a[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)a[r]===void 0&&(a[r]=e[r]);return{$$typeof:Nm,type:t,key:i,ref:o,props:a,_owner:Cm.current}}ci.Fragment=_m;ci.jsx=Nd;ci.jsxs=Nd;md.exports=ci;var s=md.exports,_d={exports:{}},jt={},Sd={exports:{}},Cd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,V){var M=L.length;L.push(V);e:for(;0<M;){var B=M-1>>>1,X=L[B];if(0<a(X,V))L[B]=V,L[M]=X,M=B;else break e}}function n(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var V=L[0],M=L.pop();if(M!==V){L[0]=M;e:for(var B=0,X=L.length,H=X>>>1;B<H;){var z=2*(B+1)-1,se=L[z],$=z+1,O=L[$];if(0>a(se,M))$<X&&0>a(O,se)?(L[B]=O,L[$]=M,B=$):(L[B]=se,L[z]=M,B=z);else if($<X&&0>a(O,M))L[B]=O,L[$]=M,B=$;else break e}}return V}function a(L,V){var M=L.sortIndex-V.sortIndex;return M!==0?M:L.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,m=3,f=!1,y=!1,b=!1,S=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(L){for(var V=n(u);V!==null;){if(V.callback===null)r(u);else if(V.startTime<=L)r(u),V.sortIndex=V.expirationTime,e(c,V);else break;V=n(u)}}function j(L){if(b=!1,p(L),!y)if(n(c)!==null)y=!0,re(N);else{var V=n(u);V!==null&&te(j,V.startTime-L)}}function N(L,V){y=!1,b&&(b=!1,x(E),E=-1),f=!0;var M=m;try{for(p(V),h=n(c);h!==null&&(!(h.expirationTime>V)||L&&!P());){var B=h.callback;if(typeof B=="function"){h.callback=null,m=h.priorityLevel;var X=B(h.expirationTime<=V);V=t.unstable_now(),typeof X=="function"?h.callback=X:h===n(c)&&r(c),p(V)}else r(c);h=n(c)}if(h!==null)var H=!0;else{var z=n(u);z!==null&&te(j,z.startTime-V),H=!1}return H}finally{h=null,m=M,f=!1}}var w=!1,_=null,E=-1,C=5,k=-1;function P(){return!(t.unstable_now()-k<C)}function U(){if(_!==null){var L=t.unstable_now();k=L;var V=!0;try{V=_(!0,L)}finally{V?D():(w=!1,_=null)}}else w=!1}var D;if(typeof g=="function")D=function(){g(U)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Y=K.port2;K.port1.onmessage=U,D=function(){Y.postMessage(null)}}else D=function(){S(U,0)};function re(L){_=L,w||(w=!0,D())}function te(L,V){E=S(function(){L(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){y||f||(y=!0,re(N))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(L){switch(m){case 1:case 2:case 3:var V=3;break;default:V=m}var M=m;m=V;try{return L()}finally{m=M}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,V){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var M=m;m=L;try{return V()}finally{m=M}},t.unstable_scheduleCallback=function(L,V,M){var B=t.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?B+M:B):M=B,L){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=M+X,L={id:d++,callback:V,priorityLevel:L,startTime:M,expirationTime:X,sortIndex:-1},M>B?(L.sortIndex=M,e(u,L),n(c)===null&&L===n(u)&&(b?(x(E),E=-1):b=!0,te(j,M-B))):(L.sortIndex=X,e(c,L),y||f||(y=!0,re(N))),L},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(L){var V=m;return function(){var M=m;m=V;try{return L.apply(this,arguments)}finally{m=M}}}})(Cd);Sd.exports=Cd;var Pm=Sd.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tm=v,wt=Pm;function R(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ed=new Set,_s={};function ar(t,e){Lr(t,e),Lr(t+"Capture",e)}function Lr(t,e){for(_s[t]=e,t=0;t<e.length;t++)Ed.add(e[t])}var an=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),po=Object.prototype.hasOwnProperty,Im=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Lc={},Dc={};function Mm(t){return po.call(Dc,t)?!0:po.call(Lc,t)?!1:Im.test(t)?Dc[t]=!0:(Lc[t]=!0,!1)}function Am(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Om(t,e,n,r){if(e===null||typeof e>"u"||Am(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function it(t,e,n,r,a,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Ke={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ke[t]=new it(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ke[e]=new it(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ke[t]=new it(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ke[t]=new it(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ke[t]=new it(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ke[t]=new it(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ke[t]=new it(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ke[t]=new it(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ke[t]=new it(t,5,!1,t.toLowerCase(),null,!1,!1)});var jl=/[\-:]([a-z])/g;function kl(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(jl,kl);Ke[e]=new it(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(jl,kl);Ke[e]=new it(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(jl,kl);Ke[e]=new it(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ke[t]=new it(t,1,!1,t.toLowerCase(),null,!1,!1)});Ke.xlinkHref=new it("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ke[t]=new it(t,1,!1,t.toLowerCase(),null,!0,!0)});function Nl(t,e,n,r){var a=Ke.hasOwnProperty(e)?Ke[e]:null;(a!==null?a.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Om(e,n,a,r)&&(n=null),r||a===null?Mm(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,r=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var dn=Tm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,na=Symbol.for("react.element"),yr=Symbol.for("react.portal"),vr=Symbol.for("react.fragment"),_l=Symbol.for("react.strict_mode"),go=Symbol.for("react.profiler"),Pd=Symbol.for("react.provider"),Td=Symbol.for("react.context"),Sl=Symbol.for("react.forward_ref"),xo=Symbol.for("react.suspense"),yo=Symbol.for("react.suspense_list"),Cl=Symbol.for("react.memo"),gn=Symbol.for("react.lazy"),Id=Symbol.for("react.offscreen"),Rc=Symbol.iterator;function Xr(t){return t===null||typeof t!="object"?null:(t=Rc&&t[Rc]||t["@@iterator"],typeof t=="function"?t:null)}var Ae=Object.assign,Oi;function ls(t){if(Oi===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Oi=e&&e[1]||""}return`
`+Oi+t}var $i=!1;function Li(t,e){if(!t||$i)return"";$i=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=r.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var c=`
`+a[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{$i=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ls(t):""}function $m(t){switch(t.tag){case 5:return ls(t.type);case 16:return ls("Lazy");case 13:return ls("Suspense");case 19:return ls("SuspenseList");case 0:case 2:case 15:return t=Li(t.type,!1),t;case 11:return t=Li(t.type.render,!1),t;case 1:return t=Li(t.type,!0),t;default:return""}}function vo(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case vr:return"Fragment";case yr:return"Portal";case go:return"Profiler";case _l:return"StrictMode";case xo:return"Suspense";case yo:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Td:return(t.displayName||"Context")+".Consumer";case Pd:return(t._context.displayName||"Context")+".Provider";case Sl:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Cl:return e=t.displayName||null,e!==null?e:vo(t.type)||"Memo";case gn:e=t._payload,t=t._init;try{return vo(t(e))}catch{}}return null}function Lm(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vo(e);case 8:return e===_l?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function An(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Md(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Dm(t){var e=Md(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ra(t){t._valueTracker||(t._valueTracker=Dm(t))}function Ad(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Md(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Da(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function bo(t,e){var n=e.checked;return Ae({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Fc(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=An(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Od(t,e){e=e.checked,e!=null&&Nl(t,"checked",e,!1)}function wo(t,e){Od(t,e);var n=An(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?jo(t,e.type,n):e.hasOwnProperty("defaultValue")&&jo(t,e.type,An(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Uc(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function jo(t,e,n){(e!=="number"||Da(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var cs=Array.isArray;function Tr(t,e,n,r){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&r&&(t[n].defaultSelected=!0)}else{for(n=""+An(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,r&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function ko(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(R(91));return Ae({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function zc(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(R(92));if(cs(n)){if(1<n.length)throw Error(R(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:An(n)}}function $d(t,e){var n=An(e.value),r=An(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Bc(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Ld(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function No(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Ld(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var sa,Dd=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(sa=sa||document.createElement("div"),sa.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=sa.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ss(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var fs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Rm=["Webkit","ms","Moz","O"];Object.keys(fs).forEach(function(t){Rm.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),fs[e]=fs[t]})});function Rd(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||fs.hasOwnProperty(t)&&fs[t]?(""+e).trim():e+"px"}function Fd(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=Rd(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,a):t[n]=a}}var Fm=Ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _o(t,e){if(e){if(Fm[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(R(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(R(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(R(61))}if(e.style!=null&&typeof e.style!="object")throw Error(R(62))}}function So(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Co=null;function El(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Eo=null,Ir=null,Mr=null;function Gc(t){if(t=Vs(t)){if(typeof Eo!="function")throw Error(R(280));var e=t.stateNode;e&&(e=mi(e),Eo(t.stateNode,t.type,e))}}function Ud(t){Ir?Mr?Mr.push(t):Mr=[t]:Ir=t}function zd(){if(Ir){var t=Ir,e=Mr;if(Mr=Ir=null,Gc(t),e)for(t=0;t<e.length;t++)Gc(e[t])}}function Bd(t,e){return t(e)}function Gd(){}var Di=!1;function Wd(t,e,n){if(Di)return t(e,n);Di=!0;try{return Bd(t,e,n)}finally{Di=!1,(Ir!==null||Mr!==null)&&(Gd(),zd())}}function Cs(t,e){var n=t.stateNode;if(n===null)return null;var r=mi(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(R(231,e,typeof n));return n}var Po=!1;if(an)try{var Zr={};Object.defineProperty(Zr,"passive",{get:function(){Po=!0}}),window.addEventListener("test",Zr,Zr),window.removeEventListener("test",Zr,Zr)}catch{Po=!1}function Um(t,e,n,r,a,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var ms=!1,Ra=null,Fa=!1,To=null,zm={onError:function(t){ms=!0,Ra=t}};function Bm(t,e,n,r,a,i,o,l,c){ms=!1,Ra=null,Um.apply(zm,arguments)}function Gm(t,e,n,r,a,i,o,l,c){if(Bm.apply(this,arguments),ms){if(ms){var u=Ra;ms=!1,Ra=null}else throw Error(R(198));Fa||(Fa=!0,To=u)}}function ir(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Hd(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Wc(t){if(ir(t)!==t)throw Error(R(188))}function Wm(t){var e=t.alternate;if(!e){if(e=ir(t),e===null)throw Error(R(188));return e!==t?null:t}for(var n=t,r=e;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return Wc(a),t;if(i===r)return Wc(a),e;i=i.sibling}throw Error(R(188))}if(n.return!==r.return)n=a,r=i;else{for(var o=!1,l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o)throw Error(R(189))}}if(n.alternate!==r)throw Error(R(190))}if(n.tag!==3)throw Error(R(188));return n.stateNode.current===n?t:e}function qd(t){return t=Wm(t),t!==null?Vd(t):null}function Vd(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Vd(t);if(e!==null)return e;t=t.sibling}return null}var Kd=wt.unstable_scheduleCallback,Hc=wt.unstable_cancelCallback,Hm=wt.unstable_shouldYield,qm=wt.unstable_requestPaint,$e=wt.unstable_now,Vm=wt.unstable_getCurrentPriorityLevel,Pl=wt.unstable_ImmediatePriority,Jd=wt.unstable_UserBlockingPriority,Ua=wt.unstable_NormalPriority,Km=wt.unstable_LowPriority,Qd=wt.unstable_IdlePriority,ui=null,Vt=null;function Jm(t){if(Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(ui,t,void 0,(t.current.flags&128)===128)}catch{}}var Ut=Math.clz32?Math.clz32:Xm,Qm=Math.log,Ym=Math.LN2;function Xm(t){return t>>>=0,t===0?32:31-(Qm(t)/Ym|0)|0}var aa=64,ia=4194304;function us(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function za(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,a=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~a;l!==0?r=us(l):(i&=o,i!==0&&(r=us(i)))}else o=n&~a,o!==0?r=us(o):i!==0&&(r=us(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&a)&&(a=r&-r,i=e&-e,a>=i||a===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ut(e),a=1<<n,r|=t[n],e&=~a;return r}function Zm(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ep(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,a=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Ut(i),l=1<<o,c=a[o];c===-1?(!(l&n)||l&r)&&(a[o]=Zm(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Io(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Yd(){var t=aa;return aa<<=1,!(aa&4194240)&&(aa=64),t}function Ri(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Hs(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ut(e),t[e]=n}function tp(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-Ut(n),i=1<<a;e[a]=0,r[a]=-1,t[a]=-1,n&=~i}}function Tl(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ut(n),a=1<<r;a&e|t[r]&e&&(t[r]|=e),n&=~a}}var ke=0;function Xd(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Zd,Il,eh,th,nh,Mo=!1,oa=[],Nn=null,_n=null,Sn=null,Es=new Map,Ps=new Map,yn=[],np="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qc(t,e){switch(t){case"focusin":case"focusout":Nn=null;break;case"dragenter":case"dragleave":_n=null;break;case"mouseover":case"mouseout":Sn=null;break;case"pointerover":case"pointerout":Es.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ps.delete(e.pointerId)}}function es(t,e,n,r,a,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},e!==null&&(e=Vs(e),e!==null&&Il(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function rp(t,e,n,r,a){switch(e){case"focusin":return Nn=es(Nn,t,e,n,r,a),!0;case"dragenter":return _n=es(_n,t,e,n,r,a),!0;case"mouseover":return Sn=es(Sn,t,e,n,r,a),!0;case"pointerover":var i=a.pointerId;return Es.set(i,es(Es.get(i)||null,t,e,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Ps.set(i,es(Ps.get(i)||null,t,e,n,r,a)),!0}return!1}function rh(t){var e=qn(t.target);if(e!==null){var n=ir(e);if(n!==null){if(e=n.tag,e===13){if(e=Hd(n),e!==null){t.blockedOn=e,nh(t.priority,function(){eh(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Sa(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ao(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Co=r,n.target.dispatchEvent(r),Co=null}else return e=Vs(n),e!==null&&Il(e),t.blockedOn=n,!1;e.shift()}return!0}function Vc(t,e,n){Sa(t)&&n.delete(e)}function sp(){Mo=!1,Nn!==null&&Sa(Nn)&&(Nn=null),_n!==null&&Sa(_n)&&(_n=null),Sn!==null&&Sa(Sn)&&(Sn=null),Es.forEach(Vc),Ps.forEach(Vc)}function ts(t,e){t.blockedOn===e&&(t.blockedOn=null,Mo||(Mo=!0,wt.unstable_scheduleCallback(wt.unstable_NormalPriority,sp)))}function Ts(t){function e(a){return ts(a,t)}if(0<oa.length){ts(oa[0],t);for(var n=1;n<oa.length;n++){var r=oa[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Nn!==null&&ts(Nn,t),_n!==null&&ts(_n,t),Sn!==null&&ts(Sn,t),Es.forEach(e),Ps.forEach(e),n=0;n<yn.length;n++)r=yn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<yn.length&&(n=yn[0],n.blockedOn===null);)rh(n),n.blockedOn===null&&yn.shift()}var Ar=dn.ReactCurrentBatchConfig,Ba=!0;function ap(t,e,n,r){var a=ke,i=Ar.transition;Ar.transition=null;try{ke=1,Ml(t,e,n,r)}finally{ke=a,Ar.transition=i}}function ip(t,e,n,r){var a=ke,i=Ar.transition;Ar.transition=null;try{ke=4,Ml(t,e,n,r)}finally{ke=a,Ar.transition=i}}function Ml(t,e,n,r){if(Ba){var a=Ao(t,e,n,r);if(a===null)Ki(t,e,r,Ga,n),qc(t,r);else if(rp(a,t,e,n,r))r.stopPropagation();else if(qc(t,r),e&4&&-1<np.indexOf(t)){for(;a!==null;){var i=Vs(a);if(i!==null&&Zd(i),i=Ao(t,e,n,r),i===null&&Ki(t,e,r,Ga,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else Ki(t,e,r,null,n)}}var Ga=null;function Ao(t,e,n,r){if(Ga=null,t=El(r),t=qn(t),t!==null)if(e=ir(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Hd(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ga=t,null}function sh(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Vm()){case Pl:return 1;case Jd:return 4;case Ua:case Km:return 16;case Qd:return 536870912;default:return 16}default:return 16}}var wn=null,Al=null,Ca=null;function ah(){if(Ca)return Ca;var t,e=Al,n=e.length,r,a="value"in wn?wn.value:wn.textContent,i=a.length;for(t=0;t<n&&e[t]===a[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===a[i-r];r++);return Ca=a.slice(t,1<r?1-r:void 0)}function Ea(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function la(){return!0}function Kc(){return!1}function kt(t){function e(n,r,a,i,o){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?la:Kc,this.isPropagationStopped=Kc,this}return Ae(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=la)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=la)},persist:function(){},isPersistent:la}),e}var qr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ol=kt(qr),qs=Ae({},qr,{view:0,detail:0}),op=kt(qs),Fi,Ui,ns,di=Ae({},qs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$l,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ns&&(ns&&t.type==="mousemove"?(Fi=t.screenX-ns.screenX,Ui=t.screenY-ns.screenY):Ui=Fi=0,ns=t),Fi)},movementY:function(t){return"movementY"in t?t.movementY:Ui}}),Jc=kt(di),lp=Ae({},di,{dataTransfer:0}),cp=kt(lp),up=Ae({},qs,{relatedTarget:0}),zi=kt(up),dp=Ae({},qr,{animationName:0,elapsedTime:0,pseudoElement:0}),hp=kt(dp),fp=Ae({},qr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),mp=kt(fp),pp=Ae({},qr,{data:0}),Qc=kt(pp),gp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vp(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=yp[t])?!!e[t]:!1}function $l(){return vp}var bp=Ae({},qs,{key:function(t){if(t.key){var e=gp[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ea(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?xp[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$l,charCode:function(t){return t.type==="keypress"?Ea(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ea(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),wp=kt(bp),jp=Ae({},di,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yc=kt(jp),kp=Ae({},qs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$l}),Np=kt(kp),_p=Ae({},qr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Sp=kt(_p),Cp=Ae({},di,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ep=kt(Cp),Pp=[9,13,27,32],Ll=an&&"CompositionEvent"in window,ps=null;an&&"documentMode"in document&&(ps=document.documentMode);var Tp=an&&"TextEvent"in window&&!ps,ih=an&&(!Ll||ps&&8<ps&&11>=ps),Xc=" ",Zc=!1;function oh(t,e){switch(t){case"keyup":return Pp.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var br=!1;function Ip(t,e){switch(t){case"compositionend":return lh(e);case"keypress":return e.which!==32?null:(Zc=!0,Xc);case"textInput":return t=e.data,t===Xc&&Zc?null:t;default:return null}}function Mp(t,e){if(br)return t==="compositionend"||!Ll&&oh(t,e)?(t=ah(),Ca=Al=wn=null,br=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ih&&e.locale!=="ko"?null:e.data;default:return null}}var Ap={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eu(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Ap[t.type]:e==="textarea"}function ch(t,e,n,r){Ud(r),e=Wa(e,"onChange"),0<e.length&&(n=new Ol("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var gs=null,Is=null;function Op(t){bh(t,0)}function hi(t){var e=kr(t);if(Ad(e))return t}function $p(t,e){if(t==="change")return e}var uh=!1;if(an){var Bi;if(an){var Gi="oninput"in document;if(!Gi){var tu=document.createElement("div");tu.setAttribute("oninput","return;"),Gi=typeof tu.oninput=="function"}Bi=Gi}else Bi=!1;uh=Bi&&(!document.documentMode||9<document.documentMode)}function nu(){gs&&(gs.detachEvent("onpropertychange",dh),Is=gs=null)}function dh(t){if(t.propertyName==="value"&&hi(Is)){var e=[];ch(e,Is,t,El(t)),Wd(Op,e)}}function Lp(t,e,n){t==="focusin"?(nu(),gs=e,Is=n,gs.attachEvent("onpropertychange",dh)):t==="focusout"&&nu()}function Dp(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return hi(Is)}function Rp(t,e){if(t==="click")return hi(e)}function Fp(t,e){if(t==="input"||t==="change")return hi(e)}function Up(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Bt=typeof Object.is=="function"?Object.is:Up;function Ms(t,e){if(Bt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!po.call(e,a)||!Bt(t[a],e[a]))return!1}return!0}function ru(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function su(t,e){var n=ru(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ru(n)}}function hh(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?hh(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function fh(){for(var t=window,e=Da();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Da(t.document)}return e}function Dl(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function zp(t){var e=fh(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hh(n.ownerDocument.documentElement,n)){if(r!==null&&Dl(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!t.extend&&i>r&&(a=r,r=i,i=a),a=su(n,i);var o=su(n,r);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Bp=an&&"documentMode"in document&&11>=document.documentMode,wr=null,Oo=null,xs=null,$o=!1;function au(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$o||wr==null||wr!==Da(r)||(r=wr,"selectionStart"in r&&Dl(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),xs&&Ms(xs,r)||(xs=r,r=Wa(Oo,"onSelect"),0<r.length&&(e=new Ol("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=wr)))}function ca(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var jr={animationend:ca("Animation","AnimationEnd"),animationiteration:ca("Animation","AnimationIteration"),animationstart:ca("Animation","AnimationStart"),transitionend:ca("Transition","TransitionEnd")},Wi={},mh={};an&&(mh=document.createElement("div").style,"AnimationEvent"in window||(delete jr.animationend.animation,delete jr.animationiteration.animation,delete jr.animationstart.animation),"TransitionEvent"in window||delete jr.transitionend.transition);function fi(t){if(Wi[t])return Wi[t];if(!jr[t])return t;var e=jr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in mh)return Wi[t]=e[n];return t}var ph=fi("animationend"),gh=fi("animationiteration"),xh=fi("animationstart"),yh=fi("transitionend"),vh=new Map,iu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $n(t,e){vh.set(t,e),ar(e,[t])}for(var Hi=0;Hi<iu.length;Hi++){var qi=iu[Hi],Gp=qi.toLowerCase(),Wp=qi[0].toUpperCase()+qi.slice(1);$n(Gp,"on"+Wp)}$n(ph,"onAnimationEnd");$n(gh,"onAnimationIteration");$n(xh,"onAnimationStart");$n("dblclick","onDoubleClick");$n("focusin","onFocus");$n("focusout","onBlur");$n(yh,"onTransitionEnd");Lr("onMouseEnter",["mouseout","mouseover"]);Lr("onMouseLeave",["mouseout","mouseover"]);Lr("onPointerEnter",["pointerout","pointerover"]);Lr("onPointerLeave",["pointerout","pointerover"]);ar("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ar("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ar("onBeforeInput",["compositionend","keypress","textInput","paste"]);ar("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ar("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ar("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ds="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hp=new Set("cancel close invalid load scroll toggle".split(" ").concat(ds));function ou(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Gm(r,e,void 0,t),t.currentTarget=null}function bh(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],a=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;ou(a,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;ou(a,l,u),i=c}}}if(Fa)throw t=To,Fa=!1,To=null,t}function Ee(t,e){var n=e[Uo];n===void 0&&(n=e[Uo]=new Set);var r=t+"__bubble";n.has(r)||(wh(e,t,2,!1),n.add(r))}function Vi(t,e,n){var r=0;e&&(r|=4),wh(n,t,r,e)}var ua="_reactListening"+Math.random().toString(36).slice(2);function As(t){if(!t[ua]){t[ua]=!0,Ed.forEach(function(n){n!=="selectionchange"&&(Hp.has(n)||Vi(n,!1,t),Vi(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ua]||(e[ua]=!0,Vi("selectionchange",!1,e))}}function wh(t,e,n,r){switch(sh(e)){case 1:var a=ap;break;case 4:a=ip;break;default:a=Ml}n=a.bind(null,e,n,t),a=void 0,!Po||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),r?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function Ki(t,e,n,r,a){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=qn(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Wd(function(){var u=i,d=El(n),h=[];e:{var m=vh.get(t);if(m!==void 0){var f=Ol,y=t;switch(t){case"keypress":if(Ea(n)===0)break e;case"keydown":case"keyup":f=wp;break;case"focusin":y="focus",f=zi;break;case"focusout":y="blur",f=zi;break;case"beforeblur":case"afterblur":f=zi;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Jc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=cp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Np;break;case ph:case gh:case xh:f=hp;break;case yh:f=Sp;break;case"scroll":f=op;break;case"wheel":f=Ep;break;case"copy":case"cut":case"paste":f=mp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Yc}var b=(e&4)!==0,S=!b&&t==="scroll",x=b?m!==null?m+"Capture":null:m;b=[];for(var g=u,p;g!==null;){p=g;var j=p.stateNode;if(p.tag===5&&j!==null&&(p=j,x!==null&&(j=Cs(g,x),j!=null&&b.push(Os(g,j,p)))),S)break;g=g.return}0<b.length&&(m=new f(m,y,null,n,d),h.push({event:m,listeners:b}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",m&&n!==Co&&(y=n.relatedTarget||n.fromElement)&&(qn(y)||y[on]))break e;if((f||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,f?(y=n.relatedTarget||n.toElement,f=u,y=y?qn(y):null,y!==null&&(S=ir(y),y!==S||y.tag!==5&&y.tag!==6)&&(y=null)):(f=null,y=u),f!==y)){if(b=Jc,j="onMouseLeave",x="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(b=Yc,j="onPointerLeave",x="onPointerEnter",g="pointer"),S=f==null?m:kr(f),p=y==null?m:kr(y),m=new b(j,g+"leave",f,n,d),m.target=S,m.relatedTarget=p,j=null,qn(d)===u&&(b=new b(x,g+"enter",y,n,d),b.target=p,b.relatedTarget=S,j=b),S=j,f&&y)t:{for(b=f,x=y,g=0,p=b;p;p=cr(p))g++;for(p=0,j=x;j;j=cr(j))p++;for(;0<g-p;)b=cr(b),g--;for(;0<p-g;)x=cr(x),p--;for(;g--;){if(b===x||x!==null&&b===x.alternate)break t;b=cr(b),x=cr(x)}b=null}else b=null;f!==null&&lu(h,m,f,b,!1),y!==null&&S!==null&&lu(h,S,y,b,!0)}}e:{if(m=u?kr(u):window,f=m.nodeName&&m.nodeName.toLowerCase(),f==="select"||f==="input"&&m.type==="file")var N=$p;else if(eu(m))if(uh)N=Fp;else{N=Dp;var w=Lp}else(f=m.nodeName)&&f.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(N=Rp);if(N&&(N=N(t,u))){ch(h,N,n,d);break e}w&&w(t,m,u),t==="focusout"&&(w=m._wrapperState)&&w.controlled&&m.type==="number"&&jo(m,"number",m.value)}switch(w=u?kr(u):window,t){case"focusin":(eu(w)||w.contentEditable==="true")&&(wr=w,Oo=u,xs=null);break;case"focusout":xs=Oo=wr=null;break;case"mousedown":$o=!0;break;case"contextmenu":case"mouseup":case"dragend":$o=!1,au(h,n,d);break;case"selectionchange":if(Bp)break;case"keydown":case"keyup":au(h,n,d)}var _;if(Ll)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else br?oh(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(ih&&n.locale!=="ko"&&(br||E!=="onCompositionStart"?E==="onCompositionEnd"&&br&&(_=ah()):(wn=d,Al="value"in wn?wn.value:wn.textContent,br=!0)),w=Wa(u,E),0<w.length&&(E=new Qc(E,t,null,n,d),h.push({event:E,listeners:w}),_?E.data=_:(_=lh(n),_!==null&&(E.data=_)))),(_=Tp?Ip(t,n):Mp(t,n))&&(u=Wa(u,"onBeforeInput"),0<u.length&&(d=new Qc("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=_))}bh(h,e)})}function Os(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Wa(t,e){for(var n=e+"Capture",r=[];t!==null;){var a=t,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Cs(t,n),i!=null&&r.unshift(Os(t,i,a)),i=Cs(t,e),i!=null&&r.push(Os(t,i,a))),t=t.return}return r}function cr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function lu(t,e,n,r,a){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,a?(c=Cs(n,i),c!=null&&o.unshift(Os(n,c,l))):a||(c=Cs(n,i),c!=null&&o.push(Os(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var qp=/\r\n?/g,Vp=/\u0000|\uFFFD/g;function cu(t){return(typeof t=="string"?t:""+t).replace(qp,`
`).replace(Vp,"")}function da(t,e,n){if(e=cu(e),cu(t)!==e&&n)throw Error(R(425))}function Ha(){}var Lo=null,Do=null;function Ro(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Fo=typeof setTimeout=="function"?setTimeout:void 0,Kp=typeof clearTimeout=="function"?clearTimeout:void 0,uu=typeof Promise=="function"?Promise:void 0,Jp=typeof queueMicrotask=="function"?queueMicrotask:typeof uu<"u"?function(t){return uu.resolve(null).then(t).catch(Qp)}:Fo;function Qp(t){setTimeout(function(){throw t})}function Ji(t,e){var n=e,r=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){t.removeChild(a),Ts(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Ts(e)}function Cn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function du(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Vr=Math.random().toString(36).slice(2),qt="__reactFiber$"+Vr,$s="__reactProps$"+Vr,on="__reactContainer$"+Vr,Uo="__reactEvents$"+Vr,Yp="__reactListeners$"+Vr,Xp="__reactHandles$"+Vr;function qn(t){var e=t[qt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[on]||n[qt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=du(t);t!==null;){if(n=t[qt])return n;t=du(t)}return e}t=n,n=t.parentNode}return null}function Vs(t){return t=t[qt]||t[on],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function kr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(R(33))}function mi(t){return t[$s]||null}var zo=[],Nr=-1;function Ln(t){return{current:t}}function Pe(t){0>Nr||(t.current=zo[Nr],zo[Nr]=null,Nr--)}function Se(t,e){Nr++,zo[Nr]=t.current,t.current=e}var On={},Xe=Ln(On),mt=Ln(!1),Xn=On;function Dr(t,e){var n=t.type.contextTypes;if(!n)return On;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function pt(t){return t=t.childContextTypes,t!=null}function qa(){Pe(mt),Pe(Xe)}function hu(t,e,n){if(Xe.current!==On)throw Error(R(168));Se(Xe,e),Se(mt,n)}function jh(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in e))throw Error(R(108,Lm(t)||"Unknown",a));return Ae({},n,r)}function Va(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||On,Xn=Xe.current,Se(Xe,t),Se(mt,mt.current),!0}function fu(t,e,n){var r=t.stateNode;if(!r)throw Error(R(169));n?(t=jh(t,e,Xn),r.__reactInternalMemoizedMergedChildContext=t,Pe(mt),Pe(Xe),Se(Xe,t)):Pe(mt),Se(mt,n)}var tn=null,pi=!1,Qi=!1;function kh(t){tn===null?tn=[t]:tn.push(t)}function Zp(t){pi=!0,kh(t)}function Dn(){if(!Qi&&tn!==null){Qi=!0;var t=0,e=ke;try{var n=tn;for(ke=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}tn=null,pi=!1}catch(a){throw tn!==null&&(tn=tn.slice(t+1)),Kd(Pl,Dn),a}finally{ke=e,Qi=!1}}return null}var _r=[],Sr=0,Ka=null,Ja=0,_t=[],St=0,Zn=null,nn=1,rn="";function Bn(t,e){_r[Sr++]=Ja,_r[Sr++]=Ka,Ka=t,Ja=e}function Nh(t,e,n){_t[St++]=nn,_t[St++]=rn,_t[St++]=Zn,Zn=t;var r=nn;t=rn;var a=32-Ut(r)-1;r&=~(1<<a),n+=1;var i=32-Ut(e)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,nn=1<<32-Ut(e)+a|n<<a|r,rn=i+t}else nn=1<<i|n<<a|r,rn=t}function Rl(t){t.return!==null&&(Bn(t,1),Nh(t,1,0))}function Fl(t){for(;t===Ka;)Ka=_r[--Sr],_r[Sr]=null,Ja=_r[--Sr],_r[Sr]=null;for(;t===Zn;)Zn=_t[--St],_t[St]=null,rn=_t[--St],_t[St]=null,nn=_t[--St],_t[St]=null}var bt=null,vt=null,Te=!1,Ft=null;function _h(t,e){var n=Ct(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function mu(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,bt=t,vt=Cn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,bt=t,vt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Zn!==null?{id:nn,overflow:rn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ct(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,bt=t,vt=null,!0):!1;default:return!1}}function Bo(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Go(t){if(Te){var e=vt;if(e){var n=e;if(!mu(t,e)){if(Bo(t))throw Error(R(418));e=Cn(n.nextSibling);var r=bt;e&&mu(t,e)?_h(r,n):(t.flags=t.flags&-4097|2,Te=!1,bt=t)}}else{if(Bo(t))throw Error(R(418));t.flags=t.flags&-4097|2,Te=!1,bt=t}}}function pu(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;bt=t}function ha(t){if(t!==bt)return!1;if(!Te)return pu(t),Te=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ro(t.type,t.memoizedProps)),e&&(e=vt)){if(Bo(t))throw Sh(),Error(R(418));for(;e;)_h(t,e),e=Cn(e.nextSibling)}if(pu(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(R(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){vt=Cn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}vt=null}}else vt=bt?Cn(t.stateNode.nextSibling):null;return!0}function Sh(){for(var t=vt;t;)t=Cn(t.nextSibling)}function Rr(){vt=bt=null,Te=!1}function Ul(t){Ft===null?Ft=[t]:Ft.push(t)}var eg=dn.ReactCurrentBatchConfig;function rs(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(R(309));var r=n.stateNode}if(!r)throw Error(R(147,t));var a=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(R(284));if(!n._owner)throw Error(R(290,t))}return t}function fa(t,e){throw t=Object.prototype.toString.call(e),Error(R(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function gu(t){var e=t._init;return e(t._payload)}function Ch(t){function e(x,g){if(t){var p=x.deletions;p===null?(x.deletions=[g],x.flags|=16):p.push(g)}}function n(x,g){if(!t)return null;for(;g!==null;)e(x,g),g=g.sibling;return null}function r(x,g){for(x=new Map;g!==null;)g.key!==null?x.set(g.key,g):x.set(g.index,g),g=g.sibling;return x}function a(x,g){return x=In(x,g),x.index=0,x.sibling=null,x}function i(x,g,p){return x.index=p,t?(p=x.alternate,p!==null?(p=p.index,p<g?(x.flags|=2,g):p):(x.flags|=2,g)):(x.flags|=1048576,g)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function l(x,g,p,j){return g===null||g.tag!==6?(g=ro(p,x.mode,j),g.return=x,g):(g=a(g,p),g.return=x,g)}function c(x,g,p,j){var N=p.type;return N===vr?d(x,g,p.props.children,j,p.key):g!==null&&(g.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===gn&&gu(N)===g.type)?(j=a(g,p.props),j.ref=rs(x,g,p),j.return=x,j):(j=$a(p.type,p.key,p.props,null,x.mode,j),j.ref=rs(x,g,p),j.return=x,j)}function u(x,g,p,j){return g===null||g.tag!==4||g.stateNode.containerInfo!==p.containerInfo||g.stateNode.implementation!==p.implementation?(g=so(p,x.mode,j),g.return=x,g):(g=a(g,p.children||[]),g.return=x,g)}function d(x,g,p,j,N){return g===null||g.tag!==7?(g=Qn(p,x.mode,j,N),g.return=x,g):(g=a(g,p),g.return=x,g)}function h(x,g,p){if(typeof g=="string"&&g!==""||typeof g=="number")return g=ro(""+g,x.mode,p),g.return=x,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case na:return p=$a(g.type,g.key,g.props,null,x.mode,p),p.ref=rs(x,null,g),p.return=x,p;case yr:return g=so(g,x.mode,p),g.return=x,g;case gn:var j=g._init;return h(x,j(g._payload),p)}if(cs(g)||Xr(g))return g=Qn(g,x.mode,p,null),g.return=x,g;fa(x,g)}return null}function m(x,g,p,j){var N=g!==null?g.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return N!==null?null:l(x,g,""+p,j);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case na:return p.key===N?c(x,g,p,j):null;case yr:return p.key===N?u(x,g,p,j):null;case gn:return N=p._init,m(x,g,N(p._payload),j)}if(cs(p)||Xr(p))return N!==null?null:d(x,g,p,j,null);fa(x,p)}return null}function f(x,g,p,j,N){if(typeof j=="string"&&j!==""||typeof j=="number")return x=x.get(p)||null,l(g,x,""+j,N);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case na:return x=x.get(j.key===null?p:j.key)||null,c(g,x,j,N);case yr:return x=x.get(j.key===null?p:j.key)||null,u(g,x,j,N);case gn:var w=j._init;return f(x,g,p,w(j._payload),N)}if(cs(j)||Xr(j))return x=x.get(p)||null,d(g,x,j,N,null);fa(g,j)}return null}function y(x,g,p,j){for(var N=null,w=null,_=g,E=g=0,C=null;_!==null&&E<p.length;E++){_.index>E?(C=_,_=null):C=_.sibling;var k=m(x,_,p[E],j);if(k===null){_===null&&(_=C);break}t&&_&&k.alternate===null&&e(x,_),g=i(k,g,E),w===null?N=k:w.sibling=k,w=k,_=C}if(E===p.length)return n(x,_),Te&&Bn(x,E),N;if(_===null){for(;E<p.length;E++)_=h(x,p[E],j),_!==null&&(g=i(_,g,E),w===null?N=_:w.sibling=_,w=_);return Te&&Bn(x,E),N}for(_=r(x,_);E<p.length;E++)C=f(_,x,E,p[E],j),C!==null&&(t&&C.alternate!==null&&_.delete(C.key===null?E:C.key),g=i(C,g,E),w===null?N=C:w.sibling=C,w=C);return t&&_.forEach(function(P){return e(x,P)}),Te&&Bn(x,E),N}function b(x,g,p,j){var N=Xr(p);if(typeof N!="function")throw Error(R(150));if(p=N.call(p),p==null)throw Error(R(151));for(var w=N=null,_=g,E=g=0,C=null,k=p.next();_!==null&&!k.done;E++,k=p.next()){_.index>E?(C=_,_=null):C=_.sibling;var P=m(x,_,k.value,j);if(P===null){_===null&&(_=C);break}t&&_&&P.alternate===null&&e(x,_),g=i(P,g,E),w===null?N=P:w.sibling=P,w=P,_=C}if(k.done)return n(x,_),Te&&Bn(x,E),N;if(_===null){for(;!k.done;E++,k=p.next())k=h(x,k.value,j),k!==null&&(g=i(k,g,E),w===null?N=k:w.sibling=k,w=k);return Te&&Bn(x,E),N}for(_=r(x,_);!k.done;E++,k=p.next())k=f(_,x,E,k.value,j),k!==null&&(t&&k.alternate!==null&&_.delete(k.key===null?E:k.key),g=i(k,g,E),w===null?N=k:w.sibling=k,w=k);return t&&_.forEach(function(U){return e(x,U)}),Te&&Bn(x,E),N}function S(x,g,p,j){if(typeof p=="object"&&p!==null&&p.type===vr&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case na:e:{for(var N=p.key,w=g;w!==null;){if(w.key===N){if(N=p.type,N===vr){if(w.tag===7){n(x,w.sibling),g=a(w,p.props.children),g.return=x,x=g;break e}}else if(w.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===gn&&gu(N)===w.type){n(x,w.sibling),g=a(w,p.props),g.ref=rs(x,w,p),g.return=x,x=g;break e}n(x,w);break}else e(x,w);w=w.sibling}p.type===vr?(g=Qn(p.props.children,x.mode,j,p.key),g.return=x,x=g):(j=$a(p.type,p.key,p.props,null,x.mode,j),j.ref=rs(x,g,p),j.return=x,x=j)}return o(x);case yr:e:{for(w=p.key;g!==null;){if(g.key===w)if(g.tag===4&&g.stateNode.containerInfo===p.containerInfo&&g.stateNode.implementation===p.implementation){n(x,g.sibling),g=a(g,p.children||[]),g.return=x,x=g;break e}else{n(x,g);break}else e(x,g);g=g.sibling}g=so(p,x.mode,j),g.return=x,x=g}return o(x);case gn:return w=p._init,S(x,g,w(p._payload),j)}if(cs(p))return y(x,g,p,j);if(Xr(p))return b(x,g,p,j);fa(x,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,g!==null&&g.tag===6?(n(x,g.sibling),g=a(g,p),g.return=x,x=g):(n(x,g),g=ro(p,x.mode,j),g.return=x,x=g),o(x)):n(x,g)}return S}var Fr=Ch(!0),Eh=Ch(!1),Qa=Ln(null),Ya=null,Cr=null,zl=null;function Bl(){zl=Cr=Ya=null}function Gl(t){var e=Qa.current;Pe(Qa),t._currentValue=e}function Wo(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Or(t,e){Ya=t,zl=Cr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ft=!0),t.firstContext=null)}function Tt(t){var e=t._currentValue;if(zl!==t)if(t={context:t,memoizedValue:e,next:null},Cr===null){if(Ya===null)throw Error(R(308));Cr=t,Ya.dependencies={lanes:0,firstContext:t}}else Cr=Cr.next=t;return e}var Vn=null;function Wl(t){Vn===null?Vn=[t]:Vn.push(t)}function Ph(t,e,n,r){var a=e.interleaved;return a===null?(n.next=n,Wl(e)):(n.next=a.next,a.next=n),e.interleaved=n,ln(t,r)}function ln(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var xn=!1;function Hl(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Th(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function sn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function En(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,we&2){var a=r.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),r.pending=e,ln(t,n)}return a=r.interleaved,a===null?(e.next=e,Wl(r)):(e.next=a.next,a.next=e),r.interleaved=e,ln(t,n)}function Pa(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Tl(t,n)}}function xu(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?a=i=e:i=i.next=e}else a=i=e;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Xa(t,e,n,r){var a=t.updateQueue;xn=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=a.baseState;o=0,d=u=c=null,l=i;do{var m=l.lane,f=l.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:f,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=t,b=l;switch(m=e,f=n,b.tag){case 1:if(y=b.payload,typeof y=="function"){h=y.call(f,h,m);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=b.payload,m=typeof y=="function"?y.call(f,h,m):y,m==null)break e;h=Ae({},h,m);break e;case 2:xn=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=a.effects,m===null?a.effects=[l]:m.push(l))}else f={eventTime:f,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=f,c=h):d=d.next=f,o|=m;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;m=l,l=m.next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}while(!0);if(d===null&&(c=h),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else i===null&&(a.shared.lanes=0);tr|=o,t.lanes=o,t.memoizedState=h}}function yu(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(R(191,a));a.call(r)}}}var Ks={},Kt=Ln(Ks),Ls=Ln(Ks),Ds=Ln(Ks);function Kn(t){if(t===Ks)throw Error(R(174));return t}function ql(t,e){switch(Se(Ds,e),Se(Ls,t),Se(Kt,Ks),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:No(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=No(e,t)}Pe(Kt),Se(Kt,e)}function Ur(){Pe(Kt),Pe(Ls),Pe(Ds)}function Ih(t){Kn(Ds.current);var e=Kn(Kt.current),n=No(e,t.type);e!==n&&(Se(Ls,t),Se(Kt,n))}function Vl(t){Ls.current===t&&(Pe(Kt),Pe(Ls))}var Ie=Ln(0);function Za(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Yi=[];function Kl(){for(var t=0;t<Yi.length;t++)Yi[t]._workInProgressVersionPrimary=null;Yi.length=0}var Ta=dn.ReactCurrentDispatcher,Xi=dn.ReactCurrentBatchConfig,er=0,Me=null,Ue=null,Be=null,ei=!1,ys=!1,Rs=0,tg=0;function Je(){throw Error(R(321))}function Jl(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Bt(t[n],e[n]))return!1;return!0}function Ql(t,e,n,r,a,i){if(er=i,Me=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ta.current=t===null||t.memoizedState===null?ag:ig,t=n(r,a),ys){i=0;do{if(ys=!1,Rs=0,25<=i)throw Error(R(301));i+=1,Be=Ue=null,e.updateQueue=null,Ta.current=og,t=n(r,a)}while(ys)}if(Ta.current=ti,e=Ue!==null&&Ue.next!==null,er=0,Be=Ue=Me=null,ei=!1,e)throw Error(R(300));return t}function Yl(){var t=Rs!==0;return Rs=0,t}function Wt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Be===null?Me.memoizedState=Be=t:Be=Be.next=t,Be}function It(){if(Ue===null){var t=Me.alternate;t=t!==null?t.memoizedState:null}else t=Ue.next;var e=Be===null?Me.memoizedState:Be.next;if(e!==null)Be=e,Ue=t;else{if(t===null)throw Error(R(310));Ue=t,t={memoizedState:Ue.memoizedState,baseState:Ue.baseState,baseQueue:Ue.baseQueue,queue:Ue.queue,next:null},Be===null?Me.memoizedState=Be=t:Be=Be.next=t}return Be}function Fs(t,e){return typeof e=="function"?e(t):e}function Zi(t){var e=It(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=Ue,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((er&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,Me.lanes|=d,tr|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,Bt(r,e.memoizedState)||(ft=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){a=t;do i=a.lane,Me.lanes|=i,tr|=i,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function eo(t){var e=It(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=n.dispatch,a=n.pending,i=e.memoizedState;if(a!==null){n.pending=null;var o=a=a.next;do i=t(i,o.action),o=o.next;while(o!==a);Bt(i,e.memoizedState)||(ft=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Mh(){}function Ah(t,e){var n=Me,r=It(),a=e(),i=!Bt(r.memoizedState,a);if(i&&(r.memoizedState=a,ft=!0),r=r.queue,Xl(Lh.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Be!==null&&Be.memoizedState.tag&1){if(n.flags|=2048,Us(9,$h.bind(null,n,r,a,e),void 0,null),Ge===null)throw Error(R(349));er&30||Oh(n,e,a)}return a}function Oh(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Me.updateQueue,e===null?(e={lastEffect:null,stores:null},Me.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function $h(t,e,n,r){e.value=n,e.getSnapshot=r,Dh(e)&&Rh(t)}function Lh(t,e,n){return n(function(){Dh(e)&&Rh(t)})}function Dh(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Bt(t,n)}catch{return!0}}function Rh(t){var e=ln(t,1);e!==null&&zt(e,t,1,-1)}function vu(t){var e=Wt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fs,lastRenderedState:t},e.queue=t,t=t.dispatch=sg.bind(null,Me,t),[e.memoizedState,t]}function Us(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Me.updateQueue,e===null?(e={lastEffect:null,stores:null},Me.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Fh(){return It().memoizedState}function Ia(t,e,n,r){var a=Wt();Me.flags|=t,a.memoizedState=Us(1|e,n,void 0,r===void 0?null:r)}function gi(t,e,n,r){var a=It();r=r===void 0?null:r;var i=void 0;if(Ue!==null){var o=Ue.memoizedState;if(i=o.destroy,r!==null&&Jl(r,o.deps)){a.memoizedState=Us(e,n,i,r);return}}Me.flags|=t,a.memoizedState=Us(1|e,n,i,r)}function bu(t,e){return Ia(8390656,8,t,e)}function Xl(t,e){return gi(2048,8,t,e)}function Uh(t,e){return gi(4,2,t,e)}function zh(t,e){return gi(4,4,t,e)}function Bh(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Gh(t,e,n){return n=n!=null?n.concat([t]):null,gi(4,4,Bh.bind(null,e,t),n)}function Zl(){}function Wh(t,e){var n=It();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jl(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Hh(t,e){var n=It();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Jl(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function qh(t,e,n){return er&21?(Bt(n,e)||(n=Yd(),Me.lanes|=n,tr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ft=!0),t.memoizedState=n)}function ng(t,e){var n=ke;ke=n!==0&&4>n?n:4,t(!0);var r=Xi.transition;Xi.transition={};try{t(!1),e()}finally{ke=n,Xi.transition=r}}function Vh(){return It().memoizedState}function rg(t,e,n){var r=Tn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Kh(t))Jh(e,n);else if(n=Ph(t,e,n,r),n!==null){var a=st();zt(n,t,r,a),Qh(n,e,r)}}function sg(t,e,n){var r=Tn(t),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Kh(t))Jh(e,a);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(a.hasEagerState=!0,a.eagerState=l,Bt(l,o)){var c=e.interleaved;c===null?(a.next=a,Wl(e)):(a.next=c.next,c.next=a),e.interleaved=a;return}}catch{}finally{}n=Ph(t,e,a,r),n!==null&&(a=st(),zt(n,t,r,a),Qh(n,e,r))}}function Kh(t){var e=t.alternate;return t===Me||e!==null&&e===Me}function Jh(t,e){ys=ei=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Qh(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Tl(t,n)}}var ti={readContext:Tt,useCallback:Je,useContext:Je,useEffect:Je,useImperativeHandle:Je,useInsertionEffect:Je,useLayoutEffect:Je,useMemo:Je,useReducer:Je,useRef:Je,useState:Je,useDebugValue:Je,useDeferredValue:Je,useTransition:Je,useMutableSource:Je,useSyncExternalStore:Je,useId:Je,unstable_isNewReconciler:!1},ag={readContext:Tt,useCallback:function(t,e){return Wt().memoizedState=[t,e===void 0?null:e],t},useContext:Tt,useEffect:bu,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ia(4194308,4,Bh.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ia(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ia(4,2,t,e)},useMemo:function(t,e){var n=Wt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Wt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=rg.bind(null,Me,t),[r.memoizedState,t]},useRef:function(t){var e=Wt();return t={current:t},e.memoizedState=t},useState:vu,useDebugValue:Zl,useDeferredValue:function(t){return Wt().memoizedState=t},useTransition:function(){var t=vu(!1),e=t[0];return t=ng.bind(null,t[1]),Wt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Me,a=Wt();if(Te){if(n===void 0)throw Error(R(407));n=n()}else{if(n=e(),Ge===null)throw Error(R(349));er&30||Oh(r,e,n)}a.memoizedState=n;var i={value:n,getSnapshot:e};return a.queue=i,bu(Lh.bind(null,r,i,t),[t]),r.flags|=2048,Us(9,$h.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Wt(),e=Ge.identifierPrefix;if(Te){var n=rn,r=nn;n=(r&~(1<<32-Ut(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Rs++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=tg++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ig={readContext:Tt,useCallback:Wh,useContext:Tt,useEffect:Xl,useImperativeHandle:Gh,useInsertionEffect:Uh,useLayoutEffect:zh,useMemo:Hh,useReducer:Zi,useRef:Fh,useState:function(){return Zi(Fs)},useDebugValue:Zl,useDeferredValue:function(t){var e=It();return qh(e,Ue.memoizedState,t)},useTransition:function(){var t=Zi(Fs)[0],e=It().memoizedState;return[t,e]},useMutableSource:Mh,useSyncExternalStore:Ah,useId:Vh,unstable_isNewReconciler:!1},og={readContext:Tt,useCallback:Wh,useContext:Tt,useEffect:Xl,useImperativeHandle:Gh,useInsertionEffect:Uh,useLayoutEffect:zh,useMemo:Hh,useReducer:eo,useRef:Fh,useState:function(){return eo(Fs)},useDebugValue:Zl,useDeferredValue:function(t){var e=It();return Ue===null?e.memoizedState=t:qh(e,Ue.memoizedState,t)},useTransition:function(){var t=eo(Fs)[0],e=It().memoizedState;return[t,e]},useMutableSource:Mh,useSyncExternalStore:Ah,useId:Vh,unstable_isNewReconciler:!1};function Lt(t,e){if(t&&t.defaultProps){e=Ae({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ho(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ae({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var xi={isMounted:function(t){return(t=t._reactInternals)?ir(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=st(),a=Tn(t),i=sn(r,a);i.payload=e,n!=null&&(i.callback=n),e=En(t,i,a),e!==null&&(zt(e,t,a,r),Pa(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=st(),a=Tn(t),i=sn(r,a);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=En(t,i,a),e!==null&&(zt(e,t,a,r),Pa(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=st(),r=Tn(t),a=sn(n,r);a.tag=2,e!=null&&(a.callback=e),e=En(t,a,r),e!==null&&(zt(e,t,r,n),Pa(e,t,r))}};function wu(t,e,n,r,a,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ms(n,r)||!Ms(a,i):!0}function Yh(t,e,n){var r=!1,a=On,i=e.contextType;return typeof i=="object"&&i!==null?i=Tt(i):(a=pt(e)?Xn:Xe.current,r=e.contextTypes,i=(r=r!=null)?Dr(t,a):On),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=xi,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=i),e}function ju(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&xi.enqueueReplaceState(e,e.state,null)}function qo(t,e,n,r){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},Hl(t);var i=e.contextType;typeof i=="object"&&i!==null?a.context=Tt(i):(i=pt(e)?Xn:Xe.current,a.context=Dr(t,i)),a.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Ho(t,e,i,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&xi.enqueueReplaceState(a,a.state,null),Xa(t,n,a,r),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function zr(t,e){try{var n="",r=e;do n+=$m(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:a,digest:null}}function to(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Vo(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var lg=typeof WeakMap=="function"?WeakMap:Map;function Xh(t,e,n){n=sn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ri||(ri=!0,rl=r),Vo(t,e)},n}function Zh(t,e,n){n=sn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var a=e.value;n.payload=function(){return r(a)},n.callback=function(){Vo(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Vo(t,e),typeof r!="function"&&(Pn===null?Pn=new Set([this]):Pn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function ku(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new lg;var a=new Set;r.set(e,a)}else a=r.get(e),a===void 0&&(a=new Set,r.set(e,a));a.has(n)||(a.add(n),t=jg.bind(null,t,e,n),e.then(t,t))}function Nu(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function _u(t,e,n,r,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=sn(-1,1),e.tag=2,En(n,e,1))),n.lanes|=1),t)}var cg=dn.ReactCurrentOwner,ft=!1;function rt(t,e,n,r){e.child=t===null?Eh(e,null,n,r):Fr(e,t.child,n,r)}function Su(t,e,n,r,a){n=n.render;var i=e.ref;return Or(e,a),r=Ql(t,e,n,r,i,a),n=Yl(),t!==null&&!ft?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,cn(t,e,a)):(Te&&n&&Rl(e),e.flags|=1,rt(t,e,r,a),e.child)}function Cu(t,e,n,r,a){if(t===null){var i=n.type;return typeof i=="function"&&!oc(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,ef(t,e,i,r,a)):(t=$a(n.type,null,r,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&a)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ms,n(o,r)&&t.ref===e.ref)return cn(t,e,a)}return e.flags|=1,t=In(i,r),t.ref=e.ref,t.return=e,e.child=t}function ef(t,e,n,r,a){if(t!==null){var i=t.memoizedProps;if(Ms(i,r)&&t.ref===e.ref)if(ft=!1,e.pendingProps=r=i,(t.lanes&a)!==0)t.flags&131072&&(ft=!0);else return e.lanes=t.lanes,cn(t,e,a)}return Ko(t,e,n,r,a)}function tf(t,e,n){var r=e.pendingProps,a=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Se(Pr,yt),yt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Se(Pr,yt),yt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Se(Pr,yt),yt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Se(Pr,yt),yt|=r;return rt(t,e,a,n),e.child}function nf(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ko(t,e,n,r,a){var i=pt(n)?Xn:Xe.current;return i=Dr(e,i),Or(e,a),n=Ql(t,e,n,r,i,a),r=Yl(),t!==null&&!ft?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,cn(t,e,a)):(Te&&r&&Rl(e),e.flags|=1,rt(t,e,n,a),e.child)}function Eu(t,e,n,r,a){if(pt(n)){var i=!0;Va(e)}else i=!1;if(Or(e,a),e.stateNode===null)Ma(t,e),Yh(e,n,r),qo(e,n,r,a),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Tt(u):(u=pt(n)?Xn:Xe.current,u=Dr(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&ju(e,o,r,u),xn=!1;var m=e.memoizedState;o.state=m,Xa(e,r,o,a),c=e.memoizedState,l!==r||m!==c||mt.current||xn?(typeof d=="function"&&(Ho(e,n,d,r),c=e.memoizedState),(l=xn||wu(e,n,l,r,m,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Th(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Lt(e.type,l),o.props=u,h=e.pendingProps,m=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Tt(c):(c=pt(n)?Xn:Xe.current,c=Dr(e,c));var f=n.getDerivedStateFromProps;(d=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||m!==c)&&ju(e,o,r,c),xn=!1,m=e.memoizedState,o.state=m,Xa(e,r,o,a);var y=e.memoizedState;l!==h||m!==y||mt.current||xn?(typeof f=="function"&&(Ho(e,n,f,r),y=e.memoizedState),(u=xn||wu(e,n,u,r,m,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),o.props=r,o.state=y,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Jo(t,e,n,r,i,a)}function Jo(t,e,n,r,a,i){nf(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return a&&fu(e,n,!1),cn(t,e,i);r=e.stateNode,cg.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Fr(e,t.child,null,i),e.child=Fr(e,null,l,i)):rt(t,e,l,i),e.memoizedState=r.state,a&&fu(e,n,!0),e.child}function rf(t){var e=t.stateNode;e.pendingContext?hu(t,e.pendingContext,e.pendingContext!==e.context):e.context&&hu(t,e.context,!1),ql(t,e.containerInfo)}function Pu(t,e,n,r,a){return Rr(),Ul(a),e.flags|=256,rt(t,e,n,r),e.child}var Qo={dehydrated:null,treeContext:null,retryLane:0};function Yo(t){return{baseLanes:t,cachePool:null,transitions:null}}function sf(t,e,n){var r=e.pendingProps,a=Ie.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(a&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),Se(Ie,a&1),t===null)return Go(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=bi(o,r,0,null),t=Qn(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Yo(n),e.memoizedState=Qo,t):ec(e,o));if(a=t.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return ug(t,e,o,r,l,a,n);if(i){i=r.fallback,o=e.mode,a=t.child,l=a.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==a?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=In(a,c),r.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=In(l,i):(i=Qn(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Yo(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Qo,r}return i=t.child,t=i.sibling,r=In(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ec(t,e){return e=bi({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ma(t,e,n,r){return r!==null&&Ul(r),Fr(e,t.child,null,n),t=ec(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ug(t,e,n,r,a,i,o){if(n)return e.flags&256?(e.flags&=-257,r=to(Error(R(422))),ma(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,a=e.mode,r=bi({mode:"visible",children:r.children},a,0,null),i=Qn(i,a,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Fr(e,t.child,null,o),e.child.memoizedState=Yo(o),e.memoizedState=Qo,i);if(!(e.mode&1))return ma(t,e,o,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(R(419)),r=to(i,r,void 0),ma(t,e,o,r)}if(l=(o&t.childLanes)!==0,ft||l){if(r=Ge,r!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,ln(t,a),zt(r,t,a,-1))}return ic(),r=to(Error(R(421))),ma(t,e,o,r)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=kg.bind(null,t),a._reactRetry=e,null):(t=i.treeContext,vt=Cn(a.nextSibling),bt=e,Te=!0,Ft=null,t!==null&&(_t[St++]=nn,_t[St++]=rn,_t[St++]=Zn,nn=t.id,rn=t.overflow,Zn=e),e=ec(e,r.children),e.flags|=4096,e)}function Tu(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Wo(t.return,e,n)}function no(t,e,n,r,a){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function af(t,e,n){var r=e.pendingProps,a=r.revealOrder,i=r.tail;if(rt(t,e,r.children,n),r=Ie.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Tu(t,n,e);else if(t.tag===19)Tu(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Se(Ie,r),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&Za(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),no(e,!1,a,n,i);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&Za(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}no(e,!0,n,null,i);break;case"together":no(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ma(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function cn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),tr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(R(153));if(e.child!==null){for(t=e.child,n=In(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=In(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function dg(t,e,n){switch(e.tag){case 3:rf(e),Rr();break;case 5:Ih(e);break;case 1:pt(e.type)&&Va(e);break;case 4:ql(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,a=e.memoizedProps.value;Se(Qa,r._currentValue),r._currentValue=a;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Se(Ie,Ie.current&1),e.flags|=128,null):n&e.child.childLanes?sf(t,e,n):(Se(Ie,Ie.current&1),t=cn(t,e,n),t!==null?t.sibling:null);Se(Ie,Ie.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return af(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Se(Ie,Ie.current),r)break;return null;case 22:case 23:return e.lanes=0,tf(t,e,n)}return cn(t,e,n)}var of,Xo,lf,cf;of=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Xo=function(){};lf=function(t,e,n,r){var a=t.memoizedProps;if(a!==r){t=e.stateNode,Kn(Kt.current);var i=null;switch(n){case"input":a=bo(t,a),r=bo(t,r),i=[];break;case"select":a=Ae({},a,{value:void 0}),r=Ae({},r,{value:void 0}),i=[];break;case"textarea":a=ko(t,a),r=ko(t,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ha)}_o(n,r);var o;n=null;for(u in a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var l=a[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(_s.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=a!=null?a[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(_s.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ee("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};cf=function(t,e,n,r){n!==r&&(e.flags|=4)};function ss(t,e){if(!Te)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Qe(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function hg(t,e,n){var r=e.pendingProps;switch(Fl(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qe(e),null;case 1:return pt(e.type)&&qa(),Qe(e),null;case 3:return r=e.stateNode,Ur(),Pe(mt),Pe(Xe),Kl(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ha(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ft!==null&&(il(Ft),Ft=null))),Xo(t,e),Qe(e),null;case 5:Vl(e);var a=Kn(Ds.current);if(n=e.type,t!==null&&e.stateNode!=null)lf(t,e,n,r,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(R(166));return Qe(e),null}if(t=Kn(Kt.current),ha(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[qt]=e,r[$s]=i,t=(e.mode&1)!==0,n){case"dialog":Ee("cancel",r),Ee("close",r);break;case"iframe":case"object":case"embed":Ee("load",r);break;case"video":case"audio":for(a=0;a<ds.length;a++)Ee(ds[a],r);break;case"source":Ee("error",r);break;case"img":case"image":case"link":Ee("error",r),Ee("load",r);break;case"details":Ee("toggle",r);break;case"input":Fc(r,i),Ee("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ee("invalid",r);break;case"textarea":zc(r,i),Ee("invalid",r)}_o(n,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&da(r.textContent,l,t),a=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&da(r.textContent,l,t),a=["children",""+l]):_s.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ee("scroll",r)}switch(n){case"input":ra(r),Uc(r,i,!0);break;case"textarea":ra(r),Bc(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ha)}r=a,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Ld(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[qt]=e,t[$s]=r,of(t,e,!1,!1),e.stateNode=t;e:{switch(o=So(n,r),n){case"dialog":Ee("cancel",t),Ee("close",t),a=r;break;case"iframe":case"object":case"embed":Ee("load",t),a=r;break;case"video":case"audio":for(a=0;a<ds.length;a++)Ee(ds[a],t);a=r;break;case"source":Ee("error",t),a=r;break;case"img":case"image":case"link":Ee("error",t),Ee("load",t),a=r;break;case"details":Ee("toggle",t),a=r;break;case"input":Fc(t,r),a=bo(t,r),Ee("invalid",t);break;case"option":a=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},a=Ae({},r,{value:void 0}),Ee("invalid",t);break;case"textarea":zc(t,r),a=ko(t,r),Ee("invalid",t);break;default:a=r}_o(n,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Fd(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Dd(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Ss(t,c):typeof c=="number"&&Ss(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(_s.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ee("scroll",t):c!=null&&Nl(t,i,c,o))}switch(n){case"input":ra(t),Uc(t,r,!1);break;case"textarea":ra(t),Bc(t);break;case"option":r.value!=null&&t.setAttribute("value",""+An(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Tr(t,!!r.multiple,i,!1):r.defaultValue!=null&&Tr(t,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=Ha)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qe(e),null;case 6:if(t&&e.stateNode!=null)cf(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(R(166));if(n=Kn(Ds.current),Kn(Kt.current),ha(e)){if(r=e.stateNode,n=e.memoizedProps,r[qt]=e,(i=r.nodeValue!==n)&&(t=bt,t!==null))switch(t.tag){case 3:da(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&da(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[qt]=e,e.stateNode=r}return Qe(e),null;case 13:if(Pe(Ie),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Te&&vt!==null&&e.mode&1&&!(e.flags&128))Sh(),Rr(),e.flags|=98560,i=!1;else if(i=ha(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(R(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(R(317));i[qt]=e}else Rr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qe(e),i=!1}else Ft!==null&&(il(Ft),Ft=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ie.current&1?ze===0&&(ze=3):ic())),e.updateQueue!==null&&(e.flags|=4),Qe(e),null);case 4:return Ur(),Xo(t,e),t===null&&As(e.stateNode.containerInfo),Qe(e),null;case 10:return Gl(e.type._context),Qe(e),null;case 17:return pt(e.type)&&qa(),Qe(e),null;case 19:if(Pe(Ie),i=e.memoizedState,i===null)return Qe(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)ss(i,!1);else{if(ze!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Za(t),o!==null){for(e.flags|=128,ss(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Se(Ie,Ie.current&1|2),e.child}t=t.sibling}i.tail!==null&&$e()>Br&&(e.flags|=128,r=!0,ss(i,!1),e.lanes=4194304)}else{if(!r)if(t=Za(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ss(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Te)return Qe(e),null}else 2*$e()-i.renderingStartTime>Br&&n!==1073741824&&(e.flags|=128,r=!0,ss(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=$e(),e.sibling=null,n=Ie.current,Se(Ie,r?n&1|2:n&1),e):(Qe(e),null);case 22:case 23:return ac(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?yt&1073741824&&(Qe(e),e.subtreeFlags&6&&(e.flags|=8192)):Qe(e),null;case 24:return null;case 25:return null}throw Error(R(156,e.tag))}function fg(t,e){switch(Fl(e),e.tag){case 1:return pt(e.type)&&qa(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ur(),Pe(mt),Pe(Xe),Kl(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Vl(e),null;case 13:if(Pe(Ie),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(R(340));Rr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Pe(Ie),null;case 4:return Ur(),null;case 10:return Gl(e.type._context),null;case 22:case 23:return ac(),null;case 24:return null;default:return null}}var pa=!1,Ye=!1,mg=typeof WeakSet=="function"?WeakSet:Set,Q=null;function Er(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Oe(t,e,r)}else n.current=null}function Zo(t,e,n){try{n()}catch(r){Oe(t,e,r)}}var Iu=!1;function pg(t,e){if(Lo=Ba,t=fh(),Dl(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=t,m=null;t:for(;;){for(var f;h!==n||a!==0&&h.nodeType!==3||(l=o+a),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)m=h,h=f;for(;;){if(h===t)break t;if(m===n&&++u===a&&(l=o),m===i&&++d===r&&(c=o),(f=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=f}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Do={focusedElem:t,selectionRange:n},Ba=!1,Q=e;Q!==null;)if(e=Q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Q=t;else for(;Q!==null;){e=Q;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var b=y.memoizedProps,S=y.memoizedState,x=e.stateNode,g=x.getSnapshotBeforeUpdate(e.elementType===e.type?b:Lt(e.type,b),S);x.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var p=e.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(j){Oe(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,Q=t;break}Q=e.return}return y=Iu,Iu=!1,y}function vs(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&t)===t){var i=a.destroy;a.destroy=void 0,i!==void 0&&Zo(e,n,i)}a=a.next}while(a!==r)}}function yi(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function el(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function uf(t){var e=t.alternate;e!==null&&(t.alternate=null,uf(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[qt],delete e[$s],delete e[Uo],delete e[Yp],delete e[Xp])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function df(t){return t.tag===5||t.tag===3||t.tag===4}function Mu(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||df(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function tl(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ha));else if(r!==4&&(t=t.child,t!==null))for(tl(t,e,n),t=t.sibling;t!==null;)tl(t,e,n),t=t.sibling}function nl(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(nl(t,e,n),t=t.sibling;t!==null;)nl(t,e,n),t=t.sibling}var qe=null,Dt=!1;function fn(t,e,n){for(n=n.child;n!==null;)hf(t,e,n),n=n.sibling}function hf(t,e,n){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(ui,n)}catch{}switch(n.tag){case 5:Ye||Er(n,e);case 6:var r=qe,a=Dt;qe=null,fn(t,e,n),qe=r,Dt=a,qe!==null&&(Dt?(t=qe,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):qe.removeChild(n.stateNode));break;case 18:qe!==null&&(Dt?(t=qe,n=n.stateNode,t.nodeType===8?Ji(t.parentNode,n):t.nodeType===1&&Ji(t,n),Ts(t)):Ji(qe,n.stateNode));break;case 4:r=qe,a=Dt,qe=n.stateNode.containerInfo,Dt=!0,fn(t,e,n),qe=r,Dt=a;break;case 0:case 11:case 14:case 15:if(!Ye&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Zo(n,e,o),a=a.next}while(a!==r)}fn(t,e,n);break;case 1:if(!Ye&&(Er(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Oe(n,e,l)}fn(t,e,n);break;case 21:fn(t,e,n);break;case 22:n.mode&1?(Ye=(r=Ye)||n.memoizedState!==null,fn(t,e,n),Ye=r):fn(t,e,n);break;default:fn(t,e,n)}}function Au(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new mg),e.forEach(function(r){var a=Ng.bind(null,t,r);n.has(r)||(n.add(r),r.then(a,a))})}}function Ot(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:qe=l.stateNode,Dt=!1;break e;case 3:qe=l.stateNode.containerInfo,Dt=!0;break e;case 4:qe=l.stateNode.containerInfo,Dt=!0;break e}l=l.return}if(qe===null)throw Error(R(160));hf(i,o,a),qe=null,Dt=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){Oe(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ff(e,t),e=e.sibling}function ff(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ot(e,t),Gt(t),r&4){try{vs(3,t,t.return),yi(3,t)}catch(b){Oe(t,t.return,b)}try{vs(5,t,t.return)}catch(b){Oe(t,t.return,b)}}break;case 1:Ot(e,t),Gt(t),r&512&&n!==null&&Er(n,n.return);break;case 5:if(Ot(e,t),Gt(t),r&512&&n!==null&&Er(n,n.return),t.flags&32){var a=t.stateNode;try{Ss(a,"")}catch(b){Oe(t,t.return,b)}}if(r&4&&(a=t.stateNode,a!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Od(a,i),So(l,o);var u=So(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?Fd(a,h):d==="dangerouslySetInnerHTML"?Dd(a,h):d==="children"?Ss(a,h):Nl(a,d,h,u)}switch(l){case"input":wo(a,i);break;case"textarea":$d(a,i);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Tr(a,!!i.multiple,f,!1):m!==!!i.multiple&&(i.defaultValue!=null?Tr(a,!!i.multiple,i.defaultValue,!0):Tr(a,!!i.multiple,i.multiple?[]:"",!1))}a[$s]=i}catch(b){Oe(t,t.return,b)}}break;case 6:if(Ot(e,t),Gt(t),r&4){if(t.stateNode===null)throw Error(R(162));a=t.stateNode,i=t.memoizedProps;try{a.nodeValue=i}catch(b){Oe(t,t.return,b)}}break;case 3:if(Ot(e,t),Gt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ts(e.containerInfo)}catch(b){Oe(t,t.return,b)}break;case 4:Ot(e,t),Gt(t);break;case 13:Ot(e,t),Gt(t),a=t.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(rc=$e())),r&4&&Au(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Ye=(u=Ye)||d,Ot(e,t),Ye=u):Ot(e,t),Gt(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Q=t,d=t.child;d!==null;){for(h=Q=d;Q!==null;){switch(m=Q,f=m.child,m.tag){case 0:case 11:case 14:case 15:vs(4,m,m.return);break;case 1:Er(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(b){Oe(r,n,b)}}break;case 5:Er(m,m.return);break;case 22:if(m.memoizedState!==null){$u(h);continue}}f!==null?(f.return=m,Q=f):$u(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{a=h.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Rd("display",o))}catch(b){Oe(t,t.return,b)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(b){Oe(t,t.return,b)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ot(e,t),Gt(t),r&4&&Au(t);break;case 21:break;default:Ot(e,t),Gt(t)}}function Gt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(df(n)){var r=n;break e}n=n.return}throw Error(R(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(Ss(a,""),r.flags&=-33);var i=Mu(t);nl(t,i,a);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Mu(t);tl(t,l,o);break;default:throw Error(R(161))}}catch(c){Oe(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function gg(t,e,n){Q=t,mf(t)}function mf(t,e,n){for(var r=(t.mode&1)!==0;Q!==null;){var a=Q,i=a.child;if(a.tag===22&&r){var o=a.memoizedState!==null||pa;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||Ye;l=pa;var u=Ye;if(pa=o,(Ye=c)&&!u)for(Q=a;Q!==null;)o=Q,c=o.child,o.tag===22&&o.memoizedState!==null?Lu(a):c!==null?(c.return=o,Q=c):Lu(a);for(;i!==null;)Q=i,mf(i),i=i.sibling;Q=a,pa=l,Ye=u}Ou(t)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Q=i):Ou(t)}}function Ou(t){for(;Q!==null;){var e=Q;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ye||yi(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ye)if(n===null)r.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:Lt(e.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&yu(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}yu(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Ts(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}Ye||e.flags&512&&el(e)}catch(m){Oe(e,e.return,m)}}if(e===t){Q=null;break}if(n=e.sibling,n!==null){n.return=e.return,Q=n;break}Q=e.return}}function $u(t){for(;Q!==null;){var e=Q;if(e===t){Q=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Q=n;break}Q=e.return}}function Lu(t){for(;Q!==null;){var e=Q;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{yi(4,e)}catch(c){Oe(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var a=e.return;try{r.componentDidMount()}catch(c){Oe(e,a,c)}}var i=e.return;try{el(e)}catch(c){Oe(e,i,c)}break;case 5:var o=e.return;try{el(e)}catch(c){Oe(e,o,c)}}}catch(c){Oe(e,e.return,c)}if(e===t){Q=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Q=l;break}Q=e.return}}var xg=Math.ceil,ni=dn.ReactCurrentDispatcher,tc=dn.ReactCurrentOwner,Et=dn.ReactCurrentBatchConfig,we=0,Ge=null,Le=null,Ve=0,yt=0,Pr=Ln(0),ze=0,zs=null,tr=0,vi=0,nc=0,bs=null,dt=null,rc=0,Br=1/0,Zt=null,ri=!1,rl=null,Pn=null,ga=!1,jn=null,si=0,ws=0,sl=null,Aa=-1,Oa=0;function st(){return we&6?$e():Aa!==-1?Aa:Aa=$e()}function Tn(t){return t.mode&1?we&2&&Ve!==0?Ve&-Ve:eg.transition!==null?(Oa===0&&(Oa=Yd()),Oa):(t=ke,t!==0||(t=window.event,t=t===void 0?16:sh(t.type)),t):1}function zt(t,e,n,r){if(50<ws)throw ws=0,sl=null,Error(R(185));Hs(t,n,r),(!(we&2)||t!==Ge)&&(t===Ge&&(!(we&2)&&(vi|=n),ze===4&&vn(t,Ve)),gt(t,r),n===1&&we===0&&!(e.mode&1)&&(Br=$e()+500,pi&&Dn()))}function gt(t,e){var n=t.callbackNode;ep(t,e);var r=za(t,t===Ge?Ve:0);if(r===0)n!==null&&Hc(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Hc(n),e===1)t.tag===0?Zp(Du.bind(null,t)):kh(Du.bind(null,t)),Jp(function(){!(we&6)&&Dn()}),n=null;else{switch(Xd(r)){case 1:n=Pl;break;case 4:n=Jd;break;case 16:n=Ua;break;case 536870912:n=Qd;break;default:n=Ua}n=jf(n,pf.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function pf(t,e){if(Aa=-1,Oa=0,we&6)throw Error(R(327));var n=t.callbackNode;if($r()&&t.callbackNode!==n)return null;var r=za(t,t===Ge?Ve:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ai(t,r);else{e=r;var a=we;we|=2;var i=xf();(Ge!==t||Ve!==e)&&(Zt=null,Br=$e()+500,Jn(t,e));do try{bg();break}catch(l){gf(t,l)}while(!0);Bl(),ni.current=i,we=a,Le!==null?e=0:(Ge=null,Ve=0,e=ze)}if(e!==0){if(e===2&&(a=Io(t),a!==0&&(r=a,e=al(t,a))),e===1)throw n=zs,Jn(t,0),vn(t,r),gt(t,$e()),n;if(e===6)vn(t,r);else{if(a=t.current.alternate,!(r&30)&&!yg(a)&&(e=ai(t,r),e===2&&(i=Io(t),i!==0&&(r=i,e=al(t,i))),e===1))throw n=zs,Jn(t,0),vn(t,r),gt(t,$e()),n;switch(t.finishedWork=a,t.finishedLanes=r,e){case 0:case 1:throw Error(R(345));case 2:Gn(t,dt,Zt);break;case 3:if(vn(t,r),(r&130023424)===r&&(e=rc+500-$e(),10<e)){if(za(t,0)!==0)break;if(a=t.suspendedLanes,(a&r)!==r){st(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=Fo(Gn.bind(null,t,dt,Zt),e);break}Gn(t,dt,Zt);break;case 4:if(vn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,a=-1;0<r;){var o=31-Ut(r);i=1<<o,o=e[o],o>a&&(a=o),r&=~i}if(r=a,r=$e()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*xg(r/1960))-r,10<r){t.timeoutHandle=Fo(Gn.bind(null,t,dt,Zt),r);break}Gn(t,dt,Zt);break;case 5:Gn(t,dt,Zt);break;default:throw Error(R(329))}}}return gt(t,$e()),t.callbackNode===n?pf.bind(null,t):null}function al(t,e){var n=bs;return t.current.memoizedState.isDehydrated&&(Jn(t,e).flags|=256),t=ai(t,e),t!==2&&(e=dt,dt=n,e!==null&&il(e)),t}function il(t){dt===null?dt=t:dt.push.apply(dt,t)}function yg(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!Bt(i(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function vn(t,e){for(e&=~nc,e&=~vi,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ut(e),r=1<<n;t[n]=-1,e&=~r}}function Du(t){if(we&6)throw Error(R(327));$r();var e=za(t,0);if(!(e&1))return gt(t,$e()),null;var n=ai(t,e);if(t.tag!==0&&n===2){var r=Io(t);r!==0&&(e=r,n=al(t,r))}if(n===1)throw n=zs,Jn(t,0),vn(t,e),gt(t,$e()),n;if(n===6)throw Error(R(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Gn(t,dt,Zt),gt(t,$e()),null}function sc(t,e){var n=we;we|=1;try{return t(e)}finally{we=n,we===0&&(Br=$e()+500,pi&&Dn())}}function nr(t){jn!==null&&jn.tag===0&&!(we&6)&&$r();var e=we;we|=1;var n=Et.transition,r=ke;try{if(Et.transition=null,ke=1,t)return t()}finally{ke=r,Et.transition=n,we=e,!(we&6)&&Dn()}}function ac(){yt=Pr.current,Pe(Pr)}function Jn(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Kp(n)),Le!==null)for(n=Le.return;n!==null;){var r=n;switch(Fl(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&qa();break;case 3:Ur(),Pe(mt),Pe(Xe),Kl();break;case 5:Vl(r);break;case 4:Ur();break;case 13:Pe(Ie);break;case 19:Pe(Ie);break;case 10:Gl(r.type._context);break;case 22:case 23:ac()}n=n.return}if(Ge=t,Le=t=In(t.current,null),Ve=yt=e,ze=0,zs=null,nc=vi=tr=0,dt=bs=null,Vn!==null){for(e=0;e<Vn.length;e++)if(n=Vn[e],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=a,r.next=o}n.pending=r}Vn=null}return t}function gf(t,e){do{var n=Le;try{if(Bl(),Ta.current=ti,ei){for(var r=Me.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}ei=!1}if(er=0,Be=Ue=Me=null,ys=!1,Rs=0,tc.current=null,n===null||n.return===null){ze=1,zs=e,Le=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=Ve,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=Nu(o);if(f!==null){f.flags&=-257,_u(f,o,l,i,e),f.mode&1&&ku(i,u,e),e=f,c=u;var y=e.updateQueue;if(y===null){var b=new Set;b.add(c),e.updateQueue=b}else y.add(c);break e}else{if(!(e&1)){ku(i,u,e),ic();break e}c=Error(R(426))}}else if(Te&&l.mode&1){var S=Nu(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),_u(S,o,l,i,e),Ul(zr(c,l));break e}}i=c=zr(c,l),ze!==4&&(ze=2),bs===null?bs=[i]:bs.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=Xh(i,c,e);xu(i,x);break e;case 1:l=c;var g=i.type,p=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Pn===null||!Pn.has(p)))){i.flags|=65536,e&=-e,i.lanes|=e;var j=Zh(i,l,e);xu(i,j);break e}}i=i.return}while(i!==null)}vf(n)}catch(N){e=N,Le===n&&n!==null&&(Le=n=n.return);continue}break}while(!0)}function xf(){var t=ni.current;return ni.current=ti,t===null?ti:t}function ic(){(ze===0||ze===3||ze===2)&&(ze=4),Ge===null||!(tr&268435455)&&!(vi&268435455)||vn(Ge,Ve)}function ai(t,e){var n=we;we|=2;var r=xf();(Ge!==t||Ve!==e)&&(Zt=null,Jn(t,e));do try{vg();break}catch(a){gf(t,a)}while(!0);if(Bl(),we=n,ni.current=r,Le!==null)throw Error(R(261));return Ge=null,Ve=0,ze}function vg(){for(;Le!==null;)yf(Le)}function bg(){for(;Le!==null&&!Hm();)yf(Le)}function yf(t){var e=wf(t.alternate,t,yt);t.memoizedProps=t.pendingProps,e===null?vf(t):Le=e,tc.current=null}function vf(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=fg(n,e),n!==null){n.flags&=32767,Le=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ze=6,Le=null;return}}else if(n=hg(n,e,yt),n!==null){Le=n;return}if(e=e.sibling,e!==null){Le=e;return}Le=e=t}while(e!==null);ze===0&&(ze=5)}function Gn(t,e,n){var r=ke,a=Et.transition;try{Et.transition=null,ke=1,wg(t,e,n,r)}finally{Et.transition=a,ke=r}return null}function wg(t,e,n,r){do $r();while(jn!==null);if(we&6)throw Error(R(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(R(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(tp(t,i),t===Ge&&(Le=Ge=null,Ve=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ga||(ga=!0,jf(Ua,function(){return $r(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Et.transition,Et.transition=null;var o=ke;ke=1;var l=we;we|=4,tc.current=null,pg(t,n),ff(n,t),zp(Do),Ba=!!Lo,Do=Lo=null,t.current=n,gg(n),qm(),we=l,ke=o,Et.transition=i}else t.current=n;if(ga&&(ga=!1,jn=t,si=a),i=t.pendingLanes,i===0&&(Pn=null),Jm(n.stateNode),gt(t,$e()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(ri)throw ri=!1,t=rl,rl=null,t;return si&1&&t.tag!==0&&$r(),i=t.pendingLanes,i&1?t===sl?ws++:(ws=0,sl=t):ws=0,Dn(),null}function $r(){if(jn!==null){var t=Xd(si),e=Et.transition,n=ke;try{if(Et.transition=null,ke=16>t?16:t,jn===null)var r=!1;else{if(t=jn,jn=null,si=0,we&6)throw Error(R(331));var a=we;for(we|=4,Q=t.current;Q!==null;){var i=Q,o=i.child;if(Q.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Q=u;Q!==null;){var d=Q;switch(d.tag){case 0:case 11:case 15:vs(8,d,i)}var h=d.child;if(h!==null)h.return=d,Q=h;else for(;Q!==null;){d=Q;var m=d.sibling,f=d.return;if(uf(d),d===u){Q=null;break}if(m!==null){m.return=f,Q=m;break}Q=f}}}var y=i.alternate;if(y!==null){var b=y.child;if(b!==null){y.child=null;do{var S=b.sibling;b.sibling=null,b=S}while(b!==null)}}Q=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Q=o;else e:for(;Q!==null;){if(i=Q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:vs(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,Q=x;break e}Q=i.return}}var g=t.current;for(Q=g;Q!==null;){o=Q;var p=o.child;if(o.subtreeFlags&2064&&p!==null)p.return=o,Q=p;else e:for(o=g;Q!==null;){if(l=Q,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:yi(9,l)}}catch(N){Oe(l,l.return,N)}if(l===o){Q=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,Q=j;break e}Q=l.return}}if(we=a,Dn(),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(ui,t)}catch{}r=!0}return r}finally{ke=n,Et.transition=e}}return!1}function Ru(t,e,n){e=zr(n,e),e=Xh(t,e,1),t=En(t,e,1),e=st(),t!==null&&(Hs(t,1,e),gt(t,e))}function Oe(t,e,n){if(t.tag===3)Ru(t,t,n);else for(;e!==null;){if(e.tag===3){Ru(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Pn===null||!Pn.has(r))){t=zr(n,t),t=Zh(e,t,1),e=En(e,t,1),t=st(),e!==null&&(Hs(e,1,t),gt(e,t));break}}e=e.return}}function jg(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=st(),t.pingedLanes|=t.suspendedLanes&n,Ge===t&&(Ve&n)===n&&(ze===4||ze===3&&(Ve&130023424)===Ve&&500>$e()-rc?Jn(t,0):nc|=n),gt(t,e)}function bf(t,e){e===0&&(t.mode&1?(e=ia,ia<<=1,!(ia&130023424)&&(ia=4194304)):e=1);var n=st();t=ln(t,e),t!==null&&(Hs(t,e,n),gt(t,n))}function kg(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),bf(t,n)}function Ng(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(R(314))}r!==null&&r.delete(e),bf(t,n)}var wf;wf=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||mt.current)ft=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ft=!1,dg(t,e,n);ft=!!(t.flags&131072)}else ft=!1,Te&&e.flags&1048576&&Nh(e,Ja,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ma(t,e),t=e.pendingProps;var a=Dr(e,Xe.current);Or(e,n),a=Ql(null,e,r,t,a,n);var i=Yl();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,pt(r)?(i=!0,Va(e)):i=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Hl(e),a.updater=xi,e.stateNode=a,a._reactInternals=e,qo(e,r,t,n),e=Jo(null,e,r,!0,i,n)):(e.tag=0,Te&&i&&Rl(e),rt(null,e,a,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ma(t,e),t=e.pendingProps,a=r._init,r=a(r._payload),e.type=r,a=e.tag=Sg(r),t=Lt(r,t),a){case 0:e=Ko(null,e,r,t,n);break e;case 1:e=Eu(null,e,r,t,n);break e;case 11:e=Su(null,e,r,t,n);break e;case 14:e=Cu(null,e,r,Lt(r.type,t),n);break e}throw Error(R(306,r,""))}return e;case 0:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Lt(r,a),Ko(t,e,r,a,n);case 1:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Lt(r,a),Eu(t,e,r,a,n);case 3:e:{if(rf(e),t===null)throw Error(R(387));r=e.pendingProps,i=e.memoizedState,a=i.element,Th(t,e),Xa(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){a=zr(Error(R(423)),e),e=Pu(t,e,r,n,a);break e}else if(r!==a){a=zr(Error(R(424)),e),e=Pu(t,e,r,n,a);break e}else for(vt=Cn(e.stateNode.containerInfo.firstChild),bt=e,Te=!0,Ft=null,n=Eh(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Rr(),r===a){e=cn(t,e,n);break e}rt(t,e,r,n)}e=e.child}return e;case 5:return Ih(e),t===null&&Go(e),r=e.type,a=e.pendingProps,i=t!==null?t.memoizedProps:null,o=a.children,Ro(r,a)?o=null:i!==null&&Ro(r,i)&&(e.flags|=32),nf(t,e),rt(t,e,o,n),e.child;case 6:return t===null&&Go(e),null;case 13:return sf(t,e,n);case 4:return ql(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Fr(e,null,r,n):rt(t,e,r,n),e.child;case 11:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Lt(r,a),Su(t,e,r,a,n);case 7:return rt(t,e,e.pendingProps,n),e.child;case 8:return rt(t,e,e.pendingProps.children,n),e.child;case 12:return rt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,a=e.pendingProps,i=e.memoizedProps,o=a.value,Se(Qa,r._currentValue),r._currentValue=o,i!==null)if(Bt(i.value,o)){if(i.children===a.children&&!mt.current){e=cn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=sn(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Wo(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(R(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Wo(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}rt(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,r=e.pendingProps.children,Or(e,n),a=Tt(a),r=r(a),e.flags|=1,rt(t,e,r,n),e.child;case 14:return r=e.type,a=Lt(r,e.pendingProps),a=Lt(r.type,a),Cu(t,e,r,a,n);case 15:return ef(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Lt(r,a),Ma(t,e),e.tag=1,pt(r)?(t=!0,Va(e)):t=!1,Or(e,n),Yh(e,r,a),qo(e,r,a,n),Jo(null,e,r,!0,t,n);case 19:return af(t,e,n);case 22:return tf(t,e,n)}throw Error(R(156,e.tag))};function jf(t,e){return Kd(t,e)}function _g(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ct(t,e,n,r){return new _g(t,e,n,r)}function oc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Sg(t){if(typeof t=="function")return oc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Sl)return 11;if(t===Cl)return 14}return 2}function In(t,e){var n=t.alternate;return n===null?(n=Ct(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function $a(t,e,n,r,a,i){var o=2;if(r=t,typeof t=="function")oc(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case vr:return Qn(n.children,a,i,e);case _l:o=8,a|=8;break;case go:return t=Ct(12,n,e,a|2),t.elementType=go,t.lanes=i,t;case xo:return t=Ct(13,n,e,a),t.elementType=xo,t.lanes=i,t;case yo:return t=Ct(19,n,e,a),t.elementType=yo,t.lanes=i,t;case Id:return bi(n,a,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Pd:o=10;break e;case Td:o=9;break e;case Sl:o=11;break e;case Cl:o=14;break e;case gn:o=16,r=null;break e}throw Error(R(130,t==null?t:typeof t,""))}return e=Ct(o,n,e,a),e.elementType=t,e.type=r,e.lanes=i,e}function Qn(t,e,n,r){return t=Ct(7,t,r,e),t.lanes=n,t}function bi(t,e,n,r){return t=Ct(22,t,r,e),t.elementType=Id,t.lanes=n,t.stateNode={isHidden:!1},t}function ro(t,e,n){return t=Ct(6,t,null,e),t.lanes=n,t}function so(t,e,n){return e=Ct(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Cg(t,e,n,r,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ri(0),this.expirationTimes=Ri(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ri(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function lc(t,e,n,r,a,i,o,l,c){return t=new Cg(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ct(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hl(i),t}function Eg(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yr,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function kf(t){if(!t)return On;t=t._reactInternals;e:{if(ir(t)!==t||t.tag!==1)throw Error(R(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(pt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(R(171))}if(t.tag===1){var n=t.type;if(pt(n))return jh(t,n,e)}return e}function Nf(t,e,n,r,a,i,o,l,c){return t=lc(n,r,!0,t,a,i,o,l,c),t.context=kf(null),n=t.current,r=st(),a=Tn(n),i=sn(r,a),i.callback=e??null,En(n,i,a),t.current.lanes=a,Hs(t,a,r),gt(t,r),t}function wi(t,e,n,r){var a=e.current,i=st(),o=Tn(a);return n=kf(n),e.context===null?e.context=n:e.pendingContext=n,e=sn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=En(a,e,o),t!==null&&(zt(t,a,o,i),Pa(t,a,o)),o}function ii(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Fu(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function cc(t,e){Fu(t,e),(t=t.alternate)&&Fu(t,e)}function Pg(){return null}var _f=typeof reportError=="function"?reportError:function(t){console.error(t)};function uc(t){this._internalRoot=t}ji.prototype.render=uc.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(R(409));wi(t,e,null,null)};ji.prototype.unmount=uc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;nr(function(){wi(null,t,null,null)}),e[on]=null}};function ji(t){this._internalRoot=t}ji.prototype.unstable_scheduleHydration=function(t){if(t){var e=th();t={blockedOn:null,target:t,priority:e};for(var n=0;n<yn.length&&e!==0&&e<yn[n].priority;n++);yn.splice(n,0,t),n===0&&rh(t)}};function dc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ki(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Uu(){}function Tg(t,e,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var u=ii(o);i.call(u)}}var o=Nf(e,r,t,0,null,!1,!1,"",Uu);return t._reactRootContainer=o,t[on]=o.current,As(t.nodeType===8?t.parentNode:t),nr(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof r=="function"){var l=r;r=function(){var u=ii(c);l.call(u)}}var c=lc(t,0,!1,null,null,!1,!1,"",Uu);return t._reactRootContainer=c,t[on]=c.current,As(t.nodeType===8?t.parentNode:t),nr(function(){wi(e,c,n,r)}),c}function Ni(t,e,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var c=ii(o);l.call(c)}}wi(e,o,t,a)}else o=Tg(n,e,t,a,r);return ii(o)}Zd=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=us(e.pendingLanes);n!==0&&(Tl(e,n|1),gt(e,$e()),!(we&6)&&(Br=$e()+500,Dn()))}break;case 13:nr(function(){var r=ln(t,1);if(r!==null){var a=st();zt(r,t,1,a)}}),cc(t,1)}};Il=function(t){if(t.tag===13){var e=ln(t,134217728);if(e!==null){var n=st();zt(e,t,134217728,n)}cc(t,134217728)}};eh=function(t){if(t.tag===13){var e=Tn(t),n=ln(t,e);if(n!==null){var r=st();zt(n,t,e,r)}cc(t,e)}};th=function(){return ke};nh=function(t,e){var n=ke;try{return ke=t,e()}finally{ke=n}};Eo=function(t,e,n){switch(e){case"input":if(wo(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var a=mi(r);if(!a)throw Error(R(90));Ad(r),wo(r,a)}}}break;case"textarea":$d(t,n);break;case"select":e=n.value,e!=null&&Tr(t,!!n.multiple,e,!1)}};Bd=sc;Gd=nr;var Ig={usingClientEntryPoint:!1,Events:[Vs,kr,mi,Ud,zd,sc]},as={findFiberByHostInstance:qn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Mg={bundleType:as.bundleType,version:as.version,rendererPackageName:as.rendererPackageName,rendererConfig:as.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:dn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=qd(t),t===null?null:t.stateNode},findFiberByHostInstance:as.findFiberByHostInstance||Pg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xa.isDisabled&&xa.supportsFiber)try{ui=xa.inject(Mg),Vt=xa}catch{}}jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ig;jt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dc(e))throw Error(R(200));return Eg(t,e,null,n)};jt.createRoot=function(t,e){if(!dc(t))throw Error(R(299));var n=!1,r="",a=_f;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=lc(t,1,!1,null,null,n,!1,r,a),t[on]=e.current,As(t.nodeType===8?t.parentNode:t),new uc(e)};jt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(R(188)):(t=Object.keys(t).join(","),Error(R(268,t)));return t=qd(e),t=t===null?null:t.stateNode,t};jt.flushSync=function(t){return nr(t)};jt.hydrate=function(t,e,n){if(!ki(e))throw Error(R(200));return Ni(null,t,e,!0,n)};jt.hydrateRoot=function(t,e,n){if(!dc(t))throw Error(R(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",o=_f;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Nf(e,null,t,1,n??null,a,!1,i,o),t[on]=e.current,As(t),r)for(t=0;t<r.length;t++)n=r[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new ji(e)};jt.render=function(t,e,n){if(!ki(e))throw Error(R(200));return Ni(null,t,e,!1,n)};jt.unmountComponentAtNode=function(t){if(!ki(t))throw Error(R(40));return t._reactRootContainer?(nr(function(){Ni(null,null,t,!1,function(){t._reactRootContainer=null,t[on]=null})}),!0):!1};jt.unstable_batchedUpdates=sc;jt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ki(n))throw Error(R(200));if(t==null||t._reactInternals===void 0)throw Error(R(38));return Ni(t,e,n,!1,r)};jt.version="18.3.1-next-f1338f8080-20240426";function Sf(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Sf)}catch(t){console.error(t)}}Sf(),_d.exports=jt;var Ag=_d.exports,Cf,zu=Ag;Cf=zu.createRoot,zu.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Og={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $g=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),oe=(t,e)=>{const n=v.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...u},d)=>v.createElement("svg",{ref:d,...Og,width:a,height:a,stroke:r,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${$g(t)}`,l].join(" "),...u},[...e.map(([h,m])=>v.createElement(h,m)),...Array.isArray(c)?c:[c]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=oe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=oe("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=oe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=oe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=oe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hc=oe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rg=oe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=oe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=oe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fg=oe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ef=oe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=oe("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=oe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=oe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pf=oe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fc=oe("Gamepad2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tf=oe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=oe("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ug=oe("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=oe("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zg=oe("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bg=oe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=oe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=oe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=oe("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=oe("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wg=oe("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=oe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hg=oe("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mc=oe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=oe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pc=oe("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vg=oe("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=oe("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mf=oe("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=oe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=oe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=oe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=oe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=oe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jg=oe("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qg=oe("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Yg="modulepreload",Xg=function(t){return"/battleplanapp/"+t},qu={},Ys=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(n.map(c=>{if(c=Xg(c),c in qu)return;qu[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":Yg,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((m,f)=>{h.addEventListener("load",m),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},Zg=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Ys(async()=>{const{default:r}=await Promise.resolve().then(()=>Qr);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class gc extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class ex extends gc{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Vu extends gc{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ku extends gc{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ol;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ol||(ol={}));var tx=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})};class nx{constructor(e,{headers:n={},customFetch:r,region:a=ol.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=Zg(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return tx(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:o}=n;let l={},{region:c}=n;c||(c=this.region);const u=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let d;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=o):typeof o=="string"?(l["Content-Type"]="text/plain",d=o):typeof FormData<"u"&&o instanceof FormData?d=o:(l["Content-Type"]="application/json",d=JSON.stringify(o)));const h=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),a),body:d}).catch(b=>{throw new ex(b)}),m=h.headers.get("x-relay-error");if(m&&m==="true")throw new Vu(h);if(!h.ok)throw new Ku(h);let f=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),y;return f==="application/json"?y=yield h.json():f==="application/octet-stream"?y=yield h.blob():f==="text/event-stream"?y=h:f==="multipart/form-data"?y=yield h.formData():y=yield h.text(),{data:y,error:null,response:h}}catch(a){return{data:null,error:a,response:a instanceof Ku||a instanceof Vu?a.context:void 0}}})}}var ht={},xc={},Si={},Xs={},Ci={},Ei={},rx=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Gr=rx();const sx=Gr.fetch,Af=Gr.fetch.bind(Gr),Of=Gr.Headers,ax=Gr.Request,ix=Gr.Response,Qr=Object.freeze(Object.defineProperty({__proto__:null,Headers:Of,Request:ax,Response:ix,default:Af,fetch:sx},Symbol.toStringTag,{value:"Module"})),ox=om(Qr);var Pi={};Object.defineProperty(Pi,"__esModule",{value:!0});let lx=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Pi.default=lx;var $f=Pt&&Pt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ei,"__esModule",{value:!0});const cx=$f(ox),ux=$f(Pi);let dx=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=cx.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let a=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c;let u=null,d=null,h=null,m=i.status,f=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=x:d=JSON.parse(x))}const b=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),S=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");b&&S&&S.length>1&&(h=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,m=406,f="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const b=await i.text();try{u=JSON.parse(b),Array.isArray(u)&&i.status===404&&(d=[],u=null,m=200,f="OK")}catch{i.status===404&&b===""?(m=204,f="No Content"):u={message:b}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,m=200,f="OK"),u&&this.shouldThrowOnError)throw new ux.default(u)}return{error:u,data:d,count:h,status:m,statusText:f}});return this.shouldThrowOnError||(a=a.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(e,n)}returns(){return this}overrideTypes(){return this}};Ei.default=dx;var hx=Pt&&Pt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ci,"__esModule",{value:!0});const fx=hx(Ei);let mx=class extends fx.default{select(e){let n=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:a=r}={}){const i=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:a=!1,wal:i=!1,format:o="text"}={}){var l;const c=[e?"analyze":null,n?"verbose":null,r?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${c};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ci.default=mx;var px=Pt&&Pt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Xs,"__esModule",{value:!0});const gx=px(Ci);let xx=class extends gx.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};Xs.default=xx;var yx=Pt&&Pt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Si,"__esModule",{value:!0});const is=yx(Xs);let vx=class{constructor(e,{headers:n={},schema:r,fetch:a}){this.url=e,this.headers=n,this.schema=r,this.fetch=a}select(e,{head:n=!1,count:r}={}){const a=n?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new is.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:r=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new is.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:a,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push(`count=${a}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const c=e.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new is.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const r="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),this.headers.Prefer=a.join(","),new is.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new is.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Si.default=vx;var Ti={},Ii={};Object.defineProperty(Ii,"__esModule",{value:!0});Ii.version=void 0;Ii.version="0.0.0-automated";Object.defineProperty(Ti,"__esModule",{value:!0});Ti.DEFAULT_HEADERS=void 0;const bx=Ii;Ti.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${bx.version}`};var Lf=Pt&&Pt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xc,"__esModule",{value:!0});const wx=Lf(Si),jx=Lf(Xs),kx=Ti;let Nx=class Df{constructor(e,{headers:n={},schema:r,fetch:a}={}){this.url=e,this.headers=Object.assign(Object.assign({},kx.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=a}from(e){const n=new URL(`${this.url}/${e}`);return new wx.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Df(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:a=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let c;r||a?(o=r?"HEAD":"GET",Object.entries(n).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{l.searchParams.append(d,h)})):(o="POST",c=n);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new jx.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};xc.default=Nx;var Yr=Pt&&Pt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ht,"__esModule",{value:!0});ht.PostgrestError=ht.PostgrestBuilder=ht.PostgrestTransformBuilder=ht.PostgrestFilterBuilder=ht.PostgrestQueryBuilder=ht.PostgrestClient=void 0;const Rf=Yr(xc);ht.PostgrestClient=Rf.default;const Ff=Yr(Si);ht.PostgrestQueryBuilder=Ff.default;const Uf=Yr(Xs);ht.PostgrestFilterBuilder=Uf.default;const zf=Yr(Ci);ht.PostgrestTransformBuilder=zf.default;const Bf=Yr(Ei);ht.PostgrestBuilder=Bf.default;const Gf=Yr(Pi);ht.PostgrestError=Gf.default;var _x=ht.default={PostgrestClient:Rf.default,PostgrestQueryBuilder:Ff.default,PostgrestFilterBuilder:Uf.default,PostgrestTransformBuilder:zf.default,PostgrestBuilder:Bf.default,PostgrestError:Gf.default};const{PostgrestClient:Sx,PostgrestQueryBuilder:iv,PostgrestFilterBuilder:ov,PostgrestTransformBuilder:lv,PostgrestBuilder:cv,PostgrestError:uv}=_x;class Cx{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const n=parseInt(process.versions.node.split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Ex="2.15.1",Px=`realtime-js/${Ex}`,Tx="1.0.0",ll=1e4,Ix=1e3,Mx=100;var js;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(js||(js={}));var Re;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Re||(Re={}));var Rt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Rt||(Rt={}));var cl;(function(t){t.websocket="websocket"})(cl||(cl={}));var Hn;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Hn||(Hn={}));class Ax{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const a=n.getUint8(1),i=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+a));o=o+a;const c=r.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class Wf{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var _e;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(_e||(_e={}));const Ju=(t,e,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=Ox(o,t,e,a),i),{})},Ox=(t,e,n,r)=>{const a=e.find(l=>l.name===t),i=a==null?void 0:a.type,o=n[t];return i&&!r.includes(i)?Hf(i,o):ul(o)},Hf=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return Rx(e,n)}switch(t){case _e.bool:return $x(e);case _e.float4:case _e.float8:case _e.int2:case _e.int4:case _e.int8:case _e.numeric:case _e.oid:return Lx(e);case _e.json:case _e.jsonb:return Dx(e);case _e.timestamp:return Fx(e);case _e.abstime:case _e.date:case _e.daterange:case _e.int4range:case _e.int8range:case _e.money:case _e.reltime:case _e.text:case _e.time:case _e.timestamptz:case _e.timetz:case _e.tsrange:case _e.tstzrange:return ul(e);default:return ul(e)}},ul=t=>t,$x=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Lx=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Dx=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Rx=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Hf(e,l))}return t},Fx=t=>typeof t=="string"?t.replace(" ","T"):t,qf=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class ao{constructor(e,n,r={},a=ll){this.channel=e,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Qu;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Qu||(Qu={}));class ks{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ks.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=ks.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=ks.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,a){const i=this.cloneDeep(e),o=this.transformState(n),l={},c={};return this.map(i,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const h=i[u];if(h){const m=d.map(S=>S.presence_ref),f=h.map(S=>S.presence_ref),y=d.filter(S=>f.indexOf(S.presence_ref)<0),b=h.filter(S=>m.indexOf(S.presence_ref)<0);y.length>0&&(l[u]=y),b.length>0&&(c[u]=b)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},r,a)}static syncDiff(e,n,r,a){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(c),d.length>0){const h=e[l].map(f=>f.presence_ref),m=d.filter(f=>h.indexOf(f.presence_ref)<0);e[l].unshift(...m)}r(l,d,c)}),this.map(o,(l,c)=>{let u=e[l];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[l]=u,a(l,u,c),u.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const a=e[r];return"metas"in a?n[r]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Yu;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Yu||(Yu={}));var Ns;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Ns||(Ns={}));var en;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(en||(en={}));class yc{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Re.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new ao(this,Rt.join,this.params,this.timeout),this.rejoinTimer=new Wf(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Re.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Re.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Re.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Re.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Re.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Rt.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new ks(this),this.broadcastEndpointURL=qf(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Re.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params,c=(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(m=>m.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[Ns.PRESENCE]&&this.bindings[Ns.PRESENCE].length>0,d={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(en.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(en.CLOSED)),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:m})=>{var f;if(this.socket.setAuth(),m===void 0){e==null||e(en.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,b=(f=y==null?void 0:y.length)!==null&&f!==void 0?f:0,S=[];for(let x=0;x<b;x++){const g=y[x],{filter:{event:p,schema:j,table:N,filter:w}}=g,_=m&&m[x];if(_&&_.event===p&&_.schema===j&&_.table===N&&_.filter===w)S.push(Object.assign(Object.assign({},g),{id:_.id}));else{this.unsubscribe(),this.state=Re.errored,e==null||e(en.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,e&&e(en.SUBSCRIBED);return}}).receive("error",m=>{this.state=Re.errored,e==null||e(en.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(en.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===Re.joined&&e===Ns.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async send(e,n={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Re.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Rt.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new ao(this,Rt.leave,{},e),r.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Re.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const a=new AbortController,i=setTimeout(()=>a.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(i),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new ao(this,e,n,r);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Mx){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var a,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Rt;if(r&&[l,c,u,d].indexOf(o)>=0&&r!==this._joinRef())return;let m=this._onMessage(o,n,r);if(n&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(f=>{var y,b,S;return((y=f.filter)===null||y===void 0?void 0:y.event)==="*"||((S=(b=f.filter)===null||b===void 0?void 0:b.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(f=>f.callback(m,r)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var y,b,S,x,g,p;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const j=f.id,N=(y=f.filter)===null||y===void 0?void 0:y.event;return j&&((b=n.ids)===null||b===void 0?void 0:b.includes(j))&&(N==="*"||(N==null?void 0:N.toLocaleLowerCase())===((S=n.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const j=(g=(x=f==null?void 0:f.filter)===null||x===void 0?void 0:x.event)===null||g===void 0?void 0:g.toLocaleLowerCase();return j==="*"||j===((p=n==null?void 0:n.event)===null||p===void 0?void 0:p.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof m=="object"&&"ids"in m){const y=m.data,{schema:b,table:S,commit_timestamp:x,type:g,errors:p}=y;m=Object.assign(Object.assign({},{schema:b,table:S,commit_timestamp:x,eventType:g,new:{},old:{},errors:p}),this._getPayloadRecords(y))}f.callback(m,r)})}_isClosed(){return this.state===Re.closed}_isJoined(){return this.state===Re.joined}_isJoining(){return this.state===Re.joining}_isLeaving(){return this.state===Re.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const a=e.toLocaleLowerCase(),i={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&yc.isEqual(a.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Rt.close,{},e)}_onError(e){this._on(Rt.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Re.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Ju(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Ju(e.columns,e.old_record)),n}}const Xu=()=>{},ya={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Ux=[1e3,2e3,5e3,1e4],zx=1e4,Bx=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Gx{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ll,this.transport=null,this.heartbeatIntervalMs=ya.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Xu,this.ref=0,this.reconnectTimer=null,this.logger=Xu,this.conn=null,this.sendBuffer=[],this.serializer=new Ax,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...o)=>Ys(async()=>{const{default:l}=await Promise.resolve().then(()=>Qr);return{default:l}},void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${cl.websocket}`,this.httpEndpoint=qf(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Cx.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Tx}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case js.connecting:return Hn.Connecting;case js.open:return Hn.Open;case js.closing:return Hn.Closing;default:return Hn.Closed}}isConnected(){return this.connectionState()===Hn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===r);if(a)return a;{const i=new yc(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:a,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${r} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Ix,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},ya.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{n.topic==="phoenix"&&n.event==="phx_reply"&&this.heartbeatCallback(n.payload.status==="ok"?"ok":"error"),n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:a,payload:i,ref:o}=n,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${r} ${a} ${l}`.trim(),i),this.channels.filter(u=>u._isMember(r)).forEach(u=>u._trigger(a,i,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Rt.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${r}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([Bx],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:Px};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(Rt.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Wf(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ya.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,a,i,o,l,c,u;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:ll,this.heartbeatIntervalMs=(a=e==null?void 0:e.heartbeatIntervalMs)!==null&&a!==void 0?a:ya.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:d=>Ux[d-1]||zx,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(d,h)=>h(JSON.stringify(d)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class vc extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Fe(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Wx extends vc{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class dl extends vc{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var Hx=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})};const Vf=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Ys(async()=>{const{default:r}=await Promise.resolve().then(()=>Qr);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},qx=()=>Hx(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ys(()=>Promise.resolve().then(()=>Qr),void 0)).Response:Response}),hl=t=>{if(Array.isArray(t))return t.map(n=>hl(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=hl(r)}),e},Vx=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var lr=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})};const io=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Kx=(t,e,n)=>lr(void 0,void 0,void 0,function*(){const r=yield qx();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(a=>{const i=t.status||500,o=(a==null?void 0:a.statusCode)||i+"";e(new Wx(io(a),i,o))}).catch(a=>{e(new dl(io(a),a))}):e(new dl(io(t),t))}),Jx=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?a:(Vx(r)?(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(r)):a.body=r,e!=null&&e.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),n))};function Zs(t,e,n,r,a,i){return lr(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(n,Jx(e,r,a,i)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Kx(c,l,r))})})}function oi(t,e,n,r){return lr(this,void 0,void 0,function*(){return Zs(t,"GET",e,n,r)})}function Ht(t,e,n,r,a){return lr(this,void 0,void 0,function*(){return Zs(t,"POST",e,r,a,n)})}function fl(t,e,n,r,a){return lr(this,void 0,void 0,function*(){return Zs(t,"PUT",e,r,a,n)})}function Qx(t,e,n,r){return lr(this,void 0,void 0,function*(){return Zs(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function Kf(t,e,n,r,a){return lr(this,void 0,void 0,function*(){return Zs(t,"DELETE",e,r,a,n)})}var nt=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})};const Yx={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Zu={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Xx{constructor(e,n={},r,a){this.url=e,this.headers=n,this.bucketId=r,this.fetch=Vf(a)}uploadOrUpdate(e,n,r,a){return nt(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Zu),a);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const u=this._removeEmptyFolders(n),d=this._getFinalPath(u),h=yield(e=="PUT"?fl:Ht)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(Fe(i))return{data:null,error:i};throw i}})}upload(e,n,r){return nt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,a){return nt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let c;const u=Object.assign({upsert:Zu.upsert},a),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",u.cacheControl)):(c=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield fl(this.fetch,l.toString(),c,{headers:d});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(Fe(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,n){return nt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const i=yield Ht(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new vc("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}update(e,n,r){return nt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return nt(this,void 0,void 0,function*(){try{return{data:yield Ht(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Fe(a))return{data:null,error:a};throw a}})}copy(e,n,r){return nt(this,void 0,void 0,function*(){try{return{data:{path:(yield Ht(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Fe(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,r){return nt(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield Ht(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(Fe(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,r){return nt(this,void 0,void 0,function*(){try{const a=yield Ht(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(Fe(a))return{data:null,error:a};throw a}})}download(e,n){return nt(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield oi(this.fetch,`${this.url}/${a}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Fe(l))return{data:null,error:l};throw l}})}info(e){return nt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield oi(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:hl(r),error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}exists(e){return nt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield Qx(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Fe(r)&&r instanceof dl){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),a=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&a.push(i);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});c!==""&&a.push(c);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}remove(e){return nt(this,void 0,void 0,function*(){try{return{data:yield Kf(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}list(e,n,r){return nt(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Yx),n),{prefix:e||""});return{data:yield Ht(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(Fe(a))return{data:null,error:a};throw a}})}listV2(e,n){return nt(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Ht(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const Zx="2.11.0",ey={"X-Client-Info":`storage-js/${Zx}`};var ur=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})};class ty{constructor(e,n={},r,a){const i=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},ey),n),this.fetch=Vf(r)}listBuckets(){return ur(this,void 0,void 0,function*(){try{return{data:yield oi(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Fe(e))return{data:null,error:e};throw e}})}getBucket(e){return ur(this,void 0,void 0,function*(){try{return{data:yield oi(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return ur(this,void 0,void 0,function*(){try{return{data:yield Ht(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return ur(this,void 0,void 0,function*(){try{return{data:yield fl(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}emptyBucket(e){return ur(this,void 0,void 0,function*(){try{return{data:yield Ht(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}deleteBucket(e){return ur(this,void 0,void 0,function*(){try{return{data:yield Kf(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}})}}class ny extends ty{constructor(e,n={},r,a){super(e,n,r,a)}from(e){return new Xx(this.url,this.headers,e,this.fetch)}}const ry="2.55.0";let hs="";typeof Deno<"u"?hs="deno":typeof document<"u"?hs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?hs="react-native":hs="node";const sy={"X-Client-Info":`supabase-js-${hs}/${ry}`},ay={headers:sy},iy={schema:"public"},oy={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ly={};var cy=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})};const uy=t=>{let e;return t?e=t:typeof fetch>"u"?e=Af:e=fetch,(...n)=>e(...n)},dy=()=>typeof Headers>"u"?Of:Headers,hy=(t,e,n)=>{const r=uy(n),a=dy();return(i,o)=>cy(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:t;let u=new a(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},o),{headers:u}))})};var fy=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})};function my(t){return t.endsWith("/")?t:t+"/"}function py(t,e){var n,r;const{db:a,auth:i,realtime:o,global:l}=t,{db:c,auth:u,realtime:d,global:h}=e,m={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>fy(this,void 0,void 0,function*(){return""})};return t.accessToken?m.accessToken=t.accessToken:delete m.accessToken,m}const Jf="2.71.1",gr=30*1e3,ml=3,oo=ml*gr,gy="http://localhost:9999",xy="supabase.auth.token",yy={"X-Client-Info":`gotrue-js/${Jf}`},pl="X-Supabase-Api-Version",Qf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},vy=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,by=10*60*1e3;class bc extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function le(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class wy extends bc{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function jy(t){return le(t)&&t.name==="AuthApiError"}class Yf extends bc{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Fn extends bc{constructor(e,n,r,a){super(e,r,a),this.name=n,this.status=r}}class pn extends Fn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ky(t){return le(t)&&t.name==="AuthSessionMissingError"}class va extends Fn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ba extends Fn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class wa extends Fn{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ny(t){return le(t)&&t.name==="AuthImplicitGrantRedirectError"}class ed extends Fn{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class gl extends Fn{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function lo(t){return le(t)&&t.name==="AuthRetryableFetchError"}class td extends Fn{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class xl extends Fn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const li="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),nd=` 	
\r=`.split(""),_y=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<nd.length;e+=1)t[nd[e].charCodeAt(0)]=-2;for(let e=0;e<li.length;e+=1)t[li[e].charCodeAt(0)]=e;return t})();function rd(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(li[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(li[r]),e.queuedBits-=6}}function Xf(t,e,n){const r=_y[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function sd(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{Ey(o,r,n)};for(let o=0;o<t.length;o+=1)Xf(t.charCodeAt(o),a,i);return e.join("")}function Sy(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Cy(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}Sy(r,e)}}function Ey(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Py(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)Xf(t.charCodeAt(a),n,r);return new Uint8Array(e)}function Ty(t){const e=[];return Cy(t,n=>e.push(n)),new Uint8Array(e)}function Iy(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};return t.forEach(a=>rd(a,n,r)),rd(null,n,r),e.join("")}function My(t){return Math.round(Date.now()/1e3)+t}function Ay(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const $t=()=>typeof window<"u"&&typeof document<"u",Un={tested:!1,writable:!1},Zf=()=>{if(!$t())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Un.tested)return Un.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Un.tested=!0,Un.writable=!0}catch{Un.tested=!0,Un.writable=!1}return Un.writable};function Oy(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return n.searchParams.forEach((r,a)=>{e[a]=r}),e}const em=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Ys(async()=>{const{default:r}=await Promise.resolve().then(()=>Qr);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},$y=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",xr=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},zn=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},mn=async(t,e)=>{await t.removeItem(e)};class Mi{constructor(){this.promise=new Mi.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Mi.promiseConstructor=Promise;function co(t){const e=t.split(".");if(e.length!==3)throw new xl("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!vy.test(e[r]))throw new xl("JWT not in base64url format");return{header:JSON.parse(sd(e[0])),payload:JSON.parse(sd(e[1])),signature:Py(e[2]),raw:{header:e[0],payload:e[1]}}}async function Ly(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Dy(t,e){return new Promise((r,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){a(o);return}}})()})}function Ry(t){return("0"+t.toString(16)).substr(-2)}function Fy(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let i=0;i<56;i++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,Ry).join("")}async function Uy(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function zy(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await Uy(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function dr(t,e,n=!1){const r=Fy();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await xr(t,`${e}-code-verifier`,a);const i=await zy(r);return[i,r===i?"plain":"s256"]}const By=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Gy(t){const e=t.headers.get(pl);if(!e||!e.match(By))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Wy(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Hy(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const qy=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function hr(t){if(!qy.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function uo(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ad(t){return JSON.parse(JSON.stringify(t))}var Vy=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const Wn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Ky=[502,503,504];async function id(t){var e;if(!$y(t))throw new gl(Wn(t),0);if(Ky.includes(t.status))throw new gl(Wn(t),t.status);let n;try{n=await t.json()}catch(i){throw new Yf(Wn(i),i)}let r;const a=Gy(t);if(a&&a.getTime()>=Qf["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new td(Wn(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new pn}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new td(Wn(n),t.status,n.weak_password.reasons);throw new wy(Wn(n),t.status||500,r)}const Jy=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function de(t,e,n,r){var a;const i=Object.assign({},r==null?void 0:r.headers);i[pl]||(i[pl]=Qf["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Qy(t,e,n+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function Qy(t,e,n,r,a,i){const o=Jy(e,r,a,i);let l;try{l=await t(n,Object.assign({},o))}catch(c){throw console.error(c),new gl(Wn(c),0)}if(l.ok||await id(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await id(c)}}function Xt(t){var e;let n=null;e0(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=My(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function od(t){const e=Xt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function bn(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Yy(t){return{data:t,error:null}}function Xy(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i}=t,o=Vy(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Zy(t){return t}function e0(t){return t.access_token&&t.refresh_token&&t.expires_in}const ho=["global","local","others"];var t0=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};class n0{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=em(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=ho[0]){if(ho.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ho.join(", ")}`);try{return await de(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(le(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await de(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:bn})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=t0(e,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await de(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Xy,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(le(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await de(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:bn})}catch(n){if(le(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,a,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await de(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:Zy});if(d.error)throw d.error;const h=await d.json(),m=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return f.length>0&&(f.forEach(y=>{const b=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(y.split(";")[1].split("=")[1]);u[`${S}Page`]=b}),u.total=parseInt(m)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(le(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){hr(e);try{return await de(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:bn})}catch(n){if(le(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){hr(e);try{return await de(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:bn})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){hr(e);try{return await de(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:bn})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){hr(e.userId);try{const{data:n,error:r}=await de(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if(le(n))return{data:null,error:n};throw n}}async _deleteFactor(e){hr(e.userId),hr(e.id);try{return{data:await de(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(le(n))return{data:null,error:n};throw n}}}function ld(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function r0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const fr={debug:!!(globalThis&&Zf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class tm extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class s0 extends tm{}async function a0(t,e,n){fr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),fr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){fr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{fr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw fr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new s0(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(fr.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}r0();const i0={url:gy,storageKey:xy,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:yy,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function cd(t,e,n){return await n()}const mr={};class Gs{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Gs.nextInstanceID,Gs.nextInstanceID+=1,this.instanceID>0&&$t()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},i0),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new n0({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=em(a.fetch),this.lock=a.lock||cd,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:$t()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=a0:this.lock=cd,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Zf()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ld(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=ld(this.memoryStorage)),$t()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=mr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){mr[this.storageKey]=Object.assign(Object.assign({},mr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=mr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){mr[this.storageKey]=Object.assign(Object.assign({},mr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Jf}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=Oy(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),$t()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Ny(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return le(n)?{error:n}:{error:new Yf("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,a;try{const i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:Xt}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(le(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,r,a;try{let i;if("email"in e){const{email:d,password:h,options:m}=e;let f=null,y=null;this.flowType==="pkce"&&([f,y]=await dr(this.storage,this.storageKey)),i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:d,password:h,data:(n=m==null?void 0:m.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:f,code_challenge_method:y},xform:Xt})}else if("phone"in e){const{phone:d,password:h,options:m}=e;i=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},channel:(a=m==null?void 0:m.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:Xt})}else throw new ba("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(le(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:l}=e;n=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:od})}else if("phone"in e){const{phone:i,password:o,options:l}=e;n=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:od})}else throw new ba("You must provide either an email or phone number and a password");const{data:r,error:a}=n;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new va}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if(le(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,a,i,o,l,c,u,d,h,m,f;let y,b;if("message"in e)y=e.message,b=e.signature;else{const{chain:S,wallet:x,statement:g,options:p}=e;let j;if($t())if(typeof x=="object")j=x;else{const w=window;if("solana"in w&&typeof w.solana=="object"&&("signIn"in w.solana&&typeof w.solana.signIn=="function"||"signMessage"in w.solana&&typeof w.solana.signMessage=="function"))j=w.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(p!=null&&p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=x}const N=new URL((n=p==null?void 0:p.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in j&&j.signIn){const w=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},p==null?void 0:p.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),g?{statement:g}:null));let _;if(Array.isArray(w)&&w[0]&&typeof w[0]=="object")_=w[0];else if(w&&typeof w=="object"&&"signedMessage"in w&&"signature"in w)_=w;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)y=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),b=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${N.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(a=(r=p==null?void 0:p.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=p==null?void 0:p.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${p.signInWithSolana.notBefore}`]:[],...!((o=p==null?void 0:p.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${p.signInWithSolana.expirationTime}`]:[],...!((l=p==null?void 0:p.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${p.signInWithSolana.chainId}`]:[],...!((c=p==null?void 0:p.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${p.signInWithSolana.nonce}`]:[],...!((u=p==null?void 0:p.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${p.signInWithSolana.requestId}`]:[],...!((h=(d=p==null?void 0:p.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...p.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const w=await j.signMessage(new TextEncoder().encode(y),"utf8");if(!w||!(w instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=w}}try{const{data:S,error:x}=await de(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:Iy(b)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Xt});if(x)throw x;return!S||!S.session||!S.user?{data:{user:null,session:null},error:new va}:(S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),{data:Object.assign({},S),error:x})}catch(S){if(le(S))return{data:{user:null,session:null},error:S};throw S}}async _exchangeCodeForSession(e){const n=await zn(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{const{data:i,error:o}=await de(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Xt});if(await mn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new va}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(le(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:a,access_token:i,nonce:o}=e,l=await de(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Xt}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new va}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(n){if(le(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,a,i,o;try{if("email"in e){const{email:l,options:c}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await dr(this.storage,this.storageKey));const{error:h}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:u,error:d}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new ba("You must provide either an email or phone number.")}catch(l){if(le(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,r;try{let a,i;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await de(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Xt});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(le(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var n,r,a;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await dr(this.storage,this.storageKey)),await de(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Yy})}catch(i){if(le(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new pn;const{error:a}=await de(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(le(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:i}=e,{error:o}=await de(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:a,options:i}=e,{data:o,error:l}=await de(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new ba("You must provide either an email or phone number and a type")}catch(n){if(le(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await zn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<oo:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await zn(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=uo()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,d)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:bn}):await this._useSession(async n=>{var r,a,i;const{data:o,error:l}=n;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new pn}:await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:bn})})}catch(n){if(le(n))return ky(n)&&(await this._removeSession(),await mn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:a,error:i}=r;if(i)throw i;if(!a.session)throw new pn;const o=a.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await dr(this.storage,this.storageKey));const{data:u,error:d}=await de(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:bn});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(le(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new pn;const n=Date.now()/1e3;let r=n,a=!0,i=null;const{payload:o}=co(e.access_token);if(o.exp&&(r=o.exp,a=r<=n),a){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(le(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new pn;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(le(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!$t())throw new wa("No browser detected.");if(e.error||e.error_description||e.error_code)throw new wa(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new ed("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new wa("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ed("No code detected.");const{data:g,error:p}=await this._exchangeCodeForSession(e.code);if(p)throw p;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:g.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=e;if(!i||!l||!o||!u)throw new wa("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let m=d+h;c&&(m=parseInt(c));const f=m-d;f*1e3<=gr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const y=m-h;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,m,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,m,d);const{data:b,error:S}=await this._getUser(i);if(S)throw S;const x={provider_token:r,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:m,refresh_token:o,token_type:u,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:e.type},error:null}}catch(r){if(le(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await zn(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{error:i};const o=(r=a.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(jy(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await mn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=Ay(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,a;try{const{data:{session:i},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await dr(this.storage,this.storageKey,!0));try{return await de(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(le(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(le(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:a}=await this._useSession(async i=>{var o,l,c,u,d;const{data:h,error:m}=i;if(m)throw m;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await de(this.fetch,"GET",f,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(a)throw a;return $t()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(le(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:o}=n;if(o)throw o;return await de(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(le(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await Dy(async a=>(a>0&&await Ly(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await de(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Xt})),(a,i)=>{const o=200*Math.pow(2,a);return i&&lo(i)&&Date.now()+o-r<gr})}catch(r){if(this._debug(n,"error",r),le(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),$t()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await zn(this.storage,this.storageKey);if(a&&this.userStorage){let o=await zn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await xr(this.userStorage,this.storageKey+"-user",o)),a.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:uo()}else if(a&&!a.user&&!a.user){const o=await zn(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,await mn(this.storage,this.storageKey+"-user"),await xr(this.storage,this.storageKey,a)):a.user=uo()}if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),a!==null&&await this._removeSession();return}const i=((n=a.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<oo;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${oo}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),lo(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(a.access_token);!l&&(o!=null&&o.user)?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(r,"error",a),console.error(a);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new pn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Mi;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new pn;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),le(i)){const o={session:null,error:i};return lo(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await xr(this.userStorage,this.storageKey+"-user",{user:n.user});const a=Object.assign({},n);delete a.user;const i=ad(a);await xr(this.storage,this.storageKey,i)}else{const a=ad(n);await xr(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await mn(this.storage,this.storageKey),await mn(this.storage,this.storageKey+"-code-verifier"),await mn(this.storage,this.storageKey+"-user"),this.userStorage&&await mn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&$t()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),gr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/gr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${gr}ms, refresh threshold is ${ml} ticks`),a<=ml&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof tm)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!$t()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await dr(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);a.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await de(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(le(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:o}=n;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=await de(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(n){if(le(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{data:null,error:i};const{data:o,error:l}=await de(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(le(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await de(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(le(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],a=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=co(a.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((r=(n=a.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const d=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r)return r;const a=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+by>a)return r;const{data:i,error:o}=await de(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,r=i.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:f,error:y}=await this.getSession();if(y||!f.session)return{data:null,error:y};r=f.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:c}}=co(r);n!=null&&n.allowExpired||Wy(i.exp);const u=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:f}=await this.getUser(r);if(f)throw f;return{data:{claims:i,header:a,signature:o},error:null}}const d=Hy(a.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,Ty(`${l}.${c}`)))throw new xl("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(r){if(le(r))return{data:null,error:r};throw r}}}Gs.nextInstanceID=0;const o0=Gs;class l0 extends o0{constructor(e){super(e)}}var c0=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):a(d.value).then(l,c)}u((r=r.apply(t,e||[])).next())})};class u0{constructor(e,n,r){var a,i,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=my(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:iy,realtime:ly,auth:Object.assign(Object.assign({},oy),{storageKey:u}),global:ay},h=py(r??{},d);this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(m,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=hy(n,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Sx(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new ny(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new nx(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return c0(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:i,flowType:o,lock:l,debug:c},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new l0({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,flowType:o,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Gx(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const d0=(t,e,n)=>new u0(t,e,n);function h0(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}h0()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const f0="https://dthxptbozocrbvmhwvao.supabase.co",m0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0aHhwdGJvem9jcmJ2bWh3dmFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyOTY0MzMsImV4cCI6MjA3MDg3MjQzM30.gFt4oRFZ7Mh4y8DgeKNbcKKDwTYjEdXRoBlqTNjvdRg",F=d0(f0,m0);function et(){const[t,e]=v.useState(null),[n,r]=v.useState(!0),a=async m=>{if(!(m!=null&&m.user)){e(null);return}try{const{data:f,error:y}=await F.from("users").upsert({id:m.user.id,email:m.user.email||""},{onConflict:"id"}).select("is_admin, user_name_public").single();if(y){console.error("Error fetching user profile:",y),e(m.user);return}const{data:b,error:S}=await F.from("locations").select("id").contains("admins",[m.user.id]).limit(1),x=!S&&b&&b.length>0;e({...m.user,is_admin:(f==null?void 0:f.is_admin)||!1,is_location_admin:x,user_name_public:(f==null?void 0:f.user_name_public)||null})}catch(f){console.error("Error fetching user profile:",f),e(m.user)}};v.useEffect(()=>{F.auth.getSession().then(({data:{session:f}})=>{a(f),r(!1)});const{data:{subscription:m}}=F.auth.onAuthStateChange((f,y)=>{a(y),r(!1)});return()=>m.unsubscribe()},[]);const i=async(m,f)=>{const{data:y,error:b}=await F.auth.signInWithPassword({email:m,password:f});return{data:y,error:b}},o=async(m,f)=>{const{data:y,error:b}=await F.auth.signUp({email:m,password:f,options:{emailRedirectTo:`${window.location.origin}/auth/callback`}});return{data:y,error:b}},l=async()=>{const{data:m,error:f}=await F.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`}});return{data:m,error:f}},c=async()=>{const{error:m}=await F.auth.signOut();return{error:m}},u=async m=>{const{data:f,error:y}=await F.auth.resetPasswordForEmail(m,{redirectTo:`${window.location.origin}/auth/callback`});return{data:f,error:y}},d=async m=>{const{data:f,error:y}=await F.auth.updateUser({password:m});return{data:f,error:y}},h=t&&window.location.hash.includes("type=recovery");return{user:t,loading:n,signIn:i,signUp:o,signInWithGoogle:l,signOut:c,resetPassword:u,updatePassword:d,needsPasswordReset:h}}function nm(){const[t,e]=v.useState(()=>{const r=localStorage.getItem("darkMode");return r!==null?JSON.parse(r):window.matchMedia("(prefers-color-scheme: dark)").matches});return v.useEffect(()=>{t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("darkMode",JSON.stringify(t))},[t]),{isDarkMode:t,toggleDarkMode:()=>{e(!t)}}}function pr({onAddModel:t,onAdminClick:e,activeTab:n,onTabChange:r}){const[a,i]=v.useState(!1),[o,l]=v.useState(!1),{isDarkMode:c,toggleDarkMode:u}=nm(),{user:d,signOut:h}=et(),m=async()=>{i(!1),await h()},f=[{id:"collection",name:"Collection",icon:Rn},{id:"battleplan",name:"Battleplan",icon:Ze}],y=b=>{l(!1),r==null||r(b)};return s.jsxs(s.Fragment,{children:[s.jsx("header",{className:"bg-bg-primary shadow-sm border-b border-border-custom relative z-50",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsx("div",{className:"flex items-center",children:d&&s.jsx("button",{onClick:()=>l(!o),className:"text-secondary-text hover:text-text focus:outline-none mr-4",children:o?s.jsx(ye,{className:"w-6 h-6 text-icon"}):s.jsx(Gg,{className:"w-6 h-6 text-icon"})})}),s.jsx("div",{className:"flex items-center justify-center flex-1",children:s.jsx("img",{src:"Battleplan-Logo-Purple.svg",alt:"Mini Myths Logo",className:"max-h-[300px] w-auto"})}),s.jsx("div",{className:"flex items-center space-x-4",children:d?s.jsx(s.Fragment,{children:s.jsx("button",{onClick:()=>i(!a),className:"text-secondary-text hover:text-text focus:outline-none",children:s.jsx(Mn,{className:"w-6 h-6 text-icon hover:text-icon-hover"})})}):null})]}),d&&s.jsxs("div",{className:`absolute right-4 top-16 bg-bg-primary border border-border-custom rounded-lg shadow-lg py-2 z-50 min-w-[200px] transition-all duration-200 ease-in-out ${a?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 -translate-y-2 pointer-events-none"}`,children:[s.jsx("div",{className:"px-4 py-2 border-b border-border-custom",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Mn,{className:"w-5 h-5 text-icon"}),s.jsx("span",{className:"text-base text-text",children:d.email})]})}),s.jsxs("button",{onClick:()=>{i(!1),e==null||e()},className:`flex items-center space-x-3 w-full text-left px-4 py-2 text-base font-semibold text-text hover:bg-bg-secondary transition-colors ${d!=null&&d.is_admin||d!=null&&d.is_location_admin?"":"hidden"}`,children:[s.jsx(Vg,{className:"w-5 h-5 text-icon hover:text-icon-hover"}),s.jsx("span",{children:"Admin"})]}),s.jsxs("button",{onClick:()=>{i(!1)},className:"flex items-center space-x-3 w-full text-left px-4 py-2 text-base font-semibold text-text hover:bg-bg-secondary transition-colors",children:[s.jsx(qg,{className:"w-5 h-5 text-icon hover:text-icon-hover"}),s.jsx("span",{children:"Settings"})]}),s.jsxs("div",{className:"flex items-center justify-between px-4 py-2 hover:bg-bg-secondary transition-colors",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[c?s.jsx(If,{className:"w-5 h-5 text-icon hover:text-icon-hover"}):s.jsx(Mf,{className:"w-5 h-5 text-icon hover:text-icon-hover"}),s.jsx("span",{className:"text-base font-semibold text-text",children:c?"Dark Mode":"Light Mode"})]}),s.jsx("button",{onClick:u,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring---color-brand focus:ring-offset-2 ${c?"bg-brand":"bg-gray-200"}`,children:s.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${c?"translate-x-6":"translate-x-1"}`})})]}),s.jsx("button",{onClick:m,className:"block w-full text-left px-4 py-2 text-base font-semibold text-text hover:bg-bg-secondary transition-colors",children:"Sign Out"})]})]})}),d&&s.jsx("div",{className:`fixed inset-y-0 left-0 z-40 w-64 bg-bg-primary border-r border-border-custom shadow-lg transform transition-transform duration-300 ease-in-out ${o?"translate-x-0":"-translate-x-full"}`,children:s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border-custom",children:[s.jsx("h2",{className:"text-lg font-semibold text-title",children:"Navigation"}),s.jsx("button",{onClick:()=>l(!1),className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6 text-icon"})})]}),s.jsx("nav",{className:"flex-1 p-4",children:s.jsxs("div",{className:"space-y-2",children:[f.map(b=>{const S=b.icon,x=n===b.id;return s.jsxs("button",{onClick:()=>y(b.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors ${x?"bg-brand/10 text-brand border border-brand/20":"text-secondary-text hover:text-text hover:bg-bg-secondary"}`,children:[s.jsx(S,{className:`w-5 h-5 ${x?"text-icon-active":"text-icon hover:text-icon-hover"}`}),s.jsx("span",{className:`font-medium ${x?"text-brand":""}`,children:b.name})]},b.id)}),s.jsx("div",{className:"border-t border-border-custom my-4"}),s.jsxs("button",{onClick:()=>{l(!1),r==null||r("about")},className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors text-secondary-text hover:text-text hover:bg-bg-secondary",children:[s.jsx(Mn,{className:"w-5 h-5 text-icon hover:text-icon-hover"}),s.jsx("span",{className:"font-medium",children:"About"})]}),((d==null?void 0:d.is_admin)||(d==null?void 0:d.is_location_admin))&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"border-t border-border-custom my-4"}),s.jsx("div",{className:"px-4 py-2",children:s.jsx("span",{className:"text-xs font-semibold text-secondary-text uppercase tracking-wide",children:"Admin Tools"})}),s.jsxs("button",{onClick:()=>{l(!1),r==null||r("all-bookings")},className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors ${n==="all-bookings"?"bg-brand/10 text-brand border border-brand/20":"text-secondary-text hover:text-text hover:bg-bg-secondary"}`,children:[s.jsx(Ze,{className:`w-5 h-5 ${n==="all-bookings"?"text-icon-active":"text-icon hover:text-icon-hover"}`}),s.jsx("span",{className:`font-medium ${n==="all-bookings"?"text-brand":""}`,children:"All Bookings"})]})]})]})})]})}),d&&s.jsx("div",{className:`fixed inset-0 bg-black z-30 transition-opacity duration-300 ease-in-out ${o?"bg-opacity-50 pointer-events-auto":"bg-opacity-0 pointer-events-none"}`,onClick:()=>l(!1)}),d&&s.jsx("div",{className:`fixed inset-0 bg-black z-40 transition-opacity duration-200 ease-in-out ${a?"bg-opacity-25 pointer-events-auto":"bg-opacity-0 pointer-events-none"}`,onClick:()=>{i(!1)}})]})}function os({activeTab:t,onTabChange:e}){const n=[{id:"collection",name:"Collection",icon:Rn},{id:"battleplan",name:"Battleplan",icon:Ze}];return s.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-40 bg-bg-primary/90 backdrop-blur-md border-t border-border-custom/30",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("nav",{className:"flex justify-center items-center space-x-8","aria-label":"Tabs",children:n.map(r=>{const a=r.icon,i=t===r.id;return s.jsxs("button",{onClick:()=>e(r.id),className:`flex items-center space-x-2 py-4 px-6 border-b-2 font-medium text-sm transition-colors ${i?"border---color-brand text-brand":"border-transparent text-secondary-text hover:text-text hover:border-border-custom"}`,children:[s.jsx(a,{className:`w-5 h-5 ${i?"text-icon-active":"text-icon hover:text-icon-hover"}`}),s.jsx("span",{className:i?"text-brand":"",children:r.name})]},r.id)})})})})}function p0({activeView:t,onViewChange:e}){const n=[{id:"recent",label:"Recent",icon:Kr},{id:"models",label:"Models",icon:zg},{id:"collections",label:"Collections",icon:Rn}];return s.jsx("div",{className:"bg-bg-secondary shadow-sm",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"flex justify-center items-center py-3",children:s.jsx("div",{className:"flex space-x-8",children:n.map(r=>{const a=r.icon,i=t===r.id;return s.jsxs("button",{onClick:()=>e(r.id),className:"flex flex-col items-center space-y-2 px-6 py-2 rounded-lg transition-all duration-200",children:[s.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center bg-border-custom transition-opacity",children:s.jsx(a,{className:`w-4 h-4 transition-opacity ${i?"text-icon-active opacity-100":"text-icon opacity-75"}`})}),s.jsx("span",{className:`text-lg font-medium transition-colors ${i?"text-text":"text-secondary-text"}`,children:r.label})]},r.id)})})})})})}function ea({games:t,selectedGame:e,onGameSelect:n,placeholder:r="Choose a Game",recentGames:a=[]}){const[i,o]=v.useState(!1),[l,c]=v.useState(""),u=v.useRef(null),d=v.useRef(null),h=t.find(p=>p.id===e),m=t.filter(p=>p.name.toLowerCase().includes(l.toLowerCase())),f=new Set(a.map(p=>p.id)),y=a.filter(p=>p.name.toLowerCase().includes(l.toLowerCase())),b=m.filter(p=>!f.has(p.id));v.useEffect(()=>{const p=j=>{u.current&&!u.current.contains(j.target)&&o(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]),v.useEffect(()=>{i&&d.current&&d.current.focus()},[i]);const S=p=>{n(p),c(""),o(!1)},x=p=>{c(p.target.value)},g=()=>{o(!i),i||c("")};return s.jsxs("div",{className:"relative",ref:u,children:[s.jsxs("button",{type:"button",onClick:g,className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] text-left bg-bg-primary flex items-center justify-between hover:bg-bg-secondary transition-colors",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[h!=null&&h.icon?s.jsx("img",{src:h.icon,alt:"",className:"w-6 h-6 object-contain flex-shrink-0",onError:p=>{const j=p.target;console.warn("Dropdown game icon failed to load:",h.icon),j.style.display="none"},onLoad:()=>{console.warn("Dropdown game icon loaded successfully:",h.icon)}}):s.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex-shrink-0"}),s.jsx("span",{className:h?"text-gray-900":"text-gray-500",children:h?h.name:r})]}),s.jsx(hc,{className:`w-5 h-5 text-icon transition-transform ${i?"rotate-180":""}`})]}),i&&s.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-bg-primary border border-border-custom rounded-lg shadow-lg max-h-60 overflow-hidden",children:[s.jsx("div",{className:"p-3 border-b border-border-custom",children:s.jsxs("div",{className:"relative",children:[s.jsx(mc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-4 h-4"}),s.jsx("input",{ref:d,type:"text",value:l,onChange:x,placeholder:"Search games...",className:"w-full pl-10 pr-4 py-2 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] text-sm bg-bg-primary text-text"})]})}),s.jsx("div",{className:"max-h-48 overflow-y-auto",children:y.length===0&&b.length===0?s.jsxs("div",{className:"px-4 py-3 text-secondary-text text-sm",children:['No games found matching "',l,'"']}):s.jsxs(s.Fragment,{children:[y.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"px-4 py-2 bg-amber-50 border-b border-border-custom",children:s.jsx("span",{className:"text-xs font-semibold text-amber-800 uppercase tracking-wide",children:"Recently Used"})}),y.map(p=>s.jsxs("button",{type:"button",onClick:()=>S(p.id),className:"w-full px-4 py-3 text-left hover:bg-bg-secondary flex items-center space-x-3 transition-colors bg-amber-25",children:[p.icon?s.jsx("img",{src:p.icon,alt:"",className:"w-6 h-6 object-contain flex-shrink-0",onError:j=>{const N=j.target;console.warn("Game list icon failed to load:",p.icon),N.style.display="none"},onLoad:()=>{console.warn("Game list icon loaded successfully:",p.icon)}}):s.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex-shrink-0"}),s.jsx("span",{className:"text-text",children:p.name})]},`recent-${p.id}`))]}),b.length>0&&s.jsxs(s.Fragment,{children:[y.length>0&&s.jsx("div",{className:"px-4 py-2 bg-bg-secondary border-b border-border-custom",children:s.jsx("span",{className:"text-xs font-semibold text-secondary-text uppercase tracking-wide",children:"All Games"})}),b.map(p=>s.jsxs("button",{type:"button",onClick:()=>S(p.id),className:"w-full px-4 py-3 text-left hover:bg-bg-secondary flex items-center space-x-3 transition-colors",children:[p.icon?s.jsx("img",{src:p.icon,alt:"",className:"w-6 h-6 object-contain flex-shrink-0",onError:j=>{const N=j.target;console.warn("Game list icon failed to load:",p.icon),N.style.display="none"},onLoad:()=>{console.warn("Game list icon loaded successfully:",p.icon)}}):s.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex-shrink-0"}),s.jsx("span",{className:"text-text",children:p.name})]},p.id))]})]})})]})]})}const ja="mini-myths-recent-games",ud=3;function g0(){const[t,e]=v.useState([]);v.useEffect(()=>{n()},[]);const n=()=>{try{const i=localStorage.getItem(ja);if(i){const l=JSON.parse(i).sort((c,u)=>u.lastUsed-c.lastUsed).slice(0,ud);e(l)}}catch(i){console.error("Error loading recent games:",i),e([])}};return{recentGames:t,addRecentGame:i=>{try{const o=Date.now(),l={id:i.id,name:i.name,icon:i.icon,lastUsed:o},c=localStorage.getItem(ja);let u=[];c&&(u=JSON.parse(c)),u=u.filter(d=>d.id!==i.id),u.unshift(l),u=u.slice(0,ud),localStorage.setItem(ja,JSON.stringify(u)),e(u)}catch(o){console.error("Error saving recent game:",o)}},clearRecentGames:()=>{try{localStorage.removeItem(ja),e([])}catch(i){console.error("Error clearing recent games:",i)}}}}function x0({isOpen:t,onClose:e,onBookingCreated:n,lastSelectedLocation:r="",onLocationSelected:a}){const[i,o]=v.useState([]),[l,c]=v.useState([]),[u,d]=v.useState([]),[h,m]=v.useState(r),[f,y]=v.useState(""),[b,S]=v.useState(""),[x,g]=v.useState(""),[p,j]=v.useState(""),[N,w]=v.useState(null),[_,E]=v.useState(!1),[C,k]=v.useState(0),[P,U]=v.useState(!1),[D,K]=v.useState(!1),[Y,re]=v.useState(""),{user:te}=et(),{recentGames:L,addRecentGame:V}=g0(),M=()=>{try{return localStorage.getItem("mini-myths-last-location")||""}catch(I){return console.error("Error loading last selected location:",I),""}},B=I=>{try{I&&localStorage.setItem("mini-myths-last-location",I)}catch(J){console.error("Error saving last selected location:",J)}};me.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),v.useEffect(()=>{if(t){z(),$(),H();const I=M();m(I||r),te!=null&&te.user_name_public&&j(te.user_name_public)}},[t,r]),v.useEffect(()=>{h?(se(),B(h),a==null||a(h)):(c([]),S(""))},[h,a]),v.useEffect(()=>{f&&(S(""),w(null))},[f]),v.useEffect(()=>{h&&f&&b?X():w(null)},[h,f,b]);const X=async()=>{if(!(!h||!f||!b)){E(!0);try{const{data:I,error:J}=await F.from("locations").select("tables").eq("id",h).single();if(J)throw J;const pe=I.tables,G=l.find(ve=>ve.id===b),ee=(G==null?void 0:G.isAllDay)||!1;let ge=0;if(ee){const{data:ve,error:be}=await F.from("bookings").select("timeslot_id").eq("location_id",h).eq("date",f);if(be)throw be;const W={};ve==null||ve.forEach(Z=>{const xe=Z.timeslot_id;W[xe]=(W[xe]||0)+1}),ge=Math.max(0,...Object.values(W))}else{const{data:ve,error:be}=await F.from("bookings").select("id").eq("location_id",h).eq("date",f).eq("timeslot_id",b);if(be)throw be;const{data:W,error:Z}=await F.from("bookings").select("timeslot:timeslots(id, name, start_time, end_time)").eq("location_id",h).eq("date",f);if(Z)throw Z;const xe=(ve==null?void 0:ve.length)||0,je=(W==null?void 0:W.filter(ue=>{const Ne=ue.timeslot;return Ne&&(Ne.name==="All Day Booking"||Ne.start_time==="00:00:00"&&Ne.end_time==="23:59:59")}).length)||0;ge=xe+je}const Ce=pe-ge;w(Math.max(0,Ce))}catch(I){console.error("Error checking table availability:",I),w(null)}finally{E(!1)}}},H=async()=>{if(te){U(!0);try{const I=new Date().toISOString().split("T")[0],{data:J,error:pe}=await F.from("bookings").select("id").eq("user_id",te.id).gte("date",I);if(pe)throw pe;k((J==null?void 0:J.length)||0)}catch(I){console.error("Error checking current bookings:",I),k(0)}finally{U(!1)}}},z=async()=>{try{const{data:I,error:J}=await F.from("locations").select("*").order("name");if(J)throw J;o(I||[])}catch(I){console.error("Error fetching locations:",I)}},se=async()=>{try{const{data:I,error:J}=await F.from("timeslots").select("*").eq("location_id",h).order("start_time");if(J)throw J;const pe=(I||[]).map(G=>({...G,isAllDay:G.name==="All Day Booking"||G.start_time==="00:00:00"&&G.end_time==="23:59:59"}));c(pe)}catch(I){console.error("Error fetching timeslots:",I)}},$=async()=>{try{const{data:I,error:J}=await F.from("games").select("id, name, icon").order("name");if(J)throw J;d(I||[])}catch(I){console.error("Error fetching games:",I)}},O=()=>{if(!f)return null;const I=new Date(f);return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][I.getDay()]},fe=()=>{const I=O();return I?l.filter(J=>J.availability&&J.availability.includes(I)):[]},ie=I=>I==="00:00:00"?"All Day":new Date(`2000-01-01T${I}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),ne=async I=>{if(I.preventDefault(),!(!h||!f||!b||!te)){K(!0),re("");try{p.trim()&&te.user_name_public!==p.trim()&&await F.from("users").update({user_name_public:p.trim()}).eq("id",te.id);const{error:J}=await F.from("bookings").insert({location_id:h,timeslot_id:b,game_id:x||null,date:f,user_id:te.id,user_name:p.trim(),user_email:te.email});if(J)throw J;if(x){const pe=u.find(G=>G.id===x);pe&&V(pe)}m(""),y(""),S(""),g(""),j(""),n(),e(),k(pe=>pe+1)}catch(J){re(J instanceof Error?J.message:"Failed to create booking")}finally{K(!1)}}},ae=h&&f&&b&&p.trim()&&C<4;if(!t)return null;const q=I=>{I.target===I.currentTarget&&e()},A=fe();return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:q,children:s.jsxs("div",{className:`bg-modal-bg rounded-lg max-w-lg w-full p-6 overflow-y-auto transition-all duration-300 ease-out transform
        fixed inset-0 sm:relative sm:inset-auto sm:max-w-lg sm:h-auto sm:rounded-lg sm:max-h-[90vh] h-screen w-screen sm:w-full overflow-y-auto rounded-none sm:rounded-lg p-6 sm:p-6
        ${t?"translate-y-0 opacity-100":"translate-y-full opacity-0"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-text font-overpass",children:"New Booking"}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6"})})]}),P?s.jsx("div",{className:"p-4 rounded-lg border bg-blue-50 border-blue-200",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),s.jsx("span",{className:"text-blue-700 text-sm font-medium",children:"Checking booking limit..."})]})}):C>=4?s.jsx("div",{className:"p-4 rounded-lg border bg-red-50 border-red-200",children:s.jsx("span",{className:"text-red-700 text-sm font-medium",children:" You have reached the maximum of 4 active bookings. Cancel an existing booking to create a new one."})}):C>=3?s.jsx("div",{className:"p-4 rounded-lg border bg-yellow-50 border-yellow-200",children:s.jsxs("span",{className:"text-yellow-700 text-sm font-medium",children:[" You have ",C," active booking",C!==1?"s":"",". You can create ",4-C," more."]})}):null,s.jsxs("form",{onSubmit:ne,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"userName",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Your Name"}),s.jsxs("div",{className:"relative",children:[s.jsx(Mn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsx("input",{type:"text",id:"userName",value:p,onChange:I=>j(I.target.value),placeholder:"Enter your full name",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]}),s.jsx("p",{className:"text-xs text-secondary-text mt-1",children:"This will be shared with the store for your booking."})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"game",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game (Optional)"}),s.jsx(ea,{games:u,selectedGame:x,onGameSelect:g,placeholder:"Choose a Game (Optional)",recentGames:L})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Location"}),s.jsxs("div",{className:"relative",children:[s.jsx(Js,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsxs("select",{id:"location",value:h,onChange:I=>m(I.target.value),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0,children:[s.jsx("option",{value:"",children:"Select Location"}),i.map(I=>s.jsxs("option",{value:I.id,children:[I.name," - ",I.tables," table",I.tables!==1?"s":""]},I.id))]})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Date"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsx("input",{type:"date",id:"date",value:f,onChange:I=>y(I.target.value),min:new Date().toISOString().split("T")[0],className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"timeslot",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Timeslot"}),s.jsxs("div",{className:"relative",children:[s.jsx(Kr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsxs("select",{id:"timeslot",value:b,onChange:I=>S(I.target.value),disabled:!h||!f,className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text disabled:opacity-50 disabled:cursor-not-allowed",required:!0,children:[s.jsx("option",{value:"",children:h?f?A.length===0?"No timeslots available for this day":"Select Timeslot":"Select date first":"Select location first"}),A.map(I=>s.jsx("option",{value:I.id,children:I.isAllDay?`${I.name} (All Day)`:`${I.name} (${ie(I.start_time)} - ${ie(I.end_time)})`},I.id))]})]}),f&&A.length===0&&h&&s.jsxs("p",{className:"text-sm text-secondary-text mt-1",children:["No timeslots available for ",O()," at this location."]})]}),Y&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:Y}),h&&f&&b&&s.jsx("div",{className:`p-4 rounded-lg border ${_?"bg-blue-50 border-blue-200":N===null?"bg-gray-50 border-gray-200":N===0?"bg-red-50 border-red-200":N<=2?"bg-yellow-50 border-yellow-200":"bg-green-50 border-green-200"}`,children:_?s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),s.jsx("span",{className:"text-blue-700 text-sm font-medium",children:"Checking table availability..."})]}):N===null?s.jsx("span",{className:"text-gray-700 text-sm font-medium",children:"Unable to check table availability"}):N===0?s.jsx("span",{className:"text-red-700 text-sm font-medium",children:" No tables available for this timeslot"}):N<=2?s.jsxs("span",{className:"text-yellow-700 text-sm font-medium",children:[" Only ",N," table",N!==1?"s":""," remaining"]}):s.jsxs("span",{className:"text-green-700 text-sm font-medium",children:[" ",N," table",N!==1?"s":""," available"]})}),s.jsxs("div",{className:"flex flex-col space-y-3 pt-4",children:[s.jsx("button",{type:"submit",disabled:!ae||D||N===0||C>=4,className:`btn-full ${ae&&!D&&N!==0&&C<4?"btn-primary":"btn-disabled"}`,children:D?"Creating Booking...":C>=4?"Booking Limit Reached":N===0?"No Tables Available":"Confirm Booking"}),s.jsx("button",{type:"button",onClick:e,className:"btn-danger-outline btn-full",children:"Cancel"})]})]})]})})}function rm({booking:t,onClick:e,onCancelBooking:n,isPast:r=!1}){const a=i=>new Date(`2000-01-01T${i}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm border border-border-custom p-4 w-full",children:[s.jsxs("div",{onClick:e,className:"cursor-pointer hover:bg-bg-secondary transition-colors text-left rounded p-2 -m-2 mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[s.jsx(Kr,{className:"w-4 h-4 text-secondary-text"}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-text text-sm",children:t.timeslot.name}),s.jsxs("p",{className:"text-xs text-secondary-text",children:[a(t.timeslot.start_time)," - ",a(t.timeslot.end_time)]})]})]}),s.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[s.jsx(Js,{className:"w-4 h-4 text-secondary-text mt-0.5"}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h3",{className:"font-medium text-text text-sm truncate",children:t.location.name}),s.jsx("p",{className:"text-xs text-secondary-text truncate",children:t.location.address})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[s.jsx(Mn,{className:"w-4 h-4 text-secondary-text"}),s.jsxs("div",{className:"min-w-0 flex-1",children:[t.user_name&&s.jsx("p",{className:"text-sm text-text truncate font-medium",children:t.user_name}),s.jsx("p",{className:"text-xs text-secondary-text truncate",children:t.user_email||t.user.email})]})]}),t.game&&s.jsxs("div",{className:"flex items-center space-x-2",children:[t.game.icon?s.jsx("img",{src:t.game.icon,alt:`${t.game.name} icon`,className:"w-4 h-4 object-contain rounded",onError:i=>{const o=i.target;o.style.display="none";const l=o.nextElementSibling;l&&l.classList.contains("icon-fallback")&&(l.style.display="flex")}}):null,s.jsx("div",{className:"w-4 h-4 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:t.game.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-xs font-bold",children:t.game.name.charAt(0)})}),s.jsx("span",{className:"text-sm text-secondary-text truncate",children:t.game.name})]})]}),n&&!r&&s.jsx("div",{className:"flex justify-end pt-2 border-t border-border-custom",children:s.jsxs("button",{onClick:()=>n(t.id),className:"btn-danger-outline-sm btn-with-icon-sm",children:[s.jsx(ye,{className:"w-3 h-3"}),s.jsx("span",{children:"Cancel"})]})})]})}function sm({isOpen:t,onClose:e,onConfirm:n,loading:r=!1}){if(!t)return null;const a=i=>{i.target===i.currentTarget&&e()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:a,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-title",children:"Are you sure you want to cancel this booking?"}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text",children:s.jsx(ye,{className:"w-6 h-6"})})]}),s.jsx("p",{className:"text-base text-secondary-text mb-6",children:"We'll delete this booking and make the table available for someone else."}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:e,disabled:r,className:"btn-ghost btn-flex",children:"No, I'll keep my booking"}),s.jsx("button",{onClick:n,disabled:r,className:"btn-danger btn-flex",children:r?"Deleting...":"Yes, Delete my booking"})]})]})})}function y0(){const[t,e]=v.useState([]),[n,r]=v.useState(!0),[a,i]=v.useState(null),{user:o}=et();v.useEffect(()=>{if(!o){e([]),r(!1);return}l()},[o]);const l=async()=>{try{const{data:c,error:u}=await F.from("bookings").select(`
          id,
          date,
          created_at,
          user_id,
          user_name,
          user_email,
          location:locations(
            id,
            name,
            address,
            icon
          ),
          timeslot:timeslots(
            id,
            name,
            start_time,
            end_time
          ),
          game:games(
            id,
            name,
            icon
          )
        `).eq("user_id",o==null?void 0:o.id).order("date",{ascending:!0});if(u)throw u;if(!c){e([]);return}const d=[...new Set(c.map(b=>b.user_id))],{data:h,error:m}=await F.from("users").select("id, email").in("id",d);if(m)throw m;const f=new Map((h||[]).map(b=>[b.id,b])),y=c.map(b=>({...b,user:f.get(b.user_id)||{id:b.user_id,email:"Unknown User"}}));e(y)}catch(c){i(c instanceof Error?c.message:"Failed to fetch bookings")}finally{r(!1)}};return{bookings:t,loading:n,error:a,refetch:l}}function v0(){const[t,e]=me.useState(!1),[n,r]=me.useState(new Set),[a,i]=me.useState(""),[o,l]=me.useState({isOpen:!1,bookingId:null}),[c,u]=me.useState(!1),{bookings:d,loading:h,refetch:m}=y0(),f=()=>{m()},y=j=>{i(j)},b=j=>{l({isOpen:!0,bookingId:j})},S=async()=>{if(o.bookingId){u(!0);try{const{error:j}=await F.from("bookings").delete().eq("id",o.bookingId);if(j)throw j;await m(),l({isOpen:!1,bookingId:null})}catch(j){console.error("Error cancelling booking:",j)}finally{u(!1)}}},x=me.useMemo(()=>{const j=new Date;j.setHours(0,0,0,0);const N={},w=[];d.forEach(C=>{if(new Date(C.date)>=j){const P=C.date;N[P]||(N[P]=[]),N[P].push(C)}else w.push(C)}),Object.keys(N).forEach(C=>{N[C].sort((k,P)=>k.timeslot.start_time.localeCompare(P.timeslot.start_time))}),w.sort((C,k)=>{const P=k.date.localeCompare(C.date);return P!==0?P:k.timeslot.start_time.localeCompare(C.timeslot.start_time)});const E=Object.keys(N).sort((C,k)=>C.localeCompare(k)).map(C=>({date:C,bookings:N[C],isPast:!1}));return w.length>0&&E.push({date:"past",bookings:w,isPast:!0}),E},[d]);me.useEffect(()=>{x.length>0&&r(new Set([x[0].date]))},[x]);const g=j=>{r(N=>{const w=new Set(N);return w.has(j)?w.delete(j):w.add(j),w})},p=j=>j==="past"?"Past Bookings":new Date(j).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsx("h1",{className:"text-4xl font-bold text-title mb-4",children:"YOUR TABLE BOOKINGS"}),d.length>0&&s.jsxs("button",{onClick:()=>e(!0),className:"btn-primary-sm btn-with-icon-sm",children:[s.jsx(kn,{className:"w-4 h-4"}),s.jsx("span",{children:"New Table Booking"})]})]}),s.jsx("div",{className:"mb-8",children:h?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Array.from({length:4}).map((j,N)=>s.jsx("div",{className:"bg-bg-card rounded-lg shadow-sm border border-border-custom overflow-hidden animate-pulse",children:s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsx("div",{className:"h-6 bg-secondary-text opacity-20 rounded"}),s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-3/4"}),s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-1/2"})]})},N))}):d.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ze,{className:"w-16 h-16 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text mb-4",children:"No table bookings yet."}),s.jsx("button",{onClick:()=>e(!0),className:"btn-primary",children:"Book Your First Table"})]}):s.jsx("div",{className:"space-y-8",children:x.map(({date:j,bookings:N,isPast:w})=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("button",{onClick:()=>g(j),className:"w-full flex items-center justify-between text-left border-b border-border-custom pb-2 hover:bg-bg-secondary transition-colors rounded-lg px-2 py-1",children:[s.jsx("h2",{className:"text-xl font-bold text-title",children:p(j)}),n.has(j)?s.jsx(hc,{className:"w-5 h-5 text-secondary-text"}):s.jsx(Yn,{className:"w-5 h-5 text-secondary-text"})]}),n.has(j)&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:N.map(_=>s.jsx(rm,{booking:_,onClick:()=>{},onCancelBooking:b,isPast:w},_.id))})]},j))})})]}),s.jsx(x0,{isOpen:t,onClose:()=>e(!1),onBookingCreated:f,lastSelectedLocation:a,onLocationSelected:y}),s.jsx(sm,{isOpen:o.isOpen,onClose:()=>l({isOpen:!1,bookingId:null}),onConfirm:S,loading:c})]})}function b0({model:t,name:e,boxName:n,gameName:r,gameIcon:a,status:i,count:o,imageUrl:l,onViewModel:c,onViewBox:u}){console.log("ModelCard Debug:",{name:e,gameName:r,gameIcon:a,hasGameIcon:!!a,gameIconType:typeof a,gameIconTrimmed:a==null?void 0:a.trim()});const d=f=>{switch(f){case"Painted":return"bg-green-100 text-green-800";case"Partially Painted":return"bg-yellow-100 text-yellow-800";case"Primed":return"bg-blue-100 text-blue-800";case"Assembled":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},h=()=>{var y,b,S;if(l&&typeof l=="string"&&l.trim()!==""&&l!=="undefined"&&l!=="null"&&!l.includes("undefined")&&!l.includes("null")&&(l.startsWith("http")||l.startsWith("/")))return{src:l,isGameFallback:!1};const f=((b=(y=t==null?void 0:t.box)==null?void 0:y.game)==null?void 0:b.icon)||((S=t==null?void 0:t.game)==null?void 0:S.icon);return f&&typeof f=="string"&&f.trim()!==""&&f!=="undefined"&&f!=="null"&&f.startsWith("http")?{src:f,isGameFallback:!0}:{src:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg",isGameFallback:!1}},m=f=>!!(f&&typeof f=="string"&&f.trim()!==""&&f!=="undefined"&&f!=="null"&&f.startsWith("http")&&f.includes("game-assets"));return s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm border border-border-custom overflow-hidden max-w-[380px] flex flex-col h-full",children:[s.jsxs("div",{className:"aspect-w-16 aspect-h-12 relative bg-bg-card-secondary",children:[(()=>{const f=h();return s.jsx("img",{src:f.src,alt:e,className:`w-full h-48 min-h-[400px] object-cover ${f.isGameFallback?"opacity-10":""}`,loading:"lazy",onError:y=>{const b=y.target,S="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg";b.src!==S&&(console.log("Image failed to load:",b.src,"Falling back to default"),b.src=S)}})})(),i!=="None"&&s.jsx("div",{className:"absolute top-2 left-2",children:s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${d(i)}`,children:i})})]}),s.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("h3",{className:"text-lg font-bold text-title w-[70%]",children:e}),s.jsx("div",{className:"flex items-center space-x-2 ml-2 flex-col w-[30%]",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-xs text-secondary-text font-bold text-right",children:r.toUpperCase()}),m(a)?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:a||"",alt:`${r} icon`,className:"w-8 h-8 object-contain rounded flex-shrink-0",onError:f=>{const y=f.target;console.warn("Game icon failed to load (bucket not found):",a,"Falling back to letter icon"),y.style.display="none";const b=y.nextElementSibling;b&&b.classList.contains("icon-fallback")&&(b.style.display="flex")},onLoad:f=>{const b=f.target.nextElementSibling;b&&b.classList.contains("icon-fallback")&&(b.style.display="none")}}),s.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center icon-fallback",children:s.jsx("span",{className:"text-white text-xs font-bold",children:r.charAt(0)})})]}):s.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center flex-shrink-0 icon-fallback",children:s.jsx("span",{className:"text-white text-xs font-bold",children:r.charAt(0)})})]})})]}),(t==null?void 0:t.box)&&s.jsx("button",{onClick:()=>u==null?void 0:u(t.box),className:"text-sm text-secondary-text font-semibold mb-3 hover:text-brand transition-colors text-left",children:n})]}),s.jsx("div",{className:"flex space-x-2",children:s.jsx("button",{onClick:c,className:"btn-secondary btn-flex",children:"View Model"})})]})]})}function w0({name:t,gameName:e,purchaseDate:n,imageUrl:r,gameImage:a,gameIcon:i,onViewBox:o}){const l=d=>new Date(d).toLocaleDateString(),c=()=>r&&typeof r=="string"&&r.trim()!==""&&r!=="undefined"&&r!=="null"&&!r.includes("undefined")&&!r.includes("null")&&(r.startsWith("http")||r.startsWith("/"))?r:a&&typeof a=="string"&&a.trim()!==""&&a!=="undefined"&&a!=="null"&&a.startsWith("http")?a:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg",u=d=>!!(d&&typeof d=="string"&&d.trim()!==""&&d!=="undefined"&&d!=="null"&&d.startsWith("http")&&d.includes("game-assets"));return s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm border border-border-custom overflow-hidden max-w-[380px] flex flex-col",children:[s.jsx("div",{className:"aspect-w-16 aspect-h-12 relative bg-bg-card-secondary",children:s.jsx("img",{src:c(),alt:t,className:"w-full h-48 min-h-[400px] bg-bg-card-secondary object-cover"})}),s.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex flex-col flex-1 min-w-0 mr-3",children:[s.jsx("h3",{className:"text-lg font-bold text-title mb-1 break-words",children:t}),s.jsxs("p",{className:"text-sm text-secondary-text",children:["Purchased: ",l(n)]})]}),s.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0 max-w-[30%]",children:[s.jsx("span",{className:"text-xs text-secondary-text font-bold",children:e.toUpperCase()}),u(i)?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:i||"",alt:`${e} icon`,className:"w-8 h-8 object-contain rounded flex-shrink-0",onError:d=>{const h=d.target;console.warn("Game icon failed to load (bucket not found):",i,"Falling back to letter icon"),h.style.display="none";const m=h.nextElementSibling;m&&m.classList.contains("icon-fallback")&&(m.style.display="flex")},onLoad:d=>{const m=d.target.nextElementSibling;m&&m.classList.contains("icon-fallback")&&(m.style.display="none")}}),s.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center icon-fallback",children:s.jsx("span",{className:"text-white text-xs font-bold",children:e.charAt(0)})})]}):s.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center flex-shrink-0 icon-fallback",children:s.jsx("span",{className:"text-white text-xs font-bold",children:e.charAt(0)})})]})]}),s.jsx("div",{className:"flex justify-center mt-auto",children:s.jsx("button",{onClick:o,className:"btn-secondary btn-flex",children:"View Collection"})})]})]})}function ka({currentPage:t,totalPages:e,onPageChange:n}){const r=[];if(e>7)if(t<=4){for(let i=1;i<=5;i++)r.push(i);r.push("..."),r.push(e)}else if(t>=e-3){r.push(1),r.push("...");for(let i=e-4;i<=e;i++)r.push(i)}else{r.push(1),r.push("...");for(let i=t-1;i<=t+1;i++)r.push(i);r.push("..."),r.push(e)}else for(let i=1;i<=e;i++)r.push(i);return s.jsxs("div",{className:"flex items-center justify-center space-x-1 mt-8",children:[s.jsx("button",{onClick:()=>n(t-1),disabled:t===1,className:"p-2 rounded-lg hover:bg-bg-secondary disabled:opacity-50 disabled:cursor-not-allowed text-text",children:s.jsx(Rg,{className:"w-5 h-5"})}),r.map((i,o)=>s.jsx("button",{onClick:()=>typeof i=="number"&&n(i),disabled:i==="...",className:`px-3 py-2 rounded-lg text-sm font-medium ${i===t?"bg-title text-bg-primary":i==="..."?"cursor-default text-secondary-text":"hover:bg-bg-secondary text-text"}`,children:i},o)),s.jsx("button",{onClick:()=>n(t+1),disabled:t===e,className:"p-2 rounded-lg hover:bg-bg-secondary disabled:opacity-50 disabled:cursor-not-allowed text-text",children:s.jsx(Yn,{className:"w-5 h-5"})})]})}function dd({isOpen:t,onClose:e,mode:n}){const[r,a]=v.useState(""),[i,o]=v.useState(""),[l,c]=v.useState(!1),[u,d]=v.useState(""),[h,m]=v.useState(""),[f,y]=v.useState(n),{signIn:b,signUp:S,signInWithGoogle:x,resetPassword:g}=et();me.useEffect(()=>{y(n),a(""),o(""),d(""),m("")},[n]);const p=async()=>{c(!0),d("");try{const{error:_}=await x();_&&d(_.message)}catch{d("An unexpected error occurred")}finally{c(!1)}},j=async _=>{_.preventDefault(),c(!0),d(""),m("");try{if(f==="forgot-password"){const{error:E}=await g(r);E?d(E.message):(m("Password reset email sent! Check your inbox."),a(""))}else{const{error:E}=f==="login"?await b(r,i):await S(r,i);E?d(E.message):(e(),a(""),o(""))}}catch{d("An unexpected error occurred")}finally{c(!1)}},N=()=>{y("login"),a(""),o(""),d(""),m("")};if(!t)return null;const w=_=>{_.target===_.currentTarget&&e()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:w,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f==="forgot-password"&&s.jsx("button",{onClick:N,className:"text-secondary-text hover:text-text p-1",children:s.jsx(or,{className:"w-5 h-5"})}),s.jsx("h2",{className:"text-2xl font-bold text-title flex-1 text-center",children:f==="login"?"Log In":f==="signup"?"Sign Up":"Reset Password"}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text",children:s.jsx(ye,{className:"w-6 h-6 text-icon"})})]}),f!=="forgot-password"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mb-6",children:s.jsxs("button",{type:"button",onClick:p,disabled:l,className:"btn-secondary btn-full btn-with-icon",children:[s.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[s.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),s.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),s.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),s.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),s.jsx("span",{className:"font-medium",children:f==="login"?"Sign in with Google":"Sign up with Google"})]})}),s.jsxs("div",{className:"relative mb-6",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-border-custom"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-2 bg-modal-bg text-secondary-text",children:"Or continue with email"})})]})]}),s.jsxs("form",{onSubmit:j,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-input-label font-overpass mb-1",children:"Email"}),s.jsx("input",{type:"email",id:"email",value:r,onChange:_=>a(_.target.value),required:!0,className:"w-full px-3 py-2 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text"})]}),f!=="forgot-password"&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-input-label font-overpass mb-1",children:"Password"}),s.jsx("input",{type:"password",id:"password",value:i,onChange:_=>o(_.target.value),required:!0,className:"w-full px-3 py-2 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text"})]}),f==="login"&&s.jsx("div",{className:"text-right",children:s.jsx("button",{type:"button",onClick:()=>y("forgot-password"),className:"text-sm text-[var(--color-brand)] hover:text-[var(--color-brand)]/80 transition-colors",children:"Forgot your password?"})}),u&&s.jsx("div",{className:"text-red-600 text-sm",children:u}),h&&s.jsx("div",{className:"text-green-600 text-sm",children:h}),s.jsx("div",{className:"flex justify-center",children:s.jsx("button",{type:"submit",disabled:l,className:"btn-primary btn-full",children:l?"Processing...":f==="login"?"Log In":f==="signup"?"Sign Up":"Send Reset Email"})})]}),f!=="forgot-password"&&s.jsx("div",{className:"mt-4 text-center",children:s.jsxs("p",{className:"text-sm text-secondary-text",children:[f==="login"?"Don't have an account? ":"Already have an account? ",s.jsx("button",{type:"button",onClick:()=>y(f==="login"?"signup":"login"),className:"btn-ghost btn-ghost-sm",children:f==="login"?"Sign Up":"Log In"})]})})]})})}async function un(t,e=1200,n=1200,r=.8){return new Promise((a,i)=>{const o=document.createElement("canvas"),l=o.getContext("2d"),c=new Image;c.onload=()=>{let{width:u,height:d}=c;u>d?u>e&&(d=d*e/u,u=e):d>n&&(u=u*n/d,d=n),o.width=u,o.height=d,l?(l.drawImage(c,0,0,u,d),o.toBlob(h=>{if(h){const m=new File([h],t.name,{type:t.type,lastModified:Date.now()});a(m)}else i(new Error("Failed to compress image"))},t.type,r)):i(new Error("Failed to get canvas context"))},c.onerror=()=>{i(new Error("Failed to load image"))},c.src=URL.createObjectURL(t)})}function Wr(t){return["image/jpeg","image/jpg","image/png","image/webp"].includes(t.type.toLowerCase())}function ut(t){if(t===0)return"0 Bytes";const e=1024,n=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,r)).toFixed(2))+" "+n[r]}function sr({isOpen:t,onClose:e,onCrop:n,imageFile:r}){const a=v.useRef(null);v.useRef(null);const[i,o]=v.useState(null),[l,c]=v.useState({x:0,y:0,width:200,height:200}),[u,d]=v.useState(!1),[h,m]=v.useState(!1),[f,y]=v.useState({x:0,y:0}),[b,S]=v.useState(1),[x,g]=v.useState(0),[p,j]=v.useState(""),[N,w]=v.useState({exposure:0});v.useEffect(()=>{if(t&&r){const M=new Image;return M.onload=()=>{o(M);const B=600,X=400,H=B/M.width,z=X/M.height,se=Math.min(H,z,1),$=M.width*se,O=M.height*se,ie=Math.min($,O)*.8;c({x:(B-ie)/2,y:(X-ie)/2,width:ie,height:ie}),S(se),g(0),w({exposure:0})},M.src=URL.createObjectURL(r),()=>URL.revokeObjectURL(M.src)}},[t,r]);const _=v.useCallback(()=>{const M=a.current,B=M==null?void 0:M.getContext("2d");if(!M||!B||!i)return;B.clearRect(0,0,M.width,M.height),B.save();const X=M.width/2,H=M.height/2;if(B.translate(X,H),B.rotate(x*Math.PI/180),B.scale(b,b),N.exposure!==0){const $=document.createElement("canvas"),O=$.getContext("2d");O&&($.width=i.width,$.height=i.height,O.drawImage(i,0,0),N.exposure>0?(O.globalCompositeOperation="screen",O.fillStyle=`rgba(255, 255, 255, ${N.exposure/100})`,O.fillRect(0,0,$.width,$.height)):N.exposure<0&&(O.globalCompositeOperation="multiply",O.fillStyle=`rgba(0, 0, 0, ${Math.abs(N.exposure)/100})`,O.fillRect(0,0,$.width,$.height)),B.drawImage($,-i.width/2,-i.height/2,i.width,i.height))}else B.drawImage(i,-i.width/2,-i.height/2,i.width,i.height);B.restore(),B.strokeStyle="#F59E0B",B.lineWidth=2,B.strokeRect(l.x,l.y,l.width,l.height);const z=8,se=[{x:l.x-z/2,y:l.y-z/2},{x:l.x+l.width-z/2,y:l.y-z/2},{x:l.x-z/2,y:l.y+l.height-z/2},{x:l.x+l.width-z/2,y:l.y+l.height-z/2},{x:l.x+l.width/2-z/2,y:l.y-z/2},{x:l.x+l.width-z/2,y:l.y+l.height/2-z/2},{x:l.x+l.width/2-z/2,y:l.y+l.height-z/2},{x:l.x-z/2,y:l.y+l.height/2-z/2}];B.fillStyle="#F59E0B",se.forEach($=>{B.fillRect($.x,$.y,z,z)})},[i,l,b,x,N]);v.useEffect(()=>{_()},[_]);const E=M=>{const B=a.current;if(!B)return;const X=B.getBoundingClientRect(),H=M.clientX-X.left,z=M.clientY-X.top,$=window.innerWidth<=768?40:20,O=[{x:l.x-$/2,y:l.y-$/2,type:"nw"},{x:l.x+l.width-$/2,y:l.y-$/2,type:"ne"},{x:l.x-$/2,y:l.y+l.height-$/2,type:"sw"},{x:l.x+l.width-$/2,y:l.y+l.height-$/2,type:"se"},{x:l.x+l.width/2-$/2,y:l.y-$/2,type:"n"},{x:l.x+l.width-$/2,y:l.y+l.height/2-$/2,type:"e"},{x:l.x+l.width/2-$/2,y:l.y+l.height-$/2,type:"s"},{x:l.x-$/2,y:l.y+l.height/2-$/2,type:"w"}];for(let fe=0;fe<O.length;fe++){const ie=O[fe];if(H>=ie.x&&H<=ie.x+$&&z>=ie.y&&z<=ie.y+$){m(!0),j(ie.type),y({x:H,y:z});return}}H>=l.x&&H<=l.x+l.width&&z>=l.y&&z<=l.y+l.height&&(d(!0),y({x:H-l.x,y:z-l.y}))},[C,k]=v.useState("crosshair"),P=M=>{const B=a.current;if(!B)return;const X=B.getBoundingClientRect(),H=M.clientX-X.left,z=M.clientY-X.top;if(!u&&!h){const $=window.innerWidth<=768?40:20,O=[{x:l.x-$/2,y:l.y-$/2,type:"nw"},{x:l.x+l.width-$/2,y:l.y-$/2,type:"ne"},{x:l.x-$/2,y:l.y+l.height-$/2,type:"sw"},{x:l.x+l.width-$/2,y:l.y+l.height-$/2,type:"se"},{x:l.x+l.width/2-$/2,y:l.y-$/2,type:"n"},{x:l.x+l.width-$/2,y:l.y+l.height/2-$/2,type:"e"},{x:l.x+l.width/2-$/2,y:l.y+l.height-$/2,type:"s"},{x:l.x-$/2,y:l.y+l.height/2-$/2,type:"w"}];let fe=!1;for(let ie=0;ie<O.length;ie++){const ne=O[ie];if(H>=ne.x&&H<=ne.x+$&&z>=ne.y&&z<=ne.y+$){switch(fe=!0,ne.type){case"nw":case"se":k("nw-resize");break;case"ne":case"sw":k("ne-resize");break;case"n":case"s":k("n-resize");break;case"e":case"w":k("e-resize");break}break}}fe||(H>=l.x&&H<=l.x+l.width&&z>=l.y&&z<=l.y+l.height?k("move"):k("default"))}if(u){k("move");const se=Math.max(0,Math.min(H-f.x,B.width-l.width)),$=Math.max(0,Math.min(z-f.y,B.height-l.height));c(O=>({...O,x:se,y:$}))}else if(h){const se=H-f.x,$=z-f.y;c(O=>{let fe=O.x,ie=O.y,ne=O.width,ae=O.height;switch(p){case"nw":fe=Math.max(0,Math.min(O.x+se,O.x+O.width-50)),ie=Math.max(0,Math.min(O.y+$,O.y+O.height-50)),ne=O.width-(fe-O.x),ae=O.height-(ie-O.y);break;case"ne":ie=Math.max(0,Math.min(O.y+$,O.y+O.height-50)),ne=Math.max(50,Math.min(O.width+se,B.width-O.x)),ae=O.height-(ie-O.y);break;case"sw":fe=Math.max(0,Math.min(O.x+se,O.x+O.width-50)),ne=O.width-(fe-O.x),ae=Math.max(50,Math.min(O.height+$,B.height-O.y));break;case"se":ne=Math.max(50,Math.min(O.width+se,B.width-O.x)),ae=Math.max(50,Math.min(O.height+$,B.height-O.y));break;case"n":ie=Math.max(0,Math.min(O.y+$,O.y+O.height-50)),ae=O.height-(ie-O.y);break;case"e":ne=Math.max(50,Math.min(O.width+se,B.width-O.x));break;case"s":ae=Math.max(50,Math.min(O.height+$,B.height-O.y));break;case"w":fe=Math.max(0,Math.min(O.x+se,O.x+O.width-50)),ne=O.width-(fe-O.x);break}return{x:fe,y:ie,width:ne,height:ae}}),y({x:H,y:z})}},U=()=>{d(!1),m(!1),j("")},D=()=>{S(M=>Math.min(M+.1,3))},K=()=>{S(M=>Math.max(M-.1,.1))},Y=()=>{g(M=>(M+90)%360)},re=M=>{const B=parseFloat(M.target.value);w(X=>({...X,exposure:B}))},te=()=>{w({exposure:0})},L=()=>{const M=a.current,B=M==null?void 0:M.getContext("2d");if(!M||!B||!i)return;const X=M.width,H=M.height,z=X/2,se=H/2,$=i.width*b,O=i.height*b,fe=z-$/2,ie=se-O/2,ne=l.x-fe,ae=l.y-ie,q=ne/b,A=ae/b,I=l.width/b,J=l.height/b,pe=Math.max(0,Math.min(q,i.width)),G=Math.max(0,Math.min(A,i.height)),ee=Math.min(I,i.width-pe),ge=Math.min(J,i.height-G),Ce=document.createElement("canvas"),ve=Ce.getContext("2d");if(ve){if(Ce.width=Math.round(ee),Ce.height=Math.round(ge),x!==0||N.exposure!==0){const be=document.createElement("canvas"),W=be.getContext("2d");if(!W)return;if(x!==0){const je=x*Math.PI/180,ue=Math.abs(Math.cos(je)),Ne=Math.abs(Math.sin(je));be.width=i.width*ue+i.height*Ne,be.height=i.width*Ne+i.height*ue,W.translate(be.width/2,be.height/2),W.rotate(je)}else be.width=i.width,be.height=i.height;W.drawImage(i,-i.width/2,-i.height/2),N.exposure!==0&&(N.exposure>0?(W.globalCompositeOperation="screen",W.fillStyle=`rgba(255, 255, 255, ${N.exposure/100})`,W.fillRect(0,0,be.width,be.height)):(W.globalCompositeOperation="multiply",W.fillStyle=`rgba(0, 0, 0, ${Math.abs(N.exposure)/100})`,W.fillRect(0,0,be.width,be.height)));let Z,xe;if(x!==0){const je=x*Math.PI/180,ue=Math.abs(Math.cos(je)),Ne=Math.abs(Math.sin(je));Z=be.width/2+(q-i.width/2)*ue-(A-i.height/2)*Ne-ee/2,xe=be.height/2+(q-i.width/2)*Ne+(A-i.height/2)*ue-ge/2}else Z=q,xe=A;ve.drawImage(be,Math.max(0,Z),Math.max(0,xe),ee,ge,0,0,ee,ge)}else ve.drawImage(i,pe,G,ee,ge,0,0,ee,ge);Ce.toBlob(be=>{if(be){const W=new File([be],r.name,{type:r.type,lastModified:Date.now()});n(W)}},r.type,1)}};if(!t)return null;const V=M=>{M.target===M.currentTarget&&e()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-[70]",onClick:V,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-2xl w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-lg font-bold text-title",children:"Crop Image"}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6"})})]}),s.jsx("div",{className:"mb-4",children:s.jsx("canvas",{ref:a,width:600,height:400,className:"border border-border-custom rounded-lg w-full block",style:{cursor:C},onMouseDown:E,onMouseMove:P,onMouseUp:U,onMouseLeave:U})}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[s.jsx("button",{onClick:K,className:"p-2 border border-border-custom rounded-lg hover:bg-bg-secondary transition-colors",title:"Zoom Out",children:s.jsx(Qg,{className:"w-4 h-4"})}),s.jsx("button",{onClick:D,className:"p-2 border border-border-custom rounded-lg hover:bg-bg-secondary transition-colors",title:"Zoom In",children:s.jsx(Jg,{className:"w-4 h-4"})}),s.jsx("button",{onClick:Y,className:"p-2 border border-border-custom rounded-lg hover:bg-bg-secondary transition-colors",title:"Rotate",children:s.jsx(Hg,{className:"w-4 h-4"})}),s.jsx("div",{className:"flex items-center space-x-2 text-sm text-secondary-text",children:s.jsx("span",{children:"Drag crop area or resize handles to adjust selection"})})]}),s.jsx("div",{className:"bg-bg-secondary rounded-lg p-4",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"text-sm text-secondary-text",children:"Exposure"}),s.jsxs("span",{className:"text-sm text-secondary-text",children:[N.exposure>0?"+":"",N.exposure]})]}),s.jsx("input",{type:"range",min:"-50",max:"50",step:"1",value:N.exposure,onChange:re,className:"w-full h-2 bg-border-custom rounded-lg appearance-none cursor-pointer slider"}),s.jsxs("div",{className:"flex justify-between text-xs text-secondary-text mt-1",children:[s.jsx("span",{children:"Darker"}),s.jsx("span",{children:"Brighter"})]})]}),s.jsx("button",{onClick:te,className:"text-sm text-amber-600 hover:text-amber-700 transition-colors",children:"Reset Adjustments"})]})})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:e,className:"btn-ghost btn-flex",children:"Cancel"}),s.jsx("button",{onClick:L,className:"btn-primary btn-flex",children:"Crop & Use"})]})]})})}function j0({isOpen:t,onClose:e,onSuccess:n,preselectedBoxId:r}){const[a,i]=v.useState(""),[o,l]=v.useState(""),[c,u]=v.useState(""),[d,h]=v.useState(""),[m,f]=v.useState(""),[y,b]=v.useState(""),[S,x]=v.useState(""),[g,p]=v.useState(""),[j,N]=v.useState("1"),[w,_]=v.useState(null),[E,C]=v.useState(!1),[k,P]=v.useState(null),[U,D]=v.useState([]),[K,Y]=v.useState([]),[re,te]=v.useState(!1),[L,V]=v.useState(!1),[M,B]=v.useState(""),[X,H]=v.useState(""),[z,se]=v.useState(""),{user:$}=et();me.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),v.useEffect(()=>{t&&(O(),fe(),r&&u(r))},[t]),v.useEffect(()=>{t&&fe()},[t,$]);const O=async()=>{try{const{data:G,error:ee}=await F.from("games").select("id, name, icon").order("name");if(ee)throw ee;D(G||[])}catch(G){console.error("Error fetching games:",G)}},fe=async()=>{if($)try{const{data:G,error:ee}=await F.from("boxes").select(`
          id,
          name,
          game_id,
          purchase_date,
          created_at,
          game:games(
            name,
            icon
          )
        `).eq("user_id",$.id).order("created_at",{ascending:!1});if(ee)throw ee;const ge=(G||[]).map(Ce=>({...Ce,game:Ce.game&&Array.isArray(Ce.game)?Ce.game[0]:Ce.game}));Y(ge)}catch(G){console.error("Error fetching boxes:",G)}},ie=()=>o?K.filter(G=>G.game_id===o):K,ne=G=>{const ee=G.target.files;if(H(""),se(""),ee&&ee.length>0){const ge=ee[0];if(!Wr(ge)){H("Please select a valid image file (JPEG, PNG, or WebP)"),_(null),G.target.value="";return}const Ce=50*1024*1024;ge.size>Ce?(H(`Your image must be 50MB or less. Current size: ${ut(ge.size)}`),_(null),G.target.value=""):(_(ee),ee&&ee.length>0&&(P(ee[0]),C(!0)),ge.size>1024*1024&&se(`Original size: ${ut(ge.size)}. Image will be automatically compressed before upload.`))}else _(ee)},ae=G=>{const ee=new DataTransfer;ee.items.add(G),_(ee.files),C(!1),P(null),se(`Cropped image ready for upload (${ut(G.size)})`)},q=()=>{C(!1),P(null);const G=document.getElementById("image");G&&(G.value=""),_(null)},A=G=>{const ee=G.target.value.replace(/[^0-9.]/g,"");if(x(ee),ee&&!isNaN(parseFloat(ee))){const ge=parseFloat(ee);p(`$${ge.toFixed(2)}`)}else p("")},I=async G=>{if(G.preventDefault(),!(!a.trim()||!$)){te(!0),B("");try{let ee="";if(w&&w.length>0){const ve=w[0];if(z.includes("Cropped image ready")){V(!0);try{const W=await un(ve,1200,1200,.8);console.log(`Cropped image compressed: ${ut(ve.size)}  ${ut(W.size)}`);const Z=W.name.split(".").pop(),xe=`${$.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${Z}`,{data:je,error:ue}=await F.storage.from("model-images").upload(xe,W);if(ue)throw console.error("Compressed cropped image upload error:",ue),new Error(`Failed to upload image: ${ue.message}`);{const{data:Ne}=F.storage.from("model-images").getPublicUrl(je.path);ee=Ne.publicUrl,console.log("Uploaded compressed cropped image URL:",ee)}}catch(W){console.error("Cropped image compression error:",W);const Z=ve.name.split(".").pop(),xe=`${$.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${Z}`,{data:je,error:ue}=await F.storage.from("model-images").upload(xe,ve);if(ue)throw console.error("Fallback cropped image upload error:",ue),new Error(`Failed to upload image: ${ue.message}`);{const{data:Ne}=F.storage.from("model-images").getPublicUrl(je.path);ee=Ne.publicUrl,console.log("Uploaded uncompressed cropped image URL:",ee)}}finally{V(!1)}}else{V(!0);try{const W=await un(ve,1200,1200,.8);console.log(`Image compressed: ${ut(ve.size)}  ${ut(W.size)}`);const Z=W.name.split(".").pop(),xe=`${$.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${Z}`,{data:je,error:ue}=await F.storage.from("model-images").upload(xe,W);if(ue)throw console.error("Image upload error:",ue),new Error(`Failed to upload image: ${ue.message}`);{const{data:Ne}=F.storage.from("model-images").getPublicUrl(je.path);ee=Ne.publicUrl,console.log("Uploaded compressed image URL:",ee)}}catch(W){console.error("Image compression error:",W);try{const Z=ve.name.split(".").pop(),xe=`${$.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${Z}`,{data:je,error:ue}=await F.storage.from("model-images").upload(xe,ve);if(ue)throw console.error("Original image upload error:",ue),new Error(`Failed to upload image: ${ue.message}`);{const{data:Ne}=F.storage.from("model-images").getPublicUrl(je.path);ee=Ne.publicUrl,console.log("Uploaded original image URL:",ee)}}catch(Z){throw console.error("Fallback upload failed:",Z),new Error("Failed to upload image after compression fallback")}}finally{V(!1)}}}let ge=o||null;if(c||r){const ve=c||r,be=K.find(W=>W.id===ve);be&&be.game_id&&(ge=be.game_id)}const{error:Ce}=await F.from("models").insert({name:a.trim(),box_id:c||r||null,game_id:ge,status:d||"None",count:parseInt(j)||1,user_id:$.id,image_url:ee,purchase_date:m||null,painted_date:y||null});if(Ce)throw Ce;i(""),l(""),u(""),h(""),f(""),b(""),x(""),p(""),N("1"),_(null),se("");try{localStorage.removeItem("mini-myths-temp-box-context")}catch(ve){console.error("Error clearing box context:",ve)}n(),e()}catch(ee){B(ee instanceof Error?ee.message:"Failed to add model")}finally{te(!1),V(!1)}}},J=a.trim().length>0&&!X&&!L;if(!t)return null;const pe=G=>{G.target===G.currentTarget&&e()};return ie(),s.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:pe,children:[s.jsxs("div",{className:`bg-modal-bg rounded-lg max-w-lg w-full p-6 overflow-y-auto transition-all duration-300 ease-out transform
        fixed inset-0 sm:relative sm:inset-auto sm:max-w-lg sm:h-auto sm:rounded-lg sm:max-h-[90vh] h-screen w-screen sm:w-full overflow-y-auto rounded-none sm:rounded-lg p-6 sm:p-6
        ${t?"translate-y-0 opacity-100":"translate-y-full opacity-0"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-lg font-bold text-secondary-text uppercase tracking-wide text-center flex-1",children:"Add New Model"}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6 text-icon"})})]}),s.jsx("p",{className:"text-base text-secondary-text text-center mb-8",children:"Don't worry- you can update any of these details later."}),s.jsxs("form",{onSubmit:I,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{htmlFor:"modelName",className:"block text-sm font-medium text-input-label font-overpass",children:"Model Name"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Required"})]}),s.jsx("input",{type:"text",id:"modelName",value:a,onChange:G=>i(G.target.value),placeholder:'eg. "Space Marine Lieutenant", "Captain America", "US Ranger Squad", etc.',className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] placeholder-secondary-text bg-bg-primary text-text"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"box",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Collection (Optional)"}),s.jsxs("select",{id:"box",value:c,onChange:G=>{u(G.target.value),G.target.value&&l("")},className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text",children:[s.jsx("option",{value:"",children:"No Collection (Loose Model)"}),ie().map(G=>s.jsxs("option",{value:G.id,children:[G.name," ",G.game&&`(${G.game.name})`]},G.id))]}),s.jsx("p",{className:"text-xs text-secondary-text mt-1",children:"Choose an existing collection or leave as loose model."}),c&&(()=>{const G=K.find(ee=>ee.id===c);return G&&G.game?s.jsxs("p",{className:"text-xs text-[var(--color-brand)] mt-1",children:["Game will be automatically set to: ",s.jsx("strong",{children:G.game.name})]}):null})()]}),!c&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"game",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game"}),s.jsx(ea,{games:U,selectedGame:o,onGameSelect:l,placeholder:"Choose a Game"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"paintedStatus",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Painted Status"}),s.jsxs("select",{id:"paintedStatus",value:d,onChange:G=>h(G.target.value),className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text",children:[s.jsx("option",{value:"",children:"Select Status"}),s.jsx("option",{value:"Assembled",children:"Assembled"}),s.jsx("option",{value:"Primed",children:"Primed"}),s.jsx("option",{value:"Partially Painted",children:"Partially Painted"}),s.jsx("option",{value:"Painted",children:"Painted"})]})]}),d==="Painted"&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"paintedDate",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Painted Date"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"date",id:"paintedDate",value:y,onChange:G=>b(G.target.value),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] text-text bg-bg-primary"})]})]}),!c&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"purchaseDate",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Purchase Date"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"date",id:"purchaseDate",value:m,onChange:G=>f(G.target.value),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] text-text bg-bg-primary"})]})]}),!c&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"purchasePrice",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Purchase Price"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ef,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"number",id:"purchasePrice",value:S,onChange:A,placeholder:"Enter Purchase Price",step:"0.01",min:"0",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] placeholder-secondary-text bg-bg-primary text-text"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"numberOfModels",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Number of Models"}),s.jsxs("div",{className:"relative",children:[s.jsx(_i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"number",id:"numberOfModels",value:j,onChange:G=>N(G.target.value),min:"1",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"image",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Image"}),s.jsxs("div",{className:"relative",children:[s.jsx(rr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"file",id:"image",accept:"image/*",onChange:ne,className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-[var(--color-brand)]/10 file:text-[var(--color-brand)] hover:file:bg-[var(--color-brand)]/20 bg-bg-primary text-text"})]}),s.jsx("p",{className:"text-xs text-secondary-text mt-1",children:"You can upload more images later."})]}),z&&s.jsx("div",{className:"text-blue-600 text-sm bg-blue-50 p-3 rounded-lg",children:z}),X&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:X}),M&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:M}),s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx("button",{type:"submit",disabled:!J||re,className:`${J&&!re?"btn-primary":"btn-disabled"}`,children:L?"Compressing Image...":re?"Adding...":"Add to Collection"})})]})]}),k&&s.jsx(sr,{isOpen:E,onClose:q,onCrop:ae,imageFile:k})]})}function am({isOpen:t,onClose:e,images:n,onImageSelect:r,searchQuery:a,onFindMoreImages:i,isLoadingMore:o}){if(!t)return null;const l=c=>{c.target===c.currentTarget&&e()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",onClick:l,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-4xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(mc,{className:"w-6 h-6 text-secondary-text"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-bold text-title",children:"Suggested Images"}),s.jsxs("p",{className:"text-sm text-secondary-text",children:['Search results for: "',a,'"']})]})]}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6"})})]}),n.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsxs("p",{className:"text-base text-secondary-text mb-4",children:['No images found for "',a,'". Try uploading your own image instead.']}),s.jsx("button",{onClick:e,className:"px-4 py-2 bg-brand hover:bg-amber-600 text-white rounded-lg transition-colors",children:"Upload My Own Image"})]}):s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-sm text-secondary-text mb-6",children:"Click on an image to use it for your box. Images are sourced from Google Image Search."}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:n.map((c,u)=>s.jsxs("button",{onClick:()=>r(c),className:"group relative aspect-square overflow-hidden rounded-lg border-2 border-transparent hover:border---color-brand transition-all duration-200",children:[s.jsx("img",{src:c,alt:`Suggested image ${u+1}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-200 flex items-center justify-center",children:s.jsx("span",{className:"text-white font-medium opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:"Select Image"})})]},u))}),i&&s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx("button",{onClick:i,disabled:o,className:"flex items-center space-x-2 px-6 py-2 bg-brand hover:bg-amber-600 disabled:bg-amber-300 text-white rounded-lg transition-colors font-medium",children:o?s.jsxs(s.Fragment,{children:[s.jsx(Hu,{className:"w-4 h-4 animate-spin"}),s.jsx("span",{children:"Finding more images..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Hu,{className:"w-4 h-4"}),s.jsx("span",{children:"Find more images"})]})})}),s.jsx("div",{className:"flex justify-center",children:s.jsx("button",{onClick:e,className:"px-6 py-2 border border-border-custom text-text hover:bg-bg-secondary rounded-lg transition-colors",children:"Upload My Own Image Instead"})})]})]})})}function fo({variant:t="primary",size:e="default",width:n="default",withIcon:r=!1,className:a="",children:i,...o}){const l=`btn-${t}`,h=[e==="small"?`btn-${t}-sm`:l,n==="full"?"btn-full":n==="flex"?"btn-flex":"",r?e==="small"?"btn-with-icon-sm":"btn-with-icon":"",a].filter(Boolean).join(" ");return s.jsx("button",{className:h,...o,children:i})}function k0({isOpen:t,onClose:e,onSuccess:n}){var be;const[r,a]=v.useState(""),[i,o]=v.useState(""),[l,c]=v.useState(""),[u,d]=v.useState(""),[h,m]=v.useState(""),[f,y]=v.useState(null),[b,S]=v.useState(!1),[x,g]=v.useState(null),[p,j]=v.useState([]),[N,w]=v.useState(!1),[_,E]=v.useState(!1),[C,k]=v.useState(""),[P,U]=v.useState(""),[D,K]=v.useState(""),{user:Y}=et(),[re,te]=v.useState(!1),[L,V]=v.useState(!1),[M,B]=v.useState([]),[X,H]=v.useState(""),[z,se]=v.useState([]),[$,O]=v.useState(!1);let fe=null;me.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),v.useEffect(()=>{t&&ie()},[t]);const ie=async()=>{try{const{data:W,error:Z}=await F.from("games").select("id, name, icon").order("name");if(Z)throw Z;j(W||[])}catch(W){console.error("Error fetching games:",W)}},ne=W=>{const Z=W.target.files;if(U(""),K(""),Z&&Z.length>0){const xe=Z[0];if(!Wr(xe)){U("Please select a valid image file (JPEG, PNG, or WebP)"),y(null),W.target.value="";return}const je=50*1024*1024;xe.size>je?(U(`Your image must be 50MB or less. Current size: ${ut(xe.size)}`),y(null),W.target.value=""):(y(Z),Z&&Z.length>0&&(g(Z[0]),S(!0)),xe.size>1024*1024&&K(`Original size: ${ut(xe.size)}. Image will be automatically compressed before upload.`))}else y(Z)},ae=W=>{const Z=new DataTransfer;Z.items.add(W),y(Z.files),S(!1),g(null),K(`Cropped image ready for upload (${ut(W.size)})`)},q=()=>{S(!1),g(null);const W=document.getElementById("boxImage");W&&(W.value=""),y(null)},A=W=>{const Z=W.target.value.replace(/[^0-9.]/g,"");if(d(Z),Z&&!isNaN(parseFloat(Z))){const xe=parseFloat(Z);m(`$${xe.toFixed(2)}`)}else m("")},I=async()=>{if(r.trim()){V(!0),B([]),se([]);try{const W=p.find(De=>De.id===i),Z=(W==null?void 0:W.name)||"",xe=`${r.trim()} ${Z}`.trim(),je=await fetch("https://dthxptbozocrbvmhwvao.supabase.co/functions/v1/search-images",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0aHhwdGJvem9jcmJ2bWh3dmFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyOTY0MzMsImV4cCI6MjA3MDg3MjQzM30.gFt4oRFZ7Mh4y8DgeKNbcKKDwTYjEdXRoBlqTNjvdRg","Content-Type":"application/json"},body:JSON.stringify({query:xe,count:6})});if(!je.ok)throw new Error("Failed to search for images");const Ne=(await je.json()).images||[];B(Ne),se(Ne),te(!0)}catch(W){console.error("Error searching for images:",W),te(!1)}finally{V(!1)}}},J=async()=>{if(r.trim()){O(!0);try{const W=p.find(tt=>tt.id===i),Z=(W==null?void 0:W.name)||"",xe=`${r.trim()} ${Z}`.trim();console.log("Finding more images with exclude:",z);const je=await fetch("https://dthxptbozocrbvmhwvao.supabase.co/functions/v1/search-images",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0aHhwdGJvem9jcmJ2bWh3dmFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyOTY0MzMsImV4cCI6MjA3MDg3MjQzM30.gFt4oRFZ7Mh4y8DgeKNbcKKDwTYjEdXRoBlqTNjvdRg","Content-Type":"application/json"},body:JSON.stringify({query:xe,count:6,exclude:z})});if(!je.ok)throw new Error("Failed to search for more images");const Ne=(await je.json()).images||[];console.log("Received additional images:",Ne),console.log("Previous results count:",z.length),console.log("New results count:",Ne.length);const De=Ne.filter(tt=>!z.includes(tt));console.log("Unique new images after filtering:",De),B(De),se([...z,...De])}catch(W){console.error("Error searching for more images:",W)}finally{O(!1)}}},pe=W=>{y(null),K(`Selected image: ${W}`),te(!1),H(W)},G=async W=>{if(W.preventDefault(),!(!r.trim()||!Y)){w(!0),k("");try{let Z="";if(X)Z=X;else if(f&&f.length>0){const ue=f[0];if(D.includes("Cropped image ready")){E(!0);try{const De=await un(ue,1200,1200,.8);console.log(`Cropped image compressed: ${ut(ue.size)}  ${ut(De.size)}`);const tt=De.name.split(".").pop(),Jt=`${Y.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${tt}`,{data:Qt,error:We}=await F.storage.from("model-images").upload(Jt,De);if(We)throw console.error("Compressed cropped image upload error:",We),new Error(`Failed to upload image: ${We.message}`);{const{data:xt}=F.storage.from("model-images").getPublicUrl(Qt.path);Z=xt.publicUrl,console.log("Uploaded compressed cropped image URL:",Z)}}catch(De){console.error("Cropped image compression error:",De);const tt=ue.name.split(".").pop(),Jt=`${Y.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${tt}`,{data:Qt,error:We}=await F.storage.from("model-images").upload(Jt,ue);if(We)throw console.error("Fallback cropped image upload error:",We),new Error(`Failed to upload image: ${We.message}`);{const{data:xt}=F.storage.from("model-images").getPublicUrl(Qt.path);Z=xt.publicUrl,console.log("Uploaded uncompressed cropped image URL:",Z)}}finally{E(!1)}}else{E(!0);try{const De=await un(ue,1200,1200,.8);console.log(`Image compressed: ${ut(ue.size)}  ${ut(De.size)}`);const tt=De.name.split(".").pop(),Jt=`${Y.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${tt}`,{data:Qt,error:We}=await F.storage.from("model-images").upload(Jt,De);if(We)throw console.error("Image upload error:",We),new Error(`Failed to upload image: ${We.message}`);{const{data:xt}=F.storage.from("model-images").getPublicUrl(Qt.path);Z=xt.publicUrl,console.log("Uploaded compressed image URL:",Z)}}catch(De){console.error("Image compression error:",De);try{const tt=ue.name.split(".").pop(),Jt=`${Y.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${tt}`,{data:Qt,error:We}=await F.storage.from("model-images").upload(Jt,ue);if(We)throw console.error("Original image upload error:",We),new Error(`Failed to upload image: ${We.message}`);{const{data:xt}=F.storage.from("model-images").getPublicUrl(Qt.path);Z=xt.publicUrl,console.log("Uploaded original image URL:",Z)}}catch(tt){throw console.error("Fallback upload failed:",tt),new Error("Failed to upload image after compression fallback")}}finally{E(!1)}}}const{data:xe,error:je}=await F.from("boxes").insert({name:r.trim(),game_id:i||null,purchase_date:l||null,user_id:Y.id,image_url:Z}).select().single();if(je)throw je;return fe=xe.id,a(""),o(""),c(""),d(""),m(""),y(null),K(""),H(""),te(!1),B([]),n(),xe}catch(Z){throw k(Z instanceof Error?Z.message:"Failed to add box"),Z}finally{w(!1),E(!1)}}},ee=async W=>{try{await G(W),e()}catch{}},ge=async W=>{await G(W),e()},Ce=r.trim().length>0&&!P&&!_;if(!t)return null;const ve=W=>{W.target===W.currentTarget&&e()};return s.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:ve,children:[s.jsxs("div",{className:`bg-modal-bg rounded-lg max-w-lg w-full p-6 overflow-y-auto transition-all duration-300 ease-out transform
        fixed inset-0 sm:relative sm:inset-auto sm:max-w-lg sm:h-auto sm:rounded-lg sm:max-h-[90vh] h-screen w-screen sm:w-full overflow-y-auto rounded-none sm:rounded-lg p-6 sm:p-6
        ${t?"translate-y-0 opacity-100":"translate-y-full opacity-0"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-lg font-bold text-secondary-text uppercase tracking-wide text-center flex-1",children:"Add New Collection"}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6 text-icon"})})]}),s.jsx("p",{className:"text-base text-secondary-text text-center mb-8",children:"Don't worry- you can update any of these details later."}),s.jsxs("form",{onSubmit:G,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{htmlFor:"boxName",className:"block text-sm font-medium text-input-label font-overpass",children:"Collection Name"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Required"})]}),s.jsx("input",{type:"text",id:"boxName",value:r,onChange:W=>a(W.target.value),placeholder:'eg. "Kill Team Collection", "Space Marine Heroes", "Warhammer 40k Elite Edition", etc.',className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] placeholder-secondary-text bg-bg-primary text-text"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"game",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game"}),s.jsx(ea,{games:p,selectedGame:i,onGameSelect:o,placeholder:"Choose a Game"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"purchaseDate",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Purchase Date"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"date",id:"purchaseDate",value:l,onChange:W=>c(W.target.value),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] text-text bg-bg-primary"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"purchasePrice",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Purchase Price"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ef,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"number",id:"purchasePrice",value:u,onChange:A,placeholder:"Enter Purchase Price",step:"0.01",min:"0",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] placeholder-secondary-text bg-bg-primary text-text"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"boxImage",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Collection Image"}),s.jsxs("div",{className:"relative",children:[s.jsx(rr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"file",id:"boxImage",accept:"image/*",onChange:ne,className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-[var(--color-brand)]/10 file:text-[var(--color-brand)] hover:file:bg-[var(--color-brand)]/20 bg-bg-primary text-text"})]}),s.jsx("p",{className:"text-xs text-secondary-text mt-1",children:"You can upload more images later."}),r.trim()&&!f&&!X&&s.jsx("div",{className:"mt-3",children:s.jsx(fo,{variant:"secondary",width:"full",size:"small",onClick:I,disabled:L,children:L?"Searching for images...":"Find images for this collection"})})]}),D&&s.jsx("div",{className:"text-blue-600 text-sm bg-blue-50 p-3 rounded-lg",children:D}),P&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:P}),C&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:C}),s.jsxs("div",{className:"flex flex-col space-y-3 pt-4",children:[s.jsx(fo,{className:"btn-primary",variant:Ce&&!N?"primary":"disabled",width:"full",onClick:ee,disabled:!Ce||N,children:_?"Compressing Image...":N?"Adding...":"Add Empty Collection"}),s.jsx(fo,{variant:Ce&&!N?"primary":"disabled",width:"full",onClick:ge,disabled:!Ce||N,children:_?"Compressing Image...":N?"Adding...":"Add Models to Collection"})]})]})]}),x&&s.jsx(sr,{isOpen:b,onClose:q,onCrop:ae,imageFile:x}),re&&s.jsx(am,{isOpen:re,onClose:()=>te(!1),images:M,onImageSelect:pe,searchQuery:`${r} ${((be=p.find(W=>W.id===i))==null?void 0:be.name)||""}`.trim(),onFindMoreImages:J,isLoadingMore:$})]})}function N0({onBack:t}){const[e,n]=v.useState([]),[r,a]=v.useState(!0),[i,o]=v.useState(null);v.useEffect(()=>{l()},[]);const l=async()=>{try{const{data:u,error:d}=await F.from("users").select("*").order("created_at",{ascending:!1});if(d)throw d;n(u||[])}catch(u){o(u instanceof Error?u.message:"Failed to fetch users")}finally{a(!1)}},c=u=>new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return r?s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text",children:"Loading users..."})]})}):s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(or,{className:"w-5 h-5"}),s.jsx("span",{children:"Back to Admin"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title",children:"MANAGE USERS"})]}),i&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:i})}),s.jsx("div",{className:"space-y-4",children:e.map(u=>s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6 flex items-center justify-between gap-6",children:[s.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[s.jsx(Mn,{className:"w-6 h-6 text-secondary-text"}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-text truncate",children:u.email||"No email"}),s.jsxs("p",{className:"text-sm text-secondary-text",children:["Joined ",c(u.created_at)]})]})]}),s.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex-shrink-0 ${u.is_admin?"bg-amber-100 text-amber-800":"bg-gray-100 text-gray-800"}`,children:u.is_admin?"Admin":"User"})]},u.id))}),e.length===0&&!r&&s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-base text-secondary-text",children:"No users found."})})]})}function _0({isOpen:t,onClose:e,onGameUpdated:n,game:r}){const[a,i]=v.useState({name:"",manufacturer_id:"",image:"",icon:""}),[o,l]=v.useState([]),[c,u]=v.useState(null),[d,h]=v.useState(null),[m,f]=v.useState(!1),[y,b]=v.useState(!1),[S,x]=v.useState(null),[g,p]=v.useState(null),[j,N]=v.useState(null),[w,_]=v.useState(null),[E,C]=v.useState(!1),[k,P]=v.useState(!1),[U,D]=v.useState("");v.useEffect(()=>{r&&i({name:r.name,manufacturer_id:r.manufacturer_id||"",image:r.image||"",icon:r.icon||""})},[r]),v.useEffect(()=>{t&&K()},[t]);const K=async()=>{try{const{data:H,error:z}=await F.from("manufacturers").select("id, name").order("name");if(z)throw z;l(H||[])}catch(H){console.error("Error fetching manufacturers:",H)}},Y=H=>{var se;const z=(se=H.target.files)==null?void 0:se[0];if(z){if(!Wr(z)){alert("Please select a valid image file");return}u(z),x(z),f(!0)}},re=H=>{var se;const z=(se=H.target.files)==null?void 0:se[0];if(z){if(!Wr(z)){alert("Please select a valid image file");return}h(z),p(z),b(!0)}},te=H=>{N(H),f(!1),x(null)},L=H=>{_(H),b(!1),p(null)},V=async(H,z,se)=>{const $=(c==null?void 0:c.name.split(".").pop())||"jpg",O=`${se}/${Date.now()}-${Math.random().toString(36).substring(2)}.${$}`,{data:fe,error:ie}=await F.storage.from(z).upload(O,H);if(ie)throw ie;const{data:ne}=F.storage.from(z).getPublicUrl(fe.path);return ne.publicUrl},M=async H=>{if(H.preventDefault(),!!r){C(!0),D("");try{let z=a.image,se=a.icon;if(j){P(!0);const O=await un(j,1200,1200,.8);z=await V(O,"game-assets","images")}if(w){P(!0);const O=await un(w,512,512,.9);se=await V(O,"game-assets","icons")}const{error:$}=await F.from("games").update({name:a.name,manufacturer_id:a.manufacturer_id||null,image:z,icon:se}).eq("id",r.id);if($)throw $;n()}catch(z){D(z instanceof Error?z.message:"Failed to update game")}finally{C(!1),P(!1)}}},B=()=>{r&&i({name:r.name,manufacturer_id:r.manufacturer_id||"",image:r.image||"",icon:r.icon||""}),u(null),h(null),N(null),_(null),D("")};if(!t||!r)return null;const X=H=>{H.target===H.currentTarget&&e()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:X,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-lg font-bold text-title",children:"Edit Game"}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6"})})]}),s.jsxs("form",{onSubmit:M,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"gameName",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game Name"}),s.jsxs("div",{className:"relative",children:[s.jsx(fc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsx("input",{type:"text",id:"gameName",value:a.name,onChange:H=>i({...a,name:H.target.value}),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"manufacturer",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Manufacturer"}),s.jsxs("div",{className:"relative",children:[s.jsx(Lg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsxs("select",{id:"manufacturer",value:a.manufacturer_id,onChange:H=>i({...a,manufacturer_id:H.target.value}),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",children:[s.jsx("option",{value:"",children:"Select Manufacturer"}),o.map(H=>s.jsx("option",{value:H.id,children:H.name},H.id))]})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"gameImage",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game Image"}),s.jsxs("div",{className:"relative",children:[s.jsx(rr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsx("input",{type:"file",id:"gameImage",accept:"image/*",onChange:Y,className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-amber-50 file:text-amber-700 hover:file:bg-amber-100 bg-bg-primary text-text"})]}),j&&s.jsx("p",{className:"text-sm text-green-600 mt-1",children:" New image ready for upload"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"gameIcon",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game Icon"}),s.jsxs("div",{className:"relative",children:[s.jsx(rr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsx("input",{type:"file",id:"gameIcon",accept:"image/*",onChange:re,className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-amber-50 file:text-amber-700 hover:file:bg-amber-100 bg-bg-primary text-text"})]}),w&&s.jsx("p",{className:"text-sm text-green-600 mt-1",children:" New icon ready for upload"})]}),U&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:U}),s.jsxs("div",{className:"flex space-x-3 pt-4",children:[s.jsx("button",{type:"button",onClick:B,className:"btn-ghost btn-flex",children:"Discard Changes"}),s.jsx("button",{type:"submit",disabled:E||k,className:"btn-primary btn-flex",children:k?"Processing...":E?"Saving...":"Save Changes"})]})]})]})}),S&&s.jsx(sr,{isOpen:m,onClose:()=>{f(!1),x(null),u(null)},onCrop:te,imageFile:S}),g&&s.jsx(sr,{isOpen:y,onClose:()=>{b(!1),p(null),h(null)},onCrop:L,imageFile:g})]})}function S0({onBack:t}){const[e,n]=v.useState([]),[r,a]=v.useState(!0),[i,o]=v.useState(null),[l,c]=v.useState({isOpen:!1,game:null});v.useEffect(()=>{u()},[]);const u=async()=>{try{const{data:m,error:f}=await F.from("games").select(`
          *,
          manufacturer:manufacturers(name)
        `).order("name");if(f)throw f;n(m||[])}catch(m){o(m instanceof Error?m.message:"Failed to fetch games")}finally{a(!1)}},d=m=>{c({isOpen:!0,game:m})},h=()=>{u(),c({isOpen:!1,game:null})};return r?s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text",children:"Loading games..."})]})}):s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(or,{className:"w-5 h-5"}),s.jsx("span",{children:"Back to Admin"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title",children:"MANAGE GAMES"})]}),i&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:i})}),s.jsx("div",{className:"space-y-4",children:e.map(m=>{var f;return s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6 flex items-center justify-between gap-6",children:[s.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[m.icon?s.jsx("img",{src:m.icon,alt:`${m.name} icon`,className:"w-12 h-12 object-contain rounded",onError:y=>{const b=y.target;b.style.display="none";const S=b.nextElementSibling;S&&S.classList.contains("icon-fallback")&&(S.style.display="flex")}}):null,s.jsx("div",{className:"w-12 h-12 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:m.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-sm font-bold",children:m.name.charAt(0)})}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-text truncate",children:m.name}),s.jsx("p",{className:"text-sm text-secondary-text",children:((f=m.manufacturer)==null?void 0:f.name)||"No manufacturer"})]})]}),s.jsxs("button",{onClick:()=>d(m),className:"btn-secondary-sm btn-with-icon-sm",children:[s.jsx(Qs,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]})]},m.id)})}),e.length===0&&!r&&s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-base text-secondary-text",children:"No games found."})}),s.jsx(_0,{isOpen:l.isOpen,onClose:()=>c({isOpen:!1,game:null}),onGameUpdated:h,game:l.game})]})}function C0({isOpen:t,onClose:e,location:n}){const[r,a]=v.useState([]),[i,o]=v.useState(!0),[l,c]=v.useState(null),[u,d]=v.useState(!1),[h,m]=v.useState(null),[f,y]=v.useState({name:"",start_time:"",end_time:"",availability:[]}),[b,S]=v.useState(!1),x=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];v.useEffect(()=>{t&&g()},[t,n.id]);const g=async()=>{try{o(!0);const{data:k,error:P}=await F.from("timeslots").select("*").eq("location_id",n.id).order("start_time");if(P)throw P;a(k||[])}catch(k){c(k instanceof Error?k.message:"Failed to fetch timeslots")}finally{o(!1)}},p=()=>{y({name:"",start_time:"",end_time:"",availability:[]}),m(null),d(!1)},j=k=>{y({name:k.name,start_time:k.start_time,end_time:k.end_time,availability:k.availability||[]}),m(k),d(!0)},N=async k=>{if(confirm("Are you sure you want to delete this timeslot?"))try{const{error:P}=await F.from("timeslots").delete().eq("id",k);if(P)throw P;await g()}catch(P){console.error("Error deleting timeslot:",P),alert("Failed to delete timeslot")}},w=k=>{y(P=>({...P,availability:P.availability.includes(k)?P.availability.filter(U=>U!==k):[...P.availability,k]}))},_=async k=>{if(k.preventDefault(),!(!f.name.trim()||!f.start_time||!f.end_time)){S(!0),c(null);try{if(h){const{error:P}=await F.from("timeslots").update({name:f.name.trim(),start_time:f.start_time,end_time:f.end_time,availability:f.availability}).eq("id",h.id);if(P)throw P}else{const{error:P}=await F.from("timeslots").insert({name:f.name.trim(),start_time:f.start_time,end_time:f.end_time,location_id:n.id,availability:f.availability});if(P)throw P}await g(),p()}catch(P){c(P instanceof Error?P.message:"Failed to save timeslot")}finally{S(!1)}}},E=k=>new Date(`2000-01-01T${k}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});if(!t)return null;const C=k=>{k.target===k.currentTarget&&e()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",onClick:C,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-4xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-lg font-bold text-title",children:["Manage Timeslots - ",n.name]}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6"})})]}),l&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:l})}),!u&&s.jsx("div",{className:"mb-6",children:s.jsxs("button",{onClick:()=>d(!0),className:"flex items-center space-x-2 bg-brand hover:bg-amber-600 text-white px-4 py-2 rounded-lg transition-colors font-medium",children:[s.jsx(kn,{className:"w-4 h-4"}),s.jsx("span",{children:"Add Timeslot"})]})}),u&&s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-title mb-4",children:h?"Edit Timeslot":"Add New Timeslot"}),s.jsxs("form",{onSubmit:_,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Timeslot Name"}),s.jsx("input",{type:"text",value:f.name,onChange:k=>y({...f,name:k.target.value}),placeholder:"e.g., Morning Session, Evening Games",className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Start Time"}),s.jsx("input",{type:"time",value:f.start_time,onChange:k=>y({...f,start_time:k.target.value}),className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"End Time"}),s.jsx("input",{type:"time",value:f.end_time,onChange:k=>y({...f,end_time:k.target.value}),className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Available Days"}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:x.map(k=>s.jsx("button",{type:"button",onClick:()=>w(k),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${f.availability.includes(k)?"bg-brand text-white":"bg-bg-primary border border-border-custom text-text hover:bg-bg-secondary"}`,children:k.slice(0,3)},k))})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{type:"button",onClick:p,className:"flex-1 px-4 py-2 border border-border-custom text-text rounded-lg hover:bg-bg-secondary transition-colors font-medium",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:b,className:"flex-1 px-4 py-2 bg-brand hover:bg-amber-600 disabled:bg-amber-300 text-white rounded-lg transition-colors font-medium",children:b?"Saving...":h?"Update Timeslot":"Add Timeslot"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-title",children:"Current Timeslots"}),i?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"Loading timeslots..."})]}):r.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Kr,{className:"w-12 h-12 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"No timeslots configured for this location."})]}):r.map(k=>{var P;return s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-text",children:k.name}),s.jsxs("p",{className:"text-sm text-secondary-text",children:[E(k.start_time)," - ",E(k.end_time)]}),s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:(P=k.availability)==null?void 0:P.map(U=>s.jsx("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 text-xs rounded-full",children:U.slice(0,3)},U))})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>j(k),className:"p-2 text-secondary-text hover:text-text transition-colors",children:s.jsx(Qs,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>N(k.id),className:"p-2 text-icon hover:text-icon-hover transition-colors",children:s.jsx(Jr,{className:"w-4 h-4"})})]})]},k.id)})]})]})})}function E0({isOpen:t,onClose:e,location:n,onAdminsUpdated:r}){const[a,i]=v.useState([]),[o,l]=v.useState([]),[c,u]=v.useState(""),[d,h]=v.useState(!0),[m,f]=v.useState(!1),[y,b]=v.useState("");v.useEffect(()=>{t&&n&&(S(),x())},[t,n]);const S=async()=>{try{const{data:w,error:_}=await F.from("users").select("id, email").order("email");if(_)throw _;i(w||[])}catch(w){console.error("Error fetching users:",w),b("Failed to fetch users")}finally{h(!1)}},x=async()=>{if(!(n!=null&&n.admins)){l([]);return}try{const{data:w,error:_}=await F.from("users").select("id, email").in("id",n.admins).order("email");if(_)throw _;l(w||[])}catch(w){console.error("Error fetching admin users:",w)}},g=async()=>{if(!(!c.trim()||!n)){f(!0),b("");try{const w=a.find(C=>C.email.toLowerCase()===c.toLowerCase().trim());if(!w){b("User not found"),f(!1);return}if(n.admins.includes(w.id)){b("User is already an admin"),f(!1);return}const _=[...n.admins,w.id],{error:E}=await F.from("locations").update({admins:_}).eq("id",n.id);if(E)throw E;l([...o,w]),r(_),u("")}catch(w){b(w instanceof Error?w.message:"Failed to add admin")}finally{f(!1)}}},p=async w=>{if(n)try{const _=n.admins.filter(C=>C!==w),{error:E}=await F.from("locations").update({admins:_}).eq("id",n.id);if(E)throw E;l(o.filter(C=>C.id!==w)),r(_)}catch(_){b(_ instanceof Error?_.message:"Failed to remove admin")}},j=w=>{w.key==="Enter"&&(w.preventDefault(),g())};if(!t||!n)return null;const N=w=>{w.target===w.currentTarget&&e()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",onClick:N,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-lg font-bold text-title",children:["Edit Location Admins - ",n.name]}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6"})})]}),y&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:y})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-md font-semibold text-title mb-3",children:"Add New Admin"}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(mc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-4 h-4"}),s.jsx("input",{type:"email",value:c,onChange:w=>u(w.target.value),onKeyPress:j,placeholder:"Enter user email address...",className:"w-full pl-10 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text"})]}),s.jsxs("button",{onClick:g,disabled:!c.trim()||m,className:"btn-primary-sm btn-with-icon-sm",children:[s.jsx(kn,{className:"w-4 h-4"}),s.jsx("span",{children:m?"Adding...":"Add"})]})]}),s.jsx("p",{className:"text-xs text-secondary-text mt-2",children:"Enter the exact email address of the user you want to add as an admin."})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-semibold text-title mb-3",children:"Current Admins"}),d?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"Loading admins..."})]}):o.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Bs,{className:"w-12 h-12 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"No admins assigned to this location."})]}):s.jsx("div",{className:"space-y-3",children:o.map(w=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-secondary rounded-lg border border-border-custom",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Bs,{className:"w-5 h-5 text-secondary-text"}),s.jsx("span",{className:"text-text font-medium",children:w.email})]}),s.jsx("button",{onClick:()=>p(w.id),className:"p-2 text-icon hover:text-icon-hover hover:bg-red-50 rounded-lg transition-colors",title:"Remove admin",children:s.jsx(Jr,{className:"w-4 h-4"})})]},w.id))})]}),s.jsx("div",{className:"mt-6 pt-4 border-t border-border-custom",children:s.jsx("button",{onClick:e,className:"btn-primary btn-full",children:"Done"})})]})})}function P0({isOpen:t,onClose:e,onLocationUpdated:n,location:r}){const[a,i]=v.useState({name:"",address:"",icon:"",tables:1,admins:[]}),[o,l]=v.useState(null),[c,u]=v.useState(!1),[d,h]=v.useState(null),[m,f]=v.useState(null),[y,b]=v.useState(!1),[S,x]=v.useState(!1),[g,p]=v.useState(""),[j,N]=v.useState(!1),[w,_]=v.useState(!1);v.useEffect(()=>{r&&i({name:r.name,address:r.address,icon:r.icon||"",tables:r.tables||1,admins:r.admins||[]})},[r]);const E=Y=>{var te;const re=(te=Y.target.files)==null?void 0:te[0];if(re){if(!Wr(re)){alert("Please select a valid image file");return}l(re),h(re),u(!0)}},C=Y=>{f(Y),u(!1),h(null)},k=async(Y,re,te)=>{const L=(o==null?void 0:o.name.split(".").pop())||"jpg",V=`${te}/${Date.now()}-${Math.random().toString(36).substring(2)}.${L}`,{data:M,error:B}=await F.storage.from(re).upload(V,Y);if(B)throw B;const{data:X}=F.storage.from(re).getPublicUrl(M.path);return X.publicUrl},P=async Y=>{if(Y.preventDefault(),!!r){b(!0),p("");try{let re=a.icon;if(m){x(!0);const L=await un(m,512,512,.9);re=await k(L,"location-assets","icons")}const{error:te}=await F.from("locations").update({name:a.name,address:a.address,icon:re,tables:a.tables,admins:a.admins}).eq("id",r.id);if(te)throw te;n()}catch(re){p(re instanceof Error?re.message:"Failed to update location")}finally{b(!1),x(!1)}}},U=()=>{r&&i({name:r.name,address:r.address,icon:r.icon||"",tables:r.tables||1,admins:r.admins||[]}),l(null),f(null),p("")},D=Y=>{i(re=>({...re,admins:Y}))};if(!t||!r)return null;const K=Y=>{Y.target===Y.currentTarget&&e()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:K,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-lg font-bold text-title",children:"Edit Location"}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6"})})]}),s.jsxs("form",{onSubmit:P,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"locationName",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Location Name"}),s.jsxs("div",{className:"relative",children:[s.jsx(Js,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsx("input",{type:"text",id:"locationName",value:a.name,onChange:Y=>i({...a,name:Y.target.value}),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Address"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ug,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsx("input",{type:"text",id:"address",value:a.address,onChange:Y=>i({...a,address:Y.target.value}),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"tables",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Number of Tables"}),s.jsxs("div",{className:"relative",children:[s.jsx(_i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsx("input",{type:"number",id:"tables",min:"1",value:a.tables,onChange:Y=>i({...a,tables:parseInt(Y.target.value)||1}),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"locationIcon",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Location Icon"}),s.jsxs("div",{className:"relative",children:[s.jsx(rr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsx("input",{type:"file",id:"locationIcon",accept:"image/*",onChange:E,className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-amber-50 file:text-amber-700 hover:file:bg-amber-100 bg-bg-primary text-text"})]}),m&&s.jsx("p",{className:"text-sm text-green-600 mt-1",children:" New icon ready for upload"})]}),g&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:g}),s.jsxs("div",{className:"space-y-3 pt-4",children:[s.jsxs("button",{type:"button",onClick:()=>N(!0),className:"btn-secondary btn-with-icon",children:[s.jsx(Kr,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit Timeslots"})]}),s.jsxs("button",{type:"button",onClick:()=>_(!0),className:"btn-secondary btn-with-icon",children:[s.jsx(Bs,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit Admins"})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{type:"button",onClick:U,className:"btn-ghost btn-flex",children:"Discard Changes"}),s.jsx("button",{type:"submit",disabled:y||S,className:"btn-primary btn-flex",children:S?"Processing...":y?"Saving...":"Save Changes"})]})]})]})]})}),d&&s.jsx(sr,{isOpen:c,onClose:()=>{u(!1),h(null),l(null)},onCrop:C,imageFile:d}),s.jsx(C0,{isOpen:j,onClose:()=>N(!1),location:r}),s.jsx(E0,{isOpen:w,onClose:()=>_(!1),location:r,onAdminsUpdated:D})]})}function T0({onBack:t,isLocationAdmin:e=!1}){const[n,r]=v.useState([]),[a,i]=v.useState(!0),[o,l]=v.useState(null),{user:c}=et(),[u,d]=v.useState({isOpen:!1,location:null});v.useEffect(()=>{h()},[]);const h=async()=>{try{let y=F.from("locations").select("*").order("name");e&&!(c!=null&&c.is_admin)&&(c!=null&&c.id)&&(y=y.contains("admins",[c.id]));const{data:b,error:S}=await y;if(S)throw S;r(b||[])}catch(y){l(y instanceof Error?y.message:"Failed to fetch locations")}finally{i(!1)}},m=y=>{d({isOpen:!0,location:y})},f=()=>{h(),d({isOpen:!1,location:null})};return a?s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text",children:"Loading locations..."})]})}):s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(or,{className:"w-5 h-5"}),s.jsx("span",{children:"Back to Admin"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title",children:"MANAGE LOCATIONS"})]}),o&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:o})}),s.jsx("div",{className:"space-y-4",children:n.map(y=>s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6 flex items-center justify-between gap-6",children:[s.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[y.icon?s.jsx("img",{src:y.icon,alt:`${y.name} icon`,className:"w-12 h-12 object-contain rounded",onError:b=>{const S=b.target;S.style.display="none";const x=S.nextElementSibling;x&&x.classList.contains("icon-fallback")&&(x.style.display="flex")}}):null,s.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center icon-fallback",style:{display:y.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-sm font-bold",children:y.name.charAt(0)})}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-text truncate",children:y.name}),s.jsx("p",{className:"text-sm text-secondary-text truncate",children:y.address}),s.jsxs("p",{className:"text-xs text-secondary-text",children:[y.tables," table",y.tables!==1?"s":""]})]})]}),s.jsxs("button",{onClick:()=>m(y),className:"btn-secondary-sm btn-with-icon-sm",children:[s.jsx(Qs,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]})]},y.id))}),n.length===0&&!a&&s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-base text-secondary-text",children:"No locations found."})}),s.jsx(P0,{isOpen:u.isOpen,onClose:()=>d({isOpen:!1,location:null}),onLocationUpdated:f,location:u.location})]})}function I0({onBack:t}){const[e,n]=v.useState("main"),{user:r}=et();return e==="users"?s.jsx(N0,{onBack:()=>n("main")}):e==="games"?s.jsx(S0,{onBack:()=>n("main")}):e==="locations"?s.jsx(T0,{onBack:()=>n("main"),isLocationAdmin:(r==null?void 0:r.is_location_admin)||!1}):s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(or,{className:"w-5 h-5"}),s.jsx("span",{children:"Back to Collection"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title",children:"ADMIN PANEL"})]}),s.jsxs("div",{className:"space-y-4 max-w-md",children:[(r==null?void 0:r.is_admin)&&s.jsxs("button",{onClick:()=>n("users"),className:"w-full bg-bg-card border border-border-custom rounded-lg p-6 hover:bg-bg-secondary transition-colors flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(Bs,{className:"w-6 h-6 text-secondary-text"}),s.jsx("span",{className:"text-lg font-semibold text-text",children:"Manage Users"})]}),s.jsx(Yn,{className:"w-5 h-5 text-secondary-text"})]}),(r==null?void 0:r.is_admin)&&s.jsxs("button",{onClick:()=>n("games"),className:"w-full bg-bg-card border border-border-custom rounded-lg p-6 hover:bg-bg-secondary transition-colors flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(fc,{className:"w-6 h-6 text-secondary-text"}),s.jsx("span",{className:"text-lg font-semibold text-text",children:"Manage Games"})]}),s.jsx(Yn,{className:"w-5 h-5 text-secondary-text"})]}),s.jsxs("button",{onClick:()=>n("locations"),className:"w-full bg-bg-card border border-border-custom rounded-lg p-6 hover:bg-bg-secondary transition-colors flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(Js,{className:"w-6 h-6 text-secondary-text"}),s.jsx("span",{className:"text-lg font-semibold text-text",children:"Manage Locations"})]}),s.jsx(Yn,{className:"w-5 h-5 text-secondary-text"})]})]})]})}function M0({onBack:t}){return s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(or,{className:"w-5 h-5"}),s.jsx("span",{children:"Back"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title text-center",children:"About this app"})]}),s.jsx("div",{children:s.jsx("div",{className:"bg-bg-card border border-border-custom rounded-lg p-8",children:s.jsxs("div",{className:"space-y-6 text-base text-text leading-relaxed",children:[s.jsx("p",{children:"You're using a very, very early version of the Mini Myths app. Our hope is that one day you'll be able to use this app to manage your tabletop wargaming collection, and book a table at nearby gaming store."}),s.jsx("p",{children:"We're still in very early development, so make sure to let us know if you run into any issues along the way. You can flag issues in the Mini Myths Discord."})]})})})]})}function hd({date:t,bookings:e,isExpanded:n,onToggle:r,onBookingClick:a,onCancelBooking:i}){const o=l=>{const c=new Date(l),u=new Date,d=new Date(u),h=new Date(u);return d.setDate(d.getDate()-1),h.setDate(h.getDate()+1),u.setHours(0,0,0,0),d.setHours(0,0,0,0),h.setHours(0,0,0,0),c.setHours(0,0,0,0),c.getTime()===u.getTime()?"Today":c.getTime()===h.getTime()?"Tomorrow":c.getTime()===d.getTime()?"Yesterday":c.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("button",{onClick:r,className:"w-full flex items-center justify-between text-left border-b border-border-custom pb-2 hover:bg-bg-secondary transition-colors rounded-lg px-2 py-1",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("h2",{className:"text-xl font-bold text-title",children:o(t)}),s.jsxs("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 text-sm font-medium rounded-full",children:[e.length," booking",e.length!==1?"s":""]})]}),n?s.jsx(hc,{className:"w-5 h-5 text-secondary-text"}):s.jsx(Yn,{className:"w-5 h-5 text-secondary-text"})]}),n&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(l=>s.jsx(rm,{booking:l,onClick:()=>a(l),onCancelBooking:i,isPast:t==="past"},l.id))})]})}function A0({isOpen:t,onClose:e,onBookingCancelled:n,booking:r}){const[a,i]=v.useState(!1),[o,l]=v.useState(!1),c=async()=>{if(r){i(!0);try{const{error:f}=await F.from("bookings").delete().eq("id",r.id);if(f)throw f;n()}catch(f){console.error("Error cancelling booking:",f),alert("Failed to cancel booking. Please try again.")}finally{i(!1),l(!1)}}},u=f=>{const y=new Date(f),b=new Date,S=new Date(b),x=new Date(b);return S.setDate(S.getDate()-1),x.setDate(x.getDate()+1),b.setHours(0,0,0,0),S.setHours(0,0,0,0),x.setHours(0,0,0,0),y.setHours(0,0,0,0),y.getTime()===b.getTime()?"Today":y.getTime()===S.getTime()?"Yesterday":y.getTime()===x.getTime()?"Tomorrow":y.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},d=f=>new Date(`2000-01-01T${f}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),h=f=>new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0});if(!t||!r)return null;const m=f=>{f.target===f.currentTarget&&e()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:m,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-bold text-title",children:"Booking Details"}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Ze,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-text",children:u(r.date)}),s.jsx("p",{className:"text-sm text-secondary-text",children:r.date})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Kr,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-text",children:r.timeslot.name}),s.jsxs("p",{className:"text-sm text-secondary-text",children:[d(r.timeslot.start_time)," - ",d(r.timeslot.end_time)]})]})]}),s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(Js,{className:"w-5 h-5 text-secondary-text mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-text",children:r.location.name}),s.jsx("p",{className:"text-sm text-secondary-text",children:r.location.address})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Mn,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-text",children:r.user_name?r.user_name:"Booked by"}),s.jsx("p",{className:"text-sm text-secondary-text",children:r.user_email||r.user.email})]})]}),r.game&&s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[r.game.icon?s.jsx("img",{src:r.game.icon,alt:`${r.game.name} icon`,className:"w-5 h-5 object-contain rounded",onError:f=>{const y=f.target;y.style.display="none";const b=y.nextElementSibling;b&&b.classList.contains("icon-fallback")&&(b.style.display="flex")}}):null,s.jsx("div",{className:"w-5 h-5 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:r.game.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-xs font-bold",children:r.game.name.charAt(0)})})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-text",children:"Game"}),s.jsx("p",{className:"text-sm text-secondary-text",children:r.game.name})]})]}),s.jsx("div",{className:"border-t border-border-custom pt-4",children:s.jsxs("p",{className:"text-sm text-secondary-text",children:["Booking created: ",h(r.created_at)]})})]}),s.jsx("div",{className:"mt-8 pt-6 border-t border-border-custom",children:o?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsx("p",{className:"text-red-800 font-medium mb-2",children:"Are you sure?"}),s.jsx("p",{className:"text-red-700 text-sm",children:"This will permanently delete this booking and make the table available for others to book."})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>l(!1),disabled:a,className:"btn-ghost btn-flex",children:"Keep Booking"}),s.jsx("button",{onClick:c,disabled:a,className:"btn-danger btn-flex",children:a?"Cancelling...":"Yes, Cancel Booking"})]})]}):s.jsxs("button",{onClick:()=>l(!0),className:"btn-danger-outline btn-with-icon",children:[s.jsx(Jr,{className:"w-4 h-4"}),s.jsx("span",{children:"Cancel This Booking"})]})})]})})}function O0(){const[t,e]=v.useState([]),[n,r]=v.useState(!0),[a,i]=v.useState(null),{user:o}=et(),l=async()=>{try{r(!0);let c=F.from("bookings").select(`
          id,
          date,
          created_at,
          user_id,
          user_name,
          user_email,
          location:locations(
            id,
            name,
            address,
            icon
          ),
          timeslot:timeslots(
            id,
            name,
            start_time,
            end_time
          ),
          game:games(
            id,
            name,
            icon
          )
        `);if(o!=null&&o.is_location_admin&&!(o!=null&&o.is_admin)&&(o!=null&&o.id)){const{data:g,error:p}=await F.from("locations").select("id").contains("admins",[o.id]);if(p)throw p;const j=(g==null?void 0:g.map(N=>N.id))||[];if(j.length===0){e([]);return}c=c.in("location_id",j)}const{data:u,error:d}=await c;if(d)throw d;const h=[...new Set((u==null?void 0:u.map(g=>g.user_id))||[])],{data:m,error:f}=await F.from("users").select("id, email").in("id",h);if(f)throw f;const y=new Map((m==null?void 0:m.map(g=>[g.id,g]))||[]),b=(u==null?void 0:u.map(g=>({...g,user:y.get(g.user_id)||{id:g.user_id,email:"Unknown User"}})))||[],S=new Date;S.setHours(0,0,0,0);const x=b.sort((g,p)=>{const j=new Date(g.date),N=new Date(p.date);j.setHours(0,0,0,0),N.setHours(0,0,0,0);const w=j<S,_=N<S;if(w&&!_)return 1;if(!w&&_)return-1;const E=N.getTime()-j.getTime();return E!==0?E:new Date(p.created_at).getTime()-new Date(g.created_at).getTime()});e(x)}catch(c){i(c instanceof Error?c.message:"Failed to fetch bookings")}finally{r(!1)}};return v.useEffect(()=>{l()},[]),{bookings:t,loading:n,error:a,refetch:l}}function $0({onBack:t}){const[e,n]=v.useState(new Set),[r,a]=v.useState(null),[i,o]=v.useState(!1),[l,c]=v.useState({isOpen:!1,bookingId:null}),[u,d]=v.useState(!1),{bookings:h,loading:m,error:f,refetch:y}=O0(),b=N=>{a(N),o(!0)},S=()=>{o(!1),a(null),y()},x=N=>{console.log("Attempting to cancel booking with ID:",N),c({isOpen:!0,bookingId:N})},g=async()=>{if(console.log("Confirming cancellation for booking ID:",l.bookingId),!!l.bookingId){d(!0);try{const{error:N}=await F.from("bookings").delete().eq("id",l.bookingId);if(N)throw N;console.log("Booking cancelled successfully"),await y(),c({isOpen:!1,bookingId:null})}catch(N){console.error("Error cancelling booking:",N),alert("Failed to cancel booking. Please try again.")}finally{d(!1)}}},p=me.useMemo(()=>{const N=new Date;N.setHours(0,0,0,0);const w=[],_=[];h.forEach(D=>{const K=new Date(D.date);K.setHours(0,0,0,0),K>=N?w.push(D):_.push(D)});const E={},C={};w.forEach(D=>{const K=D.date;E[K]||(E[K]=[]),E[K].push(D)}),_.forEach(D=>{const K=D.date;C[K]||(C[K]=[]),C[K].push(D)}),Object.keys(E).forEach(D=>{E[D].sort((K,Y)=>K.timeslot.start_time.localeCompare(Y.timeslot.start_time))}),Object.keys(C).forEach(D=>{C[D].sort((K,Y)=>K.timeslot.start_time.localeCompare(Y.timeslot.start_time))});const k=Object.keys(E).sort((D,K)=>D.localeCompare(K)),P=Object.keys(C).sort((D,K)=>K.localeCompare(D)),U=k.map(D=>({date:D,bookings:E[D],isPast:!1}));return P.forEach(D=>{U.push({date:D,bookings:C[D],isPast:!0})}),U},[h]);me.useEffect(()=>{if(p.length>0){const N=new Set(p.slice(0,3).map(w=>w.date));n(N)}},[p]);const j=N=>{n(w=>{const _=new Set(w);return _.has(N)?_.delete(N):_.add(N),_})};return m?s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text",children:"Loading all bookings..."})]})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(or,{className:"w-5 h-5"}),s.jsx("span",{children:"Back"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title",children:"ALL BOOKINGS"}),s.jsx("p",{className:"text-base text-secondary-text mt-2",children:"View and manage all table bookings across all locations"})]}),f&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:f})}),h.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ze,{className:"w-16 h-16 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text",children:"No bookings found."})]}):s.jsxs("div",{className:"space-y-8",children:[p.filter(N=>!N.isPast).length>0&&s.jsx("div",{className:"space-y-6",children:p.filter(N=>!N.isPast).map(({date:N,bookings:w,isPast:_})=>s.jsx(hd,{date:N,bookings:w,isExpanded:e.has(N),onToggle:()=>j(N),onBookingClick:b,onCancelBooking:x},N))}),p.filter(N=>N.isPast).length>0&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"border-t border-border-custom pt-8",children:s.jsx("h2",{className:"text-2xl font-bold text-title mb-6",children:"Past Bookings"})}),p.filter(N=>N.isPast).map(({date:N,bookings:w,isPast:_})=>s.jsx(hd,{date:N,bookings:w,isExpanded:e.has(N),onToggle:()=>j(N),onBookingClick:b,onCancelBooking:x},N))]})]})]}),s.jsx(A0,{isOpen:i,onClose:()=>o(!1),onBookingCancelled:S,booking:r}),s.jsx(sm,{isOpen:l.isOpen,onClose:()=>c({isOpen:!1,bookingId:null}),onConfirm:g,loading:u})]})}function L0({isOpen:t,onClose:e,onConfirm:n,modelName:r,loading:a=!1}){if(!t)return null;const i=o=>{o.target===o.currentTarget&&e()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:i,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h2",{className:"text-xl font-bold text-title",children:["Are you sure you want to delete ",r,"?"]}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text",children:s.jsx(ye,{className:"w-6 h-6"})})]}),s.jsx("p",{className:"text-base text-secondary-text mb-6",children:"This cannot be undone. If you've added images or notes, these will be deleted as well."}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:e,disabled:a,className:"btn-ghost btn-flex",children:"Cancel"}),s.jsx("button",{onClick:n,disabled:a,className:"btn-danger btn-flex",children:a?"Deleting...":"Delete Model"})]})]})})}function D0({isOpen:t,onClose:e,model:n,onModelUpdated:r}){var P;const{user:a}=et(),[i,o]=v.useState({name:"",count:1,purchase_date:"",notes:"",game_id:"",status:"",painted_date:""}),[l,c]=v.useState(null),[u,d]=v.useState(!1),[h,m]=v.useState(!1),[f,y]=v.useState(!1),[b,S]=v.useState(null),[x,g]=v.useState(null),[p,j]=v.useState([]),[N,w]=v.useState(!1);v.useEffect(()=>{n&&o({name:n.name,count:n.count,purchase_date:n.purchase_date||"",notes:n.notes||"",game_id:n.game_id||"",status:n.status||"",painted_date:n.painted_date||""})},[n]),v.useEffect(()=>{t&&(async()=>{const{data:D,error:K}=await F.from("games").select("id, name, icon").order("name");K?console.error("Error fetching games:",K):j(D||[])})()},[t]);const _=U=>{var K;const D=(K=U.target.files)==null?void 0:K[0];if(D){if(!D.type.startsWith("image/")){alert("Please select an image file");return}c(D),S(D),y(!0)}},E=async U=>{try{m(!0),console.log("Original cropped size:",(U.size/1024).toFixed(2),"KB");const D=await un(U,1200,1200,.8);console.log("Compressed size:",(D.size/1024).toFixed(2),"KB"),g(D)}catch(D){console.error("Compression failed, using original cropped image:",D),g(U)}finally{m(!1),y(!1)}},C=()=>{w(!0),g(null),c(null)},k=async U=>{if(U.preventDefault(),!!a){d(!0);try{let D=n.image_url;if(N){if(n.image_url&&n.image_url.includes("supabase"))try{const Y=n.image_url.split("/"),re=Y.findIndex(te=>te==="model-images");if(re!==-1){const te=Y.slice(re+1).join("/");await F.storage.from("model-images").remove([te])}}catch(Y){console.warn("Failed to delete old image:",Y)}D=null}else if(x){if(n.image_url&&n.image_url.includes("supabase"))try{const B=n.image_url.split("/"),X=B.findIndex(H=>H==="model-images");if(X!==-1){const H=B.slice(X+1).join("/");await F.storage.from("model-images").remove([H])}}catch(B){console.warn("Failed to delete old image:",B)}const Y=(l==null?void 0:l.name.split(".").pop())||"jpg",re=`${Date.now()}-${Math.random().toString(36).substring(2)}.${Y}`,te=`${a.id}/${re}`,{data:L,error:V}=await F.storage.from("model-images").upload(te,x);if(V)throw console.error("Upload error:",V),new Error(`Failed to upload image: ${V.message}`);const{data:M}=F.storage.from("model-images").getPublicUrl(L.path);D=M.publicUrl,console.log("New image uploaded:",D)}const{error:K}=await F.from("models").update({name:i.name,count:i.count,purchase_date:i.purchase_date||null,notes:i.notes||null,game_id:i.game_id||null,image_url:D,status:i.status||"None",painted_date:i.painted_date||null}).eq("id",n.id);if(K)throw K;r(),e(),c(null),g(null),S(null),w(!1)}catch(D){console.error("Error updating model:",D),alert("Failed to update model. Please try again.")}finally{d(!1)}}};return t?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Edit Model"}),s.jsx("button",{onClick:e,className:"text-icon hover:text-icon-hover",children:s.jsx(ye,{className:"w-6 h-6"})})]}),f&&b&&s.jsx(sr,{isOpen:f,imageFile:b,onCrop:E,onClose:()=>{y(!1),S(null),c(null)}}),!f&&s.jsxs("form",{onSubmit:k,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(La,{className:"w-4 h-4 mr-2"}),"Model Name"]}),s.jsx("input",{type:"text",value:i.name,onChange:U=>o({...i,name:U.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)] dark:bg-gray-700 dark:text-white",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(Rn,{className:"w-4 h-4 mr-2"}),"Box"]}),s.jsx("input",{type:"text",value:((P=n.box)==null?void 0:P.name)||"No Collection (Loose Model)",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 cursor-not-allowed"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Box assignment cannot be changed in edit mode."})]}),!n.box&&s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(fc,{className:"w-4 h-4 mr-2"}),"Game"]}),s.jsx(ea,{games:p,selectedGame:i.game_id,onGameSelect:U=>o({...i,game_id:U})})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(La,{className:"w-4 h-4 mr-2"}),"Painted Status"]}),s.jsxs("select",{value:i.status,onChange:U=>o({...i,status:U.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)] dark:bg-gray-700 dark:text-white",children:[s.jsx("option",{value:"",children:"Select Status"}),s.jsx("option",{value:"Assembled",children:"Assembled"}),s.jsx("option",{value:"Primed",children:"Primed"}),s.jsx("option",{value:"Partially Painted",children:"Partially Painted"}),s.jsx("option",{value:"Painted",children:"Painted"})]})]}),i.status==="Painted"&&s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Painted Date"]}),s.jsx("input",{type:"date",value:i.painted_date,onChange:U=>o({...i,painted_date:U.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring---color-brand dark:bg-gray-700 dark:text-white"})]}),!n.box&&s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Purchase Date"]}),s.jsx("input",{type:"date",value:i.purchase_date,onChange:U=>o({...i,purchase_date:U.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)] dark:bg-gray-700 dark:text-white"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(_i,{className:"w-4 h-4 mr-2"}),"Number of Models"]}),s.jsx("input",{type:"number",min:"1",value:i.count,onChange:U=>o({...i,count:parseInt(U.target.value)||1}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)] dark:bg-gray-700 dark:text-white",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(rr,{className:"w-4 h-4 mr-2"}),"Replace Image"]}),n.image_url&&!N&&s.jsx("div",{className:"mb-3 p-3 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-800",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("img",{src:n.image_url,alt:"Current model image",className:"w-12 h-12 object-cover rounded",onError:U=>{const D=U.target;D.style.display="none"}}),s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Current image"})]}),s.jsx("button",{type:"button",onClick:C,className:"text-icon hover:text-icon-hover transition-colors p-1",title:"Delete current image",children:s.jsx(Jr,{className:"w-4 h-4"})})]})}),N&&s.jsx("div",{className:"mb-3 p-3 border border-red-300 rounded-md bg-red-50 dark:bg-red-900/20",children:s.jsx("p",{className:"text-sm text-red-700 dark:text-red-400",children:" Image will be deleted when you save changes"})}),s.jsx("input",{type:"file",accept:"image/*",onChange:_,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)] dark:bg-gray-700 dark:text-white file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-[var(--color-brand)]/10 file:text-[var(--color-brand)] hover:file:bg-[var(--color-brand)]/20"}),x&&s.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:[" Cropped image ready for upload (",(x.size/1024).toFixed(1)," KB)"]}),h&&s.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400 mt-1",children:"Compressing image..."})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(La,{className:"w-4 h-4 mr-2"}),"Notes"]}),s.jsx("textarea",{value:i.notes,onChange:U=>o({...i,notes:U.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)] dark:bg-gray-700 dark:text-white resize-none",placeholder:"Optional notes about this model..."})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:e,className:"btn-ghost btn-flex",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:u||h,className:"btn-primary btn-flex",children:u?s.jsxs(s.Fragment,{children:[s.jsx(Kg,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating..."]}):"Update Model"})]})]})]})}):null}function R0({message:t,isVisible:e,onClose:n,duration:r=3e3}){return v.useEffect(()=>{if(e){const a=setTimeout(()=>{n()},r);return()=>clearTimeout(a)}},[e,r,n]),e?s.jsx("div",{className:"fixed top-4 right-4 z-[60] animate-in slide-in-from-top-2 duration-300",children:s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg shadow-lg p-4 flex items-center space-x-3 max-w-sm",children:[s.jsx(Dg,{className:"w-5 h-5 text-icon-active flex-shrink-0"}),s.jsx("p",{className:"text-sm font-medium text-green-800 flex-1",children:t}),s.jsx("button",{onClick:n,className:"text-green-600 hover:text-green-800 transition-colors",children:s.jsx(ye,{className:"w-4 h-4 text-icon"})})]})}):null}function F0({isOpen:t,onClose:e,onModelDeleted:n,onModelUpdated:r,onViewBox:a,model:i}){var P,U,D,K,Y,re,te,L,V,M,B,X,H,z,se,$,O,fe,ie;const[o,l]=me.useState(!1),[c,u]=me.useState(!1),[d,h]=me.useState(!1),[m,f]=me.useState(!1),[y,b]=me.useState(!1),[S,x]=me.useState(i);if(me.useEffect(()=>{x(i)},[i]),me.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),!t||!i)return null;const g=ne=>{ne.target===ne.currentTarget&&e()},p=ne=>new Date(ne).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}),j=(ne,ae)=>`${ae} Model${ae>1?"s":""}`,N=()=>(i==null?void 0:i.painted_date)||null,w=()=>(i==null?void 0:i.notes)||null,_=()=>{l(!0)},E=async()=>{if(i){h(!0);try{if(i.image_url&&typeof i.image_url=="string"&&i.image_url.includes("supabase")){const ae=i.image_url.split("/"),q=ae.findIndex(A=>A==="model-images");if(q!==-1){const A=ae.slice(q+1).join("/");await F.storage.from("model-images").remove([A])}}const{error:ne}=await F.from("models").delete().eq("id",i.id);if(ne)throw ne;l(!1),e(),n&&n()}catch(ne){console.error("Error deleting model:",ne)}finally{h(!1)}}},C=async()=>{if(i){f(!0);try{const ne=`${window.location.origin}/shared/model/${i.id}`;await navigator.clipboard.writeText(ne),b(!0)}catch(ne){console.error("Error sharing model:",ne);const ae=document.createElement("textarea");ae.value=`${window.location.origin}/shared/model/${i.id}`,document.body.appendChild(ae),ae.select(),document.execCommand("copy"),document.body.removeChild(ae),b(!0)}finally{f(!1)}}},k=async()=>{u(!1),e(),r&&await r()};return!t||!S?null:s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:g,children:s.jsxs("div",{className:"bg-modal-bg max-w-2xl w-full overflow-y-auto md:rounded-lg md:max-w-2xl md:max-h-[90vh] fixed inset-0 md:relative md:inset-auto h-screen md:h-auto",children:[s.jsx("div",{className:"relative",children:s.jsx("img",{src:(()=>{var ae,q,A;if(i.image_url&&typeof i.image_url=="string"&&i.image_url.trim()!==""&&i.image_url!=="undefined"&&i.image_url!=="null"&&(i.image_url.startsWith("http")||i.image_url.startsWith("/")))return i.image_url;const ne=((q=(ae=i.box)==null?void 0:ae.game)==null?void 0:q.image)||((A=i.game)==null?void 0:A.image);return ne&&typeof ne=="string"&&ne.trim()!==""&&ne!=="undefined"&&ne!=="null"&&ne.startsWith("http")?ne:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"})(),alt:i.name,className:"w-full max-h-[60%] object-cover",loading:"lazy",onError:ne=>{const ae=ne.target,q="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg";ae.src!==q&&(console.log("Modal image failed to load:",ae.src,"Falling back to default"),ae.src=q)}})}),s.jsx("button",{onClick:e,className:"fixed top-4 right-4 md:absolute text-white hover:text-gray-300 transition-colors bg-black bg-opacity-50 rounded-full p-2 z-20",children:s.jsx(ye,{className:"w-6 h-6 text-icon"})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"text-center mb-6 relative",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-title",children:i.name}),s.jsx("button",{onClick:()=>u(!0),className:"p-1 text-secondary-text hover:text-text transition-colors rounded",children:s.jsx(Qs,{className:"w-4 h-4"})})]}),i.box?s.jsx("button",{onClick:()=>{e(),a==null||a(i.box)},className:"text-base text-secondary-text mb-3 hover:text-amber-600 transition-colors",children:i.box.name}):null,s.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[(U=(P=i.box)==null?void 0:P.game)!=null&&U.icon||(D=i.game)!=null&&D.icon?s.jsx("img",{src:((Y=(K=i.box)==null?void 0:K.game)==null?void 0:Y.icon)||((re=i.game)==null?void 0:re.icon),alt:`${((L=(te=i.box)==null?void 0:te.game)==null?void 0:L.name)||((V=i.game)==null?void 0:V.name)||"Unknown Game"} icon`,className:"object-cover rounded max-h-[32px]",onError:ne=>{const ae=ne.target;console.warn("Game icon failed to load:",ae.src,"Falling back to letter icon"),ae.style.display="none";const q=ae.nextElementSibling;q&&q.classList.contains("icon-fallback")&&(q.style.display="flex")},onLoad:ne=>{const q=ne.target.nextElementSibling;q&&q.classList.contains("icon-fallback")&&(q.style.display="none")}}):null,s.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:(B=(M=i.box)==null?void 0:M.game)!=null&&B.icon||(X=i.game)!=null&&X.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-xs font-bold",children:(((z=(H=i.box)==null?void 0:H.game)==null?void 0:z.name)||((se=i.game)==null?void 0:se.name)||"Unknown Game").charAt(0)})}),s.jsx("span",{className:"text-lg font-semibold text-secondary-text",children:((O=($=i.box)==null?void 0:$.game)==null?void 0:O.name)||((fe=i.game)==null?void 0:fe.name)||"Unknown Game"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 flex items-center space-x-3",children:[s.jsx(_i,{className:"w-5 h-5 text-secondary-text"}),s.jsx("span",{className:"text-base text-text font-medium",children:j(i.status,i.count)})]}),((ie=i.box)==null?void 0:ie.purchase_date)&&s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 flex items-center space-x-3",children:[s.jsx(Ze,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("span",{className:"text-base text-text font-medium",children:["Purchased ",p(i.box.purchase_date)]})]}),N()&&s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 flex items-center space-x-3",children:[s.jsx(Wg,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("span",{className:"text-base text-text font-medium",children:["Painted ",p(N())]})]}),w()&&s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 flex items-start space-x-3",children:[s.jsx(La,{className:"w-5 h-5 text-secondary-text mt-0.5"}),s.jsx("span",{className:"text-base text-text font-medium",children:w()})]})]}),s.jsx("div",{className:"flex justify-center pt-6",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:C,disabled:m,className:"btn-primary btn-full btn-with-icon",children:[s.jsx(pc,{className:"w-4 h-4"}),s.jsx("span",{children:m?"Copying Link...":"Share Model"})]}),s.jsx("button",{onClick:_,className:"btn-danger-outline",children:"Delete this model"})]})})]})]})}),s.jsx(L0,{isOpen:o,onClose:()=>l(!1),onConfirm:E,modelName:i.name,loading:d}),s.jsx(D0,{isOpen:c,onClose:()=>u(!1),onModelUpdated:k,model:i}),s.jsx(R0,{message:"A share link has been copied to your clipboard",isVisible:y,onClose:()=>b(!1)})]})}function U0({isOpen:t,onClose:e,onConfirm:n,boxName:r,loading:a=!1}){if(!t)return null;const i=o=>{o.target===o.currentTarget&&e()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:i,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h2",{className:"text-xl font-bold text-title",children:["Are you sure you want to delete ",r,"?"]}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text",children:s.jsx(ye,{className:"w-6 h-6"})})]}),s.jsx("p",{className:"text-base text-secondary-text mb-6",children:"This cannot be undone. If you've added images or notes, these will be deleted as well."}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:e,disabled:a,className:"btn-ghost btn-flex",children:"Cancel"}),s.jsx("button",{onClick:n,disabled:a,className:"btn-danger btn-flex",children:a?"Deleting...":"Delete Box"})]})]})})}function z0({isOpen:t,onClose:e,onModelsAdded:n,onAddNewModel:r,box:a}){var C;const[i,o]=v.useState([]),[l,c]=v.useState(new Set),[u,d]=v.useState(!0),[h,m]=v.useState(!1),[f,y]=v.useState(null),{user:b}=et();v.useEffect(()=>{t&&b&&S()},[t,b]);const S=async()=>{try{d(!0);const{data:k,error:P}=await F.from("models").select(`
          id,
          name,
          status,
          count,
          image_url,
          game_id,
          box_id,
          game:games(
            id,
            name,
            icon,
            image
          )
        `).eq("user_id",b==null?void 0:b.id).is("box_id",null).order("created_at",{ascending:!1});if(P)throw P;const U=(k||[]).sort((D,K)=>{var te,L;const Y=D.game_id===((te=a.game)==null?void 0:te.id),re=K.game_id===((L=a.game)==null?void 0:L.id);return Y&&!re?-1:!Y&&re?1:D.name.localeCompare(K.name)});o(U)}catch(k){y(k instanceof Error?k.message:"Failed to fetch models")}finally{d(!1)}},x=k=>{c(P=>{const U=new Set(P);return U.has(k)?U.delete(k):U.add(k),U})},g=async()=>{if(l.size!==0){m(!0),y(null);try{const k=Array.from(l),{error:P}=await F.from("models").update({box_id:a.id}).in("id",k);if(P)throw P;n(),e(),c(new Set)}catch(k){y(k instanceof Error?k.message:"Failed to add models to box")}finally{m(!1)}}},p=()=>{try{localStorage.setItem("mini-myths-temp-box-context",JSON.stringify({id:a.id,name:a.name,game:a.game}))}catch(k){console.error("Error storing box context:",k)}r(),e()},j=k=>{switch(k){case"Painted":return"bg-green-100 text-green-800";case"Partially Painted":return"bg-yellow-100 text-yellow-800";case"Primed":return"bg-blue-100 text-blue-800";case"Assembled":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},N=k=>{var U;if(k.image_url&&typeof k.image_url=="string"&&k.image_url.trim()!==""&&k.image_url!=="undefined"&&k.image_url!=="null"&&(k.image_url.startsWith("http")||k.image_url.startsWith("/")))return{src:k.image_url,isGameFallback:!1};const P=(U=k.game)==null?void 0:U.icon;return P&&typeof P=="string"&&P.trim()!==""&&P!=="undefined"&&P!=="null"&&P.startsWith("http")?{src:P,isGameFallback:!0}:{src:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg",isGameFallback:!1}},w=i.filter(k=>{var P;return k.game_id===((P=a.game)==null?void 0:P.id)}),_=i.filter(k=>{var P;return k.game_id!==((P=a.game)==null?void 0:P.id)});if(!t)return null;const E=k=>{k.target===k.currentTarget&&e()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",onClick:E,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-lg font-bold text-title",children:["Add Models to Collection: ",a.name]}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6"})})]}),f&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:f})}),u?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"Loading models..."})]}):i.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Rn,{className:"w-12 h-12 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text mb-4",children:"No unboxed models found in your collection."}),s.jsx("p",{className:"text-sm text-secondary-text mb-6",children:"All your models are already assigned to collections."}),s.jsx("button",{onClick:p,className:"btn-primary-sm",children:"Add new model to collection"})]}):s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-sm text-secondary-text mb-6",children:"Select models to add to this box. Models will be moved from their current unboxed state."}),s.jsxs("div",{className:"space-y-6 mb-6",children:[w.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-sm font-semibold text-title mb-3 uppercase tracking-wide",children:[((C=a.game)==null?void 0:C.name)||"Same Game"," Models"]}),s.jsx("div",{className:"space-y-2",children:w.map(k=>s.jsxs("div",{className:"flex items-center space-x-3 p-3 border border-border-custom rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx("button",{type:"button",onClick:()=>x(k.id),className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${l.has(k.id)?"bg-brand border---color-brand text-white":"border-border-custom hover:border---color-brand"}`,children:l.has(k.id)&&s.jsx(Bu,{className:"w-3 h-3"})}),(()=>{const P=N(k);return s.jsx("img",{src:P.src,alt:k.name,className:`w-12 h-12 object-cover rounded ${P.isGameFallback?"opacity-10":""}`,onError:U=>{const D=U.target;D.src="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"}})})(),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-medium text-text truncate",children:k.name}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsxs("span",{className:"text-xs text-secondary-text",children:[k.count," model",k.count!==1?"s":""]}),k.status!=="None"&&s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${j(k.status)}`,children:k.status})]})]})]},k.id))})]}),_.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-title mb-3 uppercase tracking-wide",children:"Other Models"}),s.jsx("div",{className:"space-y-2",children:_.map(k=>{var P;return s.jsxs("div",{className:"flex items-center space-x-3 p-3 border border-border-custom rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx("button",{type:"button",onClick:()=>x(k.id),className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${l.has(k.id)?"bg-brand border---color-brand text-white":"border-border-custom hover:border---color-brand"}`,children:l.has(k.id)&&s.jsx(Bu,{className:"w-3 h-3"})}),(()=>{const U=N(k);return s.jsx("img",{src:U.src,alt:k.name,className:`w-12 h-12 object-cover rounded ${U.isGameFallback?"opacity-10":""}`,onError:D=>{const K=D.target;K.src="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"}})})(),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-medium text-text truncate",children:k.name}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx("span",{className:"text-xs text-secondary-text",children:((P=k.game)==null?void 0:P.name)||"Unknown Game"}),s.jsx("span",{className:"text-xs text-secondary-text",children:""}),s.jsxs("span",{className:"text-xs text-secondary-text",children:[k.count," model",k.count!==1?"s":""]}),k.status!=="None"&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-xs text-secondary-text",children:""}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${j(k.status)}`,children:k.status})]})]})]})]},k.id)})})]})]}),s.jsxs("div",{className:"flex space-x-3 pt-4 border-t border-border-custom",children:[s.jsx("button",{onClick:e,disabled:h,className:"btn-ghost btn-flex",children:"Cancel"}),s.jsx("button",{onClick:g,disabled:l.size===0||h,className:"btn-primary btn-flex",children:h?"Adding...":`Add ${l.size} Model${l.size!==1?"s":""}`})]})]})]})})}function B0({isOpen:t,onClose:e,onBoxUpdated:n,box:r}){var ae;const[a,i]=v.useState({name:"",game_id:"",purchase_date:"",image_url:""}),[o,l]=v.useState([]),[c,u]=v.useState(null),[d,h]=v.useState(!1),[m,f]=v.useState(null),[y,b]=v.useState(null),[S,x]=v.useState(!1),[g,p]=v.useState(!1),[j,N]=v.useState(""),[w,_]=v.useState(!1),[E,C]=v.useState(!1),[k,P]=v.useState(!1),[U,D]=v.useState([]),[K,Y]=v.useState(""),[re,te]=v.useState([]),[L,V]=v.useState(!1);v.useEffect(()=>{var q;r&&i({name:r.name,game_id:r.game_id||((q=r.game)==null?void 0:q.id)||"",purchase_date:r.purchase_date||"",image_url:r.image_url||""})},[r]),v.useEffect(()=>{t&&M()},[t]),v.useEffect(()=>{t&&r&&M()},[t,r]);const M=async()=>{try{const{data:q,error:A}=await F.from("games").select("id, name, icon").order("name");if(A)throw A;l(q||[])}catch(q){console.error("Error fetching games:",q)}},B=q=>{var I;const A=(I=q.target.files)==null?void 0:I[0];if(A){if(!Wr(A)){alert("Please select a valid image file");return}u(A),f(A),h(!0)}},X=q=>{b(q),h(!1),f(null)},H=()=>{_(!0),b(null),u(null)},z=async()=>{if(a.name.trim()){P(!0),D([]),te([]);try{const q=o.find(ee=>ee.id===a.game_id),A=(q==null?void 0:q.name)||"",I=`${a.name.trim()} ${A}`.trim(),J=await fetch("https://dthxptbozocrbvmhwvao.supabase.co/functions/v1/search-images",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0aHhwdGJvem9jcmJ2bWh3dmFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyOTY0MzMsImV4cCI6MjA3MDg3MjQzM30.gFt4oRFZ7Mh4y8DgeKNbcKKDwTYjEdXRoBlqTNjvdRg","Content-Type":"application/json"},body:JSON.stringify({query:I,count:6})});if(!J.ok)throw new Error("Failed to search for images");const G=(await J.json()).images||[];D(G),te(G),C(!0)}catch(q){console.error("Error searching for images:",q),C(!1)}finally{P(!1)}}},se=q=>{Y(q),C(!1)},$=async()=>{if(a.name.trim()){V(!0);try{const q=o.find(ge=>ge.id===a.game_id),A=(q==null?void 0:q.name)||"",I=`${a.name.trim()} ${A}`.trim();console.log("Finding more images with exclude:",re);const J=await fetch("https://dthxptbozocrbvmhwvao.supabase.co/functions/v1/search-images",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0aHhwdGJvem9jcmJ2bWh3dmFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyOTY0MzMsImV4cCI6MjA3MDg3MjQzM30.gFt4oRFZ7Mh4y8DgeKNbcKKDwTYjEdXRoBlqTNjvdRg","Content-Type":"application/json"},body:JSON.stringify({query:I,count:6,exclude:re})});if(!J.ok)throw new Error("Failed to search for more images");const G=(await J.json()).images||[];console.log("Received additional images:",G),console.log("Previous results count:",re.length),console.log("New results count:",G.length);const ee=G.filter(ge=>!re.includes(ge));console.log("Unique new images after filtering:",ee),D(ee),te([...re,...ee])}catch(q){console.error("Error searching for more images:",q)}finally{V(!1)}}},O=async(q,A,I)=>{const J=(c==null?void 0:c.name.split(".").pop())||"jpg",pe=`${I}/${Date.now()}-${Math.random().toString(36).substring(2)}.${J}`,{data:G,error:ee}=await F.storage.from(A).upload(pe,q);if(ee)throw ee;const{data:ge}=F.storage.from(A).getPublicUrl(G.path);return ge.publicUrl},fe=async q=>{if(q.preventDefault(),!!r){x(!0),N("");try{let A=a.image_url;if(w){if(a.image_url&&a.image_url.includes("supabase"))try{const J=a.image_url.split("/"),pe=J.findIndex(G=>G==="model-images");if(pe!==-1){const G=J.slice(pe+1).join("/");await F.storage.from("model-images").remove([G])}}catch(J){console.warn("Failed to delete old image:",J)}A=null}else if(K)A=K;else if(y){p(!0);const J=await un(y,1200,1200,.8);A=await O(J,"model-images","boxes")}const{error:I}=await F.from("boxes").update({name:a.name,game_id:a.game_id||null,purchase_date:a.purchase_date||null,image_url:A}).eq("id",r.id);if(I)throw I;n()}catch(A){N(A instanceof Error?A.message:"Failed to update box")}finally{x(!1),p(!1)}}},ie=()=>{var q;r&&i({name:r.name,game_id:r.game_id||((q=r.game)==null?void 0:q.id)||"",purchase_date:r.purchase_date||"",image_url:r.image_url||""}),u(null),b(null),_(!1),Y(""),C(!1),D([]),te([]),N("")};if(!t||!r)return null;const ne=q=>{q.target===q.currentTarget&&e()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",onClick:ne,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-lg font-bold text-title",children:"Edit Collection"}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6 text-icon"})})]}),s.jsxs("form",{onSubmit:fe,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"boxName",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Collection Name"}),s.jsxs("div",{className:"relative",children:[s.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsx("input",{type:"text",id:"boxName",value:a.name,onChange:q=>i({...a,name:q.target.value}),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"game",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game"}),s.jsx(ea,{games:o,selectedGame:a.game_id||"",onGameSelect:q=>i({...a,game_id:q}),placeholder:"Choose a Game"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"purchaseDate",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Purchase Date"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsx("input",{type:"date",id:"purchaseDate",value:a.purchase_date,onChange:q=>i({...a,purchase_date:q.target.value}),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"boxImage",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Box Image"}),a.image_url&&!w&&s.jsx("div",{className:"mb-3 p-3 border border-border-custom rounded-lg bg-bg-secondary",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("img",{src:a.image_url,alt:"Current box image",className:"w-12 h-12 object-cover rounded",onError:q=>{const A=q.target;A.style.display="none"}}),s.jsx("span",{className:"text-sm text-secondary-text",children:"Current image"})]}),s.jsx("button",{type:"button",onClick:H,className:"text-icon hover:text-icon-hover transition-colors p-1",title:"Delete current image",children:s.jsx(Jr,{className:"w-4 h-4"})})]})}),w&&s.jsx("div",{className:"mb-3 p-3 border border-red-300 rounded-lg bg-red-50",children:s.jsx("p",{className:"text-sm text-red-700",children:" Image will be deleted when you save changes"})}),s.jsxs("div",{className:"relative",children:[s.jsx(rr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-secondary-text w-5 h-5"}),s.jsx("input",{type:"file",id:"boxImage",accept:"image/*",onChange:B,className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-amber-50 file:text-amber-700 hover:file:bg-amber-100 bg-bg-primary text-text"})]}),y&&s.jsx("p",{className:"text-sm text-green-600 mt-1",children:" New image ready for upload"}),!a.image_url&&!y&&!K&&a.name.trim()&&s.jsx("div",{className:"mt-3",children:s.jsx("button",{type:"button",onClick:z,disabled:k,className:"w-full px-4 py-2 border border---color-brand text---color-brand hover:bg-amber-50 rounded-lg transition-colors font-medium disabled:opacity-50",children:k?"Searching for images...":"Find images for this box"})}),K&&s.jsx("div",{className:"mt-3 p-3 border border-green-300 rounded-lg bg-green-50",children:s.jsx("p",{className:"text-sm text-green-700",children:" Image selected from search results"})})]}),j&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:j}),s.jsxs("div",{className:"flex space-x-3 pt-4",children:[s.jsx("button",{type:"button",onClick:ie,className:"btn-ghost btn-flex",children:"Discard Changes"}),s.jsx("button",{type:"submit",disabled:S||g,className:"btn-primary btn-flex",children:g?"Processing...":S?"Saving...":"Save Changes"})]})]})]})}),m&&s.jsx(sr,{isOpen:d,onClose:()=>{h(!1),f(null),u(null)},onCrop:X,imageFile:m}),E&&s.jsx(am,{isOpen:E,onClose:()=>C(!1),images:U,onImageSelect:se,searchQuery:`${a.name} ${((ae=o.find(q=>q.id===a.game_id))==null?void 0:ae.name)||""}`.trim(),onFindMoreImages:$,isLoadingMore:L})]})}function G0({isOpen:t,onClose:e,onConfirm:n,modelName:r,boxName:a,loading:i=!1}){if(!t)return null;const o=l=>{l.target===l.currentTarget&&e()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[70]",onClick:o,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h2",{className:"text-xl font-bold text-title",children:["Remove ",r," from ",a,"?"]}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text",children:s.jsx(ye,{className:"w-6 h-6"})})]}),s.jsx("p",{className:"text-base text-secondary-text mb-6",children:"Are you sure you want to remove this model from this box? This won't delete the model or the box from your collection."}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:e,disabled:i,className:"flex-1 px-4 py-2 border border-border-custom text-text rounded-lg hover:bg-bg-secondary transition-colors font-medium",children:"Cancel"}),s.jsx("button",{onClick:n,disabled:i,className:"flex-1 px-4 py-2 bg-brand hover:bg-amber-600 disabled:bg-amber-300 text-white rounded-lg transition-colors font-medium",children:i?"Removing...":"Remove from Box"})]})]})})}function W0({isOpen:t,onClose:e,onCollectionUpdated:n,box:r}){const[a,i]=v.useState(!1),[o,l]=v.useState(!1),[c,u]=v.useState(!1),[d,h]=v.useState("");v.useEffect(()=>{r&&i(r.public??!1)},[r]);const m=async()=>{if(r){l(!0),h("");try{const{error:b}=await F.from("boxes").update({public:!a}).eq("id",r.id);if(b)throw b;i(!a),n==null||n()}catch(b){h(b instanceof Error?b.message:"Failed to update collection visibility")}finally{l(!1)}}},f=async()=>{if(r){u(!0),h("");try{const b=`${window.location.origin}/shared/collection/${r.id}`;await navigator.clipboard.writeText(b),console.log("Collection share link copied to clipboard")}catch(b){console.error("Error copying URL:",b);const S=document.createElement("textarea");S.value=`${window.location.origin}/shared/collection/${r.id}`,document.body.appendChild(S),S.select(),document.execCommand("copy"),document.body.removeChild(S),console.log("Collection share link copied to clipboard (fallback)")}finally{u(!1)}}},y=b=>{b.target===b.currentTarget&&e()};return!t||!r?null:s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[70]",onClick:y,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-lg font-bold text-title",children:"Share this collection"}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(ye,{className:"w-6 h-6 text-icon"})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-bg-secondary rounded-lg p-4",children:s.jsx("h3",{className:"font-semibold text-text mb-2",children:r.name})}),s.jsx("div",{className:"space-y-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(pc,{className:"w-5 h-5 text-icon"}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-input-label",children:"Make Public"}),s.jsx("p",{className:"text-xs text-secondary-text",children:"Allow anyone to view this collection"})]})]}),s.jsx("button",{onClick:m,disabled:o,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-brand focus:ring-offset-2 disabled:opacity-50 ${a?"bg-brand":"bg-secondary-text"}`,children:s.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${a?"translate-x-6":"translate-x-1"}`})})]})}),a&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Tf,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm text-green-800",children:"This collection is now public and can be viewed by anyone with the link."})]})}),!a&&s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Bg,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"text-sm text-gray-800",children:"This collection is private and only visible to you."})]})}),s.jsxs("button",{onClick:f,disabled:c,className:"btn-secondary btn-full btn-with-icon",children:[s.jsx(Fg,{className:"w-4 h-4"}),s.jsx("span",{children:c?"Copying...":"Copy URL"})]}),d&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:d}),s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{onClick:e,className:"btn-secondary",children:"Done"})})]})]})})}function H0({isOpen:t,onClose:e,onBoxDeleted:n,onModelsUpdated:r,onViewModel:a,onAddNewModel:i,box:o}){var fe,ie,ne,ae,q;const[l,c]=me.useState(!1),[u,d]=me.useState(!1),[h,m]=me.useState(!1),[f,y]=me.useState(!1),[b,S]=me.useState({isOpen:!1,model:null}),[x,g]=me.useState(!1),[p,j]=me.useState(!1),[N,w]=me.useState(!1),[_,E]=me.useState([]),[C,k]=me.useState(!0),[P,U]=me.useState(null);me.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),me.useEffect(()=>{t&&o&&D()},[t,o]);const D=async()=>{if(o){k(!0),U(null);try{const{data:A,error:I}=await F.from("models").select(`
          id,
          name,
          status,
          count,
          image_url,
          game_id,
          notes,
          game:games(
            id,
            name,
            icon
          )
        `).eq("box_id",o.id).order("created_at",{ascending:!1});if(I)throw I;E(A||[])}catch(A){U(A instanceof Error?A.message:"Failed to fetch models")}finally{k(!1)}}},K=()=>{d(!1),D(),r==null||r()},Y=()=>{d(!1),g(!0),e()};me.useEffect(()=>{x&&!t&&(g(!1),i==null||i((o==null?void 0:o.id)||null))},[x,t,i,o==null?void 0:o.id]);const re=A=>{S({isOpen:!0,model:A})},te=async()=>{if(b.model){w(!0);try{const{error:A}=await F.from("models").update({box_id:null}).eq("id",b.model.id);if(A)throw A;D(),r==null||r(),S({isOpen:!1,model:null})}catch(A){console.error("Error removing model from box:",A)}finally{w(!1)}}},L=A=>{e(),a==null||a(A)},V=()=>{m(!1),e(),r&&r()};if(!t||!o)return null;const M=A=>{A.target===A.currentTarget&&e()},B=A=>new Date(A).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}),X=()=>{var I;if(o.image_url&&typeof o.image_url=="string"&&o.image_url.trim()!==""&&o.image_url!=="undefined"&&o.image_url!=="null"&&(o.image_url.startsWith("http")||o.image_url.startsWith("/")))return o.image_url;const A=(I=o.game)==null?void 0:I.image;return A&&typeof A=="string"&&A.trim()!==""&&A!=="undefined"&&A!=="null"&&A.startsWith("http")?A:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"},H=A=>{switch(A){case"Painted":return"bg-green-100 text-green-800";case"Partially Painted":return"bg-yellow-100 text-yellow-800";case"Primed":return"bg-blue-100 text-blue-800";case"Assembled":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},z=A=>{var J;if(A.image_url&&typeof A.image_url=="string"&&A.image_url.trim()!==""&&A.image_url!=="undefined"&&A.image_url!=="null"&&(A.image_url.startsWith("http")||A.image_url.startsWith("/")))return{src:A.image_url,isGameFallback:!1};const I=(J=A.game)==null?void 0:J.icon;return I&&typeof I=="string"&&I.trim()!==""&&I!=="undefined"&&I!=="null"&&I.startsWith("http")?{src:I,isGameFallback:!0}:{src:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg",isGameFallback:!1}},se=()=>{y(!0)},$=()=>{c(!0)},O=async()=>{if(o){j(!0);try{if(o.image_url&&typeof o.image_url=="string"&&o.image_url.includes("supabase")){const I=o.image_url.split("/"),J=I.findIndex(pe=>pe==="model-images");if(J!==-1){const pe=I.slice(J+1).join("/");await F.storage.from("model-images").remove([pe])}}const{error:A}=await F.from("boxes").delete().eq("id",o.id);if(A)throw A;c(!1),e(),n&&n()}catch(A){console.error("Error deleting box:",A)}finally{j(!1)}}};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:M,children:s.jsxs("div",{className:"bg-modal-bg max-w-2xl w-full overflow-y-auto md:rounded-lg md:max-w-2xl md:max-h-[90vh] fixed inset-0 md:relative md:inset-auto h-screen md:h-auto",children:[s.jsx("div",{className:"relative",children:s.jsx("img",{src:X(),alt:o.name,className:"w-full max-h-[60%] object-cover",loading:"lazy",onError:A=>{const I=A.target,J="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg";I.src!==J&&(console.log("Box modal image failed to load:",I.src,"Falling back to default"),I.src=J)}})}),s.jsx("button",{onClick:e,className:"fixed top-4 right-4 md:absolute text-white hover:text-gray-300 transition-colors bg-black bg-opacity-50 rounded-full p-2 z-20",children:s.jsx(ye,{className:"w-6 h-6 text-icon"})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"text-center mb-6 relative",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-title",children:o.name}),s.jsx("button",{onClick:()=>m(!0),className:"p-1 text-secondary-text hover:text-text transition-colors rounded",children:s.jsx(Qs,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[(fe=o.game)!=null&&fe.icon?s.jsx("img",{src:o.game.icon,alt:`${o.game.name} icon`,className:"object-cover rounded max-h-[32px]",onError:A=>{const I=A.target;console.warn("Game icon failed to load:",I.src,"Falling back to letter icon"),I.style.display="none";const J=I.nextElementSibling;J&&J.classList.contains("icon-fallback")&&(J.style.display="flex")},onLoad:A=>{const J=A.target.nextElementSibling;J&&J.classList.contains("icon-fallback")&&(J.style.display="none")}}):null,s.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:(ie=o.game)!=null&&ie.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-xs font-bold",children:(((ne=o.game)==null?void 0:ne.name)||"Unknown Game").charAt(0)})}),s.jsx("span",{className:"text-lg font-semibold text-secondary-text",children:((ae=o.game)==null?void 0:ae.name)||"Unknown Game"})]})]}),s.jsx("div",{className:"space-y-3",children:o.purchase_date&&s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 flex items-center space-x-3",children:[s.jsx(Ze,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("span",{className:"text-base text-text font-medium",children:["Purchased ",B(o.purchase_date)]})]})}),s.jsxs("div",{className:"mt-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-title mb-4",children:"Models in this Collection"}),C?s.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((A,I)=>s.jsx("div",{className:"bg-bg-secondary rounded-lg p-4 animate-pulse",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-12 h-12 bg-secondary-text opacity-20 rounded"}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-1/2"})]})]})},I))}):P?s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsx("p",{className:"text-red-600",children:P})}):_.length===0?s.jsxs("div",{className:"text-center py-8 bg-bg-secondary rounded-lg",children:[s.jsx(Rn,{className:"w-12 h-12 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"No models in this collection yet."}),s.jsx("p",{className:"text-sm text-secondary-text mt-2",children:'Use the "Add Models to Collection" button to add some!'})]}):s.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:_.map(A=>s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 flex items-center justify-between hover:bg-bg-primary transition-colors",children:[s.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[(()=>{const I=z(A);return s.jsx("img",{src:I.src,alt:A.name,className:`w-12 h-12 object-cover rounded ${I.isGameFallback?"opacity-10":""}`,onError:J=>{const pe=J.target;pe.src="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"}})})(),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-medium text-text truncate",children:A.name}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsxs("span",{className:"text-xs text-secondary-text",children:[A.count," model",A.count!==1?"s":""]}),A.status!=="None"&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-xs text-secondary-text",children:""}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${H(A.status)}`,children:A.status})]})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>re(A),className:"p-2 text-icon hover:text-icon-hover transition-colors",children:s.jsx(Jr,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>L(A),className:"p-2 text-secondary-text hover:text-text transition-colors",children:s.jsx(Yn,{className:"w-4 h-4"})})]})]},A.id))})]}),s.jsx("div",{className:"flex justify-center pt-6",children:s.jsxs("div",{className:"space-y-3 w-full",children:[s.jsxs("button",{onClick:()=>d(!0),className:"btn-primary btn-full btn-with-icon",children:[s.jsx(kn,{className:"w-4 h-4"}),s.jsx("span",{children:"Add Models to Collection"})]}),s.jsxs("button",{onClick:se,className:"btn-secondary btn-full btn-with-icon",children:[s.jsx(pc,{className:"w-4 h-4"}),s.jsx("span",{children:"Share Collection"})]}),s.jsx("button",{onClick:$,className:"btn-danger-outline btn-full",children:"Delete Collection"})]})})]})]})}),s.jsx(U0,{isOpen:l,onClose:()=>c(!1),onConfirm:O,boxName:o.name,loading:p}),s.jsx(z0,{isOpen:u,onClose:()=>d(!1),onModelsAdded:K,onAddNewModel:Y,box:o}),s.jsx(B0,{isOpen:h,onClose:()=>m(!1),onBoxUpdated:V,box:o}),s.jsx(G0,{isOpen:b.isOpen,onClose:()=>S({isOpen:!1,model:null}),onConfirm:te,modelName:((q=b.model)==null?void 0:q.name)||"",boxName:(o==null?void 0:o.name)||"",loading:N}),s.jsx(W0,{isOpen:f,onClose:()=>y(!1),onCollectionUpdated:V,box:o})]})}function q0({isOpen:t,onClose:e}){const[n,r]=v.useState(""),[a,i]=v.useState(""),[o,l]=v.useState(!1),[c,u]=v.useState(!1),[d,h]=v.useState(!1),[m,f]=v.useState(""),[y,b]=v.useState(!1),{updatePassword:S}=et(),x=async g=>{if(g.preventDefault(),h(!0),f(""),n.length<6){f("Password must be at least 6 characters long"),h(!1);return}if(n!==a){f("Passwords do not match"),h(!1);return}try{const{error:p}=await S(n);p?f(p.message):(b(!0),window.history.replaceState({},document.title,window.location.pathname),setTimeout(()=>{e(),r(""),i(""),b(!1)},2e3))}catch{f("An unexpected error occurred")}finally{h(!1)}};return t?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-2xl font-bold text-title",children:"Set New Password"}),s.jsx("button",{onClick:e,className:"text-secondary-text hover:text-text",children:s.jsx(ye,{className:"w-6 h-6"})})]}),y?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"text-green-600 text-lg font-semibold mb-2",children:"Password updated successfully!"}),s.jsx("p",{className:"text-secondary-text",children:"You can now use your new password to log in."})]}):s.jsxs("form",{onSubmit:x,className:"space-y-4",children:[s.jsx("p",{className:"text-secondary-text text-sm",children:"Please set a new password for your account."}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-input-label font-overpass mb-1",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:o?"text":"password",id:"newPassword",value:n,onChange:g=>r(g.target.value),required:!0,className:"w-full px-3 py-2 pr-10 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text"}),s.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary-text hover:text-text",children:o?s.jsx(Gu,{className:"w-4 h-4"}):s.jsx(Wu,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-input-label font-overpass mb-1",children:"Confirm New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:c?"text":"password",id:"confirmPassword",value:a,onChange:g=>i(g.target.value),required:!0,className:"w-full px-3 py-2 pr-10 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text"}),s.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary-text hover:text-text",children:c?s.jsx(Gu,{className:"w-4 h-4"}):s.jsx(Wu,{className:"w-4 h-4"})})]})]}),m&&s.jsx("div",{className:"text-red-600 text-sm",children:m}),s.jsx("button",{type:"submit",disabled:d,className:"w-full bg-brand hover:bg-amber-600 disabled:bg-amber-300 text-white py-2 px-4 rounded-lg text-base font-semibold transition-colors",children:d?"Updating Password...":"Update Password"})]})]})}):null}function V0(){const[t,e]=v.useState(null),[n,r]=v.useState(!0),{user:a}=et();return v.useEffect(()=>{(async()=>{try{const o=window.location.hash,l=new URLSearchParams(window.location.search);if(o.includes("access_token")||l.has("code"))setTimeout(()=>{r(!1),window.location.href="/"},1e3);else if(o.includes("error")){const c=new URLSearchParams(o.substring(1)).get("error_description");e(c||"Authentication failed"),r(!1)}else e("Invalid authentication callback"),r(!1)}catch(o){console.error("Auth callback error:",o),e("Authentication failed"),r(!1)}})()},[]),v.useEffect(()=>{a&&!n&&(window.location.href="/")},[a,n]),n?s.jsx("div",{className:"min-h-screen bg-bg-primary flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--color-brand)] mx-auto mb-4"}),s.jsx("p",{className:"text-text",children:"Completing authentication..."})]})}):t?s.jsx("div",{className:"min-h-screen bg-bg-primary flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto p-6",children:[s.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),s.jsx("h1",{className:"text-2xl font-bold text-title mb-4",children:"Authentication Failed"}),s.jsx("p",{className:"text-red-500 mb-6",children:t}),s.jsx("button",{onClick:()=>window.location.href="/",className:"btn-primary",children:"Return to Home"})]})}):null}function K0(){const[t,e]=v.useState([]),[n,r]=v.useState(!0),[a,i]=v.useState(null),{user:o}=et();v.useEffect(()=>{if(!o){e([]),r(!1);return}l()},[o]);const l=async()=>{try{const{data:c,error:u}=await F.from("models").select(`
          id,
          name,
          status,
          count,
          image_url,
          game_id,
          notes,
          box:boxes(
            id,
            name,
            purchase_date,
            game:games(id, name, icon, image)
          ),
          game:games(id, name, icon, image)
        `).eq("user_id",o==null?void 0:o.id).order("created_at",{ascending:!1});if(u)throw u;const d=(c||[]).map(h=>({...h,box:h.box&&Array.isArray(h.box)?h.box[0]:h.box,game:h.game&&Array.isArray(h.game)?h.game[0]:h.game}));e(d)}catch(c){i(c instanceof Error?c.message:"Failed to fetch models")}finally{r(!1)}};return{models:t,loading:n,error:a,refetch:l}}function J0(){const[t,e]=v.useState([]),[n,r]=v.useState(!0),[a,i]=v.useState(null),{user:o}=et();v.useEffect(()=>{if(!o){e([]),r(!1);return}l()},[o]);const l=async()=>{try{const{data:c,error:u}=await F.from("boxes").select(`
          id,
          name,
          purchase_date,
          image_url,
          public,
          game:games(id, name, icon, image)
        `).eq("user_id",o==null?void 0:o.id).order("created_at",{ascending:!1}).limit(10);if(u)throw u;const d=(c||[]).map(h=>({...h,game:h.game&&Array.isArray(h.game)?h.game[0]:h.game}));e(d)}catch(c){i(c instanceof Error?c.message:"Failed to fetch boxes")}finally{r(!1)}};return{boxes:t,loading:n,error:a,refetch:l}}const mo="2025-08-24 23:48:57 UTC",fd=()=>({timestamp:mo,date:new Date(mo).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),time:new Date(mo).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",timeZoneName:"short"})});function Q0({games:t,boxes:e,models:n,selectedBoxes:r,selectedGames:a,selectedStatuses:i,searchQuery:o,onBoxesChange:l,onGamesChange:c,onStatusesChange:u,onSearchChange:d,onClearFilters:h}){const m=r.length>0||a.length>0||i.length>0||o.length>0,f=()=>{const w=new Map;return n.forEach(_=>{if(_.box){const E=_.box.id,C=_.box.name,k=w.get(E)||{name:C,count:0};k.count++,w.set(E,k)}}),Array.from(w.entries()).map(([_,{name:E,count:C}])=>({id:_,name:E,count:C})).sort((_,E)=>E.count-_.count)},y=()=>{const w=new Map;return n.forEach(_=>{var k,P,U,D,K,Y;const E=((P=(k=_.box)==null?void 0:k.game)==null?void 0:P.id)||((U=_.game)==null?void 0:U.id),C=((K=(D=_.box)==null?void 0:D.game)==null?void 0:K.name)||((Y=_.game)==null?void 0:Y.name);if(E&&C){const re=w.get(E)||{name:C,count:0};re.count++,w.set(E,re)}}),Array.from(w.entries()).map(([_,{name:E,count:C}])=>({id:_,name:E,count:C})).sort((_,E)=>E.count-_.count)},b=()=>{const w=new Map;return n.forEach(_=>{const E=w.get(_.status)||0;w.set(_.status,E+1)}),Array.from(w.entries()).map(([_,E])=>({status:_,count:E})).sort((_,E)=>E.count-_.count)},S=f(),x=y(),g=b(),p=w=>{const _=r.includes(w)?r.filter(E=>E!==w):[...r,w];l(_)},j=w=>{const _=a.includes(w)?a.filter(E=>E!==w):[...a,w];c(_)},N=w=>{const _=i.includes(w)?i.filter(E=>E!==w):[...i,w];u(_)};return s.jsxs("div",{className:"bg-bg-card rounded-lg border border-border-custom p-4 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Pf,{className:"w-5 h-5 text-secondary-text"}),s.jsx("h3",{className:"text-lg font-semibold text-title",children:"Filters"})]}),m&&s.jsxs("button",{onClick:h,className:"flex items-center space-x-1 text-sm text-secondary-text hover:text-text transition-colors",children:[s.jsx(ye,{className:"w-4 h-4 text-icon"}),s.jsx("span",{children:"Clear all"})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Search Models"}),s.jsx("input",{type:"text",value:o,onChange:w=>d(w.target.value),placeholder:"Search by model name...",className:"w-full px-3 py-2 border border-border-custom rounded-lg bg-bg-primary text-text placeholder-secondary-text focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Collections"}),s.jsx("div",{className:"max-h-48 overflow-y-auto border border-border-custom rounded-lg bg-bg-primary",children:S.map(w=>s.jsxs("label",{className:"flex items-center space-x-2 px-3 py-2 hover:bg-bg-secondary cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:r.includes(w.id),onChange:()=>p(w.id),className:"rounded border-border-custom text---color-brand focus:ring---color-brand"}),s.jsx("span",{className:"text-sm text-text flex-1",children:w.name}),s.jsxs("span",{className:"text-xs text-secondary-text",children:["(",w.count,")"]})]},w.id))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Games"}),s.jsx("div",{className:"max-h-48 overflow-y-auto border border-border-custom rounded-lg bg-bg-primary",children:x.map(w=>s.jsxs("label",{className:"flex items-center space-x-2 px-3 py-2 hover:bg-bg-secondary cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:a.includes(w.id),onChange:()=>j(w.id),className:"rounded border-border-custom text-blue-500 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-text flex-1",children:w.name}),s.jsxs("span",{className:"text-xs text-secondary-text",children:["(",w.count,")"]})]},w.id))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Statuses"}),s.jsx("div",{className:"max-h-48 overflow-y-auto border border-border-custom rounded-lg bg-bg-primary",children:g.map(({status:w,count:_})=>s.jsxs("label",{className:"flex items-center space-x-2 px-3 py-2 hover:bg-bg-secondary cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:i.includes(w),onChange:()=>N(w),className:"rounded border-border-custom text-green-500 focus:ring-green-500"}),s.jsx("span",{className:"text-sm text-text flex-1",children:w}),s.jsxs("span",{className:"text-xs text-secondary-text",children:["(",_,")"]})]},w))})]})]}),m&&s.jsx("div",{className:"mt-4 pt-4 border-t border-border-custom",children:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[o&&s.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm",children:[s.jsxs("span",{children:['Search: "',o,'"']}),s.jsx("button",{onClick:()=>d(""),className:"text-gray-600 hover:text-gray-800 transition-colors",children:s.jsx(ye,{className:"w-3 h-3 text-icon"})})]}),r.map(w=>{var E;const _=((E=S.find(C=>C.id===w))==null?void 0:E.name)||"";return s.jsxs("div",{className:"flex items-center space-x-2 bg-amber-100 text-amber-800 px-3 py-1 rounded-full text-sm",children:[s.jsxs("span",{children:["Collection: ",_]}),s.jsx("button",{onClick:()=>p(w),className:"text-amber-600 hover:text-amber-800 transition-colors",children:s.jsx(ye,{className:"w-3 h-3 text-icon"})})]},w)}),a.map(w=>{var E;const _=((E=x.find(C=>C.id===w))==null?void 0:E.name)||"";return s.jsxs("div",{className:"flex items-center space-x-2 bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:[s.jsxs("span",{children:["Game: ",_]}),s.jsx("button",{onClick:()=>j(w),className:"text-blue-600 hover:text-blue-800 transition-colors",children:s.jsx(ye,{className:"w-3 h-3 text-icon"})})]},w)}),i.map(w=>s.jsxs("div",{className:"flex items-center space-x-2 bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm",children:[s.jsxs("span",{children:["Status: ",w]}),s.jsx("button",{onClick:()=>N(w),className:"text-green-600 hover:text-green-800 transition-colors",children:s.jsx(ye,{className:"w-3 h-3 text-icon"})})]},w))]})})]})}function Y0({games:t,boxes:e,selectedGames:n,searchQuery:r,onGamesChange:a,onSearchChange:i,onClearFilters:o}){const l=n.length>0||r.length>0,u=(()=>{const h=new Map;return e.forEach(m=>{if(m.game){const f=m.game.id,y=m.game.name,b=h.get(f)||{name:y,count:0};b.count++,h.set(f,b)}}),Array.from(h.entries()).map(([m,{name:f,count:y}])=>({id:m,name:f,count:y})).sort((m,f)=>f.count-m.count)})(),d=h=>{const m=n.includes(h)?n.filter(f=>f!==h):[...n,h];a(m)};return s.jsxs("div",{className:"bg-bg-card rounded-lg border border-border-custom p-4 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Pf,{className:"w-5 h-5 text-secondary-text"}),s.jsx("h3",{className:"text-lg font-semibold text-title",children:"Filters"})]}),l&&s.jsxs("button",{onClick:o,className:"flex items-center space-x-1 text-sm text-secondary-text hover:text-text transition-colors",children:[s.jsx(ye,{className:"w-4 h-4 text-icon"}),s.jsx("span",{children:"Clear all"})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Search Collections"}),s.jsx("input",{type:"text",value:r,onChange:h=>i(h.target.value),placeholder:"Search by collection name...",className:"w-full px-3 py-2 border border-border-custom rounded-lg bg-bg-primary text-text placeholder-secondary-text focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Games"}),s.jsx("div",{className:"max-h-48 overflow-y-auto border border-border-custom rounded-lg bg-bg-primary",children:u.map(h=>s.jsxs("label",{className:"flex items-center space-x-2 px-3 py-2 hover:bg-bg-secondary cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:n.includes(h.id),onChange:()=>d(h.id),className:"rounded border-border-custom text-blue-500 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-text flex-1",children:h.name}),s.jsxs("span",{className:"text-xs text-secondary-text",children:["(",h.count,")"]})]},h.id))})]})}),l&&s.jsx("div",{className:"mt-4 pt-4 border-t border-border-custom",children:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[r&&s.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm",children:[s.jsxs("span",{children:['Search: "',r,'"']}),s.jsx("button",{onClick:()=>i(""),className:"text-gray-600 hover:text-gray-800 transition-colors",children:s.jsx(ye,{className:"w-3 h-3 text-icon"})})]}),n.map(h=>{var f;const m=((f=u.find(y=>y.id===h))==null?void 0:f.name)||"";return s.jsxs("div",{className:"flex items-center space-x-2 bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:[s.jsxs("span",{children:["Game: ",m]}),s.jsx("button",{onClick:()=>d(h),className:"text-blue-600 hover:text-blue-800 transition-colors",children:s.jsx(ye,{className:"w-3 h-3 text-icon"})})]},h)})]})})]})}const X0="/battleplanapp/Battleplan-Logo-Purple.svg";function Z0({collectionId:t}){var N,w,_,E;const[e,n]=v.useState(null),[r,a]=v.useState([]),[i,o]=v.useState(!0),[l,c]=v.useState(null),[u,d]=v.useState(!1),[h,m]=v.useState(!1),{isDarkMode:f,toggleDarkMode:y}=nm();v.useEffect(()=>{const C=k=>{const P=k.target;h&&!P.closest(".profile-dropdown")&&m(!1)};return document.addEventListener("mousedown",C),()=>{document.removeEventListener("mousedown",C)}},[h]),v.useEffect(()=>{b()},[t]);const b=async()=>{try{o(!0),c(null);const{data:C,error:k}=await F.from("boxes").select(`
          id,
          name,
          purchase_date,
          image_url,
          public,
          game:games(
            id,
            name,
            icon,
            image
          )
        `).eq("id",t).eq("public",!0).single();if(k){if(k.code==="PGRST116")d(!0);else throw k;return}n(C);const{data:P,error:U}=await F.from("models").select(`
          id,
          name,
          status,
          count,
          image_url,
          notes,
          game:games(
            id,
            name,
            icon
          )
        `).eq("box_id",t).order("created_at",{ascending:!1});if(U)throw U;a(P||[])}catch(C){c(C instanceof Error?C.message:"Failed to load collection")}finally{o(!1)}},S=C=>new Date(C).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}),x=()=>{var k;if(!e)return"";if(e.image_url&&typeof e.image_url=="string"&&e.image_url.trim()!==""&&e.image_url!=="undefined"&&e.image_url!=="null"&&(e.image_url.startsWith("http")||e.image_url.startsWith("/")))return e.image_url;const C=(k=e.game)==null?void 0:k.image;return C&&typeof C=="string"&&C.trim()!==""&&C!=="undefined"&&C!=="null"&&C.startsWith("http")?C:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"},g=C=>{var P;if(C.image_url&&typeof C.image_url=="string"&&C.image_url.trim()!==""&&C.image_url!=="undefined"&&C.image_url!=="null"&&(C.image_url.startsWith("http")||C.image_url.startsWith("/")))return{src:C.image_url,isGameFallback:!1};const k=(P=C.game)==null?void 0:P.icon;return k&&typeof k=="string"&&k.trim()!==""&&k!=="undefined"&&k!=="null"&&k.startsWith("http")?{src:k,isGameFallback:!0}:{src:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg",isGameFallback:!1}},p=C=>{switch(C){case"Painted":return"bg-green-100 text-green-800";case"Partially Painted":return"bg-yellow-100 text-yellow-800";case"Primed":return"bg-blue-100 text-blue-800";case"Assembled":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},j=()=>{window.history.back()};return i?s.jsx("div",{className:"min-h-screen bg-bg-primary",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),s.jsx("div",{className:"h-64 bg-gray-200 rounded mb-8"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})]})})}):u||l?s.jsx("div",{className:"min-h-screen bg-bg-primary flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Tf,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h1",{className:"text-2xl font-bold text-title mb-2",children:u?"Collection Not Found":"Error Loading Collection"}),s.jsx("p",{className:"text-secondary-text mb-6",children:u?"This collection may be private or no longer exists.":l||"Something went wrong while loading the collection."}),s.jsx("button",{onClick:j,className:"btn-secondary",children:s.jsx("span",{children:"Go Back"})})]})}):e?s.jsxs("div",{className:"min-h-screen bg-bg-primary",children:[s.jsx("header",{className:"bg-bg-primary shadow-sm border-b border-border-custom relative z-50",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsx("div",{className:"flex items-center"}),s.jsx("div",{className:"flex items-center justify-center flex-1",children:s.jsx("img",{src:X0,alt:"Battleplan",className:"max-h-[300px] w-auto"})}),s.jsxs("div",{className:"relative profile-dropdown",children:[s.jsx("button",{onClick:()=>m(!h),className:"text-secondary-text hover:text-text focus:outline-none p-2",children:s.jsx(Mn,{className:"w-6 h-6 text-icon hover:text-icon-hover"})}),h&&s.jsxs("div",{className:"absolute right-0 top-12 bg-bg-primary border border-border-custom rounded-lg shadow-lg py-2 z-[60] min-w-[200px]",children:[s.jsx("button",{onClick:()=>{m(!1),window.location.href="/"},className:"w-full px-4 py-2 text-left text-text hover:bg-bg-secondary transition-colors",children:s.jsx("span",{children:"Log In"})}),s.jsx("div",{className:"border-t border-border-custom my-1"}),s.jsxs("div",{className:"flex items-center justify-between px-4 py-2",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[f?s.jsx(If,{className:"w-5 h-5 text-icon"}):s.jsx(Mf,{className:"w-5 h-5 text-icon"}),s.jsx("span",{className:"text-base font-semibold text-text",children:f?"Dark Mode":"Light Mode"})]}),s.jsx("button",{onClick:C=>{C.stopPropagation(),y()},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-brand focus:ring-offset-2 ${f?"bg-brand":"bg-gray-200"}`,children:s.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${f?"translate-x-6":"translate-x-1"}`})})]})]})]})]})})}),s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[s.jsx("div",{className:"mb-8",children:s.jsx("h1",{className:"text-3xl font-bold text-title mb-4",children:e.name})}),s.jsx("div",{className:"mb-8",children:s.jsx("img",{src:x(),alt:e.name,className:"w-full h-64 object-contain rounded-lg bg-bg-secondary",loading:"lazy",onError:C=>{const k=C.target,P="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg";k.src!==P&&(k.src=P)}})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[s.jsx("div",{className:"bg-bg-card rounded-lg p-6 border border-border-custom",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[(N=e.game)!=null&&N.icon?s.jsx("img",{src:e.game.icon,alt:`${e.game.name} icon`,className:"w-12 h-12 object-cover rounded",onError:C=>{const k=C.target;k.style.display="none";const P=k.nextElementSibling;P&&P.classList.contains("icon-fallback")&&(P.style.display="flex")},onLoad:C=>{const P=C.target.nextElementSibling;P&&P.classList.contains("icon-fallback")&&(P.style.display="none")}}):null,s.jsx("div",{className:"w-12 h-12 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:(w=e.game)!=null&&w.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-sm font-bold",children:(((_=e.game)==null?void 0:_.name)||"Unknown Game").charAt(0)})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-text",children:"Game"}),s.jsx("p",{className:"text-secondary-text",children:((E=e.game)==null?void 0:E.name)||"Unknown Game"})]})]})}),e.purchase_date&&s.jsx("div",{className:"bg-bg-card rounded-lg p-6 border border-border-custom",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Ze,{className:"w-6 h-6 text-secondary-text"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-text",children:"Purchase Date"}),s.jsx("p",{className:"text-secondary-text",children:S(e.purchase_date)})]})]})})]}),s.jsxs("div",{className:"bg-bg-card rounded-lg border border-border-custom overflow-hidden",children:[s.jsx("div",{className:"p-6 border-b border-border-custom",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Bs,{className:"w-6 h-6 text-secondary-text"}),s.jsxs("h2",{className:"text-xl font-bold text-title",children:["Models (",r.length,")"]})]})}),r.length===0?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx(Rn,{className:"w-12 h-12 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"No models in this collection."})]}):s.jsx("div",{className:"divide-y divide-border-custom",children:r.map(C=>s.jsx("div",{className:"p-6 hover:bg-bg-secondary transition-colors",children:s.jsxs("div",{className:"flex items-start space-x-4",children:[s.jsx("div",{className:"flex-shrink-0",children:(()=>{const k=g(C);return s.jsx("img",{src:k.src,alt:C.name,className:`w-16 h-16 object-cover rounded ${k.isGameFallback?"opacity-10":""}`,onError:P=>{const U=P.target;U.src="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"}})})()}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-text mb-2",children:C.name}),s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-secondary-text mb-2",children:[C.count&&s.jsxs("span",{children:[C.count," model",C.count!==1?"s":""]}),C.status&&C.status!=="None"&&s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${p(C.status)}`,children:C.status})]}),C.notes&&s.jsx("p",{className:"text-sm text-secondary-text",children:C.notes})]})]})},C.id))})]})]})]}):null}function ev(){const t=window.location.pathname==="/auth/callback",e=window.location.pathname.match(/^\/shared\/collection\/(.+)$/),n=e?e[1]:null;if(t)return s.jsx(V0,{});if(n)return s.jsx(Z0,{collectionId:n});const[r,a]=v.useState("collection"),[i,o]=v.useState("recent"),[l,c]=v.useState(1),[u,d]=v.useState(1),[h,m]=v.useState({selectedBoxes:[],selectedGames:[],selectedStatuses:[],searchQuery:""}),[f,y]=v.useState({selectedGames:[],searchQuery:""}),[b,S]=v.useState([]),[x,g]=v.useState({isOpen:!1,mode:"login"}),[p,j]=v.useState(!1),[N,w]=v.useState(!1),[_,E]=v.useState(!1),[C,k]=v.useState(!1),[P,U]=v.useState(null),[D,K]=v.useState({isOpen:!1,model:null}),[Y,re]=v.useState({isOpen:!1,box:null}),{user:te,loading:L,needsPasswordReset:V}=et(),{models:M,loading:B,refetch:X}=K0(),{boxes:H,loading:z,refetch:se}=J0();v.useEffect(()=>{te&&$()},[te]);const $=async()=>{try{const{data:T,error:ce}=await F.from("games").select("id, name, icon").order("name");if(ce)throw ce;S(T||[])}catch(T){console.error("Error fetching games:",T)}},O=6,fe=T=>{m(ce=>({...ce,selectedBoxes:T})),c(1)},ie=T=>{m(ce=>({...ce,selectedGames:T})),c(1)},ne=T=>{m(ce=>({...ce,selectedStatuses:T})),c(1)},ae=()=>{m({selectedBoxes:[],selectedGames:[],selectedStatuses:[],searchQuery:""}),c(1)},q=T=>{y(ce=>({...ce,selectedGames:T})),d(1)},A=()=>{y({selectedGames:[],searchQuery:""}),d(1)},I=T=>{m(ce=>({...ce,searchQuery:T})),c(1)},J=T=>{y(ce=>({...ce,searchQuery:T})),d(1)},pe=M.filter(T=>{var ce,ot,lt,Mt;return!(h.searchQuery&&!T.name.toLowerCase().includes(h.searchQuery.toLowerCase())||h.selectedBoxes.length>0&&!h.selectedBoxes.includes(((ce=T.box)==null?void 0:ce.id)||"")||h.selectedGames.length>0&&!h.selectedGames.includes(((lt=(ot=T.box)==null?void 0:ot.game)==null?void 0:lt.id)||"")&&!h.selectedGames.includes(((Mt=T.game)==null?void 0:Mt.id)||"")||h.selectedStatuses.length>0&&!h.selectedStatuses.includes(T.status))}),G=M.filter(T=>T.status==="Painted"),ee=H.filter(T=>{var ce;return!(f.searchQuery&&!T.name.toLowerCase().includes(f.searchQuery.toLowerCase())||f.selectedGames.length>0&&!f.selectedGames.includes(((ce=T.game)==null?void 0:ce.id)||""))}),ge=Math.ceil(pe.length/O),Ce=Math.ceil(G.length/O),ve=Math.ceil(ee.length/O),be=pe.slice((l-1)*O,l*O),W=G.slice((l-1)*O,l*O),Z=ee.slice((u-1)*O,u*O),xe=()=>{X(),se(),U(null)},je=T=>{K({isOpen:!0,model:T})},ue=T=>{re({isOpen:!0,box:T})},Ne=()=>{X(),se()},De=async()=>{await X(),await se()},tt=()=>{se(),X()},Jt=()=>{se(),X()},Qt=T=>{U(T),j(!0)},We=T=>{U(T),j(!0)},xt=()=>{E(!0)};return v.useEffect(()=>{V&&k(!0)},[V]),L?s.jsx("div",{className:"min-h-screen bg-bg-secondary flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--color-brand)] mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text",children:"Loading..."})]})}):te?_?s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(pr,{onAddModel:()=>j(!0),onAdminClick:xt,activeTab:r,onTabChange:a}),s.jsx(I0,{onBack:()=>E(!1)}),s.jsx(os,{activeTab:r,onTabChange:T=>{E(!1),a(T)}})]}):r==="about"?s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(pr,{onAddModel:()=>j(!0),onAdminClick:xt,activeTab:r,onTabChange:a}),s.jsx(M0,{onBack:()=>a("collection")}),s.jsx(os,{activeTab:r,onTabChange:a})]}):r==="all-bookings"?s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(pr,{onAddModel:()=>j(!0),onAdminClick:xt,activeTab:r,onTabChange:a}),s.jsx($0,{onBack:()=>a("collection")}),s.jsx(os,{activeTab:r,onTabChange:a})]}):r==="battleplan"?s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(pr,{onAddModel:()=>j(!0),onAdminClick:xt,activeTab:r,onTabChange:a}),s.jsx(v0,{}),s.jsx(os,{activeTab:r,onTabChange:a})]}):s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(pr,{onAddModel:()=>j(!0),onAdminClick:xt,activeTab:r,onTabChange:a}),r==="collection"&&s.jsx(p0,{activeView:i,onViewChange:o}),s.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[i==="recent"&&s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:"mb-16",children:[M.filter(T=>T.status==="Painted").length>0&&s.jsxs("div",{className:"flex flex-col items-center mb-8",children:[s.jsx("h2",{className:"text-lg font-bold text-secondary-text text-center mb-4",children:"RECENT MODELS"}),s.jsxs("button",{onClick:()=>j(!0),className:"btn-primary-sm btn-with-icon-sm",children:[s.jsx(kn,{className:"w-4 h-4"}),s.jsx("span",{children:"Add Model"})]})]}),B?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((T,ce)=>s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm border border-border-custom overflow-hidden animate-pulse",children:[s.jsx("div",{className:"h-48 bg-secondary-text opacity-20"}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-2/3"}),s.jsx("div",{className:"h-8 bg-secondary-text opacity-20 rounded"})]})]},ce))}):G.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("p",{className:"text-base text-secondary-text mb-4",children:"No painted models in your collection yet."}),s.jsx("button",{onClick:()=>j(!0),className:"btn-primary",children:"Add Your First Model"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:W.map(T=>{var ce,ot,lt,Mt,He,ct,Nt;return s.jsx(b0,{model:T,name:T.name,boxName:((ce=T.box)==null?void 0:ce.name)||"Unknown Collection",gameName:((lt=(ot=T.box)==null?void 0:ot.game)==null?void 0:lt.name)||((Mt=T.game)==null?void 0:Mt.name)||"Unknown Game",gameIcon:((ct=(He=T.box)==null?void 0:He.game)==null?void 0:ct.icon)||((Nt=T.game)==null?void 0:Nt.icon)||null,status:T.status,count:T.count,imageUrl:T.image_url,onViewModel:()=>je(T),onViewBox:ue},T.id)})}),Ce>1&&s.jsx(ka,{currentPage:l,totalPages:Ce,onPageChange:c})]})]}),s.jsxs("section",{children:[H.length>0&&s.jsxs("div",{className:"flex flex-col items-center mb-8",children:[s.jsx("h2",{className:"text-lg font-bold text-secondary-text text-center mb-4",children:"RECENT COLLECTIONS"}),s.jsxs("button",{onClick:()=>w(!0),className:"btn-primary-sm btn-with-icon-sm",children:[s.jsx(kn,{className:"w-4 h-4"}),s.jsx("span",{children:"Add Collection"})]})]}),z?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((T,ce)=>s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm border border-border-custom overflow-hidden animate-pulse",children:[s.jsx("div",{className:"h-48 bg-secondary-text opacity-20"}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-2/3"}),s.jsx("div",{className:"h-8 bg-secondary-text opacity-20 rounded"})]})]},ce))}):H.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("p",{className:"text-base text-secondary-text mb-4",children:"No collections in your collection yet."}),s.jsx("button",{onClick:()=>w(!0),className:"btn-primary",children:"Add Your First Box"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Z.map(T=>{var ce,ot,lt;return s.jsx(w0,{name:T.name,gameName:((ce=T.game)==null?void 0:ce.name)||"Unknown Game",purchaseDate:T.purchase_date,imageUrl:T.image_url,gameImage:(ot=T.game)==null?void 0:ot.image,gameIcon:(lt=T.game)==null?void 0:lt.icon,onViewBox:()=>ue(T)},T.id)})}),ve>1&&s.jsx(ka,{currentPage:u,totalPages:ve,onPageChange:d})]})]})]}),i==="collections"&&s.jsxs("section",{children:[H.length>0&&s.jsx("div",{className:"flex flex-col items-center mb-8",children:s.jsxs("button",{onClick:()=>w(!0),className:"btn-primary-sm btn-with-icon-sm",children:[s.jsx(kn,{className:"w-4 h-4"}),s.jsx("span",{children:"Add Collection"})]})}),H.length>0&&s.jsx(Y0,{games:b,boxes:H,selectedGames:f.selectedGames,searchQuery:f.searchQuery,onGamesChange:q,onSearchChange:J,onClearFilters:A}),z?s.jsx("div",{className:"space-y-3",children:Array.from({length:6}).map((T,ce)=>s.jsx("div",{className:"bg-bg-card rounded-lg border border-border-custom p-4 animate-pulse",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-16 h-16 bg-secondary-text opacity-20 rounded"}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-1/2"})]}),s.jsx("div",{className:"w-20 h-8 bg-secondary-text opacity-20 rounded"})]})},ce))}):M.filter(T=>T.status==="Painted").length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("p",{className:"text-base text-secondary-text mb-4",children:"No painted models in your collection yet."}),s.jsx("button",{onClick:()=>w(!0),className:"btn-primary",children:"Add Your First Painted Model"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-3",children:Z.map(T=>{var ce,ot,lt,Mt;return s.jsx("div",{className:"bg-bg-card rounded-lg border border-border-custom p-4 hover:bg-bg-secondary transition-colors cursor-pointer",onClick:()=>ue(T),children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("img",{src:(()=>{var ct;if(T.image_url&&typeof T.image_url=="string"&&T.image_url.trim()!==""&&T.image_url!=="undefined"&&T.image_url!=="null"&&(T.image_url.startsWith("http")||T.image_url.startsWith("/")))return T.image_url;const He=(ct=T.game)==null?void 0:ct.image;return He&&typeof He=="string"&&He.trim()!==""&&He!=="undefined"&&He!=="null"&&He.startsWith("http")?He:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"})(),alt:T.name,className:"w-16 h-16 object-cover rounded",onError:He=>{const ct=He.target,Nt="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg";ct.src!==Nt&&(ct.src=Nt)}}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"text-lg font-semibold text-title truncate",children:T.name}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[(ce=T.game)!=null&&ce.icon?s.jsx("img",{src:T.game.icon,alt:`${T.game.name} icon`,className:"w-4 h-4 object-contain rounded",onError:He=>{const ct=He.target;ct.style.display="none";const Nt=ct.nextElementSibling;Nt&&Nt.classList.contains("icon-fallback")&&(Nt.style.display="flex")}}):null,s.jsx("div",{className:"w-4 h-4 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:(ot=T.game)!=null&&ot.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-xs font-bold",children:(((lt=T.game)==null?void 0:lt.name)||"Unknown Game").charAt(0)})}),s.jsx("span",{className:"text-sm text-secondary-text",children:((Mt=T.game)==null?void 0:Mt.name)||"Unknown Game"})]}),T.purchase_date&&s.jsxs("p",{className:"text-xs text-secondary-text mt-1",children:["Purchased: ",new Date(T.purchase_date).toLocaleDateString()]})]})]})},T.id)})}),ve>1&&s.jsx(ka,{currentPage:u,totalPages:ve,onPageChange:d})]})]}),i==="models"&&s.jsxs("section",{children:[M.length>0&&s.jsx("div",{className:"flex flex-col items-center mb-8",children:s.jsxs("button",{onClick:()=>j(!0),className:"btn-primary-sm btn-with-icon-sm",children:[s.jsx(kn,{className:"w-4 h-4"}),s.jsx("span",{children:"Add Model"})]})}),M.length>0&&s.jsx(Q0,{games:b,boxes:H,models:M,selectedBoxes:h.selectedBoxes,selectedGames:h.selectedGames,selectedStatuses:h.selectedStatuses,searchQuery:h.searchQuery,onBoxesChange:fe,onGamesChange:ie,onStatusesChange:ne,onSearchChange:I,onClearFilters:ae}),B?s.jsx("div",{className:"space-y-3",children:Array.from({length:6}).map((T,ce)=>s.jsx("div",{className:"bg-bg-card rounded-lg border border-border-custom p-4 animate-pulse",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-16 h-16 bg-secondary-text opacity-20 rounded"}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-1/2"})]}),s.jsx("div",{className:"w-20 h-8 bg-secondary-text opacity-20 rounded"})]})},ce))}):M.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("p",{className:"text-base text-secondary-text mb-4",children:"No models in your collection yet."}),s.jsx("button",{onClick:()=>j(!0),className:"btn-primary",children:"Add Your First Model"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-3",children:be.map(T=>{var ce,ot,lt,Mt,He,ct,Nt,wc,jc,kc,Nc,_c,Sc,Cc,Ec,Pc,Tc,Ic;return s.jsx("div",{className:"bg-bg-card rounded-lg border border-border-custom p-4 hover:bg-bg-secondary transition-colors cursor-pointer",onClick:()=>je(T),children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("img",{src:(()=>{var hn,Yt,Mc;if(T.image_url&&typeof T.image_url=="string"&&T.image_url.trim()!==""&&T.image_url!=="undefined"&&T.image_url!=="null"&&(T.image_url.startsWith("http")||T.image_url.startsWith("/")))return T.image_url;const At=((Yt=(hn=T.box)==null?void 0:hn.game)==null?void 0:Yt.image)||((Mc=T.game)==null?void 0:Mc.image);return At&&typeof At=="string"&&At.trim()!==""&&At!=="undefined"&&At!=="null"&&At.startsWith("http")?At:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"})(),alt:T.name,className:"w-16 h-16 object-cover rounded",onError:At=>{const hn=At.target,Yt="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg";hn.src!==Yt&&(hn.src=Yt)}}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"text-lg font-semibold text-title truncate",children:T.name}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[(ot=(ce=T.box)==null?void 0:ce.game)!=null&&ot.icon||(lt=T.game)!=null&&lt.icon?s.jsx("img",{src:((He=(Mt=T.box)==null?void 0:Mt.game)==null?void 0:He.icon)||((ct=T.game)==null?void 0:ct.icon),alt:`${((wc=(Nt=T.box)==null?void 0:Nt.game)==null?void 0:wc.name)||((jc=T.game)==null?void 0:jc.name)||"Unknown Game"} icon`,className:"w-4 h-4 object-contain rounded",onError:At=>{const hn=At.target;hn.style.display="none";const Yt=hn.nextElementSibling;Yt&&Yt.classList.contains("icon-fallback")&&(Yt.style.display="flex")}}):null,s.jsx("div",{className:"w-4 h-4 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:(Nc=(kc=T.box)==null?void 0:kc.game)!=null&&Nc.icon||(_c=T.game)!=null&&_c.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-xs font-bold",children:(((Cc=(Sc=T.box)==null?void 0:Sc.game)==null?void 0:Cc.name)||((Ec=T.game)==null?void 0:Ec.name)||"Unknown Game").charAt(0)})}),s.jsx("span",{className:"text-sm text-secondary-text",children:((Tc=(Pc=T.box)==null?void 0:Pc.game)==null?void 0:Tc.name)||((Ic=T.game)==null?void 0:Ic.name)||"Unknown Game"})]}),T.status!=="None"&&s.jsx("div",{className:"mt-1",children:s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${(()=>{switch(T.status){case"Painted":return"bg-green-100 text-green-800";case"Partially Painted":return"bg-yellow-100 text-yellow-800";case"Primed":return"bg-blue-100 text-blue-800";case"Assembled":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})()}`,children:T.status})})]})]})},T.id)})}),ge>1&&s.jsx(ka,{currentPage:l,totalPages:ge,onPageChange:c})]})]})]}),s.jsx(os,{activeTab:r,onTabChange:a}),s.jsx(dd,{isOpen:x.isOpen,onClose:()=>g({isOpen:!1,mode:"login"}),mode:x.mode}),s.jsx(j0,{isOpen:p,onClose:()=>j(!1),onSuccess:xe,preselectedBoxId:P}),s.jsx(k0,{isOpen:N,onClose:()=>w(!1),onSuccess:xe,onAddModelsToBox:Qt}),s.jsx(F0,{isOpen:D.isOpen,onClose:()=>K({isOpen:!1,model:null}),onModelDeleted:Ne,onModelUpdated:De,onViewBox:ue,model:D.model}),s.jsx(H0,{isOpen:Y.isOpen,onClose:()=>re({isOpen:!1,box:null}),onBoxDeleted:tt,onModelsUpdated:Jt,onViewModel:je,onAddNewModel:We,box:Y.box}),s.jsx(q0,{isOpen:C,onClose:()=>k(!1)})]}):s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(pr,{}),s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-16 text-center",children:s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm p-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-title mb-4",children:"Welcome to the Mini Myths App Beta"}),s.jsxs("p",{className:"text-xs text-secondary-text mb-2",children:["Last updated: ",fd().date," at ",fd().time]}),s.jsxs("p",{className:"text-base text-secondary-text mb-8",children:["Track your miniatures and book a table at your favourite gaming store.",s.jsx("br",{}),s.jsx("br",{}),"Make sure to report any bugs and issues on the Discord!"]}),s.jsxs("div",{className:"flex justify-center space-x-4",children:[s.jsx("button",{onClick:()=>g({isOpen:!0,mode:"login"}),className:"btn-secondary",children:"Log In"}),s.jsx("button",{onClick:()=>g({isOpen:!0,mode:"signup"}),className:"btn-primary",children:"Sign Up"})]})]})}),s.jsx(dd,{isOpen:x.isOpen,onClose:()=>g({isOpen:!1,mode:"login"}),mode:x.mode})]})}Cf(document.getElementById("root")).render(s.jsx(v.StrictMode,{children:s.jsx(ev,{})}));
