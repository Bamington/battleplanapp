(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var vt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ub(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var Hf={exports:{}},Io={},Wf={exports:{}},Te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zi=Symbol.for("react.element"),db=Symbol.for("react.portal"),hb=Symbol.for("react.fragment"),mb=Symbol.for("react.strict_mode"),fb=Symbol.for("react.profiler"),pb=Symbol.for("react.provider"),gb=Symbol.for("react.context"),xb=Symbol.for("react.forward_ref"),yb=Symbol.for("react.suspense"),bb=Symbol.for("react.memo"),vb=Symbol.for("react.lazy"),dh=Symbol.iterator;function wb(e){return e===null||typeof e!="object"?null:(e=dh&&e[dh]||e["@@iterator"],typeof e=="function"?e:null)}var Yf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Kf=Object.assign,Jf={};function Rs(e,t,n){this.props=e,this.context=t,this.refs=Jf,this.updater=n||Yf}Rs.prototype.isReactComponent={};Rs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Rs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Qf(){}Qf.prototype=Rs.prototype;function Tu(e,t,n){this.props=e,this.context=t,this.refs=Jf,this.updater=n||Yf}var Iu=Tu.prototype=new Qf;Iu.constructor=Tu;Kf(Iu,Rs.prototype);Iu.isPureReactComponent=!0;var hh=Array.isArray,Xf=Object.prototype.hasOwnProperty,Mu={current:null},Zf={key:!0,ref:!0,__self:!0,__source:!0};function ep(e,t,n){var r,i={},a=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)Xf.call(t,r)&&!Zf.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Zi,type:e,key:a,ref:o,props:i,_owner:Mu.current}}function jb(e,t){return{$$typeof:Zi,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Au(e){return typeof e=="object"&&e!==null&&e.$$typeof===Zi}function kb(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var mh=/\/+/g;function dl(e,t){return typeof e=="object"&&e!==null&&e.key!=null?kb(""+e.key):t.toString(36)}function Fa(e,t,n,r,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Zi:case db:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+dl(o,0):r,hh(i)?(n="",e!=null&&(n=e.replace(mh,"$&/")+"/"),Fa(i,t,n,"",function(u){return u})):i!=null&&(Au(i)&&(i=jb(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(mh,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",hh(e))for(var l=0;l<e.length;l++){a=e[l];var c=r+dl(a,l);o+=Fa(a,t,n,c,i)}else if(c=wb(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=r+dl(a,l++),o+=Fa(a,t,n,c,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function da(e,t,n){if(e==null)return e;var r=[],i=0;return Fa(e,r,"","",function(a){return t.call(n,a,i++)}),r}function Nb(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Et={current:null},$a={transition:null},Sb={ReactCurrentDispatcher:Et,ReactCurrentBatchConfig:$a,ReactCurrentOwner:Mu};function tp(){throw Error("act(...) is not supported in production builds of React.")}Te.Children={map:da,forEach:function(e,t,n){da(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return da(e,function(){t++}),t},toArray:function(e){return da(e,function(t){return t})||[]},only:function(e){if(!Au(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Te.Component=Rs;Te.Fragment=hb;Te.Profiler=fb;Te.PureComponent=Tu;Te.StrictMode=mb;Te.Suspense=yb;Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Sb;Te.act=tp;Te.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Kf({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=Mu.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Xf.call(t,c)&&!Zf.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Zi,type:e.type,key:i,ref:a,props:r,_owner:o}};Te.createContext=function(e){return e={$$typeof:gb,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:pb,_context:e},e.Consumer=e};Te.createElement=ep;Te.createFactory=function(e){var t=ep.bind(null,e);return t.type=e,t};Te.createRef=function(){return{current:null}};Te.forwardRef=function(e){return{$$typeof:xb,render:e}};Te.isValidElement=Au;Te.lazy=function(e){return{$$typeof:vb,_payload:{_status:-1,_result:e},_init:Nb}};Te.memo=function(e,t){return{$$typeof:bb,type:e,compare:t===void 0?null:t}};Te.startTransition=function(e){var t=$a.transition;$a.transition={};try{e()}finally{$a.transition=t}};Te.unstable_act=tp;Te.useCallback=function(e,t){return Et.current.useCallback(e,t)};Te.useContext=function(e){return Et.current.useContext(e)};Te.useDebugValue=function(){};Te.useDeferredValue=function(e){return Et.current.useDeferredValue(e)};Te.useEffect=function(e,t){return Et.current.useEffect(e,t)};Te.useId=function(){return Et.current.useId()};Te.useImperativeHandle=function(e,t,n){return Et.current.useImperativeHandle(e,t,n)};Te.useInsertionEffect=function(e,t){return Et.current.useInsertionEffect(e,t)};Te.useLayoutEffect=function(e,t){return Et.current.useLayoutEffect(e,t)};Te.useMemo=function(e,t){return Et.current.useMemo(e,t)};Te.useReducer=function(e,t,n){return Et.current.useReducer(e,t,n)};Te.useRef=function(e){return Et.current.useRef(e)};Te.useState=function(e){return Et.current.useState(e)};Te.useSyncExternalStore=function(e,t,n){return Et.current.useSyncExternalStore(e,t,n)};Te.useTransition=function(){return Et.current.useTransition()};Te.version="18.3.1";Wf.exports=Te;var j=Wf.exports;const Ne=Pu(j);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _b=j,Cb=Symbol.for("react.element"),Eb=Symbol.for("react.fragment"),Pb=Object.prototype.hasOwnProperty,Tb=_b.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ib={key:!0,ref:!0,__self:!0,__source:!0};function np(e,t,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)Pb.call(t,r)&&!Ib.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:Cb,type:e,key:a,ref:o,props:i,_owner:Tb.current}}Io.Fragment=Eb;Io.jsx=np;Io.jsxs=np;Hf.exports=Io;var s=Hf.exports,rp={exports:{}},Yt={},sp={exports:{}},ip={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(F,B){var _=F.length;F.push(B);e:for(;0<_;){var z=_-1>>>1,q=F[z];if(0<i(q,B))F[z]=B,F[_]=q,_=z;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var B=F[0],_=F.pop();if(_!==B){F[0]=_;e:for(var z=0,q=F.length,E=q>>>1;z<E;){var K=2*(z+1)-1,G=F[K],W=K+1,le=F[W];if(0>i(G,_))W<q&&0>i(le,G)?(F[z]=le,F[W]=_,z=W):(F[z]=G,F[K]=_,z=K);else if(W<q&&0>i(le,_))F[z]=le,F[W]=_,z=W;else break e}}return B}function i(F,B){var _=F.sortIndex-B.sortIndex;return _!==0?_:F.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,m=!1,p=!1,y=!1,S=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(F){for(var B=n(u);B!==null;){if(B.callback===null)r(u);else if(B.startTime<=F)r(u),B.sortIndex=B.expirationTime,t(c,B);else break;B=n(u)}}function k(F){if(y=!1,x(F),!p)if(n(c)!==null)p=!0,U(N);else{var B=n(u);B!==null&&H(k,B.startTime-F)}}function N(F,B){p=!1,y&&(y=!1,g(T),T=-1),m=!0;var _=f;try{for(x(B),d=n(c);d!==null&&(!(d.expirationTime>B)||F&&!P());){var z=d.callback;if(typeof z=="function"){d.callback=null,f=d.priorityLevel;var q=z(d.expirationTime<=B);B=e.unstable_now(),typeof q=="function"?d.callback=q:d===n(c)&&r(c),x(B)}else r(c);d=n(c)}if(d!==null)var E=!0;else{var K=n(u);K!==null&&H(k,K.startTime-B),E=!1}return E}finally{d=null,f=_,m=!1}}var w=!1,C=null,T=-1,I=5,v=-1;function P(){return!(e.unstable_now()-v<I)}function A(){if(C!==null){var F=e.unstable_now();v=F;var B=!0;try{B=C(!0,F)}finally{B?L():(w=!1,C=null)}}else w=!1}var L;if(typeof b=="function")L=function(){b(A)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,M=O.port2;O.port1.onmessage=A,L=function(){M.postMessage(null)}}else L=function(){S(A,0)};function U(F){C=F,w||(w=!0,L())}function H(F,B){T=S(function(){F(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){p||m||(p=!0,U(N))},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(F){switch(f){case 1:case 2:case 3:var B=3;break;default:B=f}var _=f;f=B;try{return F()}finally{f=_}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,B){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var _=f;f=F;try{return B()}finally{f=_}},e.unstable_scheduleCallback=function(F,B,_){var z=e.unstable_now();switch(typeof _=="object"&&_!==null?(_=_.delay,_=typeof _=="number"&&0<_?z+_:z):_=z,F){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=_+q,F={id:h++,callback:B,priorityLevel:F,startTime:_,expirationTime:q,sortIndex:-1},_>z?(F.sortIndex=_,t(u,F),n(c)===null&&F===n(u)&&(y?(g(T),T=-1):y=!0,H(k,_-z))):(F.sortIndex=q,t(c,F),p||m||(p=!0,U(N))),F},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(F){var B=f;return function(){var _=f;f=B;try{return F.apply(this,arguments)}finally{f=_}}}})(ip);sp.exports=ip;var Mb=sp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ab=j,Wt=Mb;function Z(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ap=new Set,Pi={};function Gr(e,t){Es(e,t),Es(e+"Capture",t)}function Es(e,t){for(Pi[e]=t,e=0;e<t.length;e++)ap.add(t[e])}var zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),oc=Object.prototype.hasOwnProperty,Lb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fh={},ph={};function Db(e){return oc.call(ph,e)?!0:oc.call(fh,e)?!1:Lb.test(e)?ph[e]=!0:(fh[e]=!0,!1)}function Ob(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Rb(e,t,n,r){if(t===null||typeof t>"u"||Ob(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Pt(e,t,n,r,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var pt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){pt[e]=new Pt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];pt[t]=new Pt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){pt[e]=new Pt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){pt[e]=new Pt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){pt[e]=new Pt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){pt[e]=new Pt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){pt[e]=new Pt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){pt[e]=new Pt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){pt[e]=new Pt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Lu=/[\-:]([a-z])/g;function Du(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Lu,Du);pt[t]=new Pt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Lu,Du);pt[t]=new Pt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Lu,Du);pt[t]=new Pt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){pt[e]=new Pt(e,1,!1,e.toLowerCase(),null,!1,!1)});pt.xlinkHref=new Pt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){pt[e]=new Pt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ou(e,t,n,r){var i=pt.hasOwnProperty(t)?pt[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Rb(t,n,i,r)&&(n=null),r||i===null?Db(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Gn=Ab.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ha=Symbol.for("react.element"),os=Symbol.for("react.portal"),ls=Symbol.for("react.fragment"),Ru=Symbol.for("react.strict_mode"),lc=Symbol.for("react.profiler"),op=Symbol.for("react.provider"),lp=Symbol.for("react.context"),Fu=Symbol.for("react.forward_ref"),cc=Symbol.for("react.suspense"),uc=Symbol.for("react.suspense_list"),$u=Symbol.for("react.memo"),Zn=Symbol.for("react.lazy"),cp=Symbol.for("react.offscreen"),gh=Symbol.iterator;function Ks(e){return e===null||typeof e!="object"?null:(e=gh&&e[gh]||e["@@iterator"],typeof e=="function"?e:null)}var Je=Object.assign,hl;function ai(e){if(hl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);hl=t&&t[1]||""}return`
`+hl+e}var ml=!1;function fl(e,t){if(!e||ml)return"";ml=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{ml=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ai(e):""}function Fb(e){switch(e.tag){case 5:return ai(e.type);case 16:return ai("Lazy");case 13:return ai("Suspense");case 19:return ai("SuspenseList");case 0:case 2:case 15:return e=fl(e.type,!1),e;case 11:return e=fl(e.type.render,!1),e;case 1:return e=fl(e.type,!0),e;default:return""}}function dc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ls:return"Fragment";case os:return"Portal";case lc:return"Profiler";case Ru:return"StrictMode";case cc:return"Suspense";case uc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case lp:return(e.displayName||"Context")+".Consumer";case op:return(e._context.displayName||"Context")+".Provider";case Fu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case $u:return t=e.displayName||null,t!==null?t:dc(e.type)||"Memo";case Zn:t=e._payload,e=e._init;try{return dc(e(t))}catch{}}return null}function $b(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return dc(t);case 8:return t===Ru?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function gr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function up(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function zb(e){var t=up(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ma(e){e._valueTracker||(e._valueTracker=zb(e))}function dp(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=up(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function hc(e,t){var n=t.checked;return Je({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function xh(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=gr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function hp(e,t){t=t.checked,t!=null&&Ou(e,"checked",t,!1)}function mc(e,t){hp(e,t);var n=gr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?fc(e,t.type,n):t.hasOwnProperty("defaultValue")&&fc(e,t.type,gr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function yh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function fc(e,t,n){(t!=="number"||Xa(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var oi=Array.isArray;function bs(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+gr(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function pc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Z(91));return Je({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function bh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Z(92));if(oi(n)){if(1<n.length)throw Error(Z(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:gr(n)}}function mp(e,t){var n=gr(t.value),r=gr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function vh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function fp(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?fp(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var fa,pp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(fa=fa||document.createElement("div"),fa.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=fa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ti(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var di={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Bb=["Webkit","ms","Moz","O"];Object.keys(di).forEach(function(e){Bb.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),di[t]=di[e]})});function gp(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||di.hasOwnProperty(e)&&di[e]?(""+t).trim():t+"px"}function xp(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=gp(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var Ub=Je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xc(e,t){if(t){if(Ub[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Z(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Z(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Z(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Z(62))}}function yc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bc=null;function zu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vc=null,vs=null,ws=null;function wh(e){if(e=na(e)){if(typeof vc!="function")throw Error(Z(280));var t=e.stateNode;t&&(t=Oo(t),vc(e.stateNode,e.type,t))}}function yp(e){vs?ws?ws.push(e):ws=[e]:vs=e}function bp(){if(vs){var e=vs,t=ws;if(ws=vs=null,wh(e),t)for(e=0;e<t.length;e++)wh(t[e])}}function vp(e,t){return e(t)}function wp(){}var pl=!1;function jp(e,t,n){if(pl)return e(t,n);pl=!0;try{return vp(e,t,n)}finally{pl=!1,(vs!==null||ws!==null)&&(wp(),bp())}}function Ii(e,t){var n=e.stateNode;if(n===null)return null;var r=Oo(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Z(231,t,typeof n));return n}var wc=!1;if(zn)try{var Js={};Object.defineProperty(Js,"passive",{get:function(){wc=!0}}),window.addEventListener("test",Js,Js),window.removeEventListener("test",Js,Js)}catch{wc=!1}function Vb(e,t,n,r,i,a,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(h){this.onError(h)}}var hi=!1,Za=null,eo=!1,jc=null,qb={onError:function(e){hi=!0,Za=e}};function Gb(e,t,n,r,i,a,o,l,c){hi=!1,Za=null,Vb.apply(qb,arguments)}function Hb(e,t,n,r,i,a,o,l,c){if(Gb.apply(this,arguments),hi){if(hi){var u=Za;hi=!1,Za=null}else throw Error(Z(198));eo||(eo=!0,jc=u)}}function Hr(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function kp(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function jh(e){if(Hr(e)!==e)throw Error(Z(188))}function Wb(e){var t=e.alternate;if(!t){if(t=Hr(e),t===null)throw Error(Z(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return jh(i),e;if(a===r)return jh(i),t;a=a.sibling}throw Error(Z(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(Z(189))}}if(n.alternate!==r)throw Error(Z(190))}if(n.tag!==3)throw Error(Z(188));return n.stateNode.current===n?e:t}function Np(e){return e=Wb(e),e!==null?Sp(e):null}function Sp(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Sp(e);if(t!==null)return t;e=e.sibling}return null}var _p=Wt.unstable_scheduleCallback,kh=Wt.unstable_cancelCallback,Yb=Wt.unstable_shouldYield,Kb=Wt.unstable_requestPaint,Ze=Wt.unstable_now,Jb=Wt.unstable_getCurrentPriorityLevel,Bu=Wt.unstable_ImmediatePriority,Cp=Wt.unstable_UserBlockingPriority,to=Wt.unstable_NormalPriority,Qb=Wt.unstable_LowPriority,Ep=Wt.unstable_IdlePriority,Mo=null,_n=null;function Xb(e){if(_n&&typeof _n.onCommitFiberRoot=="function")try{_n.onCommitFiberRoot(Mo,e,void 0,(e.current.flags&128)===128)}catch{}}var fn=Math.clz32?Math.clz32:t0,Zb=Math.log,e0=Math.LN2;function t0(e){return e>>>=0,e===0?32:31-(Zb(e)/e0|0)|0}var pa=64,ga=4194304;function li(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function no(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=li(l):(a&=o,a!==0&&(r=li(a)))}else o=n&~i,o!==0?r=li(o):a!==0&&(r=li(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-fn(t),i=1<<n,r|=e[n],t&=~i;return r}function n0(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function r0(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-fn(a),l=1<<o,c=i[o];c===-1?(!(l&n)||l&r)&&(i[o]=n0(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function kc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Pp(){var e=pa;return pa<<=1,!(pa&4194240)&&(pa=64),e}function gl(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ea(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-fn(t),e[t]=n}function s0(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-fn(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}function Uu(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-fn(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var De=0;function Tp(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ip,Vu,Mp,Ap,Lp,Nc=!1,xa=[],or=null,lr=null,cr=null,Mi=new Map,Ai=new Map,nr=[],i0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nh(e,t){switch(e){case"focusin":case"focusout":or=null;break;case"dragenter":case"dragleave":lr=null;break;case"mouseover":case"mouseout":cr=null;break;case"pointerover":case"pointerout":Mi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ai.delete(t.pointerId)}}function Qs(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=na(t),t!==null&&Vu(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function a0(e,t,n,r,i){switch(t){case"focusin":return or=Qs(or,e,t,n,r,i),!0;case"dragenter":return lr=Qs(lr,e,t,n,r,i),!0;case"mouseover":return cr=Qs(cr,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Mi.set(a,Qs(Mi.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Ai.set(a,Qs(Ai.get(a)||null,e,t,n,r,i)),!0}return!1}function Dp(e){var t=Lr(e.target);if(t!==null){var n=Hr(t);if(n!==null){if(t=n.tag,t===13){if(t=kp(n),t!==null){e.blockedOn=t,Lp(e.priority,function(){Mp(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function za(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Sc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);bc=r,n.target.dispatchEvent(r),bc=null}else return t=na(n),t!==null&&Vu(t),e.blockedOn=n,!1;t.shift()}return!0}function Sh(e,t,n){za(e)&&n.delete(t)}function o0(){Nc=!1,or!==null&&za(or)&&(or=null),lr!==null&&za(lr)&&(lr=null),cr!==null&&za(cr)&&(cr=null),Mi.forEach(Sh),Ai.forEach(Sh)}function Xs(e,t){e.blockedOn===t&&(e.blockedOn=null,Nc||(Nc=!0,Wt.unstable_scheduleCallback(Wt.unstable_NormalPriority,o0)))}function Li(e){function t(i){return Xs(i,e)}if(0<xa.length){Xs(xa[0],e);for(var n=1;n<xa.length;n++){var r=xa[n];r.blockedOn===e&&(r.blockedOn=null)}}for(or!==null&&Xs(or,e),lr!==null&&Xs(lr,e),cr!==null&&Xs(cr,e),Mi.forEach(t),Ai.forEach(t),n=0;n<nr.length;n++)r=nr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<nr.length&&(n=nr[0],n.blockedOn===null);)Dp(n),n.blockedOn===null&&nr.shift()}var js=Gn.ReactCurrentBatchConfig,ro=!0;function l0(e,t,n,r){var i=De,a=js.transition;js.transition=null;try{De=1,qu(e,t,n,r)}finally{De=i,js.transition=a}}function c0(e,t,n,r){var i=De,a=js.transition;js.transition=null;try{De=4,qu(e,t,n,r)}finally{De=i,js.transition=a}}function qu(e,t,n,r){if(ro){var i=Sc(e,t,n,r);if(i===null)_l(e,t,r,so,n),Nh(e,r);else if(a0(i,e,t,n,r))r.stopPropagation();else if(Nh(e,r),t&4&&-1<i0.indexOf(e)){for(;i!==null;){var a=na(i);if(a!==null&&Ip(a),a=Sc(e,t,n,r),a===null&&_l(e,t,r,so,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else _l(e,t,r,null,n)}}var so=null;function Sc(e,t,n,r){if(so=null,e=zu(r),e=Lr(e),e!==null)if(t=Hr(e),t===null)e=null;else if(n=t.tag,n===13){if(e=kp(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return so=e,null}function Op(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Jb()){case Bu:return 1;case Cp:return 4;case to:case Qb:return 16;case Ep:return 536870912;default:return 16}default:return 16}}var ir=null,Gu=null,Ba=null;function Rp(){if(Ba)return Ba;var e,t=Gu,n=t.length,r,i="value"in ir?ir.value:ir.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[a-r];r++);return Ba=i.slice(e,1<r?1-r:void 0)}function Ua(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ya(){return!0}function _h(){return!1}function Kt(e){function t(n,r,i,a,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?ya:_h,this.isPropagationStopped=_h,this}return Je(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ya)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ya)},persist:function(){},isPersistent:ya}),t}var Fs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hu=Kt(Fs),ta=Je({},Fs,{view:0,detail:0}),u0=Kt(ta),xl,yl,Zs,Ao=Je({},ta,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zs&&(Zs&&e.type==="mousemove"?(xl=e.screenX-Zs.screenX,yl=e.screenY-Zs.screenY):yl=xl=0,Zs=e),xl)},movementY:function(e){return"movementY"in e?e.movementY:yl}}),Ch=Kt(Ao),d0=Je({},Ao,{dataTransfer:0}),h0=Kt(d0),m0=Je({},ta,{relatedTarget:0}),bl=Kt(m0),f0=Je({},Fs,{animationName:0,elapsedTime:0,pseudoElement:0}),p0=Kt(f0),g0=Je({},Fs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),x0=Kt(g0),y0=Je({},Fs,{data:0}),Eh=Kt(y0),b0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},v0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},w0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function j0(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=w0[e])?!!t[e]:!1}function Wu(){return j0}var k0=Je({},ta,{key:function(e){if(e.key){var t=b0[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ua(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?v0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wu,charCode:function(e){return e.type==="keypress"?Ua(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ua(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),N0=Kt(k0),S0=Je({},Ao,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ph=Kt(S0),_0=Je({},ta,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wu}),C0=Kt(_0),E0=Je({},Fs,{propertyName:0,elapsedTime:0,pseudoElement:0}),P0=Kt(E0),T0=Je({},Ao,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),I0=Kt(T0),M0=[9,13,27,32],Yu=zn&&"CompositionEvent"in window,mi=null;zn&&"documentMode"in document&&(mi=document.documentMode);var A0=zn&&"TextEvent"in window&&!mi,Fp=zn&&(!Yu||mi&&8<mi&&11>=mi),Th=" ",Ih=!1;function $p(e,t){switch(e){case"keyup":return M0.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var cs=!1;function L0(e,t){switch(e){case"compositionend":return zp(t);case"keypress":return t.which!==32?null:(Ih=!0,Th);case"textInput":return e=t.data,e===Th&&Ih?null:e;default:return null}}function D0(e,t){if(cs)return e==="compositionend"||!Yu&&$p(e,t)?(e=Rp(),Ba=Gu=ir=null,cs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fp&&t.locale!=="ko"?null:t.data;default:return null}}var O0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!O0[e.type]:t==="textarea"}function Bp(e,t,n,r){yp(r),t=io(t,"onChange"),0<t.length&&(n=new Hu("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var fi=null,Di=null;function R0(e){Xp(e,0)}function Lo(e){var t=hs(e);if(dp(t))return e}function F0(e,t){if(e==="change")return t}var Up=!1;if(zn){var vl;if(zn){var wl="oninput"in document;if(!wl){var Ah=document.createElement("div");Ah.setAttribute("oninput","return;"),wl=typeof Ah.oninput=="function"}vl=wl}else vl=!1;Up=vl&&(!document.documentMode||9<document.documentMode)}function Lh(){fi&&(fi.detachEvent("onpropertychange",Vp),Di=fi=null)}function Vp(e){if(e.propertyName==="value"&&Lo(Di)){var t=[];Bp(t,Di,e,zu(e)),jp(R0,t)}}function $0(e,t,n){e==="focusin"?(Lh(),fi=t,Di=n,fi.attachEvent("onpropertychange",Vp)):e==="focusout"&&Lh()}function z0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Lo(Di)}function B0(e,t){if(e==="click")return Lo(t)}function U0(e,t){if(e==="input"||e==="change")return Lo(t)}function V0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var xn=typeof Object.is=="function"?Object.is:V0;function Oi(e,t){if(xn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!oc.call(t,i)||!xn(e[i],t[i]))return!1}return!0}function Dh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Oh(e,t){var n=Dh(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Dh(n)}}function qp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?qp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Gp(){for(var e=window,t=Xa();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Xa(e.document)}return t}function Ku(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function q0(e){var t=Gp(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&qp(n.ownerDocument.documentElement,n)){if(r!==null&&Ku(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=Oh(n,a);var o=Oh(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var G0=zn&&"documentMode"in document&&11>=document.documentMode,us=null,_c=null,pi=null,Cc=!1;function Rh(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Cc||us==null||us!==Xa(r)||(r=us,"selectionStart"in r&&Ku(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),pi&&Oi(pi,r)||(pi=r,r=io(_c,"onSelect"),0<r.length&&(t=new Hu("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=us)))}function ba(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ds={animationend:ba("Animation","AnimationEnd"),animationiteration:ba("Animation","AnimationIteration"),animationstart:ba("Animation","AnimationStart"),transitionend:ba("Transition","TransitionEnd")},jl={},Hp={};zn&&(Hp=document.createElement("div").style,"AnimationEvent"in window||(delete ds.animationend.animation,delete ds.animationiteration.animation,delete ds.animationstart.animation),"TransitionEvent"in window||delete ds.transitionend.transition);function Do(e){if(jl[e])return jl[e];if(!ds[e])return e;var t=ds[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Hp)return jl[e]=t[n];return e}var Wp=Do("animationend"),Yp=Do("animationiteration"),Kp=Do("animationstart"),Jp=Do("transitionend"),Qp=new Map,Fh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yr(e,t){Qp.set(e,t),Gr(t,[e])}for(var kl=0;kl<Fh.length;kl++){var Nl=Fh[kl],H0=Nl.toLowerCase(),W0=Nl[0].toUpperCase()+Nl.slice(1);yr(H0,"on"+W0)}yr(Wp,"onAnimationEnd");yr(Yp,"onAnimationIteration");yr(Kp,"onAnimationStart");yr("dblclick","onDoubleClick");yr("focusin","onFocus");yr("focusout","onBlur");yr(Jp,"onTransitionEnd");Es("onMouseEnter",["mouseout","mouseover"]);Es("onMouseLeave",["mouseout","mouseover"]);Es("onPointerEnter",["pointerout","pointerover"]);Es("onPointerLeave",["pointerout","pointerover"]);Gr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Gr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Gr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Gr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Gr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Gr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ci="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Y0=new Set("cancel close invalid load scroll toggle".split(" ").concat(ci));function $h(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Hb(r,t,void 0,e),e.currentTarget=null}function Xp(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&i.isPropagationStopped())break e;$h(i,l,u),a=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&i.isPropagationStopped())break e;$h(i,l,u),a=c}}}if(eo)throw e=jc,eo=!1,jc=null,e}function Ve(e,t){var n=t[Mc];n===void 0&&(n=t[Mc]=new Set);var r=e+"__bubble";n.has(r)||(Zp(t,e,2,!1),n.add(r))}function Sl(e,t,n){var r=0;t&&(r|=4),Zp(n,e,r,t)}var va="_reactListening"+Math.random().toString(36).slice(2);function Ri(e){if(!e[va]){e[va]=!0,ap.forEach(function(n){n!=="selectionchange"&&(Y0.has(n)||Sl(n,!1,e),Sl(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[va]||(t[va]=!0,Sl("selectionchange",!1,t))}}function Zp(e,t,n,r){switch(Op(t)){case 1:var i=l0;break;case 4:i=c0;break;default:i=qu}n=i.bind(null,t,n,e),i=void 0,!wc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function _l(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Lr(l),o===null)return;if(c=o.tag,c===5||c===6){r=a=o;continue e}l=l.parentNode}}r=r.return}jp(function(){var u=a,h=zu(n),d=[];e:{var f=Qp.get(e);if(f!==void 0){var m=Hu,p=e;switch(e){case"keypress":if(Ua(n)===0)break e;case"keydown":case"keyup":m=N0;break;case"focusin":p="focus",m=bl;break;case"focusout":p="blur",m=bl;break;case"beforeblur":case"afterblur":m=bl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Ch;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=h0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=C0;break;case Wp:case Yp:case Kp:m=p0;break;case Jp:m=P0;break;case"scroll":m=u0;break;case"wheel":m=I0;break;case"copy":case"cut":case"paste":m=x0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Ph}var y=(t&4)!==0,S=!y&&e==="scroll",g=y?f!==null?f+"Capture":null:f;y=[];for(var b=u,x;b!==null;){x=b;var k=x.stateNode;if(x.tag===5&&k!==null&&(x=k,g!==null&&(k=Ii(b,g),k!=null&&y.push(Fi(b,k,x)))),S)break;b=b.return}0<y.length&&(f=new m(f,p,null,n,h),d.push({event:f,listeners:y}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",f&&n!==bc&&(p=n.relatedTarget||n.fromElement)&&(Lr(p)||p[Bn]))break e;if((m||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,m?(p=n.relatedTarget||n.toElement,m=u,p=p?Lr(p):null,p!==null&&(S=Hr(p),p!==S||p.tag!==5&&p.tag!==6)&&(p=null)):(m=null,p=u),m!==p)){if(y=Ch,k="onMouseLeave",g="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(y=Ph,k="onPointerLeave",g="onPointerEnter",b="pointer"),S=m==null?f:hs(m),x=p==null?f:hs(p),f=new y(k,b+"leave",m,n,h),f.target=S,f.relatedTarget=x,k=null,Lr(h)===u&&(y=new y(g,b+"enter",p,n,h),y.target=x,y.relatedTarget=S,k=y),S=k,m&&p)t:{for(y=m,g=p,b=0,x=y;x;x=Qr(x))b++;for(x=0,k=g;k;k=Qr(k))x++;for(;0<b-x;)y=Qr(y),b--;for(;0<x-b;)g=Qr(g),x--;for(;b--;){if(y===g||g!==null&&y===g.alternate)break t;y=Qr(y),g=Qr(g)}y=null}else y=null;m!==null&&zh(d,f,m,y,!1),p!==null&&S!==null&&zh(d,S,p,y,!0)}}e:{if(f=u?hs(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var N=F0;else if(Mh(f))if(Up)N=U0;else{N=z0;var w=$0}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(N=B0);if(N&&(N=N(e,u))){Bp(d,N,n,h);break e}w&&w(e,f,u),e==="focusout"&&(w=f._wrapperState)&&w.controlled&&f.type==="number"&&fc(f,"number",f.value)}switch(w=u?hs(u):window,e){case"focusin":(Mh(w)||w.contentEditable==="true")&&(us=w,_c=u,pi=null);break;case"focusout":pi=_c=us=null;break;case"mousedown":Cc=!0;break;case"contextmenu":case"mouseup":case"dragend":Cc=!1,Rh(d,n,h);break;case"selectionchange":if(G0)break;case"keydown":case"keyup":Rh(d,n,h)}var C;if(Yu)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else cs?$p(e,n)&&(T="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(Fp&&n.locale!=="ko"&&(cs||T!=="onCompositionStart"?T==="onCompositionEnd"&&cs&&(C=Rp()):(ir=h,Gu="value"in ir?ir.value:ir.textContent,cs=!0)),w=io(u,T),0<w.length&&(T=new Eh(T,e,null,n,h),d.push({event:T,listeners:w}),C?T.data=C:(C=zp(n),C!==null&&(T.data=C)))),(C=A0?L0(e,n):D0(e,n))&&(u=io(u,"onBeforeInput"),0<u.length&&(h=new Eh("onBeforeInput","beforeinput",null,n,h),d.push({event:h,listeners:u}),h.data=C))}Xp(d,t)})}function Fi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function io(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Ii(e,n),a!=null&&r.unshift(Fi(e,a,i)),a=Ii(e,t),a!=null&&r.push(Fi(e,a,i))),e=e.return}return r}function Qr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function zh(e,t,n,r,i){for(var a=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,i?(c=Ii(n,a),c!=null&&o.unshift(Fi(n,c,l))):i||(c=Ii(n,a),c!=null&&o.push(Fi(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var K0=/\r\n?/g,J0=/\u0000|\uFFFD/g;function Bh(e){return(typeof e=="string"?e:""+e).replace(K0,`
`).replace(J0,"")}function wa(e,t,n){if(t=Bh(t),Bh(e)!==t&&n)throw Error(Z(425))}function ao(){}var Ec=null,Pc=null;function Tc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ic=typeof setTimeout=="function"?setTimeout:void 0,Q0=typeof clearTimeout=="function"?clearTimeout:void 0,Uh=typeof Promise=="function"?Promise:void 0,X0=typeof queueMicrotask=="function"?queueMicrotask:typeof Uh<"u"?function(e){return Uh.resolve(null).then(e).catch(Z0)}:Ic;function Z0(e){setTimeout(function(){throw e})}function Cl(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),Li(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Li(t)}function ur(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Vh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var $s=Math.random().toString(36).slice(2),Sn="__reactFiber$"+$s,$i="__reactProps$"+$s,Bn="__reactContainer$"+$s,Mc="__reactEvents$"+$s,ev="__reactListeners$"+$s,tv="__reactHandles$"+$s;function Lr(e){var t=e[Sn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Bn]||n[Sn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Vh(e);e!==null;){if(n=e[Sn])return n;e=Vh(e)}return t}e=n,n=e.parentNode}return null}function na(e){return e=e[Sn]||e[Bn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function hs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Z(33))}function Oo(e){return e[$i]||null}var Ac=[],ms=-1;function br(e){return{current:e}}function qe(e){0>ms||(e.current=Ac[ms],Ac[ms]=null,ms--)}function Be(e,t){ms++,Ac[ms]=e.current,e.current=t}var xr={},wt=br(xr),Ot=br(!1),$r=xr;function Ps(e,t){var n=e.type.contextTypes;if(!n)return xr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Rt(e){return e=e.childContextTypes,e!=null}function oo(){qe(Ot),qe(wt)}function qh(e,t,n){if(wt.current!==xr)throw Error(Z(168));Be(wt,t),Be(Ot,n)}function eg(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(Z(108,$b(e)||"Unknown",i));return Je({},n,r)}function lo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||xr,$r=wt.current,Be(wt,e),Be(Ot,Ot.current),!0}function Gh(e,t,n){var r=e.stateNode;if(!r)throw Error(Z(169));n?(e=eg(e,t,$r),r.__reactInternalMemoizedMergedChildContext=e,qe(Ot),qe(wt),Be(wt,e)):qe(Ot),Be(Ot,n)}var On=null,Ro=!1,El=!1;function tg(e){On===null?On=[e]:On.push(e)}function nv(e){Ro=!0,tg(e)}function vr(){if(!El&&On!==null){El=!0;var e=0,t=De;try{var n=On;for(De=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}On=null,Ro=!1}catch(i){throw On!==null&&(On=On.slice(e+1)),_p(Bu,vr),i}finally{De=t,El=!1}}return null}var fs=[],ps=0,co=null,uo=0,Qt=[],Xt=0,zr=null,Rn=1,Fn="";function Pr(e,t){fs[ps++]=uo,fs[ps++]=co,co=e,uo=t}function ng(e,t,n){Qt[Xt++]=Rn,Qt[Xt++]=Fn,Qt[Xt++]=zr,zr=e;var r=Rn;e=Fn;var i=32-fn(r)-1;r&=~(1<<i),n+=1;var a=32-fn(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Rn=1<<32-fn(t)+i|n<<i|r,Fn=a+e}else Rn=1<<a|n<<i|r,Fn=e}function Ju(e){e.return!==null&&(Pr(e,1),ng(e,1,0))}function Qu(e){for(;e===co;)co=fs[--ps],fs[ps]=null,uo=fs[--ps],fs[ps]=null;for(;e===zr;)zr=Qt[--Xt],Qt[Xt]=null,Fn=Qt[--Xt],Qt[Xt]=null,Rn=Qt[--Xt],Qt[Xt]=null}var Gt=null,qt=null,We=!1,mn=null;function rg(e,t){var n=en(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Hh(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Gt=e,qt=ur(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Gt=e,qt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=zr!==null?{id:Rn,overflow:Fn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=en(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Gt=e,qt=null,!0):!1;default:return!1}}function Lc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Dc(e){if(We){var t=qt;if(t){var n=t;if(!Hh(e,t)){if(Lc(e))throw Error(Z(418));t=ur(n.nextSibling);var r=Gt;t&&Hh(e,t)?rg(r,n):(e.flags=e.flags&-4097|2,We=!1,Gt=e)}}else{if(Lc(e))throw Error(Z(418));e.flags=e.flags&-4097|2,We=!1,Gt=e}}}function Wh(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Gt=e}function ja(e){if(e!==Gt)return!1;if(!We)return Wh(e),We=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Tc(e.type,e.memoizedProps)),t&&(t=qt)){if(Lc(e))throw sg(),Error(Z(418));for(;t;)rg(e,t),t=ur(t.nextSibling)}if(Wh(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Z(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){qt=ur(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}qt=null}}else qt=Gt?ur(e.stateNode.nextSibling):null;return!0}function sg(){for(var e=qt;e;)e=ur(e.nextSibling)}function Ts(){qt=Gt=null,We=!1}function Xu(e){mn===null?mn=[e]:mn.push(e)}var rv=Gn.ReactCurrentBatchConfig;function ei(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Z(309));var r=n.stateNode}if(!r)throw Error(Z(147,e));var i=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(Z(284));if(!n._owner)throw Error(Z(290,e))}return e}function ka(e,t){throw e=Object.prototype.toString.call(t),Error(Z(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yh(e){var t=e._init;return t(e._payload)}function ig(e){function t(g,b){if(e){var x=g.deletions;x===null?(g.deletions=[b],g.flags|=16):x.push(b)}}function n(g,b){if(!e)return null;for(;b!==null;)t(g,b),b=b.sibling;return null}function r(g,b){for(g=new Map;b!==null;)b.key!==null?g.set(b.key,b):g.set(b.index,b),b=b.sibling;return g}function i(g,b){return g=fr(g,b),g.index=0,g.sibling=null,g}function a(g,b,x){return g.index=x,e?(x=g.alternate,x!==null?(x=x.index,x<b?(g.flags|=2,b):x):(g.flags|=2,b)):(g.flags|=1048576,b)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function l(g,b,x,k){return b===null||b.tag!==6?(b=Dl(x,g.mode,k),b.return=g,b):(b=i(b,x),b.return=g,b)}function c(g,b,x,k){var N=x.type;return N===ls?h(g,b,x.props.children,k,x.key):b!==null&&(b.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Zn&&Yh(N)===b.type)?(k=i(b,x.props),k.ref=ei(g,b,x),k.return=g,k):(k=Ka(x.type,x.key,x.props,null,g.mode,k),k.ref=ei(g,b,x),k.return=g,k)}function u(g,b,x,k){return b===null||b.tag!==4||b.stateNode.containerInfo!==x.containerInfo||b.stateNode.implementation!==x.implementation?(b=Ol(x,g.mode,k),b.return=g,b):(b=i(b,x.children||[]),b.return=g,b)}function h(g,b,x,k,N){return b===null||b.tag!==7?(b=Fr(x,g.mode,k,N),b.return=g,b):(b=i(b,x),b.return=g,b)}function d(g,b,x){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Dl(""+b,g.mode,x),b.return=g,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ha:return x=Ka(b.type,b.key,b.props,null,g.mode,x),x.ref=ei(g,null,b),x.return=g,x;case os:return b=Ol(b,g.mode,x),b.return=g,b;case Zn:var k=b._init;return d(g,k(b._payload),x)}if(oi(b)||Ks(b))return b=Fr(b,g.mode,x,null),b.return=g,b;ka(g,b)}return null}function f(g,b,x,k){var N=b!==null?b.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return N!==null?null:l(g,b,""+x,k);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ha:return x.key===N?c(g,b,x,k):null;case os:return x.key===N?u(g,b,x,k):null;case Zn:return N=x._init,f(g,b,N(x._payload),k)}if(oi(x)||Ks(x))return N!==null?null:h(g,b,x,k,null);ka(g,x)}return null}function m(g,b,x,k,N){if(typeof k=="string"&&k!==""||typeof k=="number")return g=g.get(x)||null,l(b,g,""+k,N);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case ha:return g=g.get(k.key===null?x:k.key)||null,c(b,g,k,N);case os:return g=g.get(k.key===null?x:k.key)||null,u(b,g,k,N);case Zn:var w=k._init;return m(g,b,x,w(k._payload),N)}if(oi(k)||Ks(k))return g=g.get(x)||null,h(b,g,k,N,null);ka(b,k)}return null}function p(g,b,x,k){for(var N=null,w=null,C=b,T=b=0,I=null;C!==null&&T<x.length;T++){C.index>T?(I=C,C=null):I=C.sibling;var v=f(g,C,x[T],k);if(v===null){C===null&&(C=I);break}e&&C&&v.alternate===null&&t(g,C),b=a(v,b,T),w===null?N=v:w.sibling=v,w=v,C=I}if(T===x.length)return n(g,C),We&&Pr(g,T),N;if(C===null){for(;T<x.length;T++)C=d(g,x[T],k),C!==null&&(b=a(C,b,T),w===null?N=C:w.sibling=C,w=C);return We&&Pr(g,T),N}for(C=r(g,C);T<x.length;T++)I=m(C,g,T,x[T],k),I!==null&&(e&&I.alternate!==null&&C.delete(I.key===null?T:I.key),b=a(I,b,T),w===null?N=I:w.sibling=I,w=I);return e&&C.forEach(function(P){return t(g,P)}),We&&Pr(g,T),N}function y(g,b,x,k){var N=Ks(x);if(typeof N!="function")throw Error(Z(150));if(x=N.call(x),x==null)throw Error(Z(151));for(var w=N=null,C=b,T=b=0,I=null,v=x.next();C!==null&&!v.done;T++,v=x.next()){C.index>T?(I=C,C=null):I=C.sibling;var P=f(g,C,v.value,k);if(P===null){C===null&&(C=I);break}e&&C&&P.alternate===null&&t(g,C),b=a(P,b,T),w===null?N=P:w.sibling=P,w=P,C=I}if(v.done)return n(g,C),We&&Pr(g,T),N;if(C===null){for(;!v.done;T++,v=x.next())v=d(g,v.value,k),v!==null&&(b=a(v,b,T),w===null?N=v:w.sibling=v,w=v);return We&&Pr(g,T),N}for(C=r(g,C);!v.done;T++,v=x.next())v=m(C,g,T,v.value,k),v!==null&&(e&&v.alternate!==null&&C.delete(v.key===null?T:v.key),b=a(v,b,T),w===null?N=v:w.sibling=v,w=v);return e&&C.forEach(function(A){return t(g,A)}),We&&Pr(g,T),N}function S(g,b,x,k){if(typeof x=="object"&&x!==null&&x.type===ls&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case ha:e:{for(var N=x.key,w=b;w!==null;){if(w.key===N){if(N=x.type,N===ls){if(w.tag===7){n(g,w.sibling),b=i(w,x.props.children),b.return=g,g=b;break e}}else if(w.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Zn&&Yh(N)===w.type){n(g,w.sibling),b=i(w,x.props),b.ref=ei(g,w,x),b.return=g,g=b;break e}n(g,w);break}else t(g,w);w=w.sibling}x.type===ls?(b=Fr(x.props.children,g.mode,k,x.key),b.return=g,g=b):(k=Ka(x.type,x.key,x.props,null,g.mode,k),k.ref=ei(g,b,x),k.return=g,g=k)}return o(g);case os:e:{for(w=x.key;b!==null;){if(b.key===w)if(b.tag===4&&b.stateNode.containerInfo===x.containerInfo&&b.stateNode.implementation===x.implementation){n(g,b.sibling),b=i(b,x.children||[]),b.return=g,g=b;break e}else{n(g,b);break}else t(g,b);b=b.sibling}b=Ol(x,g.mode,k),b.return=g,g=b}return o(g);case Zn:return w=x._init,S(g,b,w(x._payload),k)}if(oi(x))return p(g,b,x,k);if(Ks(x))return y(g,b,x,k);ka(g,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,b!==null&&b.tag===6?(n(g,b.sibling),b=i(b,x),b.return=g,g=b):(n(g,b),b=Dl(x,g.mode,k),b.return=g,g=b),o(g)):n(g,b)}return S}var Is=ig(!0),ag=ig(!1),ho=br(null),mo=null,gs=null,Zu=null;function ed(){Zu=gs=mo=null}function td(e){var t=ho.current;qe(ho),e._currentValue=t}function Oc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ks(e,t){mo=e,Zu=gs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Dt=!0),e.firstContext=null)}function nn(e){var t=e._currentValue;if(Zu!==e)if(e={context:e,memoizedValue:t,next:null},gs===null){if(mo===null)throw Error(Z(308));gs=e,mo.dependencies={lanes:0,firstContext:e}}else gs=gs.next=e;return t}var Dr=null;function nd(e){Dr===null?Dr=[e]:Dr.push(e)}function og(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,nd(t)):(n.next=i.next,i.next=n),t.interleaved=n,Un(e,r)}function Un(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var er=!1;function rd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $n(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function dr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ae&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Un(e,n)}return i=r.interleaved,i===null?(t.next=t,nd(r)):(t.next=i.next,i.next=t),r.interleaved=t,Un(e,n)}function Va(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Uu(e,n)}}function Kh(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function fo(e,t,n,r){var i=e.updateQueue;er=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?a=u:o.next=u,o=c;var h=e.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(a!==null){var d=i.baseState;o=0,h=u=c=null,l=a;do{var f=l.lane,m=l.eventTime;if((r&f)===f){h!==null&&(h=h.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var p=e,y=l;switch(f=t,m=n,y.tag){case 1:if(p=y.payload,typeof p=="function"){d=p.call(m,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=y.payload,f=typeof p=="function"?p.call(m,d,f):p,f==null)break e;d=Je({},d,f);break e;case 2:er=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=i.effects,f===null?i.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=m,c=d):h=h.next=m,o|=f;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;f=l,l=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(h===null&&(c=d),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=h,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);Ur|=o,e.lanes=o,e.memoizedState=d}}function Jh(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Z(191,i));i.call(r)}}}var ra={},Cn=br(ra),zi=br(ra),Bi=br(ra);function Or(e){if(e===ra)throw Error(Z(174));return e}function sd(e,t){switch(Be(Bi,t),Be(zi,e),Be(Cn,ra),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:gc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=gc(t,e)}qe(Cn),Be(Cn,t)}function Ms(){qe(Cn),qe(zi),qe(Bi)}function cg(e){Or(Bi.current);var t=Or(Cn.current),n=gc(t,e.type);t!==n&&(Be(zi,e),Be(Cn,n))}function id(e){zi.current===e&&(qe(Cn),qe(zi))}var Ye=br(0);function po(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Pl=[];function ad(){for(var e=0;e<Pl.length;e++)Pl[e]._workInProgressVersionPrimary=null;Pl.length=0}var qa=Gn.ReactCurrentDispatcher,Tl=Gn.ReactCurrentBatchConfig,Br=0,Ke=null,lt=null,ut=null,go=!1,gi=!1,Ui=0,sv=0;function gt(){throw Error(Z(321))}function od(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!xn(e[n],t[n]))return!1;return!0}function ld(e,t,n,r,i,a){if(Br=a,Ke=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,qa.current=e===null||e.memoizedState===null?lv:cv,e=n(r,i),gi){a=0;do{if(gi=!1,Ui=0,25<=a)throw Error(Z(301));a+=1,ut=lt=null,t.updateQueue=null,qa.current=uv,e=n(r,i)}while(gi)}if(qa.current=xo,t=lt!==null&&lt.next!==null,Br=0,ut=lt=Ke=null,go=!1,t)throw Error(Z(300));return e}function cd(){var e=Ui!==0;return Ui=0,e}function jn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ut===null?Ke.memoizedState=ut=e:ut=ut.next=e,ut}function rn(){if(lt===null){var e=Ke.alternate;e=e!==null?e.memoizedState:null}else e=lt.next;var t=ut===null?Ke.memoizedState:ut.next;if(t!==null)ut=t,lt=e;else{if(e===null)throw Error(Z(310));lt=e,e={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},ut===null?Ke.memoizedState=ut=e:ut=ut.next=e}return ut}function Vi(e,t){return typeof t=="function"?t(e):t}function Il(e){var t=rn(),n=t.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=e;var r=lt,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var l=o=null,c=null,u=a;do{var h=u.lane;if((Br&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=d,o=r):c=c.next=d,Ke.lanes|=h,Ur|=h}u=u.next}while(u!==null&&u!==a);c===null?o=r:c.next=l,xn(r,t.memoizedState)||(Dt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do a=i.lane,Ke.lanes|=a,Ur|=a,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ml(e){var t=rn(),n=t.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);xn(a,t.memoizedState)||(Dt=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function ug(){}function dg(e,t){var n=Ke,r=rn(),i=t(),a=!xn(r.memoizedState,i);if(a&&(r.memoizedState=i,Dt=!0),r=r.queue,ud(fg.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||ut!==null&&ut.memoizedState.tag&1){if(n.flags|=2048,qi(9,mg.bind(null,n,r,i,t),void 0,null),dt===null)throw Error(Z(349));Br&30||hg(n,t,i)}return i}function hg(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ke.updateQueue,t===null?(t={lastEffect:null,stores:null},Ke.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function mg(e,t,n,r){t.value=n,t.getSnapshot=r,pg(t)&&gg(e)}function fg(e,t,n){return n(function(){pg(t)&&gg(e)})}function pg(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!xn(e,n)}catch{return!0}}function gg(e){var t=Un(e,1);t!==null&&pn(t,e,1,-1)}function Qh(e){var t=jn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vi,lastRenderedState:e},t.queue=e,e=e.dispatch=ov.bind(null,Ke,e),[t.memoizedState,e]}function qi(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ke.updateQueue,t===null?(t={lastEffect:null,stores:null},Ke.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function xg(){return rn().memoizedState}function Ga(e,t,n,r){var i=jn();Ke.flags|=e,i.memoizedState=qi(1|t,n,void 0,r===void 0?null:r)}function Fo(e,t,n,r){var i=rn();r=r===void 0?null:r;var a=void 0;if(lt!==null){var o=lt.memoizedState;if(a=o.destroy,r!==null&&od(r,o.deps)){i.memoizedState=qi(t,n,a,r);return}}Ke.flags|=e,i.memoizedState=qi(1|t,n,a,r)}function Xh(e,t){return Ga(8390656,8,e,t)}function ud(e,t){return Fo(2048,8,e,t)}function yg(e,t){return Fo(4,2,e,t)}function bg(e,t){return Fo(4,4,e,t)}function vg(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function wg(e,t,n){return n=n!=null?n.concat([e]):null,Fo(4,4,vg.bind(null,t,e),n)}function dd(){}function jg(e,t){var n=rn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&od(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function kg(e,t){var n=rn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&od(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ng(e,t,n){return Br&21?(xn(n,t)||(n=Pp(),Ke.lanes|=n,Ur|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Dt=!0),e.memoizedState=n)}function iv(e,t){var n=De;De=n!==0&&4>n?n:4,e(!0);var r=Tl.transition;Tl.transition={};try{e(!1),t()}finally{De=n,Tl.transition=r}}function Sg(){return rn().memoizedState}function av(e,t,n){var r=mr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},_g(e))Cg(t,n);else if(n=og(e,t,n,r),n!==null){var i=Ct();pn(n,e,r,i),Eg(n,t,r)}}function ov(e,t,n){var r=mr(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(_g(e))Cg(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,n);if(i.hasEagerState=!0,i.eagerState=l,xn(l,o)){var c=t.interleaved;c===null?(i.next=i,nd(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}n=og(e,t,i,r),n!==null&&(i=Ct(),pn(n,e,r,i),Eg(n,t,r))}}function _g(e){var t=e.alternate;return e===Ke||t!==null&&t===Ke}function Cg(e,t){gi=go=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Eg(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Uu(e,n)}}var xo={readContext:nn,useCallback:gt,useContext:gt,useEffect:gt,useImperativeHandle:gt,useInsertionEffect:gt,useLayoutEffect:gt,useMemo:gt,useReducer:gt,useRef:gt,useState:gt,useDebugValue:gt,useDeferredValue:gt,useTransition:gt,useMutableSource:gt,useSyncExternalStore:gt,useId:gt,unstable_isNewReconciler:!1},lv={readContext:nn,useCallback:function(e,t){return jn().memoizedState=[e,t===void 0?null:t],e},useContext:nn,useEffect:Xh,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Ga(4194308,4,vg.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ga(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ga(4,2,e,t)},useMemo:function(e,t){var n=jn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=jn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=av.bind(null,Ke,e),[r.memoizedState,e]},useRef:function(e){var t=jn();return e={current:e},t.memoizedState=e},useState:Qh,useDebugValue:dd,useDeferredValue:function(e){return jn().memoizedState=e},useTransition:function(){var e=Qh(!1),t=e[0];return e=iv.bind(null,e[1]),jn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ke,i=jn();if(We){if(n===void 0)throw Error(Z(407));n=n()}else{if(n=t(),dt===null)throw Error(Z(349));Br&30||hg(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Xh(fg.bind(null,r,a,e),[e]),r.flags|=2048,qi(9,mg.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=jn(),t=dt.identifierPrefix;if(We){var n=Fn,r=Rn;n=(r&~(1<<32-fn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ui++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=sv++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},cv={readContext:nn,useCallback:jg,useContext:nn,useEffect:ud,useImperativeHandle:wg,useInsertionEffect:yg,useLayoutEffect:bg,useMemo:kg,useReducer:Il,useRef:xg,useState:function(){return Il(Vi)},useDebugValue:dd,useDeferredValue:function(e){var t=rn();return Ng(t,lt.memoizedState,e)},useTransition:function(){var e=Il(Vi)[0],t=rn().memoizedState;return[e,t]},useMutableSource:ug,useSyncExternalStore:dg,useId:Sg,unstable_isNewReconciler:!1},uv={readContext:nn,useCallback:jg,useContext:nn,useEffect:ud,useImperativeHandle:wg,useInsertionEffect:yg,useLayoutEffect:bg,useMemo:kg,useReducer:Ml,useRef:xg,useState:function(){return Ml(Vi)},useDebugValue:dd,useDeferredValue:function(e){var t=rn();return lt===null?t.memoizedState=e:Ng(t,lt.memoizedState,e)},useTransition:function(){var e=Ml(Vi)[0],t=rn().memoizedState;return[e,t]},useMutableSource:ug,useSyncExternalStore:dg,useId:Sg,unstable_isNewReconciler:!1};function un(e,t){if(e&&e.defaultProps){t=Je({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Rc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Je({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var $o={isMounted:function(e){return(e=e._reactInternals)?Hr(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ct(),i=mr(e),a=$n(r,i);a.payload=t,n!=null&&(a.callback=n),t=dr(e,a,i),t!==null&&(pn(t,e,i,r),Va(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ct(),i=mr(e),a=$n(r,i);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=dr(e,a,i),t!==null&&(pn(t,e,i,r),Va(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ct(),r=mr(e),i=$n(n,r);i.tag=2,t!=null&&(i.callback=t),t=dr(e,i,r),t!==null&&(pn(t,e,r,n),Va(t,e,r))}};function Zh(e,t,n,r,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,o):t.prototype&&t.prototype.isPureReactComponent?!Oi(n,r)||!Oi(i,a):!0}function Pg(e,t,n){var r=!1,i=xr,a=t.contextType;return typeof a=="object"&&a!==null?a=nn(a):(i=Rt(t)?$r:wt.current,r=t.contextTypes,a=(r=r!=null)?Ps(e,i):xr),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=$o,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function em(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&$o.enqueueReplaceState(t,t.state,null)}function Fc(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},rd(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=nn(a):(a=Rt(t)?$r:wt.current,i.context=Ps(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Rc(e,t,a,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&$o.enqueueReplaceState(i,i.state,null),fo(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function As(e,t){try{var n="",r=t;do n+=Fb(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Al(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function $c(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var dv=typeof WeakMap=="function"?WeakMap:Map;function Tg(e,t,n){n=$n(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){bo||(bo=!0,Kc=r),$c(e,t)},n}function Ig(e,t,n){n=$n(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){$c(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){$c(e,t),typeof r!="function"&&(hr===null?hr=new Set([this]):hr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function tm(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new dv;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Sv.bind(null,e,t,n),t.then(e,e))}function nm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function rm(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=$n(-1,1),t.tag=2,dr(n,t,1))),n.lanes|=1),e)}var hv=Gn.ReactCurrentOwner,Dt=!1;function St(e,t,n,r){t.child=e===null?ag(t,null,n,r):Is(t,e.child,n,r)}function sm(e,t,n,r,i){n=n.render;var a=t.ref;return ks(t,i),r=ld(e,t,n,r,a,i),n=cd(),e!==null&&!Dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Vn(e,t,i)):(We&&n&&Ju(t),t.flags|=1,St(e,t,r,i),t.child)}function im(e,t,n,r,i){if(e===null){var a=n.type;return typeof a=="function"&&!bd(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,Mg(e,t,a,r,i)):(e=Ka(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Oi,n(o,r)&&e.ref===t.ref)return Vn(e,t,i)}return t.flags|=1,e=fr(a,r),e.ref=t.ref,e.return=t,t.child=e}function Mg(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if(Oi(a,r)&&e.ref===t.ref)if(Dt=!1,t.pendingProps=r=a,(e.lanes&i)!==0)e.flags&131072&&(Dt=!0);else return t.lanes=e.lanes,Vn(e,t,i)}return zc(e,t,n,r,i)}function Ag(e,t,n){var r=t.pendingProps,i=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(ys,Ut),Ut|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Be(ys,Ut),Ut|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,Be(ys,Ut),Ut|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,Be(ys,Ut),Ut|=r;return St(e,t,i,n),t.child}function Lg(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function zc(e,t,n,r,i){var a=Rt(n)?$r:wt.current;return a=Ps(t,a),ks(t,i),n=ld(e,t,n,r,a,i),r=cd(),e!==null&&!Dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Vn(e,t,i)):(We&&r&&Ju(t),t.flags|=1,St(e,t,n,i),t.child)}function am(e,t,n,r,i){if(Rt(n)){var a=!0;lo(t)}else a=!1;if(ks(t,i),t.stateNode===null)Ha(e,t),Pg(t,n,r),Fc(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=nn(u):(u=Rt(n)?$r:wt.current,u=Ps(t,u));var h=n.getDerivedStateFromProps,d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&em(t,o,r,u),er=!1;var f=t.memoizedState;o.state=f,fo(t,r,o,i),c=t.memoizedState,l!==r||f!==c||Ot.current||er?(typeof h=="function"&&(Rc(t,n,h,r),c=t.memoizedState),(l=er||Zh(t,n,l,r,f,c,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,lg(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:un(t.type,l),o.props=u,d=t.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=nn(c):(c=Rt(n)?$r:wt.current,c=Ps(t,c));var m=n.getDerivedStateFromProps;(h=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==d||f!==c)&&em(t,o,r,c),er=!1,f=t.memoizedState,o.state=f,fo(t,r,o,i);var p=t.memoizedState;l!==d||f!==p||Ot.current||er?(typeof m=="function"&&(Rc(t,n,m,r),p=t.memoizedState),(u=er||Zh(t,n,u,r,f,p,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Bc(e,t,n,r,a,i)}function Bc(e,t,n,r,i,a){Lg(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&Gh(t,n,!1),Vn(e,t,a);r=t.stateNode,hv.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Is(t,e.child,null,a),t.child=Is(t,null,l,a)):St(e,t,l,a),t.memoizedState=r.state,i&&Gh(t,n,!0),t.child}function Dg(e){var t=e.stateNode;t.pendingContext?qh(e,t.pendingContext,t.pendingContext!==t.context):t.context&&qh(e,t.context,!1),sd(e,t.containerInfo)}function om(e,t,n,r,i){return Ts(),Xu(i),t.flags|=256,St(e,t,n,r),t.child}var Uc={dehydrated:null,treeContext:null,retryLane:0};function Vc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Og(e,t,n){var r=t.pendingProps,i=Ye.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Be(Ye,i&1),e===null)return Dc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,a?(r=t.mode,a=t.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=Uo(o,r,0,null),e=Fr(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Vc(n),t.memoizedState=Uc,e):hd(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return mv(e,t,o,r,l,i,n);if(a){a=r.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=fr(i,c),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=fr(l,a):(a=Fr(a,o,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,o=e.child.memoizedState,o=o===null?Vc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~n,t.memoizedState=Uc,r}return a=e.child,e=a.sibling,r=fr(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function hd(e,t){return t=Uo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Na(e,t,n,r){return r!==null&&Xu(r),Is(t,e.child,null,n),e=hd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function mv(e,t,n,r,i,a,o){if(n)return t.flags&256?(t.flags&=-257,r=Al(Error(Z(422))),Na(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Uo({mode:"visible",children:r.children},i,0,null),a=Fr(a,i,o,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&Is(t,e.child,null,o),t.child.memoizedState=Vc(o),t.memoizedState=Uc,a);if(!(t.mode&1))return Na(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(Z(419)),r=Al(a,r,void 0),Na(e,t,o,r)}if(l=(o&e.childLanes)!==0,Dt||l){if(r=dt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Un(e,i),pn(r,e,i,-1))}return yd(),r=Al(Error(Z(421))),Na(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=_v.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,qt=ur(i.nextSibling),Gt=t,We=!0,mn=null,e!==null&&(Qt[Xt++]=Rn,Qt[Xt++]=Fn,Qt[Xt++]=zr,Rn=e.id,Fn=e.overflow,zr=t),t=hd(t,r.children),t.flags|=4096,t)}function lm(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Oc(e.return,t,n)}function Ll(e,t,n,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Rg(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(St(e,t,r.children,n),r=Ye.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&lm(e,n,t);else if(e.tag===19)lm(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Be(Ye,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&po(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ll(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&po(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ll(t,!0,n,null,a);break;case"together":Ll(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ha(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ur|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Z(153));if(t.child!==null){for(e=t.child,n=fr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=fr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function fv(e,t,n){switch(t.tag){case 3:Dg(t),Ts();break;case 5:cg(t);break;case 1:Rt(t.type)&&lo(t);break;case 4:sd(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Be(ho,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Be(Ye,Ye.current&1),t.flags|=128,null):n&t.child.childLanes?Og(e,t,n):(Be(Ye,Ye.current&1),e=Vn(e,t,n),e!==null?e.sibling:null);Be(Ye,Ye.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Rg(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Be(Ye,Ye.current),r)break;return null;case 22:case 23:return t.lanes=0,Ag(e,t,n)}return Vn(e,t,n)}var Fg,qc,$g,zg;Fg=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};qc=function(){};$g=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Or(Cn.current);var a=null;switch(n){case"input":i=hc(e,i),r=hc(e,r),a=[];break;case"select":i=Je({},i,{value:void 0}),r=Je({},r,{value:void 0}),a=[];break;case"textarea":i=pc(e,i),r=pc(e,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ao)}xc(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Pi.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Pi.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ve("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};zg=function(e,t,n,r){n!==r&&(t.flags|=4)};function ti(e,t){if(!We)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function xt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function pv(e,t,n){var r=t.pendingProps;switch(Qu(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xt(t),null;case 1:return Rt(t.type)&&oo(),xt(t),null;case 3:return r=t.stateNode,Ms(),qe(Ot),qe(wt),ad(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ja(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,mn!==null&&(Xc(mn),mn=null))),qc(e,t),xt(t),null;case 5:id(t);var i=Or(Bi.current);if(n=t.type,e!==null&&t.stateNode!=null)$g(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Z(166));return xt(t),null}if(e=Or(Cn.current),ja(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[Sn]=t,r[$i]=a,e=(t.mode&1)!==0,n){case"dialog":Ve("cancel",r),Ve("close",r);break;case"iframe":case"object":case"embed":Ve("load",r);break;case"video":case"audio":for(i=0;i<ci.length;i++)Ve(ci[i],r);break;case"source":Ve("error",r);break;case"img":case"image":case"link":Ve("error",r),Ve("load",r);break;case"details":Ve("toggle",r);break;case"input":xh(r,a),Ve("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ve("invalid",r);break;case"textarea":bh(r,a),Ve("invalid",r)}xc(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&wa(r.textContent,l,e),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&wa(r.textContent,l,e),i=["children",""+l]):Pi.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ve("scroll",r)}switch(n){case"input":ma(r),yh(r,a,!0);break;case"textarea":ma(r),vh(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=ao)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=fp(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Sn]=t,e[$i]=r,Fg(e,t,!1,!1),t.stateNode=e;e:{switch(o=yc(n,r),n){case"dialog":Ve("cancel",e),Ve("close",e),i=r;break;case"iframe":case"object":case"embed":Ve("load",e),i=r;break;case"video":case"audio":for(i=0;i<ci.length;i++)Ve(ci[i],e);i=r;break;case"source":Ve("error",e),i=r;break;case"img":case"image":case"link":Ve("error",e),Ve("load",e),i=r;break;case"details":Ve("toggle",e),i=r;break;case"input":xh(e,r),i=hc(e,r),Ve("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=Je({},r,{value:void 0}),Ve("invalid",e);break;case"textarea":bh(e,r),i=pc(e,r),Ve("invalid",e);break;default:i=r}xc(n,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?xp(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&pp(e,c)):a==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Ti(e,c):typeof c=="number"&&Ti(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Pi.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Ve("scroll",e):c!=null&&Ou(e,a,c,o))}switch(n){case"input":ma(e),yh(e,r,!1);break;case"textarea":ma(e),vh(e);break;case"option":r.value!=null&&e.setAttribute("value",""+gr(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?bs(e,!!r.multiple,a,!1):r.defaultValue!=null&&bs(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=ao)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return xt(t),null;case 6:if(e&&t.stateNode!=null)zg(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Z(166));if(n=Or(Bi.current),Or(Cn.current),ja(t)){if(r=t.stateNode,n=t.memoizedProps,r[Sn]=t,(a=r.nodeValue!==n)&&(e=Gt,e!==null))switch(e.tag){case 3:wa(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&wa(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Sn]=t,t.stateNode=r}return xt(t),null;case 13:if(qe(Ye),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(We&&qt!==null&&t.mode&1&&!(t.flags&128))sg(),Ts(),t.flags|=98560,a=!1;else if(a=ja(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(Z(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Z(317));a[Sn]=t}else Ts(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;xt(t),a=!1}else mn!==null&&(Xc(mn),mn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ye.current&1?ct===0&&(ct=3):yd())),t.updateQueue!==null&&(t.flags|=4),xt(t),null);case 4:return Ms(),qc(e,t),e===null&&Ri(t.stateNode.containerInfo),xt(t),null;case 10:return td(t.type._context),xt(t),null;case 17:return Rt(t.type)&&oo(),xt(t),null;case 19:if(qe(Ye),a=t.memoizedState,a===null)return xt(t),null;if(r=(t.flags&128)!==0,o=a.rendering,o===null)if(r)ti(a,!1);else{if(ct!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=po(e),o!==null){for(t.flags|=128,ti(a,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Be(Ye,Ye.current&1|2),t.child}e=e.sibling}a.tail!==null&&Ze()>Ls&&(t.flags|=128,r=!0,ti(a,!1),t.lanes=4194304)}else{if(!r)if(e=po(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ti(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!We)return xt(t),null}else 2*Ze()-a.renderingStartTime>Ls&&n!==1073741824&&(t.flags|=128,r=!0,ti(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(n=a.last,n!==null?n.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ze(),t.sibling=null,n=Ye.current,Be(Ye,r?n&1|2:n&1),t):(xt(t),null);case 22:case 23:return xd(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Ut&1073741824&&(xt(t),t.subtreeFlags&6&&(t.flags|=8192)):xt(t),null;case 24:return null;case 25:return null}throw Error(Z(156,t.tag))}function gv(e,t){switch(Qu(t),t.tag){case 1:return Rt(t.type)&&oo(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ms(),qe(Ot),qe(wt),ad(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return id(t),null;case 13:if(qe(Ye),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Z(340));Ts()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return qe(Ye),null;case 4:return Ms(),null;case 10:return td(t.type._context),null;case 22:case 23:return xd(),null;case 24:return null;default:return null}}var Sa=!1,yt=!1,xv=typeof WeakSet=="function"?WeakSet:Set,ie=null;function xs(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Qe(e,t,r)}else n.current=null}function Gc(e,t,n){try{n()}catch(r){Qe(e,t,r)}}var cm=!1;function yv(e,t){if(Ec=ro,e=Gp(),Ku(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var m;d!==n||i!==0&&d.nodeType!==3||(l=o+i),d!==a||r!==0&&d.nodeType!==3||(c=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(m=d.firstChild)!==null;)f=d,d=m;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=o),f===a&&++h===r&&(c=o),(m=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Pc={focusedElem:e,selectionRange:n},ro=!1,ie=t;ie!==null;)if(t=ie,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ie=e;else for(;ie!==null;){t=ie;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var y=p.memoizedProps,S=p.memoizedState,g=t.stateNode,b=g.getSnapshotBeforeUpdate(t.elementType===t.type?y:un(t.type,y),S);g.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(k){Qe(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,ie=e;break}ie=t.return}return p=cm,cm=!1,p}function xi(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&Gc(t,n,a)}i=i.next}while(i!==r)}}function zo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Hc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Bg(e){var t=e.alternate;t!==null&&(e.alternate=null,Bg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Sn],delete t[$i],delete t[Mc],delete t[ev],delete t[tv])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ug(e){return e.tag===5||e.tag===3||e.tag===4}function um(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ug(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Wc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ao));else if(r!==4&&(e=e.child,e!==null))for(Wc(e,t,n),e=e.sibling;e!==null;)Wc(e,t,n),e=e.sibling}function Yc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Yc(e,t,n),e=e.sibling;e!==null;)Yc(e,t,n),e=e.sibling}var mt=null,dn=!1;function Kn(e,t,n){for(n=n.child;n!==null;)Vg(e,t,n),n=n.sibling}function Vg(e,t,n){if(_n&&typeof _n.onCommitFiberUnmount=="function")try{_n.onCommitFiberUnmount(Mo,n)}catch{}switch(n.tag){case 5:yt||xs(n,t);case 6:var r=mt,i=dn;mt=null,Kn(e,t,n),mt=r,dn=i,mt!==null&&(dn?(e=mt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):mt.removeChild(n.stateNode));break;case 18:mt!==null&&(dn?(e=mt,n=n.stateNode,e.nodeType===8?Cl(e.parentNode,n):e.nodeType===1&&Cl(e,n),Li(e)):Cl(mt,n.stateNode));break;case 4:r=mt,i=dn,mt=n.stateNode.containerInfo,dn=!0,Kn(e,t,n),mt=r,dn=i;break;case 0:case 11:case 14:case 15:if(!yt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Gc(n,t,o),i=i.next}while(i!==r)}Kn(e,t,n);break;case 1:if(!yt&&(xs(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Qe(n,t,l)}Kn(e,t,n);break;case 21:Kn(e,t,n);break;case 22:n.mode&1?(yt=(r=yt)||n.memoizedState!==null,Kn(e,t,n),yt=r):Kn(e,t,n);break;default:Kn(e,t,n)}}function dm(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new xv),t.forEach(function(r){var i=Cv.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function on(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:mt=l.stateNode,dn=!1;break e;case 3:mt=l.stateNode.containerInfo,dn=!0;break e;case 4:mt=l.stateNode.containerInfo,dn=!0;break e}l=l.return}if(mt===null)throw Error(Z(160));Vg(a,o,i),mt=null,dn=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Qe(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)qg(t,e),t=t.sibling}function qg(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(on(t,e),wn(e),r&4){try{xi(3,e,e.return),zo(3,e)}catch(y){Qe(e,e.return,y)}try{xi(5,e,e.return)}catch(y){Qe(e,e.return,y)}}break;case 1:on(t,e),wn(e),r&512&&n!==null&&xs(n,n.return);break;case 5:if(on(t,e),wn(e),r&512&&n!==null&&xs(n,n.return),e.flags&32){var i=e.stateNode;try{Ti(i,"")}catch(y){Qe(e,e.return,y)}}if(r&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=n!==null?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&hp(i,a),yc(l,o);var u=yc(l,a);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];h==="style"?xp(i,d):h==="dangerouslySetInnerHTML"?pp(i,d):h==="children"?Ti(i,d):Ou(i,h,d,u)}switch(l){case"input":mc(i,a);break;case"textarea":mp(i,a);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?bs(i,!!a.multiple,m,!1):f!==!!a.multiple&&(a.defaultValue!=null?bs(i,!!a.multiple,a.defaultValue,!0):bs(i,!!a.multiple,a.multiple?[]:"",!1))}i[$i]=a}catch(y){Qe(e,e.return,y)}}break;case 6:if(on(t,e),wn(e),r&4){if(e.stateNode===null)throw Error(Z(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(y){Qe(e,e.return,y)}}break;case 3:if(on(t,e),wn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Li(t.containerInfo)}catch(y){Qe(e,e.return,y)}break;case 4:on(t,e),wn(e);break;case 13:on(t,e),wn(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(pd=Ze())),r&4&&dm(e);break;case 22:if(h=n!==null&&n.memoizedState!==null,e.mode&1?(yt=(u=yt)||h,on(t,e),yt=u):on(t,e),wn(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!h&&e.mode&1)for(ie=e,h=e.child;h!==null;){for(d=ie=h;ie!==null;){switch(f=ie,m=f.child,f.tag){case 0:case 11:case 14:case 15:xi(4,f,f.return);break;case 1:xs(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(y){Qe(r,n,y)}}break;case 5:xs(f,f.return);break;case 22:if(f.memoizedState!==null){mm(d);continue}}m!==null?(m.return=f,ie=m):mm(d)}h=h.sibling}e:for(h=null,d=e;;){if(d.tag===5){if(h===null){h=d;try{i=d.stateNode,u?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=gp("display",o))}catch(y){Qe(e,e.return,y)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(y){Qe(e,e.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:on(t,e),wn(e),r&4&&dm(e);break;case 21:break;default:on(t,e),wn(e)}}function wn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Ug(n)){var r=n;break e}n=n.return}throw Error(Z(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ti(i,""),r.flags&=-33);var a=um(e);Yc(e,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=um(e);Wc(e,l,o);break;default:throw Error(Z(161))}}catch(c){Qe(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function bv(e,t,n){ie=e,Gg(e)}function Gg(e,t,n){for(var r=(e.mode&1)!==0;ie!==null;){var i=ie,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Sa;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||yt;l=Sa;var u=yt;if(Sa=o,(yt=c)&&!u)for(ie=i;ie!==null;)o=ie,c=o.child,o.tag===22&&o.memoizedState!==null?fm(i):c!==null?(c.return=o,ie=c):fm(i);for(;a!==null;)ie=a,Gg(a),a=a.sibling;ie=i,Sa=l,yt=u}hm(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,ie=a):hm(e)}}function hm(e){for(;ie!==null;){var t=ie;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:yt||zo(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!yt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:un(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Jh(t,a,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Jh(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&Li(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}yt||t.flags&512&&Hc(t)}catch(f){Qe(t,t.return,f)}}if(t===e){ie=null;break}if(n=t.sibling,n!==null){n.return=t.return,ie=n;break}ie=t.return}}function mm(e){for(;ie!==null;){var t=ie;if(t===e){ie=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ie=n;break}ie=t.return}}function fm(e){for(;ie!==null;){var t=ie;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{zo(4,t)}catch(c){Qe(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(c){Qe(t,i,c)}}var a=t.return;try{Hc(t)}catch(c){Qe(t,a,c)}break;case 5:var o=t.return;try{Hc(t)}catch(c){Qe(t,o,c)}}}catch(c){Qe(t,t.return,c)}if(t===e){ie=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ie=l;break}ie=t.return}}var vv=Math.ceil,yo=Gn.ReactCurrentDispatcher,md=Gn.ReactCurrentOwner,tn=Gn.ReactCurrentBatchConfig,Ae=0,dt=null,nt=null,ft=0,Ut=0,ys=br(0),ct=0,Gi=null,Ur=0,Bo=0,fd=0,yi=null,At=null,pd=0,Ls=1/0,An=null,bo=!1,Kc=null,hr=null,_a=!1,ar=null,vo=0,bi=0,Jc=null,Wa=-1,Ya=0;function Ct(){return Ae&6?Ze():Wa!==-1?Wa:Wa=Ze()}function mr(e){return e.mode&1?Ae&2&&ft!==0?ft&-ft:rv.transition!==null?(Ya===0&&(Ya=Pp()),Ya):(e=De,e!==0||(e=window.event,e=e===void 0?16:Op(e.type)),e):1}function pn(e,t,n,r){if(50<bi)throw bi=0,Jc=null,Error(Z(185));ea(e,n,r),(!(Ae&2)||e!==dt)&&(e===dt&&(!(Ae&2)&&(Bo|=n),ct===4&&rr(e,ft)),Ft(e,r),n===1&&Ae===0&&!(t.mode&1)&&(Ls=Ze()+500,Ro&&vr()))}function Ft(e,t){var n=e.callbackNode;r0(e,t);var r=no(e,e===dt?ft:0);if(r===0)n!==null&&kh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&kh(n),t===1)e.tag===0?nv(pm.bind(null,e)):tg(pm.bind(null,e)),X0(function(){!(Ae&6)&&vr()}),n=null;else{switch(Tp(r)){case 1:n=Bu;break;case 4:n=Cp;break;case 16:n=to;break;case 536870912:n=Ep;break;default:n=to}n=Zg(n,Hg.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Hg(e,t){if(Wa=-1,Ya=0,Ae&6)throw Error(Z(327));var n=e.callbackNode;if(Ns()&&e.callbackNode!==n)return null;var r=no(e,e===dt?ft:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=wo(e,r);else{t=r;var i=Ae;Ae|=2;var a=Yg();(dt!==e||ft!==t)&&(An=null,Ls=Ze()+500,Rr(e,t));do try{kv();break}catch(l){Wg(e,l)}while(!0);ed(),yo.current=a,Ae=i,nt!==null?t=0:(dt=null,ft=0,t=ct)}if(t!==0){if(t===2&&(i=kc(e),i!==0&&(r=i,t=Qc(e,i))),t===1)throw n=Gi,Rr(e,0),rr(e,r),Ft(e,Ze()),n;if(t===6)rr(e,r);else{if(i=e.current.alternate,!(r&30)&&!wv(i)&&(t=wo(e,r),t===2&&(a=kc(e),a!==0&&(r=a,t=Qc(e,a))),t===1))throw n=Gi,Rr(e,0),rr(e,r),Ft(e,Ze()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(Z(345));case 2:Tr(e,At,An);break;case 3:if(rr(e,r),(r&130023424)===r&&(t=pd+500-Ze(),10<t)){if(no(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Ct(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ic(Tr.bind(null,e,At,An),t);break}Tr(e,At,An);break;case 4:if(rr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-fn(r);a=1<<o,o=t[o],o>i&&(i=o),r&=~a}if(r=i,r=Ze()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*vv(r/1960))-r,10<r){e.timeoutHandle=Ic(Tr.bind(null,e,At,An),r);break}Tr(e,At,An);break;case 5:Tr(e,At,An);break;default:throw Error(Z(329))}}}return Ft(e,Ze()),e.callbackNode===n?Hg.bind(null,e):null}function Qc(e,t){var n=yi;return e.current.memoizedState.isDehydrated&&(Rr(e,t).flags|=256),e=wo(e,t),e!==2&&(t=At,At=n,t!==null&&Xc(t)),e}function Xc(e){At===null?At=e:At.push.apply(At,e)}function wv(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!xn(a(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function rr(e,t){for(t&=~fd,t&=~Bo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-fn(t),r=1<<n;e[n]=-1,t&=~r}}function pm(e){if(Ae&6)throw Error(Z(327));Ns();var t=no(e,0);if(!(t&1))return Ft(e,Ze()),null;var n=wo(e,t);if(e.tag!==0&&n===2){var r=kc(e);r!==0&&(t=r,n=Qc(e,r))}if(n===1)throw n=Gi,Rr(e,0),rr(e,t),Ft(e,Ze()),n;if(n===6)throw Error(Z(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Tr(e,At,An),Ft(e,Ze()),null}function gd(e,t){var n=Ae;Ae|=1;try{return e(t)}finally{Ae=n,Ae===0&&(Ls=Ze()+500,Ro&&vr())}}function Vr(e){ar!==null&&ar.tag===0&&!(Ae&6)&&Ns();var t=Ae;Ae|=1;var n=tn.transition,r=De;try{if(tn.transition=null,De=1,e)return e()}finally{De=r,tn.transition=n,Ae=t,!(Ae&6)&&vr()}}function xd(){Ut=ys.current,qe(ys)}function Rr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Q0(n)),nt!==null)for(n=nt.return;n!==null;){var r=n;switch(Qu(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&oo();break;case 3:Ms(),qe(Ot),qe(wt),ad();break;case 5:id(r);break;case 4:Ms();break;case 13:qe(Ye);break;case 19:qe(Ye);break;case 10:td(r.type._context);break;case 22:case 23:xd()}n=n.return}if(dt=e,nt=e=fr(e.current,null),ft=Ut=t,ct=0,Gi=null,fd=Bo=Ur=0,At=yi=null,Dr!==null){for(t=0;t<Dr.length;t++)if(n=Dr[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}n.pending=r}Dr=null}return e}function Wg(e,t){do{var n=nt;try{if(ed(),qa.current=xo,go){for(var r=Ke.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}go=!1}if(Br=0,ut=lt=Ke=null,gi=!1,Ui=0,md.current=null,n===null||n.return===null){ct=1,Gi=t,nt=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=ft,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=nm(o);if(m!==null){m.flags&=-257,rm(m,o,l,a,t),m.mode&1&&tm(a,u,t),t=m,c=u;var p=t.updateQueue;if(p===null){var y=new Set;y.add(c),t.updateQueue=y}else p.add(c);break e}else{if(!(t&1)){tm(a,u,t),yd();break e}c=Error(Z(426))}}else if(We&&l.mode&1){var S=nm(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),rm(S,o,l,a,t),Xu(As(c,l));break e}}a=c=As(c,l),ct!==4&&(ct=2),yi===null?yi=[a]:yi.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var g=Tg(a,c,t);Kh(a,g);break e;case 1:l=c;var b=a.type,x=a.stateNode;if(!(a.flags&128)&&(typeof b.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(hr===null||!hr.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t;var k=Ig(a,l,t);Kh(a,k);break e}}a=a.return}while(a!==null)}Jg(n)}catch(N){t=N,nt===n&&n!==null&&(nt=n=n.return);continue}break}while(!0)}function Yg(){var e=yo.current;return yo.current=xo,e===null?xo:e}function yd(){(ct===0||ct===3||ct===2)&&(ct=4),dt===null||!(Ur&268435455)&&!(Bo&268435455)||rr(dt,ft)}function wo(e,t){var n=Ae;Ae|=2;var r=Yg();(dt!==e||ft!==t)&&(An=null,Rr(e,t));do try{jv();break}catch(i){Wg(e,i)}while(!0);if(ed(),Ae=n,yo.current=r,nt!==null)throw Error(Z(261));return dt=null,ft=0,ct}function jv(){for(;nt!==null;)Kg(nt)}function kv(){for(;nt!==null&&!Yb();)Kg(nt)}function Kg(e){var t=Xg(e.alternate,e,Ut);e.memoizedProps=e.pendingProps,t===null?Jg(e):nt=t,md.current=null}function Jg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=gv(n,t),n!==null){n.flags&=32767,nt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ct=6,nt=null;return}}else if(n=pv(n,t,Ut),n!==null){nt=n;return}if(t=t.sibling,t!==null){nt=t;return}nt=t=e}while(t!==null);ct===0&&(ct=5)}function Tr(e,t,n){var r=De,i=tn.transition;try{tn.transition=null,De=1,Nv(e,t,n,r)}finally{tn.transition=i,De=r}return null}function Nv(e,t,n,r){do Ns();while(ar!==null);if(Ae&6)throw Error(Z(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Z(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(s0(e,a),e===dt&&(nt=dt=null,ft=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_a||(_a=!0,Zg(to,function(){return Ns(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=tn.transition,tn.transition=null;var o=De;De=1;var l=Ae;Ae|=4,md.current=null,yv(e,n),qg(n,e),q0(Pc),ro=!!Ec,Pc=Ec=null,e.current=n,bv(n),Kb(),Ae=l,De=o,tn.transition=a}else e.current=n;if(_a&&(_a=!1,ar=e,vo=i),a=e.pendingLanes,a===0&&(hr=null),Xb(n.stateNode),Ft(e,Ze()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(bo)throw bo=!1,e=Kc,Kc=null,e;return vo&1&&e.tag!==0&&Ns(),a=e.pendingLanes,a&1?e===Jc?bi++:(bi=0,Jc=e):bi=0,vr(),null}function Ns(){if(ar!==null){var e=Tp(vo),t=tn.transition,n=De;try{if(tn.transition=null,De=16>e?16:e,ar===null)var r=!1;else{if(e=ar,ar=null,vo=0,Ae&6)throw Error(Z(331));var i=Ae;for(Ae|=4,ie=e.current;ie!==null;){var a=ie,o=a.child;if(ie.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ie=u;ie!==null;){var h=ie;switch(h.tag){case 0:case 11:case 15:xi(8,h,a)}var d=h.child;if(d!==null)d.return=h,ie=d;else for(;ie!==null;){h=ie;var f=h.sibling,m=h.return;if(Bg(h),h===u){ie=null;break}if(f!==null){f.return=m,ie=f;break}ie=m}}}var p=a.alternate;if(p!==null){var y=p.child;if(y!==null){p.child=null;do{var S=y.sibling;y.sibling=null,y=S}while(y!==null)}}ie=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,ie=o;else e:for(;ie!==null;){if(a=ie,a.flags&2048)switch(a.tag){case 0:case 11:case 15:xi(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,ie=g;break e}ie=a.return}}var b=e.current;for(ie=b;ie!==null;){o=ie;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,ie=x;else e:for(o=b;ie!==null;){if(l=ie,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:zo(9,l)}}catch(N){Qe(l,l.return,N)}if(l===o){ie=null;break e}var k=l.sibling;if(k!==null){k.return=l.return,ie=k;break e}ie=l.return}}if(Ae=i,vr(),_n&&typeof _n.onPostCommitFiberRoot=="function")try{_n.onPostCommitFiberRoot(Mo,e)}catch{}r=!0}return r}finally{De=n,tn.transition=t}}return!1}function gm(e,t,n){t=As(n,t),t=Tg(e,t,1),e=dr(e,t,1),t=Ct(),e!==null&&(ea(e,1,t),Ft(e,t))}function Qe(e,t,n){if(e.tag===3)gm(e,e,n);else for(;t!==null;){if(t.tag===3){gm(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(hr===null||!hr.has(r))){e=As(n,e),e=Ig(t,e,1),t=dr(t,e,1),e=Ct(),t!==null&&(ea(t,1,e),Ft(t,e));break}}t=t.return}}function Sv(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ct(),e.pingedLanes|=e.suspendedLanes&n,dt===e&&(ft&n)===n&&(ct===4||ct===3&&(ft&130023424)===ft&&500>Ze()-pd?Rr(e,0):fd|=n),Ft(e,t)}function Qg(e,t){t===0&&(e.mode&1?(t=ga,ga<<=1,!(ga&130023424)&&(ga=4194304)):t=1);var n=Ct();e=Un(e,t),e!==null&&(ea(e,t,n),Ft(e,n))}function _v(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Qg(e,n)}function Cv(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Z(314))}r!==null&&r.delete(t),Qg(e,n)}var Xg;Xg=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ot.current)Dt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Dt=!1,fv(e,t,n);Dt=!!(e.flags&131072)}else Dt=!1,We&&t.flags&1048576&&ng(t,uo,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ha(e,t),e=t.pendingProps;var i=Ps(t,wt.current);ks(t,n),i=ld(null,t,r,e,i,n);var a=cd();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rt(r)?(a=!0,lo(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,rd(t),i.updater=$o,t.stateNode=i,i._reactInternals=t,Fc(t,r,e,n),t=Bc(null,t,r,!0,a,n)):(t.tag=0,We&&a&&Ju(t),St(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ha(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=Pv(r),e=un(r,e),i){case 0:t=zc(null,t,r,e,n);break e;case 1:t=am(null,t,r,e,n);break e;case 11:t=sm(null,t,r,e,n);break e;case 14:t=im(null,t,r,un(r.type,e),n);break e}throw Error(Z(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:un(r,i),zc(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:un(r,i),am(e,t,r,i,n);case 3:e:{if(Dg(t),e===null)throw Error(Z(387));r=t.pendingProps,a=t.memoizedState,i=a.element,lg(e,t),fo(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=As(Error(Z(423)),t),t=om(e,t,r,n,i);break e}else if(r!==i){i=As(Error(Z(424)),t),t=om(e,t,r,n,i);break e}else for(qt=ur(t.stateNode.containerInfo.firstChild),Gt=t,We=!0,mn=null,n=ag(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ts(),r===i){t=Vn(e,t,n);break e}St(e,t,r,n)}t=t.child}return t;case 5:return cg(t),e===null&&Dc(t),r=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,Tc(r,i)?o=null:a!==null&&Tc(r,a)&&(t.flags|=32),Lg(e,t),St(e,t,o,n),t.child;case 6:return e===null&&Dc(t),null;case 13:return Og(e,t,n);case 4:return sd(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Is(t,null,r,n):St(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:un(r,i),sm(e,t,r,i,n);case 7:return St(e,t,t.pendingProps,n),t.child;case 8:return St(e,t,t.pendingProps.children,n),t.child;case 12:return St(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Be(ho,r._currentValue),r._currentValue=o,a!==null)if(xn(a.value,o)){if(a.children===i.children&&!Ot.current){t=Vn(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=$n(-1,n&-n),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),Oc(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(Z(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Oc(o,n,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}St(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,ks(t,n),i=nn(i),r=r(i),t.flags|=1,St(e,t,r,n),t.child;case 14:return r=t.type,i=un(r,t.pendingProps),i=un(r.type,i),im(e,t,r,i,n);case 15:return Mg(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:un(r,i),Ha(e,t),t.tag=1,Rt(r)?(e=!0,lo(t)):e=!1,ks(t,n),Pg(t,r,i),Fc(t,r,i,n),Bc(null,t,r,!0,e,n);case 19:return Rg(e,t,n);case 22:return Ag(e,t,n)}throw Error(Z(156,t.tag))};function Zg(e,t){return _p(e,t)}function Ev(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function en(e,t,n,r){return new Ev(e,t,n,r)}function bd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Pv(e){if(typeof e=="function")return bd(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Fu)return 11;if(e===$u)return 14}return 2}function fr(e,t){var n=e.alternate;return n===null?(n=en(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ka(e,t,n,r,i,a){var o=2;if(r=e,typeof e=="function")bd(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case ls:return Fr(n.children,i,a,t);case Ru:o=8,i|=8;break;case lc:return e=en(12,n,t,i|2),e.elementType=lc,e.lanes=a,e;case cc:return e=en(13,n,t,i),e.elementType=cc,e.lanes=a,e;case uc:return e=en(19,n,t,i),e.elementType=uc,e.lanes=a,e;case cp:return Uo(n,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case op:o=10;break e;case lp:o=9;break e;case Fu:o=11;break e;case $u:o=14;break e;case Zn:o=16,r=null;break e}throw Error(Z(130,e==null?e:typeof e,""))}return t=en(o,n,t,i),t.elementType=e,t.type=r,t.lanes=a,t}function Fr(e,t,n,r){return e=en(7,e,r,t),e.lanes=n,e}function Uo(e,t,n,r){return e=en(22,e,r,t),e.elementType=cp,e.lanes=n,e.stateNode={isHidden:!1},e}function Dl(e,t,n){return e=en(6,e,null,t),e.lanes=n,e}function Ol(e,t,n){return t=en(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Tv(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gl(0),this.expirationTimes=gl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gl(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function vd(e,t,n,r,i,a,o,l,c){return e=new Tv(e,t,n,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=en(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},rd(a),e}function Iv(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:os,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function ex(e){if(!e)return xr;e=e._reactInternals;e:{if(Hr(e)!==e||e.tag!==1)throw Error(Z(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Z(171))}if(e.tag===1){var n=e.type;if(Rt(n))return eg(e,n,t)}return t}function tx(e,t,n,r,i,a,o,l,c){return e=vd(n,r,!0,e,i,a,o,l,c),e.context=ex(null),n=e.current,r=Ct(),i=mr(n),a=$n(r,i),a.callback=t??null,dr(n,a,i),e.current.lanes=i,ea(e,i,r),Ft(e,r),e}function Vo(e,t,n,r){var i=t.current,a=Ct(),o=mr(i);return n=ex(n),t.context===null?t.context=n:t.pendingContext=n,t=$n(a,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=dr(i,t,o),e!==null&&(pn(e,i,o,a),Va(e,i,o)),o}function jo(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function xm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function wd(e,t){xm(e,t),(e=e.alternate)&&xm(e,t)}function Mv(){return null}var nx=typeof reportError=="function"?reportError:function(e){console.error(e)};function jd(e){this._internalRoot=e}qo.prototype.render=jd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Z(409));Vo(e,t,null,null)};qo.prototype.unmount=jd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Vr(function(){Vo(null,e,null,null)}),t[Bn]=null}};function qo(e){this._internalRoot=e}qo.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ap();e={blockedOn:null,target:e,priority:t};for(var n=0;n<nr.length&&t!==0&&t<nr[n].priority;n++);nr.splice(n,0,e),n===0&&Dp(e)}};function kd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Go(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ym(){}function Av(e,t,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var u=jo(o);a.call(u)}}var o=tx(t,r,e,0,null,!1,!1,"",ym);return e._reactRootContainer=o,e[Bn]=o.current,Ri(e.nodeType===8?e.parentNode:e),Vr(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=jo(c);l.call(u)}}var c=vd(e,0,!1,null,null,!1,!1,"",ym);return e._reactRootContainer=c,e[Bn]=c.current,Ri(e.nodeType===8?e.parentNode:e),Vr(function(){Vo(t,c,n,r)}),c}function Ho(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var c=jo(o);l.call(c)}}Vo(t,o,e,i)}else o=Av(n,t,e,i,r);return jo(o)}Ip=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=li(t.pendingLanes);n!==0&&(Uu(t,n|1),Ft(t,Ze()),!(Ae&6)&&(Ls=Ze()+500,vr()))}break;case 13:Vr(function(){var r=Un(e,1);if(r!==null){var i=Ct();pn(r,e,1,i)}}),wd(e,1)}};Vu=function(e){if(e.tag===13){var t=Un(e,134217728);if(t!==null){var n=Ct();pn(t,e,134217728,n)}wd(e,134217728)}};Mp=function(e){if(e.tag===13){var t=mr(e),n=Un(e,t);if(n!==null){var r=Ct();pn(n,e,t,r)}wd(e,t)}};Ap=function(){return De};Lp=function(e,t){var n=De;try{return De=e,t()}finally{De=n}};vc=function(e,t,n){switch(t){case"input":if(mc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Oo(r);if(!i)throw Error(Z(90));dp(r),mc(r,i)}}}break;case"textarea":mp(e,n);break;case"select":t=n.value,t!=null&&bs(e,!!n.multiple,t,!1)}};vp=gd;wp=Vr;var Lv={usingClientEntryPoint:!1,Events:[na,hs,Oo,yp,bp,gd]},ni={findFiberByHostInstance:Lr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Dv={bundleType:ni.bundleType,version:ni.version,rendererPackageName:ni.rendererPackageName,rendererConfig:ni.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Np(e),e===null?null:e.stateNode},findFiberByHostInstance:ni.findFiberByHostInstance||Mv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ca=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ca.isDisabled&&Ca.supportsFiber)try{Mo=Ca.inject(Dv),_n=Ca}catch{}}Yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lv;Yt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kd(t))throw Error(Z(200));return Iv(e,t,null,n)};Yt.createRoot=function(e,t){if(!kd(e))throw Error(Z(299));var n=!1,r="",i=nx;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=vd(e,1,!1,null,null,n,!1,r,i),e[Bn]=t.current,Ri(e.nodeType===8?e.parentNode:e),new jd(t)};Yt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Z(188)):(e=Object.keys(e).join(","),Error(Z(268,e)));return e=Np(t),e=e===null?null:e.stateNode,e};Yt.flushSync=function(e){return Vr(e)};Yt.hydrate=function(e,t,n){if(!Go(t))throw Error(Z(200));return Ho(null,e,t,!0,n)};Yt.hydrateRoot=function(e,t,n){if(!kd(e))throw Error(Z(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",o=nx;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=tx(t,null,e,1,n??null,i,!1,a,o),e[Bn]=t.current,Ri(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new qo(t)};Yt.render=function(e,t,n){if(!Go(t))throw Error(Z(200));return Ho(null,e,t,!1,n)};Yt.unmountComponentAtNode=function(e){if(!Go(e))throw Error(Z(40));return e._reactRootContainer?(Vr(function(){Ho(null,null,e,!1,function(){e._reactRootContainer=null,e[Bn]=null})}),!0):!1};Yt.unstable_batchedUpdates=gd;Yt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Go(n))throw Error(Z(200));if(e==null||e._reactInternals===void 0)throw Error(Z(38));return Ho(e,t,n,!1,r)};Yt.version="18.3.1-next-f1338f8080-20240426";function rx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(rx)}catch(e){console.error(e)}}rx(),rp.exports=Yt;var sx=rp.exports,ix,bm=sx;ix=bm.createRoot,bm.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ov={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rv=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),me=(e,t)=>{const n=j.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:l="",children:c,...u},h)=>j.createElement("svg",{ref:h,...Ov,width:i,height:i,stroke:r,strokeWidth:o?Number(a)*24/Number(i):a,className:["lucide",`lucide-${Rv(e)}`,l].join(" "),...u},[...t.map(([d,f])=>j.createElement(d,f)),...Array.isArray(c)?c:[c]]));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vm=me("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ax=me("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=me("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wm=me("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=me("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fv=me("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zc=me("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vi=me("Brush",[["path",{d:"m9.06 11.9 8.07-8.06a2.85 2.85 0 1 1 4.03 4.03l-8.06 8.08",key:"1styjt"}],["path",{d:"M7.07 14.94c-1.66 0-3 1.35-3 3.02 0 1.33-2.5 1.52-2 2.02 1.08 1.1 2.49 2.02 4 2.02 2.2 0 4-1.8 4-4.04a3.01 3.01 0 0 0-3-3.02z",key:"z0l1mu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=me("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=me("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=me("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lx=me("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eu=me("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=me("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cx=me("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=me("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=me("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ux=me("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=me("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jm=me("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tu=me("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hi=me("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hx=me("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wo=me("Gamepad2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zv=me("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=me("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=me("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bv=me("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=me("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mx=me("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=me("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fx=me("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vv=me("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qv=me("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const px=me("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=me("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gv=me("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gx=me("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=me("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const km=me("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hv=me("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=me("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nm=me("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xx=me("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=me("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wv=me("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=me("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yv=me("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=me("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yx=me("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=me("Sword",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=me("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kv=me("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jv=me("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _d=me("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=me("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wi=me("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=me("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Qv="modulepreload",Xv=function(e){return"/"+e},Sm={},ia=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=Xv(c),c in Sm)return;Sm[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":Qv,u||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((f,m)=>{d.addEventListener("load",f),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return t().catch(a)})},Zv=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>ia(async()=>{const{default:r}=await Promise.resolve().then(()=>qs);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)};class Cd extends Error{constructor(t,n="FunctionsError",r){super(t),this.name=n,this.context=r}}class ew extends Cd{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class _m extends Cd{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Cm extends Cd{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var nu;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(nu||(nu={}));var tw=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(h){try{u(r.next(h))}catch(d){o(d)}}function c(h){try{u(r.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):i(h.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};class nw{constructor(t,{headers:n={},customFetch:r,region:i=nu.Any}={}){this.url=t,this.headers=n,this.region=i,this.fetch=Zv(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,n={}){var r;return tw(this,void 0,void 0,function*(){try{const{headers:i,method:a,body:o}=n;let l={},{region:c}=n;c||(c=this.region);const u=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let h;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",h=o):typeof o=="string"?(l["Content-Type"]="text/plain",h=o):typeof FormData<"u"&&o instanceof FormData?h=o:(l["Content-Type"]="application/json",h=JSON.stringify(o)));const d=yield this.fetch(u.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),i),body:h}).catch(y=>{throw new ew(y)}),f=d.headers.get("x-relay-error");if(f&&f==="true")throw new _m(d);if(!d.ok)throw new Cm(d);let m=((r=d.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),p;return m==="application/json"?p=yield d.json():m==="application/octet-stream"?p=yield d.blob():m==="text/event-stream"?p=d:m==="multipart/form-data"?p=yield d.formData():p=yield d.text(),{data:p,error:null,response:d}}catch(i){return{data:null,error:i,response:i instanceof Cm||i instanceof _m?i.context:void 0}}})}}var Lt={},Ed={},Jo={},aa={},Qo={},Xo={},rw=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ds=rw();const sw=Ds.fetch,bx=Ds.fetch.bind(Ds),vx=Ds.Headers,iw=Ds.Request,aw=Ds.Response,qs=Object.freeze(Object.defineProperty({__proto__:null,Headers:vx,Request:iw,Response:aw,default:bx,fetch:sw},Symbol.toStringTag,{value:"Module"})),ow=ub(qs);var Zo={};Object.defineProperty(Zo,"__esModule",{value:!0});let lw=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Zo.default=lw;var wx=vt&&vt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xo,"__esModule",{value:!0});const cw=wx(ow),uw=wx(Zo);let dw=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=cw.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,n){return this.headers=Object.assign({},this.headers),this.headers[t]=n,this}then(t,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var o,l,c;let u=null,h=null,d=null,f=a.status,m=a.statusText;if(a.ok){if(this.method!=="HEAD"){const g=await a.text();g===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?h=g:h=JSON.parse(g))}const y=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),S=(l=a.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");y&&S&&S.length>1&&(d=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(u={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,d=null,f=406,m="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const y=await a.text();try{u=JSON.parse(y),Array.isArray(u)&&a.status===404&&(h=[],u=null,f=200,m="OK")}catch{a.status===404&&y===""?(f=204,m="No Content"):u={message:y}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,f=200,m="OK"),u&&this.shouldThrowOnError)throw new uw.default(u)}return{error:u,data:h,count:d,status:f,statusText:m}});return this.shouldThrowOnError||(i=i.catch(a=>{var o,l,c;return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(l=a==null?void 0:a.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=a==null?void 0:a.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,n)}returns(){return this}overrideTypes(){return this}};Xo.default=dw;var hw=vt&&vt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Qo,"__esModule",{value:!0});const mw=hw(Xo);let fw=class extends mw.default{select(t){let n=!1;const r=(t??"*").split("").map(i=>/\s/.test(i)&&!n?"":(i==='"'&&(n=!n),i)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:n=!0,nullsFirst:r,foreignTable:i,referencedTable:a=i}={}){const o=a?`${a}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:n,referencedTable:r=n}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${t}`),this}range(t,n,{foreignTable:r,referencedTable:i=r}={}){const a=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(o,`${n-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:n=!1,settings:r=!1,buffers:i=!1,wal:a=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,n?"verbose":null,r?"settings":null,i?"buffers":null,a?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${c};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Qo.default=fw;var pw=vt&&vt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(aa,"__esModule",{value:!0});const gw=pw(Qo);let xw=class extends gw.default{eq(t,n){return this.url.searchParams.append(t,`eq.${n}`),this}neq(t,n){return this.url.searchParams.append(t,`neq.${n}`),this}gt(t,n){return this.url.searchParams.append(t,`gt.${n}`),this}gte(t,n){return this.url.searchParams.append(t,`gte.${n}`),this}lt(t,n){return this.url.searchParams.append(t,`lt.${n}`),this}lte(t,n){return this.url.searchParams.append(t,`lte.${n}`),this}like(t,n){return this.url.searchParams.append(t,`like.${n}`),this}likeAllOf(t,n){return this.url.searchParams.append(t,`like(all).{${n.join(",")}}`),this}likeAnyOf(t,n){return this.url.searchParams.append(t,`like(any).{${n.join(",")}}`),this}ilike(t,n){return this.url.searchParams.append(t,`ilike.${n}`),this}ilikeAllOf(t,n){return this.url.searchParams.append(t,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(t,n){return this.url.searchParams.append(t,`ilike(any).{${n.join(",")}}`),this}is(t,n){return this.url.searchParams.append(t,`is.${n}`),this}in(t,n){const r=Array.from(new Set(n)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cs.{${n.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(n)}`),this}containedBy(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cd.{${n.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(n)}`),this}rangeGt(t,n){return this.url.searchParams.append(t,`sr.${n}`),this}rangeGte(t,n){return this.url.searchParams.append(t,`nxl.${n}`),this}rangeLt(t,n){return this.url.searchParams.append(t,`sl.${n}`),this}rangeLte(t,n){return this.url.searchParams.append(t,`nxr.${n}`),this}rangeAdjacent(t,n){return this.url.searchParams.append(t,`adj.${n}`),this}overlaps(t,n){return typeof n=="string"?this.url.searchParams.append(t,`ov.${n}`):this.url.searchParams.append(t,`ov.{${n.join(",")}}`),this}textSearch(t,n,{config:r,type:i}={}){let a="";i==="plain"?a="pl":i==="phrase"?a="ph":i==="websearch"&&(a="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${a}fts${o}.${n}`),this}match(t){return Object.entries(t).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(t,n,r){return this.url.searchParams.append(t,`not.${n}.${r}`),this}or(t,{foreignTable:n,referencedTable:r=n}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${t})`),this}filter(t,n,r){return this.url.searchParams.append(t,`${n}.${r}`),this}};aa.default=xw;var yw=vt&&vt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Jo,"__esModule",{value:!0});const ri=yw(aa);let bw=class{constructor(t,{headers:n={},schema:r,fetch:i}){this.url=t,this.headers=n,this.schema=r,this.fetch=i}select(t,{head:n=!1,count:r}={}){const i=n?"HEAD":"GET";let a=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new ri.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:n,defaultToNull:r=!0}={}){const i="POST",a=[];if(this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),r||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new ri.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:n,ignoreDuplicates:r=!1,count:i,defaultToNull:a=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const c=t.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new ri.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:n}={}){const r="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),this.headers.Prefer=i.join(","),new ri.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const n="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new ri.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Jo.default=bw;var el={},tl={};Object.defineProperty(tl,"__esModule",{value:!0});tl.version=void 0;tl.version="0.0.0-automated";Object.defineProperty(el,"__esModule",{value:!0});el.DEFAULT_HEADERS=void 0;const vw=tl;el.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${vw.version}`};var jx=vt&&vt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ed,"__esModule",{value:!0});const ww=jx(Jo),jw=jx(aa),kw=el;let Nw=class kx{constructor(t,{headers:n={},schema:r,fetch:i}={}){this.url=t,this.headers=Object.assign(Object.assign({},kw.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=i}from(t){const n=new URL(`${this.url}/${t}`);return new ww.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new kx(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,n={},{head:r=!1,get:i=!1,count:a}={}){let o;const l=new URL(`${this.url}/rpc/${t}`);let c;r||i?(o=r?"HEAD":"GET",Object.entries(n).filter(([h,d])=>d!==void 0).map(([h,d])=>[h,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([h,d])=>{l.searchParams.append(h,d)})):(o="POST",c=n);const u=Object.assign({},this.headers);return a&&(u.Prefer=`count=${a}`),new jw.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Ed.default=Nw;var Gs=vt&&vt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Lt,"__esModule",{value:!0});Lt.PostgrestError=Lt.PostgrestBuilder=Lt.PostgrestTransformBuilder=Lt.PostgrestFilterBuilder=Lt.PostgrestQueryBuilder=Lt.PostgrestClient=void 0;const Nx=Gs(Ed);Lt.PostgrestClient=Nx.default;const Sx=Gs(Jo);Lt.PostgrestQueryBuilder=Sx.default;const _x=Gs(aa);Lt.PostgrestFilterBuilder=_x.default;const Cx=Gs(Qo);Lt.PostgrestTransformBuilder=Cx.default;const Ex=Gs(Xo);Lt.PostgrestBuilder=Ex.default;const Px=Gs(Zo);Lt.PostgrestError=Px.default;var Sw=Lt.default={PostgrestClient:Nx.default,PostgrestQueryBuilder:Sx.default,PostgrestFilterBuilder:_x.default,PostgrestTransformBuilder:Cx.default,PostgrestBuilder:Ex.default,PostgrestError:Px.default};const{PostgrestClient:_w,PostgrestQueryBuilder:m4,PostgrestFilterBuilder:f4,PostgrestTransformBuilder:p4,PostgrestBuilder:g4,PostgrestError:x4}=Sw;class Cw{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const n=parseInt(process.versions.node.split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const r=this.getWebSocketConstructor();return new r(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Ew="2.15.1",Pw=`realtime-js/${Ew}`,Tw="1.0.0",ru=1e4,Iw=1e3,Mw=100;var wi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(wi||(wi={}));var at;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(at||(at={}));var hn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(hn||(hn={}));var su;(function(e){e.websocket="websocket"})(su||(su={}));var Mr;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Mr||(Mr={}));class Aw{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,n,r)}_decodeBroadcast(t,n,r){const i=n.getUint8(1),a=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(t.slice(o,o+i));o=o+i;const c=r.decode(t.slice(o,o+a));o=o+a;const u=JSON.parse(r.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class Tx{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var $e;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})($e||($e={}));const Em=(e,t,n={})=>{var r;const i=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((a,o)=>(a[o]=Lw(o,e,t,i),a),{})},Lw=(e,t,n,r)=>{const i=t.find(l=>l.name===e),a=i==null?void 0:i.type,o=n[e];return a&&!r.includes(a)?Ix(a,o):iu(o)},Ix=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return Fw(t,n)}switch(e){case $e.bool:return Dw(t);case $e.float4:case $e.float8:case $e.int2:case $e.int4:case $e.int8:case $e.numeric:case $e.oid:return Ow(t);case $e.json:case $e.jsonb:return Rw(t);case $e.timestamp:return $w(t);case $e.abstime:case $e.date:case $e.daterange:case $e.int4range:case $e.int8range:case $e.money:case $e.reltime:case $e.text:case $e.time:case $e.timestamptz:case $e.timetz:case $e.tsrange:case $e.tstzrange:return iu(t);default:return iu(t)}},iu=e=>e,Dw=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Ow=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Rw=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Fw=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,r=e[n];if(e[0]==="{"&&r==="}"){let a;const o=e.slice(1,n);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>Ix(t,l))}return e},$w=e=>typeof e=="string"?e.replace(" ","T"):e,Mx=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Rl{constructor(t,n,r={},i=ru){this.channel=t,this.event=n,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var r;return this._hasReceived(t)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Pm;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Pm||(Pm={}));class ji{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ji.syncState(this.state,i,a,o),this.pendingDiffs.forEach(c=>{this.state=ji.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=ji.syncDiff(this.state,i,a,o),l())}),this.onJoin((i,a,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:o})}),this.onLeave((i,a,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,r,i){const a=this.cloneDeep(t),o=this.transformState(n),l={},c={};return this.map(a,(u,h)=>{o[u]||(c[u]=h)}),this.map(o,(u,h)=>{const d=a[u];if(d){const f=h.map(S=>S.presence_ref),m=d.map(S=>S.presence_ref),p=h.filter(S=>m.indexOf(S.presence_ref)<0),y=d.filter(S=>f.indexOf(S.presence_ref)<0);p.length>0&&(l[u]=p),y.length>0&&(c[u]=y)}else l[u]=h}),this.syncDiff(a,{joins:l,leaves:c},r,i)}static syncDiff(t,n,r,i){const{joins:a,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(a,(l,c)=>{var u;const h=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),h.length>0){const d=t[l].map(m=>m.presence_ref),f=h.filter(m=>d.indexOf(m.presence_ref)<0);t[l].unshift(...f)}r(l,h,c)}),this.map(o,(l,c)=>{let u=t[l];if(!u)return;const h=c.map(d=>d.presence_ref);u=u.filter(d=>h.indexOf(d.presence_ref)<0),t[l]=u,i(l,u,c),u.length===0&&delete t[l]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(r=>n(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,r)=>{const i=t[r];return"metas"in i?n[r]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):n[r]=i,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Tm;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Tm||(Tm={}));var ki;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(ki||(ki={}));var Ln;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Ln||(Ln={}));class Pd{constructor(t,n={config:{}},r){this.topic=t,this.params=n,this.socket=r,this.bindings={},this.state=at.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Rl(this,hn.join,this.params,this.timeout),this.rejoinTimer=new Tx(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=at.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=at.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=at.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=at.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=at.errored,this.rejoinTimer.scheduleTimeout())}),this._on(hn.reply,{},(i,a)=>{this._trigger(this._replyEventName(a),i)}),this.presence=new ji(this),this.broadcastEndpointURL=Mx(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,n=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==at.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(f=>f.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[ki.PRESENCE]&&this.bindings[ki.PRESENCE].length>0,h={},d={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(f=>t==null?void 0:t(Ln.CHANNEL_ERROR,f)),this._onClose(()=>t==null?void 0:t(Ln.CLOSED)),this.updateJoinPayload(Object.assign({config:d},h)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:f})=>{var m;if(this.socket.setAuth(),f===void 0){t==null||t(Ln.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,y=(m=p==null?void 0:p.length)!==null&&m!==void 0?m:0,S=[];for(let g=0;g<y;g++){const b=p[g],{filter:{event:x,schema:k,table:N,filter:w}}=b,C=f&&f[g];if(C&&C.event===x&&C.schema===k&&C.table===N&&C.filter===w)S.push(Object.assign(Object.assign({},b),{id:C.id}));else{this.unsubscribe(),this.state=at.errored,t==null||t(Ln.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,t&&t(Ln.SUBSCRIBED);return}}).receive("error",f=>{this.state=at.errored,t==null||t(Ln.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Ln.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,r){return this.state===at.joined&&t===ki.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,n,r)}async send(t,n={}){var r,i;if(!this._canPush()&&t.type==="broadcast"){const{event:a,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const u=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=at.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(hn.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(i=>{r=new Rl(this,hn.leave,{},t),r.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=at.closed,this.bindings={}}async _fetchWithTimeout(t,n,r){const i=new AbortController,a=setTimeout(()=>i.abort(),r),o=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(a),o}_push(t,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Rl(this,t,n,r);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Mw){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,r){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,r){var i,a;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:h}=hn;if(r&&[l,c,u,h].indexOf(o)>=0&&r!==this._joinRef())return;let f=this._onMessage(o,n,r);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(m=>{var p,y,S;return((p=m.filter)===null||p===void 0?void 0:p.event)==="*"||((S=(y=m.filter)===null||y===void 0?void 0:y.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(m=>m.callback(f,r)):(a=this.bindings[o])===null||a===void 0||a.filter(m=>{var p,y,S,g,b,x;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const k=m.id,N=(p=m.filter)===null||p===void 0?void 0:p.event;return k&&((y=n.ids)===null||y===void 0?void 0:y.includes(k))&&(N==="*"||(N==null?void 0:N.toLocaleLowerCase())===((S=n.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const k=(b=(g=m==null?void 0:m.filter)===null||g===void 0?void 0:g.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return k==="*"||k===((x=n==null?void 0:n.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:y,table:S,commit_timestamp:g,type:b,errors:x}=p;f=Object.assign(Object.assign({},{schema:y,table:S,commit_timestamp:g,eventType:b,new:{},old:{},errors:x}),this._getPayloadRecords(p))}m.callback(f,r)})}_isClosed(){return this.state===at.closed}_isJoined(){return this.state===at.joined}_isJoining(){return this.state===at.joining}_isLeaving(){return this.state===at.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,r){const i=t.toLocaleLowerCase(),a={type:i,filter:n,callback:r};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(t,n){const r=t.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===r&&Pd.isEqual(i.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(t[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(hn.close,{},t)}_onError(t){this._on(hn.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=at.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=Em(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=Em(t.columns,t.old_record)),n}}const Im=()=>{},Ea={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},zw=[1e3,2e3,5e3,1e4],Bw=1e4,Uw=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Vw{constructor(t,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ru,this.transport=null,this.heartbeatIntervalMs=Ea.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Im,this.ref=0,this.reconnectTimer=null,this.logger=Im,this.conn=null,this.sendBuffer=[],this.serializer=new Aw,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>ia(async()=>{const{default:l}=await Promise.resolve().then(()=>qs);return{default:l}},void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...o)=>a(...o)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${su.websocket}`,this.httpEndpoint=Mx(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Cw.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Tw}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},t?this.conn.close(t,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,r){this.logger(t,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case wi.connecting:return Mr.Connecting;case wi.open:return Mr.Open;case wi.closing:return Mr.Closing;default:return Mr.Closed}}isConnected(){return this.connectionState()===Mr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const r=`realtime:${t}`,i=this.getChannels().find(a=>a.topic===r);if(i)return i;{const a=new Pd(`realtime:${t}`,n,this);return this.channels.push(a),a}}push(t){const{topic:n,event:r,payload:i,ref:a}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${r} (${a})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Iw,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Ea.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{n.topic==="phoenix"&&n.event==="phx_reply"&&this.heartbeatCallback(n.payload.status==="ok"?"ok":"error"),n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:i,payload:a,ref:o}=n,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${r} ${i} ${l}`.trim(),a),this.channels.filter(u=>u._isMember(r)).forEach(u=>u._trigger(i,a,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(hn.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const r=t.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${t}${r}${i}`}_workerObjectUrl(t){let n;if(t)n=t;else{const r=new Blob([Uw],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n;t?n=t:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const i={access_token:n,version:Pw};n&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(hn.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(r=>{try{r(n)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(r){this.log("error",`error triggering ${t} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Tx(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ea.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,r,i,a,o,l,c,u;if(this.transport=(n=t==null?void 0:t.transport)!==null&&n!==void 0?n:null,this.timeout=(r=t==null?void 0:t.timeout)!==null&&r!==void 0?r:ru,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:Ea.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t==null?void 0:t.reconnectAfterMs)!==null&&l!==void 0?l:h=>zw[h-1]||Bw,this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(h,d)=>d(JSON.stringify(h)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class Td extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ot(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class qw extends Td{constructor(t,n,r){super(t),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class au extends Td{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}var Gw=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(h){try{u(r.next(h))}catch(d){o(d)}}function c(h){try{u(r.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):i(h.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const Ax=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>ia(async()=>{const{default:r}=await Promise.resolve().then(()=>qs);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},Hw=()=>Gw(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ia(()=>Promise.resolve().then(()=>qs),void 0)).Response:Response}),ou=e=>{if(Array.isArray(e))return e.map(n=>ou(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,r])=>{const i=n.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[i]=ou(r)}),t},Ww=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Wr=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(h){try{u(r.next(h))}catch(d){o(d)}}function c(h){try{u(r.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):i(h.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const Fl=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Yw=(e,t,n)=>Wr(void 0,void 0,void 0,function*(){const r=yield Hw();e instanceof r&&!(n!=null&&n.noResolveJson)?e.json().then(i=>{const a=e.status||500,o=(i==null?void 0:i.statusCode)||a+"";t(new qw(Fl(i),a,o))}).catch(i=>{t(new au(Fl(i),i))}):t(new au(Fl(e),e))}),Kw=(e,t,n,r)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!r?i:(Ww(r)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(r)):i.body=r,t!=null&&t.duplex&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),n))};function oa(e,t,n,r,i,a){return Wr(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(n,Kw(t,r,i,a)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Yw(c,l,r))})})}function ko(e,t,n,r){return Wr(this,void 0,void 0,function*(){return oa(e,"GET",t,n,r)})}function kn(e,t,n,r,i){return Wr(this,void 0,void 0,function*(){return oa(e,"POST",t,r,i,n)})}function lu(e,t,n,r,i){return Wr(this,void 0,void 0,function*(){return oa(e,"PUT",t,r,i,n)})}function Jw(e,t,n,r){return Wr(this,void 0,void 0,function*(){return oa(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function Lx(e,t,n,r,i){return Wr(this,void 0,void 0,function*(){return oa(e,"DELETE",t,r,i,n)})}var Nt=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(h){try{u(r.next(h))}catch(d){o(d)}}function c(h){try{u(r.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):i(h.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const Qw={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Mm={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Xw{constructor(t,n={},r,i){this.url=t,this.headers=n,this.bucketId=r,this.fetch=Ax(i)}uploadOrUpdate(t,n,r,i){return Nt(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},Mm),i);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const u=this._removeEmptyFolders(n),h=this._getFinalPath(u),d=yield(t=="PUT"?lu:kn)(this.fetch,`${this.url}/object/${h}`,a,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:d.Id,fullPath:d.Key},error:null}}catch(a){if(ot(a))return{data:null,error:a};throw a}})}upload(t,n,r){return Nt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,r)})}uploadToSignedUrl(t,n,r,i){return Nt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let c;const u=Object.assign({upsert:Mm.upsert},i),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",u.cacheControl)):(c=r,h["cache-control"]=`max-age=${u.cacheControl}`,h["content-type"]=u.contentType);const d=yield lu(this.fetch,l.toString(),c,{headers:h});return{data:{path:a,fullPath:d.Key},error:null}}catch(c){if(ot(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,n){return Nt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const i=Object.assign({},this.headers);n!=null&&n.upsert&&(i["x-upsert"]="true");const a=yield kn(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new Td("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(r){if(ot(r))return{data:null,error:r};throw r}})}update(t,n,r){return Nt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,r)})}move(t,n,r){return Nt(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}copy(t,n,r){return Nt(this,void 0,void 0,function*(){try{return{data:{path:(yield kn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}createSignedUrl(t,n,r){return Nt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),a=yield kn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}createSignedUrls(t,n,r){return Nt(this,void 0,void 0,function*(){try{const i=yield kn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}download(t,n){return Nt(this,void 0,void 0,function*(){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=a?`?${a}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield ko(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(ot(l))return{data:null,error:l};throw l}})}info(t){return Nt(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const r=yield ko(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:ou(r),error:null}}catch(r){if(ot(r))return{data:null,error:r};throw r}})}exists(t){return Nt(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield Jw(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(ot(r)&&r instanceof au){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,n){const r=this._getFinalPath(t),i=[],a=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";a!==""&&i.push(a);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});c!==""&&i.push(c);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}remove(t){return Nt(this,void 0,void 0,function*(){try{return{data:yield Lx(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}list(t,n,r){return Nt(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Qw),n),{prefix:t||""});return{data:yield kn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}listV2(t,n){return Nt(this,void 0,void 0,function*(){try{const r=Object.assign({},t);return{data:yield kn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(ot(r))return{data:null,error:r};throw r}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const Zw="2.11.0",e1={"X-Client-Info":`storage-js/${Zw}`};var Xr=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(h){try{u(r.next(h))}catch(d){o(d)}}function c(h){try{u(r.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):i(h.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};class t1{constructor(t,n={},r,i){const a=new URL(t);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},e1),n),this.fetch=Ax(r)}listBuckets(){return Xr(this,void 0,void 0,function*(){try{return{data:yield ko(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}})}getBucket(t){return Xr(this,void 0,void 0,function*(){try{return{data:yield ko(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}createBucket(t,n={public:!1}){return Xr(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ot(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return Xr(this,void 0,void 0,function*(){try{return{data:yield lu(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(ot(r))return{data:null,error:r};throw r}})}emptyBucket(t){return Xr(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}deleteBucket(t){return Xr(this,void 0,void 0,function*(){try{return{data:yield Lx(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}}class n1 extends t1{constructor(t,n={},r,i){super(t,n,r,i)}from(t){return new Xw(this.url,this.headers,t,this.fetch)}}const r1="2.55.0";let ui="";typeof Deno<"u"?ui="deno":typeof document<"u"?ui="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ui="react-native":ui="node";const s1={"X-Client-Info":`supabase-js-${ui}/${r1}`},i1={headers:s1},a1={schema:"public"},o1={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},l1={};var c1=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(h){try{u(r.next(h))}catch(d){o(d)}}function c(h){try{u(r.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):i(h.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const u1=e=>{let t;return e?t=e:typeof fetch>"u"?t=bx:t=fetch,(...n)=>t(...n)},d1=()=>typeof Headers>"u"?vx:Headers,h1=(e,t,n)=>{const r=u1(n),i=d1();return(a,o)=>c1(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let u=new i(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),r(a,Object.assign(Object.assign({},o),{headers:u}))})};var m1=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(h){try{u(r.next(h))}catch(d){o(d)}}function c(h){try{u(r.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):i(h.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};function f1(e){return e.endsWith("/")?e:e+"/"}function p1(e,t){var n,r;const{db:i,auth:a,realtime:o,global:l}=e,{db:c,auth:u,realtime:h,global:d}=t,f={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},h),o),storage:{},global:Object.assign(Object.assign(Object.assign({},d),l),{headers:Object.assign(Object.assign({},(n=d==null?void 0:d.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>m1(this,void 0,void 0,function*(){return""})};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}const Dx="2.71.1",ss=30*1e3,cu=3,$l=cu*ss,g1="http://localhost:9999",x1="supabase.auth.token",y1={"X-Client-Info":`gotrue-js/${Dx}`},uu="X-Supabase-Api-Version",Ox={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},b1=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,v1=10*60*1e3;class Id extends Error{constructor(t,n,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function ke(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class w1 extends Id{constructor(t,n,r){super(t,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function j1(e){return ke(e)&&e.name==="AuthApiError"}class Rx extends Id{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class jr extends Id{constructor(t,n,r,i){super(t,r,i),this.name=n,this.status=r}}class Xn extends jr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function k1(e){return ke(e)&&e.name==="AuthSessionMissingError"}class Pa extends jr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ta extends jr{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Ia extends jr{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function N1(e){return ke(e)&&e.name==="AuthImplicitGrantRedirectError"}class Am extends jr{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class du extends jr{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function zl(e){return ke(e)&&e.name==="AuthRetryableFetchError"}class Lm extends jr{constructor(t,n,r){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class hu extends jr{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const No="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Dm=` 	
\r=`.split(""),S1=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Dm.length;t+=1)e[Dm[t].charCodeAt(0)]=-2;for(let t=0;t<No.length;t+=1)e[No[t].charCodeAt(0)]=t;return e})();function Om(e,t,n){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(No[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(No[r]),t.queuedBits-=6}}function Fx(e,t,n){const r=S1[e];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Rm(e){const t=[],n=o=>{t.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=o=>{E1(o,r,n)};for(let o=0;o<e.length;o+=1)Fx(e.charCodeAt(o),i,a);return t.join("")}function _1(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function C1(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const i=(r-55296)*1024&65535;r=(e.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}_1(r,t)}}function E1(e,t,n){if(t.utf8seq===0){if(e<=127){n(e);return}for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function P1(e){const t=[],n={queue:0,queuedBits:0},r=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Fx(e.charCodeAt(i),n,r);return new Uint8Array(t)}function T1(e){const t=[];return C1(e,n=>t.push(n)),new Uint8Array(t)}function I1(e){const t=[],n={queue:0,queuedBits:0},r=i=>{t.push(i)};return e.forEach(i=>Om(i,n,r)),Om(null,n,r),t.join("")}function M1(e){return Math.round(Date.now()/1e3)+e}function A1(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const ln=()=>typeof window<"u"&&typeof document<"u",Sr={tested:!1,writable:!1},$x=()=>{if(!ln())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Sr.tested)return Sr.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Sr.tested=!0,Sr.writable=!0}catch{Sr.tested=!0,Sr.writable=!1}return Sr.writable};function L1(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,a)=>{t[a]=i})}catch{}return n.searchParams.forEach((r,i)=>{t[i]=r}),t}const zx=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>ia(async()=>{const{default:r}=await Promise.resolve().then(()=>qs);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},D1=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",is=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},_r=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Jn=async(e,t)=>{await e.removeItem(t)};class nl{constructor(){this.promise=new nl.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}nl.promiseConstructor=Promise;function Bl(e){const t=e.split(".");if(t.length!==3)throw new hu("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!b1.test(t[r]))throw new hu("JWT not in base64url format");return{header:JSON.parse(Rm(t[0])),payload:JSON.parse(Rm(t[1])),signature:P1(t[2]),raw:{header:t[0],payload:t[1]}}}async function O1(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function R1(e,t){return new Promise((r,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await e(a);if(!t(a,null,o)){r(o);return}}catch(o){if(!t(a,o)){i(o);return}}})()})}function F1(e){return("0"+e.toString(16)).substr(-2)}function $1(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let i="";for(let a=0;a<56;a++)i+=n.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(t),Array.from(t,F1).join("")}async function z1(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(r);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function B1(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await z1(e);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Zr(e,t,n=!1){const r=$1();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await is(e,`${t}-code-verifier`,i);const a=await B1(r);return[a,r===a?"plain":"s256"]}const U1=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function V1(e){const t=e.headers.get(uu);if(!t||!t.match(U1))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function q1(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function G1(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const H1=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function es(e){if(!H1.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ul(){const e={};return new Proxy(e,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Fm(e){return JSON.parse(JSON.stringify(e))}var W1=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const Ir=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Y1=[502,503,504];async function $m(e){var t;if(!D1(e))throw new du(Ir(e),0);if(Y1.includes(e.status))throw new du(Ir(e),e.status);let n;try{n=await e.json()}catch(a){throw new Rx(Ir(a),a)}let r;const i=V1(e);if(i&&i.getTime()>=Ox["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new Lm(Ir(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new Xn}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new Lm(Ir(n),e.status,n.weak_password.reasons);throw new w1(Ir(n),e.status||500,r)}const K1=(e,t,n,r)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};async function Ee(e,t,n,r){var i;const a=Object.assign({},r==null?void 0:r.headers);a[uu]||(a[uu]=Ox["2024-01-01"].name),r!=null&&r.jwt&&(a.Authorization=`Bearer ${r.jwt}`);const o=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await J1(e,t,n+l,{headers:a,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function J1(e,t,n,r,i,a){const o=K1(t,r,i,a);let l;try{l=await e(n,Object.assign({},o))}catch(c){throw console.error(c),new du(Ir(c),0)}if(l.ok||await $m(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await $m(c)}}function Mn(e){var t;let n=null;ej(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=M1(e.expires_in)));const r=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:r},error:null}}function zm(e){const t=Mn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(t.data.weak_password=e.weak_password),t}function sr(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Q1(e){return{data:e,error:null}}function X1(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:i,verification_type:a}=e,o=W1(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:n,hashed_token:r,redirect_to:i,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Z1(e){return e}function ej(e){return e.access_token&&e.refresh_token&&e.expires_in}const Vl=["global","local","others"];var tj=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};class nj{constructor({url:t="",headers:n={},fetch:r}){this.url=t,this.headers=n,this.fetch=zx(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,n=Vl[0]){if(Vl.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Vl.join(", ")}`);try{return await Ee(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ke(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,n={}){try{return await Ee(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:sr})}catch(r){if(ke(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:n}=t,r=tj(t,["options"]),i=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await Ee(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:X1,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ke(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await Ee(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:sr})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,r,i,a,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},h=await Ee(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:Z1});if(h.error)throw h.error;const d=await h.json(),f=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(p=>{const y=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(p.split(";")[1].split("=")[1]);u[`${S}Page`]=y}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(ke(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){es(t);try{return await Ee(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:sr})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){es(t);try{return await Ee(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:sr})}catch(r){if(ke(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,n=!1){es(t);try{return await Ee(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:sr})}catch(r){if(ke(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){es(t.userId);try{const{data:n,error:r}=await Ee(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:r}}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _deleteFactor(t){es(t.userId),es(t.id);try{return{data:await Ee(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(ke(n))return{data:null,error:n};throw n}}}function Bm(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}function rj(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ts={debug:!!(globalThis&&$x()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Bx extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class sj extends Bx{}async function ij(e,t,n){ts.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),ts.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){ts.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await n()}finally{ts.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw ts.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new sj(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ts.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}rj();const aj={url:g1,storageKey:x1,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:y1,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Um(e,t,n){return await n()}const ns={};class Yi{constructor(t){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Yi.nextInstanceID,Yi.nextInstanceID+=1,this.instanceID>0&&ln()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},aj),t);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new nj({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=zx(i.fetch),this.lock=i.lock||Um,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:ln()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=ij:this.lock=Um,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:$x()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Bm(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Bm(this.memoryStorage)),ln()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var t,n;return(n=(t=ns[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){ns[this.storageKey]=Object.assign(Object.assign({},ns[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=ns[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ns[this.storageKey]=Object.assign(Object.assign({},ns[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Dx}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=L1(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),ln()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:a}=await this._getSessionFromURL(n,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),N1(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ke(n)?{error:n}:{error:new Rx("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,r,i;try{const a=await Ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:Mn}),{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(ke(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(t){var n,r,i;try{let a;if("email"in t){const{email:h,password:d,options:f}=t;let m=null,p=null;this.flowType==="pkce"&&([m,p]=await Zr(this.storage,this.storageKey)),a=await Ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:h,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:m,code_challenge_method:p},xform:Mn})}else if("phone"in t){const{phone:h,password:d,options:f}=t;a=await Ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:d,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Mn})}else throw new Ta("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(ke(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(t){try{let n;if("email"in t){const{email:a,password:o,options:l}=t;n=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:zm})}else if("phone"in t){const{phone:a,password:o,options:l}=t;n=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:zm})}else throw new Ta("You must provide either an email or phone number and a password");const{data:r,error:i}=n;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Pa}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(n){if(ke(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,r,i,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;if(n==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(t){var n,r,i,a,o,l,c,u,h,d,f,m;let p,y;if("message"in t)p=t.message,y=t.signature;else{const{chain:S,wallet:g,statement:b,options:x}=t;let k;if(ln())if(typeof g=="object")k=g;else{const w=window;if("solana"in w&&typeof w.solana=="object"&&("signIn"in w.solana&&typeof w.solana.signIn=="function"||"signMessage"in w.solana&&typeof w.solana.signMessage=="function"))k=w.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=g}const N=new URL((n=x==null?void 0:x.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in k&&k.signIn){const w=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x==null?void 0:x.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),b?{statement:b}:null));let C;if(Array.isArray(w)&&w[0]&&typeof w[0]=="object")C=w[0];else if(w&&typeof w=="object"&&"signedMessage"in w&&"signature"in w)C=w;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)p=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),y=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${N.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(i=(r=x==null?void 0:x.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=x==null?void 0:x.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((o=x==null?void 0:x.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((l=x==null?void 0:x.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((c=x==null?void 0:x.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((u=x==null?void 0:x.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((d=(h=x==null?void 0:x.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||d===void 0)&&d.length?["Resources",...x.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const w=await k.signMessage(new TextEncoder().encode(p),"utf8");if(!w||!(w instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=w}}try{const{data:S,error:g}=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:I1(y)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Mn});if(g)throw g;return!S||!S.session||!S.user?{data:{user:null,session:null},error:new Pa}:(S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),{data:Object.assign({},S),error:g})}catch(S){if(ke(S))return{data:{user:null,session:null},error:S};throw S}}async _exchangeCodeForSession(t){const n=await _r(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(n??"").split("/");try{const{data:a,error:o}=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:Mn});if(await Jn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Pa}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:o})}catch(a){if(ke(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(t){try{const{options:n,provider:r,token:i,access_token:a,nonce:o}=t,l=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Mn}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Pa}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(n){if(ke(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,r,i,a,o;try{if("email"in t){const{email:l,options:c}=t;let u=null,h=null;this.flowType==="pkce"&&([u,h]=await Zr(this.storage,this.storageKey));const{error:d}=await Ee(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:h},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:h}=await Ee(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:h}}throw new Ta("You must provide either an email or phone number.")}catch(l){if(ke(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var n,r;try{let i,a;"options"in t&&(i=(n=t.options)===null||n===void 0?void 0:n.redirectTo,a=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await Ee(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:Mn});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(ke(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(t){var n,r,i;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await Zr(this.storage,this.storageKey)),await Ee(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:Q1})}catch(a){if(ke(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;if(r)throw r;if(!n)throw new Xn;const{error:i}=await Ee(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(t){if(ke(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:r,type:i,options:a}=t,{error:o}=await Ee(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:r,type:i,options:a}=t,{data:o,error:l}=await Ee(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Ta("You must provide either an email or phone number and a type")}catch(n){if(ke(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await _r(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<$l:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){const o=await _r(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=Ul()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,h)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,h))})}return{data:{session:t},error:null}}const{session:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ee(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:sr}):await this._useSession(async n=>{var r,i,a;const{data:o,error:l}=n;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Xn}:await Ee(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:sr})})}catch(n){if(ke(n))return k1(n)&&(await this._removeSession(),await Jn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async r=>{const{data:i,error:a}=r;if(a)throw a;if(!i.session)throw new Xn;const o=i.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await Zr(this.storage,this.storageKey));const{data:u,error:h}=await Ee(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:sr});if(h)throw h;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(ke(r))return{data:{user:null},error:r};throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Xn;const n=Date.now()/1e3;let r=n,i=!0,a=null;const{payload:o}=Bl(t.access_token);if(o.exp&&(r=o.exp,i=r<=n),i){const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(n){if(ke(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var r;if(!t){const{data:o,error:l}=n;if(l)throw l;t=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new Xn;const{session:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ke(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!ln())throw new Ia("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Ia(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Am("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ia("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Am("No code detected.");const{data:b,error:x}=await this._exchangeCodeForSession(t.code);if(x)throw x;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=t;if(!a||!l||!o||!u)throw new Ia("No session defined in URL");const h=Math.round(Date.now()/1e3),d=parseInt(l);let f=h+d;c&&(f=parseInt(c));const m=f-h;m*1e3<=ss&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${d}s`);const p=f-d;h-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,h):h-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,h);const{data:y,error:S}=await this._getUser(a);if(S)throw S;const g={provider_token:r,provider_refresh_token:i,access_token:a,expires_in:d,expires_at:f,refresh_token:o,token_type:u,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:t.type},error:null}}catch(r){if(ke(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await _r(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:i,error:a}=n;if(a)return{error:a};const o=(r=i.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(j1(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await Jn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=A1(),r={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async n=>{var r,i;try{const{data:{session:a},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,n={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await Zr(this.storage,this.storageKey,!0));try{return await Ee(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(a){if(ke(a))return{data:null,error:a};throw a}}async getUserIdentities(){var t;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(ke(n))return{data:null,error:n};throw n}}async linkIdentity(t){var n;try{const{data:r,error:i}=await this._useSession(async a=>{var o,l,c,u,h;const{data:d,error:f}=a;if(f)throw f;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Ee(this.fetch,"GET",m,{headers:this.headers,jwt:(h=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&h!==void 0?h:void 0})});if(i)throw i;return ln()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:t.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(ke(r))return{data:{provider:t.provider,url:null},error:r};throw r}}async unlinkIdentity(t){try{return await this._useSession(async n=>{var r,i;const{data:a,error:o}=n;if(o)throw o;return await Ee(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await R1(async i=>(i>0&&await O1(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await Ee(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Mn})),(i,a)=>{const o=200*Math.pow(2,i);return a&&zl(a)&&Date.now()+o-r<ss})}catch(r){if(this._debug(n,"error",r),ke(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",r),ln()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const i=await _r(this.storage,this.storageKey);if(i&&this.userStorage){let o=await _r(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await is(this.userStorage,this.storageKey+"-user",o)),i.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:Ul()}else if(i&&!i.user&&!i.user){const o=await _r(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await Jn(this.storage,this.storageKey+"-user"),await is(this.storage,this.storageKey,i)):i.user=Ul()}if(this._debug(r,"session from storage",i),!this._isValidSession(i)){this._debug(r,"session is not valid"),i!==null&&await this._removeSession();return}const a=((n=i.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<$l;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${$l}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),zl(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(r,"error",i),console.error(i);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var n,r;if(!t)throw new Xn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new nl;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new Xn;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={session:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(i,"error",a),ke(a)){const o={session:null,error:a};return zl(a)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,n,r=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:n});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,n)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await is(this.userStorage,this.storageKey+"-user",{user:n.user});const i=Object.assign({},n);delete i.user;const a=Fm(i);await is(this.storage,this.storageKey,a)}else{const i=Fm(n);await is(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Jn(this.storage,this.storageKey),await Jn(this.storage,this.storageKey+"-code-verifier"),await Jn(this.storage,this.storageKey+"-user"),this.userStorage&&await Jn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ln()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ss);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-t)/ss);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ss}ms, refresh threshold is ${cu} ticks`),i<=cu&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Bx)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ln()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,r){const i=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[a,o]=await Zr(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(r!=null&&r.queryParams){const a=new URLSearchParams(r.queryParams);i.push(a.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var r;const{data:i,error:a}=n;return a?{data:null,error:a}:await Ee(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var r,i;const{data:a,error:o}=n;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await Ee(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(n){if(ke(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:a}=n;if(a)return{data:null,error:a};const{data:o,error:l}=await Ee(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(ke(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:a}=n;return a?{data:null,error:a}:await Ee(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ke(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:r}=await this._challenge({factorId:t.factorId});return r?{data:null,error:r}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(t==null?void 0:t.factors)||[],i=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:i,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,r;const{data:{session:i},error:a}=t;if(a)return{data:null,error:a};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Bl(i.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((r=(n=i.user.factors)===null||n===void 0?void 0:n.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const h=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:h},error:null}}))}async fetchJwk(t,n={keys:[]}){let r=n.keys.find(l=>l.kid===t);if(r)return r;const i=Date.now();if(r=this.jwks.keys.find(l=>l.kid===t),r&&this.jwks_cached_at+v1>i)return r;const{data:a,error:o}=await Ee(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,r=a.keys.find(l=>l.kid===t),!r)?null:r}async getClaims(t,n={}){try{let r=t;if(!r){const{data:m,error:p}=await this.getSession();if(p||!m.session)return{data:null,error:p};r=m.session.access_token}const{header:i,payload:a,signature:o,raw:{header:l,payload:c}}=Bl(r);n!=null&&n.allowExpired||q1(a.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:m}=await this.getUser(r);if(m)throw m;return{data:{claims:a,header:i,signature:o},error:null}}const h=G1(i.alg),d=await crypto.subtle.importKey("jwk",u,h,!0,["verify"]);if(!await crypto.subtle.verify(h,d,o,T1(`${l}.${c}`)))throw new hu("Invalid JWT signature");return{data:{claims:a,header:i,signature:o},error:null}}catch(r){if(ke(r))return{data:null,error:r};throw r}}}Yi.nextInstanceID=0;const oj=Yi;class lj extends oj{constructor(t){super(t)}}var cj=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function l(h){try{u(r.next(h))}catch(d){o(d)}}function c(h){try{u(r.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):i(h.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};class uj{constructor(t,n,r){var i,a,o;if(this.supabaseUrl=t,this.supabaseKey=n,!t)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=f1(t),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,h={db:a1,realtime:l1,auth:Object.assign(Object.assign({},o1),{storageKey:u}),global:i1},d=p1(r??{},h);this.storageKey=(i=d.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=h1(n,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new _w(new URL("rest/v1",c).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new n1(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new nw(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},r={}){return this.rest.rpc(t,n,r)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,n;return cj(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:i,storageKey:a,flowType:o,lock:l,debug:c},u,h){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new lj({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),u),storageKey:a,autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:i,flowType:o,lock:l,debug:c,fetch:h,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Vw(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,n,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const dj=(e,t,n)=>new uj(e,t,n);function hj(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}hj()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const mj="https://dthxptbozocrbvmhwvao.supabase.co",fj="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0aHhwdGJvem9jcmJ2bWh3dmFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyOTY0MzMsImV4cCI6MjA3MDg3MjQzM30.gFt4oRFZ7Mh4y8DgeKNbcKKDwTYjEdXRoBlqTNjvdRg",Y=dj(mj,fj,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"}});Y.auth.getSession().then(({data:e,error:t})=>{t?console.error(" Supabase auth error:",t):console.log(" Supabase client initialized successfully")});const pj=()=>window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",Ni=()=>pj()?"http://localhost:5173":`${window.location.origin}/`,ql=()=>{const e=Ni();return`${e.endsWith("/")?e.slice(0,-1):e}/auth/callback`},So=e=>{const t=Ni(),n=t.endsWith("/")?t.slice(0,-1):t,r=e.startsWith("/")?e:`/${e}`;return`${n}${r}`};function Ge(){const[e,t]=j.useState(null),[n,r]=j.useState(!0),i=async f=>{if(console.log("fetchUserProfile called with session:",f?"exists":"null"),!(f!=null&&f.user)){console.log("No session or user, setting user to null"),t(null);return}try{const{data:m,error:p}=await Y.from("users").select("is_admin, user_name_public, onboarded, fav_games, fav_locations").eq("id",f.user.id).single();p&&p.code!=="PGRST116"&&console.error("Error fetching user profile:",p);const{data:y,error:S}=await Y.from("locations").select("id").contains("admins",[f.user.id]).limit(1),g=!S&&y&&y.length>0;t({...f.user,is_admin:(m==null?void 0:m.is_admin)||!1,is_location_admin:g,user_name_public:(m==null?void 0:m.user_name_public)||null,onboarded:(m==null?void 0:m.onboarded)||!1,fav_games:(m==null?void 0:m.fav_games)||null,fav_locations:(m==null?void 0:m.fav_locations)||null})}catch(m){console.error("Error fetching user profile:",m),t(f.user)}};j.useEffect(()=>{Y.auth.getSession().then(({data:{session:m}})=>{i(m),r(!1)});const{data:{subscription:f}}=Y.auth.onAuthStateChange((m,p)=>{console.log("Auth state change:",{event:m,session:p?"exists":"null"}),i(p),r(!1)});return()=>f.unsubscribe()},[]);const a=async(f,m)=>{const{data:p,error:y}=await Y.auth.signInWithPassword({email:f,password:m});return{data:p,error:y}},o=async(f,m)=>{const{data:p,error:y}=await Y.auth.signUp({email:f,password:m,options:{emailRedirectTo:ql()}});return{data:p,error:y}},l=async()=>{const{data:f,error:m}=await Y.auth.signInWithOAuth({provider:"google",options:{redirectTo:ql(),queryParams:{hd:"",prompt:"select_account"}}});return{data:f,error:m}},c=async()=>{try{console.log("Calling Supabase auth.signOut()...");const{data:{session:f}}=await Y.auth.getSession();if(!f)return console.log("No active session found, clearing user state directly"),t(null),localStorage.removeItem("supabase.auth.token"),sessionStorage.removeItem("supabase.auth.token"),Object.keys(localStorage).forEach(p=>{p.startsWith("supabase.")&&localStorage.removeItem(p)}),Object.keys(sessionStorage).forEach(p=>{p.startsWith("supabase.")&&sessionStorage.removeItem(p)}),{error:null};const{error:m}=await Y.auth.signOut();return console.log("Supabase signOut response:",{error:m}),m?console.error("Supabase sign out error:",m):console.log("Supabase signOut successful"),{error:m}}catch(f){return console.error("Sign out error:",f),t(null),localStorage.removeItem("supabase.auth.token"),sessionStorage.removeItem("supabase.auth.token"),Object.keys(localStorage).forEach(m=>{m.startsWith("supabase.")&&localStorage.removeItem(m)}),Object.keys(sessionStorage).forEach(m=>{m.startsWith("supabase.")&&sessionStorage.removeItem(m)}),{error:f}}},u=async f=>{const{data:m,error:p}=await Y.auth.resetPasswordForEmail(f,{redirectTo:ql()});return{data:m,error:p}},h=async f=>{const{data:m,error:p}=await Y.auth.updateUser({password:f});return{data:m,error:p}},d=e&&window.location.hash.includes("type=recovery");return{user:e,loading:n,signIn:a,signUp:o,signInWithGoogle:l,signOut:c,resetPassword:u,updatePassword:h,needsPasswordReset:d}}function Md(){const[e,t]=j.useState(()=>{const r=localStorage.getItem("darkMode");return r!==null?JSON.parse(r):window.matchMedia("(prefers-color-scheme: dark)").matches});return j.useEffect(()=>{e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem("darkMode",JSON.stringify(e))},[e]),{isDarkMode:e,toggleDarkMode:()=>{t(!e)}}}function rl({message:e,isVisible:t,onClose:n,duration:r=3e3}){return j.useEffect(()=>{if(t){const i=setTimeout(()=>{n()},r);return()=>clearTimeout(i)}},[t,r,n]),t?s.jsx("div",{className:"fixed top-4 right-4 z-[60] animate-in slide-in-from-top-2 duration-300",children:s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg shadow-lg p-4 flex items-center space-x-3 max-w-sm",children:[s.jsx(lx,{className:"w-5 h-5 text-icon-active flex-shrink-0"}),s.jsx("p",{className:"text-sm font-medium text-green-800 flex-1",children:e}),s.jsx("button",{onClick:n,className:"text-green-600 hover:text-green-800 transition-colors",children:s.jsx(fe,{className:"w-4 h-4 text-icon"})})]})}):null}function Dn({onAddModel:e,onAdminClick:t,onSettingsClick:n,activeTab:r,onTabChange:i}){const[a,o]=j.useState(!1),[l,c]=j.useState(!1),[u,h]=j.useState(""),[d,f]=j.useState(!1),{isDarkMode:m,toggleDarkMode:p}=Md(),{user:y,signOut:S}=Ge(),g=async()=>{try{console.log("Starting sign out process..."),o(!1);const{error:k}=await S();console.log("Sign out result:",{error:k}),k?(console.error("Sign out error:",k),h("Failed to sign out. Please try again."),f(!0)):(console.log("Sign out successful"),h("Successfully signed out"),f(!0))}catch(k){console.error("Sign out error:",k),h("Failed to sign out. Please try again."),f(!0)}},b=[{id:"collection",name:"Collection",icon:vn},{id:"battles",name:"Battles",icon:Sd},{id:"battleplan",name:"Battleplan",icon:Xe}],x=k=>{c(!1),i==null||i(k)};return s.jsxs(s.Fragment,{children:[s.jsx("header",{className:"bg-bg-primary shadow-sm border-b border-border-custom relative z-50",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsx("div",{className:"flex items-center",children:y&&s.jsx("button",{onClick:()=>c(!l),className:"text-secondary-text hover:text-text focus:outline-none mr-4",children:l?s.jsx(fe,{className:"w-6 h-6 text-icon"}):s.jsx(Gv,{className:"w-6 h-6 text-icon"})})}),s.jsx("div",{className:"flex items-center justify-center flex-1",children:s.jsx("button",{onClick:()=>i==null?void 0:i("collection"),className:"hover:opacity-80 transition-opacity focus:outline-none",children:s.jsx("img",{src:"Battleplan-Logo-Purple.svg",alt:"Mini Myths Logo",className:"max-h-[300px] w-auto"})})}),s.jsx("div",{className:"flex items-center space-x-4",children:y?s.jsx(s.Fragment,{children:s.jsx("button",{onClick:()=>o(!a),className:"text-secondary-text hover:text-text focus:outline-none",children:s.jsx($t,{className:"w-6 h-6 text-icon hover:text-icon-hover"})})}):null})]}),y&&s.jsxs("div",{className:`absolute right-4 top-16 bg-bg-primary border border-border-custom rounded-lg shadow-lg py-2 z-50 min-w-[200px] transition-all duration-200 ease-in-out ${a?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 -translate-y-2 pointer-events-none"}`,children:[s.jsx("div",{className:"px-4 py-2 border-b border-border-custom",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx($t,{className:"w-5 h-5 text-icon"}),s.jsx("span",{className:"text-base text-text",children:y.email})]})}),s.jsxs("button",{onClick:()=>{o(!1),t==null||t()},className:`flex items-center space-x-3 w-full text-left px-4 py-2 text-base font-semibold text-text hover:bg-bg-secondary transition-colors ${y!=null&&y.is_admin||y!=null&&y.is_location_admin?"":"hidden"}`,children:[s.jsx(Yv,{className:"w-5 h-5 text-icon hover:text-icon-hover"}),s.jsx("span",{children:"Admin"})]}),s.jsxs("button",{onClick:()=>{o(!1),n==null||n()},className:"flex items-center space-x-3 w-full text-left px-4 py-2 text-base font-semibold text-text hover:bg-bg-secondary transition-colors",children:[s.jsx(Wv,{className:"w-5 h-5 text-icon hover:text-icon-hover"}),s.jsx("span",{children:"Settings"})]}),s.jsxs("div",{className:"flex items-center justify-between px-4 py-2 hover:bg-bg-secondary transition-colors",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[m?s.jsx(gx,{className:"w-5 h-5 text-icon hover:text-icon-hover"}):s.jsx(yx,{className:"w-5 h-5 text-icon hover:text-icon-hover"}),s.jsx("span",{className:"text-base font-semibold text-text",children:m?"Dark Mode":"Light Mode"})]}),s.jsx("button",{onClick:p,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring---color-brand focus:ring-offset-2 ${m?"bg-brand":"bg-gray-200"}`,children:s.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${m?"translate-x-6":"translate-x-1"}`})})]}),s.jsx("button",{onClick:g,className:"block w-full text-left px-4 py-2 text-base font-semibold text-text hover:bg-bg-secondary transition-colors",children:"Sign Out"})]})]})}),y&&s.jsx("div",{className:`fixed inset-y-0 left-0 z-40 w-64 bg-bg-primary border-r border-border-custom shadow-lg transform transition-transform duration-300 ease-in-out ${l?"translate-x-0":"-translate-x-full"}`,children:s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border-custom",children:[s.jsx("h2",{className:"text-lg font-semibold text-title",children:"Navigation"}),s.jsx("button",{onClick:()=>c(!1),className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6 text-icon"})})]}),s.jsx("nav",{className:"flex-1 p-4",children:s.jsxs("div",{className:"space-y-2",children:[b.map(k=>{const N=k.icon,w=r===k.id;return s.jsxs("button",{onClick:()=>x(k.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors ${w?"bg-brand/10 text-brand border border-brand/20":"text-secondary-text hover:text-text hover:bg-bg-secondary"}`,children:[s.jsx(N,{className:`w-5 h-5 ${w?"text-icon-active":"text-icon hover:text-icon-hover"}`}),s.jsx("span",{className:`font-medium ${w?"text-brand":""}`,children:k.name})]},k.id)}),s.jsx("div",{className:"border-t border-border-custom my-4"}),s.jsxs("button",{onClick:()=>{c(!1),i==null||i("about")},className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors text-secondary-text hover:text-text hover:bg-bg-secondary",children:[s.jsx($t,{className:"w-5 h-5 text-icon hover:text-icon-hover"}),s.jsx("span",{className:"font-medium",children:"About"})]}),((y==null?void 0:y.is_admin)||(y==null?void 0:y.is_location_admin))&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"border-t border-border-custom my-4"}),s.jsx("div",{className:"px-4 py-2",children:s.jsx("span",{className:"text-xs font-semibold text-secondary-text uppercase tracking-wide",children:"Admin Tools"})}),s.jsxs("button",{onClick:()=>{c(!1),i==null||i("all-bookings")},className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors ${r==="all-bookings"?"bg-brand/10 text-brand border border-brand/20":"text-secondary-text hover:text-text hover:bg-bg-secondary"}`,children:[s.jsx(Xe,{className:`w-5 h-5 ${r==="all-bookings"?"text-icon-active":"text-icon hover:text-icon-hover"}`}),s.jsx("span",{className:`font-medium ${r==="all-bookings"?"text-brand":""}`,children:"All Bookings"})]}),s.jsxs("button",{onClick:()=>{c(!1),i==null||i("blocked-dates")},className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors ${r==="blocked-dates"?"bg-brand/10 text-brand border border-brand/20":"text-secondary-text hover:text-text hover:bg-bg-secondary"}`,children:[s.jsx(ox,{className:`w-5 h-5 ${r==="blocked-dates"?"text-icon-active":"text-icon hover:text-icon-hover"}`}),s.jsx("span",{className:`font-medium ${r==="blocked-dates"?"text-brand":""}`,children:"Blocked Dates"})]})]})]})})]})}),y&&s.jsx("div",{className:`fixed inset-0 bg-black z-30 transition-opacity duration-300 ease-in-out ${l?"bg-opacity-50 pointer-events-auto":"bg-opacity-0 pointer-events-none"}`,onClick:()=>c(!1)}),y&&s.jsx("div",{className:`fixed inset-0 bg-black z-40 transition-opacity duration-200 ease-in-out ${a?"bg-opacity-25 pointer-events-auto":"bg-opacity-0 pointer-events-none"}`,onClick:()=>{o(!1)}}),s.jsx(rl,{message:u,isVisible:d,onClose:()=>f(!1)})]})}function gj({icon:e,label:t,isActive:n,onClick:r}){return s.jsxs("button",{onClick:r,className:`flex flex-col items-center space-y-1 sm:flex-row sm:space-y-0 sm:space-x-2 py-4 px-6 border-b-2 font-medium text-sm transition-colors ${n?"!border-brand !text-brand":"border-transparent text-secondary-text hover:text-text hover:border-border-custom"}`,children:[s.jsx(e,{className:`w-5 h-5 ${n?"text-brand":"text-secondary-text hover:text-text"}`}),s.jsx("span",{children:t})]})}function tr({activeTab:e,onTabChange:t}){const n=[{id:"collection",name:"Collection",icon:vn},{id:"battles",name:"Battles",icon:Sd},{id:"battleplan",name:"Bookings",icon:Xe}];return s.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-40 bg-black/75 backdrop-blur-md border-t border-border-custom/30",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("nav",{className:"flex justify-center items-center space-x-8","aria-label":"Tabs",children:n.map(r=>s.jsx(gj,{icon:r.icon,label:r.name,isActive:e===r.id,onClick:()=>t(r.id)},r.id))})})})}function xj({activeView:e,onViewChange:t}){const n=[{id:"recent",label:"Recent",icon:Us},{id:"models",label:"Models",icon:fx},{id:"collections",label:"Collections",icon:vn}];return s.jsx("div",{className:"bg-bg-secondary shadow-sm",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"flex justify-center items-center py-3",children:s.jsx("div",{className:"grid grid-cols-3 gap-8 w-full max-w-md",children:n.map(r=>{const i=r.icon,a=e===r.id;return s.jsxs("button",{onClick:()=>t(r.id),className:"flex flex-col items-center space-y-2 px-4 py-2 rounded-lg transition-all duration-300 ease-in-out w-full group",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 ease-in-out ${a?"bg-[var(--color-brand)]/20 scale-110 opacity-100 shadow-[0_0px_16px_rgba(114,77,221,0.44)]":"bg-border-custom opacity-75 group-hover:opacity-90 group-hover:scale-105"}`,children:s.jsx(i,{className:`w-4 h-4 transition-all duration-300 ease-in-out ${a?"text-icon-active opacity-100 scale-110":"text-icon opacity-75 group-hover:opacity-90"}`})}),s.jsx("span",{className:`text-lg font-medium transition-all duration-300 ease-in-out text-center ${a?"text-text opacity-100 scale-105":"text-secondary-text opacity-75 group-hover:opacity-90"}`,children:r.label})]},r.id)})})})})})}function Ad(e){return new Date(e)}function jt(e,t={weekday:"long",year:"numeric",month:"long",day:"numeric"}){return Ad(e).toLocaleDateString("en-US",t)}function _o(e,t={hour:"numeric",minute:"2-digit",hour12:!0}){const n=new Date,[r,i,a="00"]=e.split(":");return new Date(n.getFullYear(),n.getMonth(),n.getDate(),parseInt(r),parseInt(i),parseInt(a)).toLocaleTimeString("en-US",t)}function mu(){const e=new Date,t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${r}`}function fu(e){const t=Ad(e),n=new Date;return t.setHours(0,0,0,0),n.setHours(0,0,0,0),t<n}function Ux(e){const t=Ad(e),n=new Date,r=new Date(n),i=new Date(n);return r.setDate(r.getDate()-1),i.setDate(i.getDate()+1),n.setHours(0,0,0,0),r.setHours(0,0,0,0),i.setHours(0,0,0,0),t.setHours(0,0,0,0),t.getTime()===n.getTime()?"Today":t.getTime()===r.getTime()?"Yesterday":t.getTime()===i.getTime()?"Tomorrow":jt(e,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}function yj(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${r}`}function Vx({booking:e,onClick:t,onCancelBooking:n,isPast:r=!1}){return s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm border border-border-custom p-4 w-full",children:[s.jsxs("div",{onClick:t,className:"cursor-pointer hover:bg-bg-secondary transition-colors text-left rounded p-2 -m-2 mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[s.jsx(Us,{className:"w-4 h-4 text-secondary-text"}),s.jsxs("div",{children:[s.jsxs("span",{className:"font-medium text-text text-sm",children:[jt(e.date)," - ",e.timeslot.name]}),s.jsxs("p",{className:"text-xs text-secondary-text",children:[_o(e.timeslot.start_time)," - ",_o(e.timeslot.end_time)]})]})]}),s.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[s.jsx(wr,{className:"w-4 h-4 text-secondary-text mt-0.5"}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h3",{className:"font-medium text-text text-sm truncate",children:e.location.name}),s.jsx("p",{className:"text-xs text-secondary-text truncate",children:e.location.address})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[s.jsx($t,{className:"w-4 h-4 text-secondary-text"}),s.jsxs("div",{className:"min-w-0 flex-1",children:[e.user_name&&s.jsx("p",{className:"text-sm text-text truncate font-medium",children:e.user_name}),s.jsx("p",{className:"text-xs text-secondary-text truncate",children:e.user_email||e.user.email})]})]}),e.game&&s.jsxs("div",{className:"flex items-center space-x-2",children:[e.game.icon?s.jsx("img",{src:e.game.icon,alt:`${e.game.name} icon`,className:"w-4 h-4 object-contain rounded",onError:i=>{const a=i.target;a.style.display="none";const o=a.nextElementSibling;o&&o.classList.contains("icon-fallback")&&(o.style.display="flex")}}):null,s.jsx("div",{className:"w-4 h-4 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:e.game.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-xs font-bold",children:e.game.name.charAt(0)})}),s.jsx("span",{className:"text-sm text-secondary-text truncate",children:e.game.name})]})]}),n&&!r&&s.jsx("div",{className:"flex justify-end pt-2 border-t border-border-custom",children:s.jsxs("button",{onClick:()=>n(e.id),className:"btn-danger-outline-sm btn-with-icon-sm",children:[s.jsx(fe,{className:"w-3 h-3"}),s.jsx("span",{children:"Cancel"})]})})]})}function qx({isOpen:e,onClose:t,onConfirm:n,loading:r=!1}){if(!e)return null;const i=a=>{a.target===a.currentTarget&&t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:i,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-title",children:"Are you sure you want to cancel this booking?"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text",children:s.jsx(fe,{className:"w-6 h-6"})})]}),s.jsx("p",{className:"text-base text-secondary-text mb-6",children:"We'll delete this booking and make the table available for someone else."}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:t,disabled:r,className:"btn-ghost btn-flex",children:"No, I'll keep my booking"}),s.jsx("button",{onClick:n,disabled:r,className:"btn-danger btn-flex",children:r?"Deleting...":"Yes, Delete my booking"})]})]})})}function bj(){const[e,t]=j.useState([]),[n,r]=j.useState(!0),[i,a]=j.useState(null),[o,l]=j.useState(!1),{user:c,loading:u}=Ge();j.useEffect(()=>{if(u){r(!0),l(!1);return}if(!u){if(!c){t([]),r(!1),l(!0);return}r(!0),h()}},[c,u]);const h=async()=>{const d=Date.now(),f=500;try{const{data:m,error:p}=await Y.from("bookings").select(`
          id,
          date,
          created_at,
          user_id,
          user_name,
          user_email,
          location:locations(
            id,
            name,
            address,
            icon
          ),
          timeslot:timeslots(
            id,
            name,
            start_time,
            end_time
          ),
          game:games(
            id,
            name,
            icon
          )
        `).eq("user_id",c==null?void 0:c.id).order("date",{ascending:!0});if(p)throw p;if(!m){t([]);return}const y=[...new Set(m.map(k=>k.user_id))],{data:S,error:g}=await Y.from("users").select("id, email").in("id",y);if(g)throw g;const b=new Map((S||[]).map(k=>[k.id,k])),x=m.map(k=>({...k,user:b.get(k.user_id)||{id:k.user_id,email:"Unknown User"}}));t(x)}catch(m){a(m instanceof Error?m.message:"Failed to fetch bookings")}finally{const m=Date.now()-d,p=Math.max(0,f-m);setTimeout(()=>{r(!1),l(!0)},p)}};return console.log("useBookings state:",{loading:n,hasInitialized:o,bookingsLength:e.length,authLoading:u}),{bookings:e,loading:n,error:i,hasInitialized:o,refetch:h}}function vj({refreshTrigger:e=0,onNewBooking:t}){const[n,r]=Ne.useState(new Set);Ne.useState("");const[i,a]=Ne.useState({isOpen:!1,bookingId:null}),[o,l]=Ne.useState(!1),{bookings:c,loading:u,hasInitialized:h,refetch:d}=bj();console.log("BattleplanPage render:",{loading:u,hasInitialized:h,bookingsLength:c.length}),Ne.useEffect(()=>{e>0&&d()},[e,d]);const f=g=>{a({isOpen:!0,bookingId:g})},m=async()=>{if(i.bookingId){l(!0);try{const{error:g}=await Y.from("bookings").delete().eq("id",i.bookingId);if(g)throw g;await d(),a({isOpen:!1,bookingId:null})}catch(g){console.error("Error cancelling booking:",g)}finally{l(!1)}}},p=Ne.useMemo(()=>{const g=new Date;g.setHours(0,0,0,0);const b={},x=[];c.forEach(w=>{if(new Date(w.date)>=g){const T=w.date;b[T]||(b[T]=[]),b[T].push(w)}else x.push(w)}),Object.keys(b).forEach(w=>{b[w].sort((C,T)=>C.timeslot.start_time.localeCompare(T.timeslot.start_time))}),x.sort((w,C)=>{const T=C.date.localeCompare(w.date);return T!==0?T:C.timeslot.start_time.localeCompare(w.timeslot.start_time)});const N=Object.keys(b).sort((w,C)=>w.localeCompare(C)).map(w=>({date:w,bookings:b[w],isPast:!1}));return x.length>0&&N.push({date:"past",bookings:x,isPast:!0}),N},[c]);Ne.useEffect(()=>{p.length>0&&r(new Set([p[0].date]))},[p]);const y=g=>{r(b=>{const x=new Set(b);return x.has(g)?x.delete(g):x.add(g),x})},S=g=>g==="past"?"Past Bookings":jt(g,{weekday:"long",year:"numeric",month:"long",day:"numeric"});return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsx("div",{className:"text-center mb-12",children:s.jsx("h1",{className:"text-4xl font-bold text-title mb-4",children:"YOUR TABLE BOOKINGS"})}),s.jsx("div",{className:"mb-8",children:u||!h?s.jsx("div",{className:"space-y-8",children:Array.from({length:2}).map((g,b)=>s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"w-full border-b border-border-custom pb-2 animate-pulse",children:s.jsx("div",{className:"h-6 bg-secondary-text opacity-20 rounded w-48"})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Array.from({length:b===0?3:2}).map((x,k)=>s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm border border-border-custom p-4 animate-pulse",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[s.jsx("div",{className:"w-4 h-4 bg-secondary-text opacity-20 rounded"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-3/4 mb-1"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-1/2"})]})]}),s.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[s.jsx("div",{className:"w-4 h-4 bg-secondary-text opacity-20 rounded mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-2/3 mb-1"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-full"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[s.jsx("div",{className:"w-4 h-4 bg-secondary-text opacity-20 rounded"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-1/2 mb-1"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-3/4"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-4 h-4 bg-secondary-text opacity-20 rounded"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-1/3"})]})]},k))})]},b))}):!u&&h&&c.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Xe,{className:"w-16 h-16 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text mb-4",children:"No table bookings yet."}),s.jsx("div",{className:"flex justify-center",children:s.jsx("button",{onClick:t,className:"btn-primary",children:"Book Your First Table"})})]}):s.jsx("div",{className:"space-y-8",children:p.map(({date:g,bookings:b,isPast:x})=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("button",{onClick:()=>y(g),className:"w-full flex items-center justify-between text-left border-b border-border-custom pb-2 hover:bg-bg-secondary transition-colors rounded-lg px-2 py-1",children:[s.jsx("h2",{className:"text-xl font-bold text-title",children:S(g)}),n.has(g)?s.jsx(Bs,{className:"w-5 h-5 text-icon"}):s.jsx(Vt,{className:"w-5 h-5 text-icon"})]}),n.has(g)&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:b.map(k=>s.jsx(Vx,{booking:k,onClick:()=>{},onCancelBooking:f,isPast:x},k.id))})]},g))})})]}),s.jsx(qx,{isOpen:i.isOpen,onClose:()=>a({isOpen:!1,bookingId:null}),onConfirm:m,loading:o})]})}function wj({model:e,name:t,boxName:n,gameName:r,gameIcon:i,status:a,count:o,imageUrl:l,paintedDate:c,onViewModel:u,onViewBox:h}){console.log("ModelCard Debug:",{name:t,gameName:r,gameIcon:i,hasGameIcon:!!i,gameIconType:typeof i,gameIconTrimmed:i==null?void 0:i.trim()});const d=y=>{switch(y){case"Painted":return"bg-green-100 text-green-800";case"Partially Painted":return"bg-yellow-100 text-yellow-800";case"Primed":return"bg-blue-100 text-blue-800";case"Assembled":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},f=(y,S)=>y==="Painted"&&S?`Painted ${jt(S,{day:"2-digit",month:"2-digit",year:"2-digit"})}`:y,m=()=>{var S,g,b;if(l&&typeof l=="string"&&l.trim()!==""&&l!=="undefined"&&l!=="null"&&!l.includes("undefined")&&!l.includes("null")&&(l.startsWith("http")||l.startsWith("/")))return{src:l,isGameFallback:!1};const y=((g=(S=e==null?void 0:e.box)==null?void 0:S.game)==null?void 0:g.icon)||((b=e==null?void 0:e.game)==null?void 0:b.icon);return y&&typeof y=="string"&&y.trim()!==""&&y!=="undefined"&&y!=="null"&&y.startsWith("http")?{src:y,isGameFallback:!0}:{src:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg",isGameFallback:!1}},p=y=>!!(y&&typeof y=="string"&&y.trim()!==""&&y!=="undefined"&&y!=="null"&&y.startsWith("http")&&y.includes("game-assets"));return s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm border border-border-custom overflow-hidden max-w-[380px] flex flex-col h-full hover:shadow-[0_4px_12px_rgba(114,77,221,0.2)] transition-shadow duration-200",children:[s.jsxs("div",{className:"aspect-w-16 aspect-h-12 relative bg-bg-card-secondary",children:[(()=>{const y=m();return s.jsx("img",{src:y.src,alt:t,className:`w-full h-48 min-h-[400px] object-cover ${y.isGameFallback?"opacity-10":""}`,loading:"lazy",onError:S=>{const g=S.target,b="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg";g.src!==b&&(console.log("Image failed to load:",g.src,"Falling back to default"),g.src=b)}})})(),a!=="None"&&s.jsx("div",{className:"absolute top-2 left-2",children:s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${d(a)}`,children:f(a,c)})})]}),s.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4 max-w-full",children:[s.jsxs("div",{className:"flex flex-col flex-1 min-w-0 mr-3 flex-shrink-0 min-w-[50%]",children:[s.jsx("h3",{className:"text-lg font-bold text-title mb-1 break-words",children:t}),(e==null?void 0:e.box)&&s.jsx("button",{onClick:()=>h==null?void 0:h(e.box),className:"text-sm text-secondary-text hover:text-brand transition-colors text-left",children:n})]}),s.jsxs("div",{className:"flex items-center space-x-2 flex-shrink min-w-0 justify-end",children:[s.jsx("span",{className:"text-xs text-secondary-text font-bold leading-tight break-words line-clamp-2 text-right",children:r.toUpperCase()}),p(i)?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:i||"",alt:`${r} icon`,className:"w-8 h-8 object-contain rounded flex-shrink-0",onError:y=>{const S=y.target;console.warn("Game icon failed to load (bucket not found):",i,"Falling back to letter icon"),S.style.display="none";const g=S.nextElementSibling;g&&g.classList.contains("icon-fallback")&&(g.style.display="flex")},onLoad:y=>{const g=y.target.nextElementSibling;g&&g.classList.contains("icon-fallback")&&(g.style.display="none")}}),s.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center icon-fallback",children:s.jsx("span",{className:"text-white text-xs font-bold",children:r.charAt(0)})})]}):s.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center flex-shrink-0 icon-fallback",children:s.jsx("span",{className:"text-white text-xs font-bold",children:r.charAt(0)})})]})]}),s.jsx("div",{className:"flex justify-center mt-auto",children:s.jsx("button",{onClick:u,className:"btn-secondary btn-flex",children:"View Model"})})]})]})}function jj({name:e,gameName:t,modelCount:n,imageUrl:r,gameImage:i,gameIcon:a,onViewBox:o}){const l=h=>`${h} Model${h!==1?"s":""}`,c=()=>r&&typeof r=="string"&&r.trim()!==""&&r!=="undefined"&&r!=="null"&&!r.includes("undefined")&&!r.includes("null")&&(r.startsWith("http")||r.startsWith("/"))?r:i&&typeof i=="string"&&i.trim()!==""&&i!=="undefined"&&i!=="null"&&i.startsWith("http")?i:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg",u=h=>!!(h&&typeof h=="string"&&h.trim()!==""&&h!=="undefined"&&h!=="null"&&h.startsWith("http")&&h.includes("game-assets"));return s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm border border-border-custom overflow-hidden max-w-[380px] flex flex-col hover:shadow-[0_4px_12px_rgba(114,77,221,0.2)] transition-shadow duration-200",children:[s.jsx("div",{className:"aspect-w-16 aspect-h-12 relative bg-bg-card-secondary",children:s.jsx("img",{src:c(),alt:e,className:"w-full h-48 min-h-[400px] bg-bg-card-secondary object-cover"})}),s.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4 max-w-full",children:[s.jsxs("div",{className:"flex flex-col flex-1 min-w-0 mr-3 flex-shrink-0 min-w-[50%]",children:[s.jsx("h3",{className:"text-lg font-bold text-title mb-1 break-words",children:e}),s.jsx("p",{className:"text-sm text-secondary-text",children:l(n)})]}),s.jsxs("div",{className:"flex items-center space-x-2 flex-shrink min-w-0 justify-end",children:[s.jsx("span",{className:"text-xs text-secondary-text font-bold leading-tight break-words line-clamp-2 text-right",children:t.toUpperCase()}),u(a)?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:a||"",alt:`${t} icon`,className:"w-8 h-8 object-contain rounded flex-shrink-0",onError:h=>{const d=h.target;console.warn("Game icon failed to load (bucket not found):",a,"Falling back to letter icon"),d.style.display="none";const f=d.nextElementSibling;f&&f.classList.contains("icon-fallback")&&(f.style.display="flex")},onLoad:h=>{const f=h.target.nextElementSibling;f&&f.classList.contains("icon-fallback")&&(f.style.display="none")}}),s.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center icon-fallback",children:s.jsx("span",{className:"text-white text-xs font-bold",children:t.charAt(0)})})]}):s.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center flex-shrink-0 icon-fallback",children:s.jsx("span",{className:"text-white text-xs font-bold",children:t.charAt(0)})})]})]}),s.jsx("div",{className:"flex justify-center mt-auto",children:s.jsx("button",{onClick:o,className:"btn-secondary btn-flex",children:"View Collection"})})]})]})}function Ma({currentPage:e,totalPages:t,onPageChange:n}){const r=[];if(t>7)if(e<=4){for(let a=1;a<=5;a++)r.push(a);r.push("..."),r.push(t)}else if(e>=t-3){r.push(1),r.push("...");for(let a=t-4;a<=t;a++)r.push(a)}else{r.push(1),r.push("...");for(let a=e-1;a<=e+1;a++)r.push(a);r.push("..."),r.push(t)}else for(let a=1;a<=t;a++)r.push(a);return s.jsxs("div",{className:"flex items-center justify-center space-x-1 mt-8",children:[s.jsx("button",{onClick:()=>n(e-1),disabled:e===1,className:"p-2 rounded-lg hover:bg-bg-secondary disabled:opacity-50 disabled:cursor-not-allowed text-text",children:s.jsx(cx,{className:"w-5 h-5"})}),r.map((a,o)=>s.jsx("button",{onClick:()=>typeof a=="number"&&n(a),disabled:a==="...",className:`px-3 py-2 rounded-lg text-sm font-medium ${a===e?"bg-title text-bg-primary":a==="..."?"cursor-default text-secondary-text":"hover:bg-bg-secondary text-text"}`,children:a},o)),s.jsx("button",{onClick:()=>n(e+1),disabled:e===t,className:"p-2 rounded-lg hover:bg-bg-secondary disabled:opacity-50 disabled:cursor-not-allowed text-text",children:s.jsx(Vt,{className:"w-5 h-5"})})]})}function Vm({isOpen:e,onClose:t,mode:n}){const[r,i]=j.useState(""),[a,o]=j.useState(""),[l,c]=j.useState(!1),[u,h]=j.useState(""),[d,f]=j.useState(""),[m,p]=j.useState(n),{signIn:y,signUp:S,signInWithGoogle:g,resetPassword:b}=Ge();Ne.useEffect(()=>{p(n),i(""),o(""),h(""),f("")},[n]);const x=async()=>{c(!0),h("");try{const{error:C}=await g();C&&h(C.message)}catch{h("An unexpected error occurred")}finally{c(!1)}},k=async C=>{C.preventDefault(),c(!0),h(""),f("");try{if(m==="forgot-password"){const{error:T}=await b(r);T?h(T.message):(f("Password reset email sent! Check your inbox."),i(""))}else{const{error:T}=m==="login"?await y(r,a):await S(r,a);T?h(T.message):(t(),i(""),o(""))}}catch{h("An unexpected error occurred")}finally{c(!1)}},N=()=>{p("login"),i(""),o(""),h(""),f("")};if(!e)return null;const w=C=>{C.target===C.currentTarget&&t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:w,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[m==="forgot-password"&&s.jsx("button",{onClick:N,className:"text-secondary-text hover:text-text p-1",children:s.jsx(Tt,{className:"w-5 h-5"})}),s.jsx("h2",{className:"text-2xl font-bold text-title flex-1 text-center",children:m==="login"?"Log In":m==="signup"?"Sign Up":"Reset Password"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text",children:s.jsx(fe,{className:"w-6 h-6 text-icon"})})]}),m!=="forgot-password"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mb-6",children:s.jsxs("button",{type:"button",onClick:x,disabled:l,className:"btn-secondary btn-full btn-with-icon",children:[s.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[s.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),s.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),s.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),s.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),s.jsx("span",{className:"font-medium",children:m==="login"?"Sign in with Google":"Sign up with Google"})]})}),s.jsxs("div",{className:"relative mb-6",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-border-custom"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-2 bg-modal-bg text-secondary-text",children:"Or continue with email"})})]})]}),s.jsxs("form",{onSubmit:k,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-input-label font-overpass mb-1",children:"Email"}),s.jsx("input",{type:"email",id:"email",value:r,onChange:C=>i(C.target.value),required:!0,className:"w-full px-3 py-2 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text"})]}),m!=="forgot-password"&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-input-label font-overpass mb-1",children:"Password"}),s.jsx("input",{type:"password",id:"password",value:a,onChange:C=>o(C.target.value),required:!0,className:"w-full px-3 py-2 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text"})]}),m==="login"&&s.jsx("div",{className:"text-right",children:s.jsx("button",{type:"button",onClick:()=>p("forgot-password"),className:"text-sm text-[var(--color-brand)] hover:text-[var(--color-brand)]/80 transition-colors",children:"Forgot your password?"})}),u&&s.jsx("div",{className:"text-red-600 text-sm",children:u}),d&&s.jsx("div",{className:"text-green-600 text-sm",children:d}),s.jsx("div",{className:"flex justify-center",children:s.jsx("button",{type:"submit",disabled:l,className:"btn-primary btn-full",children:l?"Processing...":m==="login"?"Log In":m==="signup"?"Sign Up":"Send Reset Email"})})]}),m!=="forgot-password"&&s.jsx("div",{className:"mt-4 text-center",children:s.jsxs("p",{className:"text-sm text-secondary-text",children:[m==="login"?"Don't have an account? ":"Already have an account? ",s.jsx("button",{type:"button",onClick:()=>p(m==="login"?"signup":"login"),className:"btn-ghost btn-ghost-sm",children:m==="login"?"Sign Up":"Log In"})]})})]})})}const Aa="mini-myths-recent-games",qm=3;function Hs(){const[e,t]=j.useState([]);j.useEffect(()=>{n()},[]);const n=()=>{try{const a=localStorage.getItem(Aa);if(a){const l=JSON.parse(a).sort((c,u)=>u.lastUsed-c.lastUsed).slice(0,qm);t(l)}}catch(a){console.error("Error loading recent games:",a),t([])}};return{recentGames:e,addRecentGame:a=>{try{const o=Date.now(),l={id:a.id,name:a.name,icon:a.icon,lastUsed:o},c=localStorage.getItem(Aa);let u=[];c&&(u=JSON.parse(c)),u=u.filter(h=>h.id!==a.id),u.unshift(l),u=u.slice(0,qm),localStorage.setItem(Aa,JSON.stringify(u)),t(u)}catch(o){console.error("Error saving recent game:",o)}},clearRecentGames:()=>{try{localStorage.removeItem(Aa),t([])}catch(a){console.error("Error clearing recent games:",a)}}}}function Yr({games:e,selectedGame:t,onGameSelect:n,placeholder:r="Choose a Game",favoriteGames:i=[]}){const[a,o]=j.useState(!1),[l,c]=j.useState(""),u=j.useRef(null),h=j.useRef(null),{recentGames:d}=Hs(),f=e.find(w=>w.id===t),m=e.filter(w=>w.name.toLowerCase().includes(l.toLowerCase())),p=new Set(i.map(w=>w.id)),y=d.find(w=>!p.has(w.id)&&m.some(C=>C.id===w.id)),S=y?m.filter(w=>w.id===y.id):[],g=i.filter(w=>w.name.toLowerCase().includes(l.toLowerCase())),b=m.filter(w=>w.id!==(y==null?void 0:y.id)&&!p.has(w.id));j.useEffect(()=>{const w=C=>{u.current&&!u.current.contains(C.target)&&o(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),j.useEffect(()=>{a&&h.current&&h.current.focus()},[a]);const x=w=>{n(w),c(""),o(!1)},k=w=>{c(w.target.value)},N=()=>{o(!a),a||c("")};return s.jsxs("div",{className:"relative",ref:u,children:[s.jsxs("button",{type:"button",onClick:N,className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] text-left bg-bg-primary flex items-center justify-between hover:bg-bg-secondary transition-colors",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[f!=null&&f.icon?s.jsx("img",{src:f.icon,alt:"",className:"w-6 h-6 object-contain flex-shrink-0",onError:w=>{const C=w.target;console.warn("Dropdown game icon failed to load:",f.icon),C.style.display="none"},onLoad:()=>{console.warn("Dropdown game icon loaded successfully:",f.icon)}}):s.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex-shrink-0"}),s.jsx("span",{className:f?"text-text":"text-secondary-text",children:f?f.name:r})]}),s.jsx(Bs,{className:`w-5 h-5 text-icon transition-transform ${a?"rotate-180":""}`})]}),a&&s.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-bg-primary border border-border-custom rounded-lg shadow-lg max-h-60 overflow-hidden",children:[s.jsx("div",{className:"p-3 border-b border-border-custom",children:s.jsxs("div",{className:"relative",children:[s.jsx(Ko,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-4 h-4"}),s.jsx("input",{ref:h,type:"text",value:l,onChange:k,placeholder:"Search games...",className:"w-full pl-10 pr-4 py-2 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] text-sm bg-bg-primary text-text"})]})}),s.jsx("div",{className:"max-h-48 overflow-y-auto",children:S.length===0&&g.length===0&&b.length===0?s.jsxs("div",{className:"px-4 py-3 text-secondary-text text-sm",children:['No games found matching "',l,'"']}):s.jsxs(s.Fragment,{children:[S.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"px-4 py-2 bg-blue-50 border-b border-border-custom",children:s.jsx("span",{className:"text-xs font-semibold text-blue-800 uppercase tracking-wide",children:"Recent Games"})}),S.map(w=>s.jsxs("button",{type:"button",onClick:()=>x(w.id),className:"w-full px-4 py-3 text-left hover:bg-bg-secondary flex items-center space-x-3 transition-colors bg-blue-25",children:[w.icon?s.jsx("img",{src:w.icon,alt:"",className:"w-6 h-6 object-contain flex-shrink-0",onError:C=>{const T=C.target;console.warn("Game list icon failed to load:",w.icon),T.style.display="none"},onLoad:()=>{console.warn("Game list icon loaded successfully:",w.icon)}}):s.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex-shrink-0"}),s.jsx("span",{className:"text-text",children:w.name})]},`recent-${w.id}`))]}),g.length>0&&s.jsxs(s.Fragment,{children:[S.length>0&&s.jsx("div",{className:"px-4 py-2 bg-amber-50 border-b border-border-custom",children:s.jsx("span",{className:"text-xs font-semibold text-amber-800 uppercase tracking-wide",children:"Favorite Games"})}),g.map(w=>s.jsxs("button",{type:"button",onClick:()=>x(w.id),className:"w-full px-4 py-3 text-left hover:bg-bg-secondary flex items-center space-x-3 transition-colors bg-amber-25",children:[w.icon?s.jsx("img",{src:w.icon,alt:"",className:"w-6 h-6 object-contain flex-shrink-0",onError:C=>{const T=C.target;console.warn("Game list icon failed to load:",w.icon),T.style.display="none"},onLoad:()=>{console.warn("Game list icon loaded successfully:",w.icon)}}):s.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex-shrink-0"}),s.jsx("span",{className:"text-text",children:w.name})]},`favorite-${w.id}`))]}),b.length>0&&s.jsxs(s.Fragment,{children:[(S.length>0||g.length>0)&&s.jsx("div",{className:"px-4 py-2 bg-bg-secondary border-b border-border-custom",children:s.jsx("span",{className:"text-xs font-semibold text-secondary-text uppercase tracking-wide",children:"All Games"})}),b.map(w=>s.jsxs("button",{type:"button",onClick:()=>x(w.id),className:"w-full px-4 py-3 text-left hover:bg-bg-secondary flex items-center space-x-3 transition-colors",children:[w.icon?s.jsx("img",{src:w.icon,alt:"",className:"w-6 h-6 object-contain flex-shrink-0",onError:C=>{const T=C.target;console.warn("Game list icon failed to load:",w.icon),T.style.display="none"},onLoad:()=>{console.warn("Game list icon loaded successfully:",w.icon)}}):s.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex-shrink-0"}),s.jsx("span",{className:"text-text",children:w.name})]},w.id))]})]})})]})]})}async function yn(e,t=1200,n=1200,r=.8){return new Promise((i,a)=>{const o=document.createElement("canvas"),l=o.getContext("2d"),c=new Image;c.onload=()=>{let{width:u,height:h}=c;u>h?u>t&&(h=h*t/u,u=t):h>n&&(u=u*n/h,h=n),o.width=u,o.height=h,l?(l.drawImage(c,0,0,u,h),o.toBlob(d=>{if(d){const f=new File([d],e.name,{type:e.type,lastModified:Date.now()});i(f)}else a(new Error("Failed to compress image"))},e.type,r)):a(new Error("Failed to get canvas context"))},c.onerror=()=>{a(new Error("Failed to load image"))},c.src=URL.createObjectURL(e)})}function bn(e){return["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type.toLowerCase())}function He(e){if(e===0)return"0 Bytes";const t=1024,n=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,r)).toFixed(2))+" "+n[r]}function qn({isOpen:e,onClose:t,onCrop:n,imageFile:r}){const i=j.useRef(null),[a,o]=j.useState(null),[l,c]=j.useState({x:100,y:100,width:200,height:200}),[u,h]=j.useState(1),[d,f]=j.useState(0),[m,p]=j.useState(0),y=window.innerWidth<=768;j.useEffect(()=>{if(!e||!y)return;const x=N=>{N.preventDefault()},k=i.current;if(k)return k.addEventListener("touchmove",x,{passive:!1}),()=>{k.removeEventListener("touchmove",x)}},[e,y]),j.useEffect(()=>(e?(document.body.style.overflow="hidden",document.body.style.touchAction="none",document.body.style.overscrollBehavior="none"):(document.body.style.overflow="",document.body.style.touchAction="",document.body.style.overscrollBehavior=""),()=>{document.body.style.overflow="",document.body.style.touchAction="",document.body.style.overscrollBehavior=""}),[e]),j.useEffect(()=>{if(!e)return;const x=k=>{switch(k.key){case"=":case"+":k.preventDefault(),h(N=>Math.min(5,N+.1));break;case"-":k.preventDefault(),h(N=>Math.max(.1,N-.1));break;case"r":k.preventDefault(),f(N=>N+90);break;case"l":k.preventDefault(),f(N=>N-90);break;case"e":k.preventDefault(),p(N=>Math.max(-100,N-10));break;case"d":k.preventDefault(),p(N=>Math.min(100,N+10));break;case"0":k.preventDefault(),h(1),f(0),p(0);break}};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[e]),j.useEffect(()=>{if(e&&r){const x=new Image;return x.onload=()=>{o(x),c({x:100,y:100,width:200,height:200}),h(1),f(0),p(0)},x.src=URL.createObjectURL(r),()=>URL.revokeObjectURL(x.src)}},[e,r]),j.useEffect(()=>{const x=i.current,k=x==null?void 0:x.getContext("2d");if(!x||!k||!a)return;k.clearRect(0,0,x.width,x.height),k.save(),k.translate(x.width/2,x.height/2),k.rotate(d*Math.PI/180),k.scale(u,u);const N=a.width*u,w=a.height*u;if(k.drawImage(a,-N/2,-w/2,N,w),m!==0){const T=k.getImageData(-N/2,-w/2,N,w),I=T.data,v=1+m/100;for(let P=0;P<I.length;P+=4)I[P]=Math.min(255,Math.max(0,I[P]*v)),I[P+1]=Math.min(255,Math.max(0,I[P+1]*v)),I[P+2]=Math.min(255,Math.max(0,I[P+2]*v));k.putImageData(T,-N/2,-w/2)}k.restore(),k.strokeStyle="#F59E0B",k.lineWidth=2,k.strokeRect(l.x,l.y,l.width,l.height);const C=y?20:16;k.fillStyle="#F59E0B",k.fillRect(l.x-C/2,l.y-C/2,C,C),k.fillRect(l.x+l.width-C/2,l.y-C/2,C,C),k.fillRect(l.x-C/2,l.y+l.height-C/2,C,C),k.fillRect(l.x+l.width-C/2,l.y+l.height-C/2,C,C),k.strokeStyle="#FFFFFF",k.lineWidth=2,k.strokeRect(l.x-C/2,l.y-C/2,C,C),k.strokeRect(l.x+l.width-C/2,l.y-C/2,C,C),k.strokeRect(l.x-C/2,l.y+l.height-C/2,C,C),k.strokeRect(l.x+l.width-C/2,l.y+l.height-C/2,C,C)},[a,l,y,u,d,m]);const S=x=>{console.log("handleTouchStart called with touch:",x);const k=i.current;if(!k){console.log("Canvas ref not available");return}const N=k.getBoundingClientRect(),w=k.width/N.width,C=k.height/N.height;let T=(x.clientX-N.left)*w,I=(x.clientY-N.top)*C;const v=k.width/2,P=k.height/2;if(d!==0){const L=Math.cos(-d*Math.PI/180),O=Math.sin(-d*Math.PI/180),M=T-v,U=I-P;T=v+M*L-U*O,I=P+M*O+U*L}T=(T-v)/u+v,I=(I-P)/u+P,console.log("Touch detected:",{touchX:x.clientX,touchY:x.clientY,canvasX:T,canvasY:I,cropArea:l,isMobile:y,handleHitSize:y?60:32,canvasWidth:k.width,canvasHeight:k.height,scaleX:w,scaleY:C});const A=y?120:64;if(console.log("Checking touch position:",{x:T,y:I,handleHitSize:A,cropArea:l}),T>=l.x-A/2&&T<=l.x+A/2&&I>=l.y-A/2&&I<=l.y+A/2){console.log("Top-left handle touched!");const L=T,O=I,M={...l},U=F=>{const B=F.touches[0];let _=(B.clientX-N.left)*w,z=(B.clientY-N.top)*C;const q=_-v,E=z-P;if(d!==0){const W=Math.cos(-d*Math.PI/180),le=Math.sin(-d*Math.PI/180);_=v+q*W-E*le,z=P+q*le+E*W}_=(_-v)/u+v,z=(z-P)/u+P;const K=_-L,G=z-O;c({x:Math.max(0,M.x+K),y:Math.max(0,M.y+G),width:Math.max(50,M.width-K),height:Math.max(50,M.height-G)})},H=()=>{document.removeEventListener("touchmove",U),document.removeEventListener("touchend",H)};document.addEventListener("touchmove",U,{passive:!1}),document.addEventListener("touchend",H,{passive:!1});return}if(T>=l.x+l.width-A/2&&T<=l.x+l.width+A/2&&I>=l.y-A/2&&I<=l.y+A/2){console.log("Top-right handle touched!");const L=T,O=I,M={...l},U=F=>{const B=F.touches[0];let _=(B.clientX-N.left)*w,z=(B.clientY-N.top)*C;const q=_-v,E=z-P;if(d!==0){const W=Math.cos(-d*Math.PI/180),le=Math.sin(-d*Math.PI/180);_=v+q*W-E*le,z=P+q*le+E*W}_=(_-v)/u+v,z=(z-P)/u+P;const K=_-L,G=z-O;c({x:M.x,y:Math.max(0,M.y+G),width:Math.max(50,M.width+K),height:Math.max(50,M.height-G)})},H=()=>{document.removeEventListener("touchmove",U),document.removeEventListener("touchend",H)};document.addEventListener("touchmove",U,{passive:!1}),document.addEventListener("touchend",H,{passive:!1});return}if(T>=l.x-A/2&&T<=l.x+A/2&&I>=l.y+l.height-A/2&&I<=l.y+l.height+A/2){console.log("Bottom-left handle touched!");const L=T,O=I,M={...l},U=F=>{const B=F.touches[0];let _=(B.clientX-N.left)*w,z=(B.clientY-N.top)*C;const q=_-v,E=z-P;if(d!==0){const W=Math.cos(-d*Math.PI/180),le=Math.sin(-d*Math.PI/180);_=v+q*W-E*le,z=P+q*le+E*W}_=(_-v)/u+v,z=(z-P)/u+P;const K=_-L,G=z-O;c({x:Math.max(0,M.x+K),y:M.y,width:Math.max(50,M.width-K),height:Math.max(50,M.height+G)})},H=()=>{document.removeEventListener("touchmove",U),document.removeEventListener("touchend",H)};document.addEventListener("touchmove",U,{passive:!1}),document.addEventListener("touchend",H,{passive:!1});return}if(T>=l.x+l.width-A/2&&T<=l.x+l.width+A/2&&I>=l.y+l.height-A/2&&I<=l.y+l.height+A/2){console.log("Bottom-right handle touched!");const L=T,O=I,M={...l},U=F=>{const B=F.touches[0];let _=(B.clientX-N.left)*w,z=(B.clientY-N.top)*C;const q=_-v,E=z-P;if(d!==0){const W=Math.cos(-d*Math.PI/180),le=Math.sin(-d*Math.PI/180);_=v+q*W-E*le,z=P+q*le+E*W}_=(_-v)/u+v,z=(z-P)/u+P;const K=_-L,G=z-O;c({x:M.x,y:M.y,width:Math.max(50,M.width+K),height:Math.max(50,M.height+G)})},H=()=>{document.removeEventListener("touchmove",U),document.removeEventListener("touchend",H)};document.addEventListener("touchmove",U,{passive:!1}),document.addEventListener("touchend",H,{passive:!1});return}},g=x=>{const k=i.current;if(!k)return;const N=k.getBoundingClientRect(),w=k.width/N.width,C=k.height/N.height;let T=(x.clientX-N.left)*w,I=(x.clientY-N.top)*C;const v=k.width/2,P=k.height/2;if(d!==0){const L=Math.cos(-d*Math.PI/180),O=Math.sin(-d*Math.PI/180),M=T-v,U=I-P;T=v+M*L-U*O,I=P+M*O+U*L}T=(T-v)/u+v,I=(I-P)/u+P;const A=y?120:64;if(T>=l.x-A/2&&T<=l.x+A/2&&I>=l.y-A/2&&I<=l.y+A/2){const L=T,O=I,M={...l},U=F=>{let B=(F.clientX-N.left)*w,_=(F.clientY-N.top)*C;const z=B-v,q=_-P;if(d!==0){const G=Math.cos(-d*Math.PI/180),W=Math.sin(-d*Math.PI/180);B=v+z*G-q*W,_=P+z*W+q*G}B=(B-v)/u+v,_=(_-P)/u+P;const E=B-L,K=_-O;c({x:Math.max(0,M.x+E),y:Math.max(0,M.y+K),width:Math.max(50,M.width-E),height:Math.max(50,M.height-K)})},H=()=>{document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",H)};document.addEventListener("mousemove",U),document.addEventListener("mouseup",H);return}if(T>=l.x+l.width-A/2&&T<=l.x+l.width+A/2&&I>=l.y-A/2&&I<=l.y+A/2){const L=T,O=I,M={...l},U=F=>{let B=(F.clientX-N.left)*w,_=(F.clientY-N.top)*C;const z=B-v,q=_-P;if(d!==0){const G=Math.cos(-d*Math.PI/180),W=Math.sin(-d*Math.PI/180);B=v+z*G-q*W,_=P+z*W+q*G}B=(B-v)/u+v,_=(_-P)/u+P;const E=B-L,K=_-O;c({x:M.x,y:Math.max(0,M.y+K),width:Math.max(50,M.width+E),height:Math.max(50,M.height-K)})},H=()=>{document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",H)};document.addEventListener("mousemove",U),document.addEventListener("mouseup",H);return}if(T>=l.x-A/2&&T<=l.x+A/2&&I>=l.y+l.height-A/2&&I<=l.y+l.height+A/2){const L=T,O=I,M={...l},U=F=>{let B=(F.clientX-N.left)*w,_=(F.clientY-N.top)*C;const z=B-v,q=_-P;if(d!==0){const G=Math.cos(-d*Math.PI/180),W=Math.sin(-d*Math.PI/180);B=v+z*G-q*W,_=P+z*W+q*G}B=(B-v)/u+v,_=(_-P)/u+P;const E=B-L,K=_-O;c({x:Math.max(0,M.x+E),y:M.y,width:Math.max(50,M.width-E),height:Math.max(50,M.height+K)})},H=()=>{document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",H)};document.addEventListener("mousemove",U),document.addEventListener("mouseup",H);return}if(T>=l.x+l.width-A/2&&T<=l.x+l.width+A/2&&I>=l.y+l.height-A/2&&I<=l.y+l.height+A/2){const L=T,O=I,M={...l},U=F=>{let B=(F.clientX-N.left)*w,_=(F.clientY-N.top)*C;const z=B-v,q=_-P;if(d!==0){const G=Math.cos(-d*Math.PI/180),W=Math.sin(-d*Math.PI/180);B=v+z*G-q*W,_=P+z*W+q*G}B=(B-v)/u+v,_=(_-P)/u+P;const E=B-L,K=_-O;c({x:M.x,y:M.y,width:Math.max(50,M.width+E),height:Math.max(50,M.height+K)})},H=()=>{document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",H)};document.addEventListener("mousemove",U),document.addEventListener("mouseup",H);return}},b=()=>{if(!i.current||!a)return;const k=document.createElement("canvas"),N=k.getContext("2d");if(!N)return;k.width=l.width,k.height=l.height;const w=document.createElement("canvas"),C=w.getContext("2d");if(!C)return;w.width=a.width,w.height=a.height,C.save(),C.translate(w.width/2,w.height/2),C.rotate(d*Math.PI/180),C.scale(u,u),C.drawImage(a,-a.width/2,-a.height/2,a.width,a.height),C.restore();const T=600,I=400,v=a.width/T,P=a.height/I;let A=l.x*v,L=l.y*P,O=l.width*v,M=l.height*P;if(u!==1||d!==0){const U=a.width/2,H=a.height/2,F=Math.cos(d*Math.PI/180),B=Math.sin(d*Math.PI/180),z=[{x:A,y:L},{x:A+O,y:L},{x:A,y:L+M},{x:A+O,y:L+M}].map(W=>{const le=W.x-U,se=W.y-H,ae=U+le*F-se*B,be=H+le*B+se*F,je=U+(ae-U)*u,Ie=H+(be-H)*u;return{x:je,y:Ie}}),q=Math.min(...z.map(W=>W.x)),E=Math.max(...z.map(W=>W.x)),K=Math.min(...z.map(W=>W.y)),G=Math.max(...z.map(W=>W.y));A=q,L=K,O=E-q,M=G-K}N.drawImage(w,A,L,O,M,0,0,l.width,l.height),k.toBlob(U=>{if(U){const H=new File([U],r.name,{type:r.type,lastModified:Date.now()});n(H)}},r.type,1)};return e?s.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[70] ${y?"p-0":"p-4"}`,onClick:x=>{x.target===x.currentTarget&&t()},children:s.jsxs("div",{className:`bg-modal-bg w-full ${y?"h-full rounded-none flex flex-col":"rounded-lg max-w-2xl p-6"}`,children:[s.jsxs("div",{className:`flex items-center justify-between ${y?"p-4 border-b border-border-custom":"mb-4"}`,children:[s.jsx("h2",{className:"text-lg font-bold text-title",children:"Crop Image"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors p-2",children:s.jsx(fe,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:`${y?"flex-1 p-4":"mb-4"}`,children:[s.jsx("div",{className:"relative select-none",style:{touchAction:"none",overscrollBehavior:"none",WebkitOverflowScrolling:"touch"},children:s.jsx("canvas",{ref:i,width:600,height:400,className:`border border-border-custom w-full block ${y?"h-full object-contain":"rounded-lg"}`,style:{cursor:"crosshair",touchAction:"none",maxHeight:y?"calc(100vh - 200px)":"400px",position:"relative",zIndex:10,userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",overscrollBehavior:"none",WebkitTouchCallout:"none",WebkitTapHighlightColor:"transparent"},onMouseDown:g,onTouchStart:x=>{console.log("Canvas touch start event:",x.type,"passive:",x.defaultPrevented);const k=x.touches[0];S(k)}})}),s.jsxs("div",{className:`mt-4 ${y?"space-y-4":"space-y-3"}`,children:[s.jsx("div",{className:"text-xs text-secondary-text text-center",children:s.jsx("span",{className:"hidden sm:inline",children:"Keyboard shortcuts: +/- zoom, r/l rotate, e/d exposure, 0 reset"})}),s.jsxs("div",{className:`${y?"space-y-4":"space-y-3"}`,children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>h(Math.max(.1,u-.1)),className:"btn-ghost btn-sm w-8 h-8 p-0 flex-shrink-0",disabled:u<=.1,children:"-"}),s.jsx("input",{type:"range",min:"0.1",max:"5",step:"0.1",value:u,onChange:x=>h(parseFloat(x.target.value)),className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 slider"}),s.jsx("button",{onClick:()=>h(Math.min(5,u+.1)),className:"btn-ghost btn-sm w-8 h-8 p-0 flex-shrink-0",disabled:u>=5,children:"+"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>f(d-90),className:"btn-ghost btn-sm w-8 h-8 p-0 flex-shrink-0",children:""}),s.jsx("input",{type:"range",min:"-180",max:"180",step:"1",value:d,onChange:x=>f(parseInt(x.target.value)),className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 slider"}),s.jsx("button",{onClick:()=>f(d+90),className:"btn-ghost btn-sm w-8 h-8 p-0 flex-shrink-0",children:""})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>p(Math.max(-100,m-10)),className:"btn-ghost btn-sm w-8 h-8 p-0 flex-shrink-0",disabled:m<=-100,children:s.jsx(gx,{className:"w-4 h-4"})}),s.jsx("input",{type:"range",min:"-100",max:"100",step:"1",value:m,onChange:x=>p(parseInt(x.target.value)),className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 slider"}),s.jsx("button",{onClick:()=>p(Math.min(100,m+10)),className:"btn-ghost btn-sm w-8 h-8 p-0 flex-shrink-0",disabled:m>=100,children:s.jsx(yx,{className:"w-4 h-4"})})]}),(u!==1||d!==0||m!==0||l.x!==100||l.y!==100||l.width!==200||l.height!==200)&&s.jsx("button",{onClick:()=>{h(1),f(0),p(0),c({x:100,y:100,width:200,height:200})},className:"btn-secondary w-full",children:"Reset"})]})]})]}),s.jsxs("div",{className:`flex space-x-3 ${y?"p-4 border-t border-border-custom":""}`,children:[s.jsx("button",{onClick:t,className:`btn-ghost btn-flex ${y?"flex-1 py-3":""}`,children:"Cancel"}),s.jsx("button",{onClick:b,className:`btn-primary btn-flex ${y?"flex-1 py-3":""}`,children:"Crop & Use"})]})]})}):null}function Ki({value:e,onChange:t,minDate:n=mu(),placeholder:r="Select date",className:i="",disabled:a=!1}){const[o,l]=j.useState(!1),[c,u]=j.useState(new Date),[h,d]=j.useState(e?new Date(e):null),f=j.useRef(null);j.useEffect(()=>{const C=T=>{f.current&&!f.current.contains(T.target)&&setTimeout(()=>{l(!1)},10)};return o&&document.addEventListener("click",C),()=>{document.removeEventListener("click",C)}},[o]),j.useEffect(()=>{e&&(d(new Date(e)),u(new Date(e)))},[e]);const m=C=>{const T=C.getFullYear(),I=C.getMonth(),v=new Date(T,I,1),A=new Date(T,I+1,0).getDate(),L=v.getDay(),O=[];for(let M=0;M<L;M++)O.push(null);for(let M=1;M<=A;M++)O.push(new Date(T,I,M));return O},p=C=>yj(C),y=C=>{const T=new Date(n);return T.setHours(0,0,0,0),C.setHours(0,0,0,0),C<T},S=C=>h?p(C)===p(h):!1,g=(C,T)=>{T.stopPropagation(),!y(C)&&(d(C),t(p(C)),l(!1))},b=C=>{C.stopPropagation(),C.preventDefault(),console.log("Previous month clicked"),u(new Date(c.getFullYear(),c.getMonth()-1,1))},x=C=>{C.stopPropagation(),C.preventDefault(),console.log("Next month clicked"),u(new Date(c.getFullYear(),c.getMonth()+1,1))},k=C=>{C.stopPropagation(),d(null),t(""),l(!1)},N=m(c),w=["January","February","March","April","May","June","July","August","September","October","November","December"];return s.jsxs("div",{className:`relative ${i}`,ref:f,children:[s.jsxs("div",{className:"relative",children:[s.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"text",value:h?h.toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"",placeholder:r,onClick:C=>{C.stopPropagation(),a||l(!o)},readOnly:!0,disabled:a,className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-brand focus:border-brand bg-bg-primary text-text cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"}),h&&!a&&s.jsx("button",{onClick:k,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary-text hover:text-text",children:s.jsx(fe,{className:"w-4 h-4"})})]}),o&&s.jsxs("div",{className:"absolute top-full left-0 mt-1 bg-bg-primary border border-border-custom rounded-lg shadow-lg z-[70] min-w-[280px]",onClick:C=>C.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border-custom",children:[s.jsx("button",{onClick:b,className:"p-1 hover:bg-bg-secondary rounded transition-colors",children:s.jsx(cx,{className:"w-4 h-4"})}),s.jsxs("h3",{className:"text-sm font-semibold text-text",children:[w[c.getMonth()]," ",c.getFullYear()]}),s.jsx("button",{onClick:x,className:"p-1 hover:bg-bg-secondary rounded transition-colors",children:s.jsx(Vt,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(C=>s.jsx("div",{className:"text-xs text-secondary-text text-center py-1",children:C},C))}),s.jsx("div",{className:"grid grid-cols-7 gap-1",children:N.map((C,T)=>s.jsx("div",{className:"text-center",children:C?s.jsx("button",{onClick:I=>g(C,I),disabled:y(C),className:`w-8 h-8 text-sm rounded-full transition-colors ${S(C)?"bg-brand text-white":y(C)?"text-secondary-text cursor-not-allowed":"hover:bg-bg-secondary text-text"}`,children:C.getDate()}):s.jsx("div",{className:"w-8 h-8"})},T))})]})]})]})}function kj({isOpen:e,onClose:t,onSuccess:n,preselectedBoxId:r}){const[i,a]=j.useState(""),[o,l]=j.useState(""),[c,u]=j.useState(""),[h,d]=j.useState(""),[f,m]=j.useState(""),[p,y]=j.useState(""),[S,g]=j.useState(""),[b,x]=j.useState(""),[k,N]=j.useState("1"),[w,C]=j.useState(null),[T,I]=j.useState(!1),[v,P]=j.useState(null),[A,L]=j.useState([]),[O,M]=j.useState([]),[U,H]=j.useState(!1),[F,B]=j.useState(!1),[_,z]=j.useState(""),[q,E]=j.useState(""),[K,G]=j.useState(""),{user:W}=Ge(),{addRecentGame:le}=Hs();Ne.useEffect(()=>{if(e)document.body.style.overflow="hidden";else{document.body.style.overflow="unset";try{localStorage.removeItem("mini-myths-temp-box-context")}catch(V){console.error("Error clearing box context:",V)}}return()=>{document.body.style.overflow="unset"}},[e]),j.useEffect(()=>{if(e)if(se(),je(),r)u(r);else try{const V=localStorage.getItem("mini-myths-temp-box-context");if(V){const X=JSON.parse(V);u(X.id)}}catch(V){console.error("Error reading box context from localStorage:",V)}},[e]),j.useEffect(()=>{e&&je()},[e,W]);const se=async()=>{try{const{data:V,error:X}=await Y.from("games").select("id, name, icon").order("name");if(X)throw X;L(V||[])}catch(V){console.error("Error fetching games:",V)}},ae=()=>!(W!=null&&W.fav_games)||W.fav_games.length===0?[]:A.filter(V=>{var X;return(X=W.fav_games)==null?void 0:X.includes(V.id)}),be=V=>{l(V);const X=A.find(oe=>oe.id===V);X&&le(X)},je=async()=>{if(W)try{const{data:V,error:X}=await Y.from("boxes").select(`
          id,
          name,
          game_id,
          purchase_date,
          public,
          created_at,
          game:games(
            name,
            icon
          )
        `).eq("user_id",W.id).order("created_at",{ascending:!1});if(X)throw X;const oe=(V||[]).map(Se=>({...Se,game:Se.game&&Array.isArray(Se.game)?Se.game[0]:Se.game}));M(oe)}catch(V){console.error("Error fetching boxes:",V)}},Ie=()=>o?O.filter(V=>V.game_id===o):O,ne=V=>{const X=V.target.files;if(E(""),G(""),X&&X.length>0){const oe=X[0];if(!bn(oe)){E("Please select a valid image file (JPEG, PNG, or WebP)"),C(null),V.target.value="";return}const Se=50*1024*1024;oe.size>Se?(E(`Your image must be 50MB or less. Current size: ${He(oe.size)}`),C(null),V.target.value=""):(C(X),X&&X.length>0&&(P(X[0]),I(!0)),oe.size>1024*1024&&G(`Original size: ${He(oe.size)}. Image will be automatically compressed before upload.`))}else C(X)},Q=async()=>{var V;try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){E("Camera is not available on this device");return}E("");let X;try{X=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280,max:1920},height:{ideal:720,max:1080}}})}catch(de){console.log("Back camera failed, trying front camera:",de);try{X=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:1280,max:1920},height:{ideal:720,max:1080}}})}catch(ye){console.log("Front camera failed, trying any available camera:",ye),X=await navigator.mediaDevices.getUserMedia({video:!0})}}const oe=document.createElement("video");oe.srcObject=X,oe.autoplay=!0,oe.playsInline=!0,oe.muted=!0,oe.style.position="fixed",oe.style.top="0",oe.style.left="0",oe.style.width="100%",oe.style.height="100%",oe.style.zIndex="9999",oe.style.objectFit="cover",oe.style.backgroundColor="#000";const Se=document.createElement("canvas"),rt=Se.getContext("2d");if(!rt)throw new Error("Could not get canvas context");const D=document.createElement("button");D.textContent=" Take Photo",D.style.position="fixed",D.style.bottom="20px",D.style.left="50%",D.style.transform="translateX(-50%)",D.style.zIndex="10000",D.style.padding="12px 24px",D.style.backgroundColor="#007bff",D.style.color="white",D.style.border="none",D.style.borderRadius="8px",D.style.fontSize="16px",D.style.fontWeight="bold",D.style.touchAction="manipulation";const R=document.createElement("button");R.textContent=" Cancel",R.style.position="fixed",R.style.top="20px",R.style.right="20px",R.style.zIndex="10000",R.style.padding="8px 16px",R.style.backgroundColor="#dc3545",R.style.color="white",R.style.border="none",R.style.borderRadius="6px",R.style.fontSize="14px",R.style.touchAction="manipulation";const $=document.createElement("button");$.textContent=" Switch Camera",$.style.position="fixed",$.style.top="20px",$.style.left="20px",$.style.zIndex="10000",$.style.padding="8px 16px",$.style.backgroundColor="#6c757d",$.style.color="white",$.style.border="none",$.style.borderRadius="6px",$.style.fontSize="14px",$.style.touchAction="manipulation";let te=((V=X.getVideoTracks()[0])==null?void 0:V.getSettings().facingMode)||"environment";const ue=async()=>{try{X.getTracks().forEach(Ce=>Ce.stop());const de=te==="environment"?"user":"environment";te=de;const ye=await navigator.mediaDevices.getUserMedia({video:{facingMode:de,width:{ideal:1280,max:1920},height:{ideal:720,max:1080}}});oe.srcObject=ye,X=ye}catch(de){console.error("Error switching camera:",de);try{const ye=await navigator.mediaDevices.getUserMedia({video:!0});X.getTracks().forEach(Ce=>Ce.stop()),oe.srcObject=ye,X=ye}catch(ye){console.error("Fallback camera also failed:",ye)}}},he=()=>{try{if(oe.videoWidth===0||oe.videoHeight===0){console.log("Video not ready yet, waiting..."),setTimeout(he,100);return}Se.width=oe.videoWidth,Se.height=oe.videoHeight,rt.drawImage(oe,0,0,Se.width,Se.height),Se.toBlob(de=>{if(de){const ye=new File([de],`camera-capture-${Date.now()}.jpg`,{type:"image/jpeg"});if(!bn(ye)){E("Please select a valid image file (JPEG, PNG, or WebP)");return}const Ce=50*1024*1024;if(ye.size>Ce)E(`Your image must be 50MB or less. Current size: ${He(ye.size)}`);else{const Le=new DataTransfer;Le.items.add(ye),C(Le.files),E(""),G(""),P(ye),I(!0),ye.size>1024*1024&&G(`Original size: ${He(ye.size)}. Image will be automatically compressed before upload.`)}}ce()},"image/jpeg",.9)}catch(de){console.error("Error capturing photo:",de),E("Error capturing photo. Please try again."),ce()}},ce=()=>{try{X&&X.getTracks().forEach(de=>de.stop()),document.body.contains(oe)&&document.body.removeChild(oe),document.body.contains(D)&&document.body.removeChild(D),document.body.contains(R)&&document.body.removeChild(R),document.body.contains($)&&document.body.removeChild($)}catch(de){console.error("Error during cleanup:",de)}};D.addEventListener("click",he),R.addEventListener("click",ce),$.addEventListener("click",ue),document.body.appendChild(oe),document.body.appendChild(D),document.body.appendChild(R),document.body.appendChild($),oe.addEventListener("loadedmetadata",()=>{console.log("Video ready, dimensions:",oe.videoWidth,"x",oe.videoHeight)}),oe.addEventListener("error",de=>{console.error("Video error:",de),E("Error loading camera feed. Please try again."),ce()})}catch(X){console.error("Error accessing camera:",X),X instanceof DOMException?X.name==="NotAllowedError"?E("Camera access denied. Please allow camera permissions and try again."):X.name==="NotFoundError"?E("No camera found on this device."):X.name==="NotReadableError"?E("Camera is already in use by another application."):E(`Camera error: ${X.message}`):E("Unable to access camera. Please try again or use the file upload option.")}},re=V=>{const X=new DataTransfer;X.items.add(V),C(X.files),I(!1),P(null),G(`Cropped image ready for upload (${He(V.size)})`)},ge=()=>{I(!1),P(null);const V=document.getElementById("image");V&&(V.value=""),C(null)},ve=V=>{const X=V.target.value.replace(/[^0-9.]/g,"");if(g(X),X&&!isNaN(parseFloat(X))){const oe=parseFloat(X);x(`$${oe.toFixed(2)}`)}else x("")},we=async V=>{if(V.preventDefault(),!(!i.trim()||!W)){H(!0),z("");try{let X="";if(w&&w.length>0){const D=w[0];if(K.includes("Cropped image ready")){B(!0);try{const $=await yn(D,1200,1200,.8);console.log(`Cropped image compressed: ${He(D.size)}  ${He($.size)}`);const te=$.name.split(".").pop(),ue=`${W.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${te}`,{data:he,error:ce}=await Y.storage.from("model-images").upload(ue,$);if(ce)throw console.error("Compressed cropped image upload error:",ce),new Error(`Failed to upload image: ${ce.message}`);{const{data:de}=Y.storage.from("model-images").getPublicUrl(he.path);X=de.publicUrl,console.log("Uploaded compressed cropped image URL:",X)}}catch($){console.error("Cropped image compression error:",$);const te=D.name.split(".").pop(),ue=`${W.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${te}`,{data:he,error:ce}=await Y.storage.from("model-images").upload(ue,D);if(ce)throw console.error("Fallback cropped image upload error:",ce),new Error(`Failed to upload image: ${ce.message}`);{const{data:de}=Y.storage.from("model-images").getPublicUrl(he.path);X=de.publicUrl,console.log("Uploaded uncompressed cropped image URL:",X)}}finally{B(!1)}}else{B(!0);try{const $=await yn(D,1200,1200,.8);console.log(`Image compressed: ${He(D.size)}  ${He($.size)}`);const te=$.name.split(".").pop(),ue=`${W.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${te}`,{data:he,error:ce}=await Y.storage.from("model-images").upload(ue,$);if(ce)throw console.error("Image upload error:",ce),new Error(`Failed to upload image: ${ce.message}`);{const{data:de}=Y.storage.from("model-images").getPublicUrl(he.path);X=de.publicUrl,console.log("Uploaded compressed image URL:",X)}}catch($){console.error("Image compression error:",$);try{const te=D.name.split(".").pop(),ue=`${W.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${te}`,{data:he,error:ce}=await Y.storage.from("model-images").upload(ue,D);if(ce)throw console.error("Original image upload error:",ce),new Error(`Failed to upload image: ${ce.message}`);{const{data:de}=Y.storage.from("model-images").getPublicUrl(he.path);X=de.publicUrl,console.log("Uploaded original image URL:",X)}}catch(te){throw console.error("Fallback upload failed:",te),new Error("Failed to upload image after compression fallback")}}finally{B(!1)}}}let oe=o||null;if(c||r){const D=c||r,R=O.find($=>$.id===D);R&&R.game_id&&(oe=R.game_id)}let Se=!1;if(c||r){const D=c||r,R=O.find($=>$.id===D);R&&(Se=R.public)}const{error:rt}=await Y.from("models").insert({name:i.trim(),box_id:c||r||null,game_id:oe,status:h||"None",count:parseInt(k)||1,user_id:W.id,image_url:X,purchase_date:f||null,painted_date:p||null,public:Se});if(rt)throw rt;a(""),l(""),u(""),d(""),m(""),y(""),g(""),x(""),N("1"),C(null),G(""),n(),t()}catch(X){z(X instanceof Error?X.message:"Failed to add model")}finally{H(!1),B(!1)}}},Ue=i.trim().length>0&&!q&&!F;if(!e)return null;const Fe=V=>{V.target===V.currentTarget&&t()};return Ie(),s.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:Fe,children:[s.jsxs("div",{className:`bg-modal-bg rounded-lg max-w-lg w-full p-6 overflow-y-auto transition-all duration-300 ease-out transform
        fixed inset-0 sm:relative sm:inset-auto sm:max-w-lg sm:h-auto sm:rounded-lg sm:max-h-[90vh] h-screen w-screen sm:w-full overflow-y-auto rounded-none sm:rounded-lg p-6 sm:p-6
        ${e?"translate-y-0 opacity-100":"translate-y-full opacity-0"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-lg font-bold text-secondary-text uppercase tracking-wide text-center flex-1",children:"Add New Model"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6 text-icon"})})]}),s.jsx("p",{className:"text-base text-secondary-text text-center mb-8",children:"Don't worry- you can update any of these details later."}),s.jsxs("form",{onSubmit:we,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{htmlFor:"modelName",className:"block text-sm font-medium text-input-label font-overpass",children:"Model Name"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Required"})]}),s.jsx("input",{type:"text",id:"modelName",value:i,onChange:V=>a(V.target.value),placeholder:'eg. "Space Marine Lieutenant", "Captain America", "US Ranger Squad", etc.',className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] placeholder-secondary-text bg-bg-primary text-text"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"box",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Collection (Optional)"}),s.jsxs("select",{id:"box",value:c,onChange:V=>{u(V.target.value),V.target.value&&l("")},className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text",children:[s.jsx("option",{value:"",children:"No Collection (Loose Model)"}),Ie().map(V=>s.jsxs("option",{value:V.id,children:[V.name," ",V.game&&`(${V.game.name})`]},V.id))]}),s.jsx("p",{className:"text-xs text-secondary-text mt-1",children:"Choose an existing collection or leave as loose model."}),c&&(()=>{const V=O.find(X=>X.id===c);return V&&V.game?s.jsxs("p",{className:"text-xs text-[var(--color-brand)] mt-1",children:["Game will be automatically set to: ",s.jsx("strong",{children:V.game.name})]}):null})()]}),!c&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"game",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game"}),s.jsx(Yr,{games:A,selectedGame:o,onGameSelect:be,placeholder:"Choose a Game",favoriteGames:ae()})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"paintedStatus",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Painted Status"}),s.jsxs("select",{id:"paintedStatus",value:h,onChange:V=>d(V.target.value),className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text",children:[s.jsx("option",{value:"",children:"Select Status"}),s.jsx("option",{value:"Assembled",children:"Assembled"}),s.jsx("option",{value:"Primed",children:"Primed"}),s.jsx("option",{value:"Partially Painted",children:"Partially Painted"}),s.jsx("option",{value:"Painted",children:"Painted"})]})]}),h==="Painted"&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"paintedDate",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Painted Date"}),s.jsx(Ki,{value:p,onChange:y,placeholder:"Select painted date",minDate:""})]}),!c&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"purchaseDate",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Purchase Date"}),s.jsx(Ki,{value:f,onChange:m,placeholder:"Select purchase date",minDate:""})]}),!c&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"purchasePrice",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Purchase Price"}),s.jsxs("div",{className:"relative",children:[s.jsx(dx,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"number",id:"purchasePrice",value:S,onChange:ve,placeholder:"Enter Purchase Price",step:"0.01",min:"0",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] placeholder-secondary-text bg-bg-primary text-text"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"numberOfModels",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Number of Models"}),s.jsxs("div",{className:"relative",children:[s.jsx(Yo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"number",id:"numberOfModels",value:k,onChange:V=>N(V.target.value),min:"1",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text"})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass",children:"Model Image"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Optional"})]}),s.jsx("div",{className:"border-2 border-dashed border-border-custom rounded-lg p-6 text-center hover:border-[var(--color-brand)] transition-colors",children:w&&w.length>0?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative mx-auto w-32 h-32",children:[s.jsx("img",{src:URL.createObjectURL(w[0]),alt:"Selected model image",className:"w-full h-full object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>{C(null),E(""),G("")},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",children:s.jsx(fe,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-sm text-secondary-text",children:w[0].name})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-center space-x-4",children:[s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:ne,className:"hidden",disabled:U}),s.jsxs("div",{className:"flex flex-col items-center space-y-2 p-4 rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx(En,{className:"w-8 h-8 text-icon"}),s.jsx("span",{className:"text-sm font-medium text-text",children:"Upload Image"})]})]}),s.jsxs("button",{type:"button",onClick:Q,disabled:U,className:"flex flex-col items-center space-y-2 p-4 rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx(zs,{className:"w-8 h-8 text-icon"}),s.jsx("span",{className:"text-sm font-medium text-text",children:"Take Photo"})]})]}),s.jsx("p",{className:"text-xs text-secondary-text",children:"JPEG, PNG, or WebP up to 50MB"})]})}),q&&s.jsx("p",{className:"text-red-600 text-sm mt-2",children:q}),K&&s.jsx("p",{className:"text-blue-600 text-sm mt-2",children:K})]}),K&&s.jsx("div",{className:"text-blue-600 text-sm bg-blue-50 p-3 rounded-lg",children:K}),q&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:q}),_&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:_}),s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx("button",{type:"submit",disabled:!Ue||U,className:`${Ue&&!U?"btn-primary":"btn-disabled"}`,children:F?"Compressing Image...":U?"Adding...":"Add to Collection"})})]})]}),v&&s.jsx(qn,{isOpen:T,onClose:ge,onCrop:re,imageFile:v})]})}function Gx({isOpen:e,onClose:t,images:n,onImageSelect:r,searchQuery:i,onFindMoreImages:a,isLoadingMore:o}){if(!e)return null;const l=c=>{c.target===c.currentTarget&&t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",onClick:l,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-4xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Ko,{className:"w-6 h-6 text-secondary-text"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-bold text-title",children:"Suggested Images"}),s.jsxs("p",{className:"text-sm text-secondary-text",children:['Search results for: "',i,'"']})]})]}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6"})})]}),n.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsxs("p",{className:"text-base text-secondary-text mb-4",children:['No images found for "',i,'". Try uploading your own image instead.']}),s.jsx("button",{onClick:t,className:"btn-primary",children:"Upload My Own Image"})]}):s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-sm text-secondary-text mb-6",children:"Click on an image to use it for your box. Images are sourced from Google Image Search."}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:n.map((c,u)=>s.jsxs("button",{onClick:()=>r(c),className:"group relative aspect-square overflow-hidden rounded-lg border-2 border-transparent hover:border---color-brand transition-all duration-200",children:[s.jsx("img",{src:c,alt:`Suggested image ${u+1}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",loading:"lazy"}),s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-200 flex items-center justify-center",children:s.jsx("span",{className:"text-white font-overpass font-medium opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:"Select Image"})})]},u))}),a&&s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx("button",{onClick:a,disabled:o,className:"btn-primary btn-with-icon",children:o?s.jsxs(s.Fragment,{children:[s.jsx(Nm,{className:"w-4 h-4 animate-spin"}),s.jsx("span",{children:"Finding more images..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Nm,{className:"w-4 h-4"}),s.jsx("span",{children:"Find more images"})]})})}),s.jsx("div",{className:"flex justify-center",children:s.jsx("button",{onClick:t,className:"btn-ghost",children:"Upload My Own Image Instead"})})]})]})})}function Si({variant:e="primary",size:t="default",width:n="default",withIcon:r=!1,className:i="",children:a,...o}){const l=`btn-${e}`,d=[t==="small"?`btn-${e}-sm`:l,n==="full"?"btn-full":n==="flex"?"btn-flex":"",r?t==="small"?"btn-with-icon-sm":"btn-with-icon":"",i].filter(Boolean).join(" ");return s.jsx("button",{className:d,...o,children:a})}function Nj({isOpen:e,onClose:t,onSuccess:n}){var D;const[r,i]=j.useState(""),[a,o]=j.useState(""),[l,c]=j.useState(""),[u,h]=j.useState(""),[d,f]=j.useState(""),[m,p]=j.useState(null),[y,S]=j.useState(!1),[g,b]=j.useState(null),[x,k]=j.useState([]),[N,w]=j.useState(!1),[C,T]=j.useState(!1),[I,v]=j.useState(""),[P,A]=j.useState(""),[L,O]=j.useState(""),{user:M}=Ge(),{addRecentGame:U}=Hs(),[H,F]=j.useState(!1),[B,_]=j.useState(!1),[z,q]=j.useState([]),[E,K]=j.useState(""),[G,W]=j.useState([]),[le,se]=j.useState(!1);let ae=null;Ne.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]),j.useEffect(()=>{e&&be()},[e]);const be=async()=>{try{const{data:R,error:$}=await Y.from("games").select("id, name, icon").order("name");if($)throw $;k(R||[])}catch(R){console.error("Error fetching games:",R)}},je=()=>!(M!=null&&M.fav_games)||M.fav_games.length===0?[]:x.filter(R=>{var $;return($=M.fav_games)==null?void 0:$.includes(R.id)}),Ie=R=>{o(R);const $=x.find(te=>te.id===R);$&&U($)},ne=R=>{const $=R.target.files;if(A(""),O(""),$&&$.length>0){const te=$[0];if(!bn(te)){A("Please select a valid image file (JPEG, PNG, or WebP)"),p(null),R.target.value="";return}const ue=50*1024*1024;te.size>ue?(A(`Your image must be 50MB or less. Current size: ${He(te.size)}`),p(null),R.target.value=""):(p($),$&&$.length>0&&(b($[0]),S(!0)),te.size>1024*1024&&O(`Original size: ${He(te.size)}. Image will be automatically compressed before upload.`))}else p($)},Q=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){alert("Camera is not available on this device");return}const R=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280,max:1920},height:{ideal:720,max:1080}}}),$=document.createElement("video");$.srcObject=R,$.autoplay=!0,$.playsInline=!0,$.muted=!0,$.style.position="fixed",$.style.top="0",$.style.left="0",$.style.width="100%",$.style.height="100%",$.style.zIndex="9999",$.style.objectFit="cover",$.style.backgroundColor="#000";const te=document.createElement("canvas"),ue=te.getContext("2d");if(!ue)throw new Error("Could not get canvas context");const he=document.createElement("button");he.textContent=" Take Photo",he.style.position="fixed",he.style.bottom="20px",he.style.left="50%",he.style.transform="translateX(-50%)",he.style.zIndex="10000",he.style.padding="12px 24px",he.style.backgroundColor="#007bff",he.style.color="white",he.style.border="none",he.style.borderRadius="8px",he.style.fontSize="16px",he.style.fontWeight="bold",he.style.cursor="pointer";const ce=document.createElement("button");ce.textContent=" Cancel",ce.style.position="fixed",ce.style.bottom="20px",ce.style.right="20px",ce.style.zIndex="10000",ce.style.padding="12px 24px",ce.style.backgroundColor="#dc3545",ce.style.color="white",ce.style.border="none",ce.style.borderRadius="8px",ce.style.fontSize="16px",ce.style.fontWeight="bold",ce.style.cursor="pointer";const de=()=>{try{te.width=$.videoWidth,te.height=$.videoHeight,ue.drawImage($,0,0,te.width,te.height),te.toBlob(Ce=>{if(Ce){const Le=new File([Ce],`collection-photo-${Date.now()}.jpg`,{type:"image/jpeg",lastModified:Date.now()}),Oe=new DataTransfer;Oe.items.add(Le),p(Oe.files),b(Le),S(!0)}ye()},"image/jpeg",.9)}catch(Ce){console.error("Error capturing photo:",Ce),alert("Error capturing photo. Please try again."),ye()}},ye=()=>{try{R&&R.getTracks().forEach(Ce=>Ce.stop()),document.body.contains($)&&document.body.removeChild($),document.body.contains(he)&&document.body.removeChild(he),document.body.contains(ce)&&document.body.removeChild(ce)}catch(Ce){console.error("Error during cleanup:",Ce)}};he.addEventListener("click",de),ce.addEventListener("click",ye),document.body.appendChild($),document.body.appendChild(he),document.body.appendChild(ce),$.addEventListener("loadedmetadata",()=>{console.log("Video ready, dimensions:",$.videoWidth,"x",$.videoHeight)}),$.addEventListener("error",Ce=>{console.error("Video error:",Ce),alert("Error loading camera feed. Please try again."),ye()})}catch(R){console.error("Error accessing camera:",R),R instanceof DOMException?R.name==="NotAllowedError"?alert("Camera access denied. Please allow camera permissions and try again."):R.name==="NotFoundError"?alert("No camera found on this device."):R.name==="NotReadableError"?alert("Camera is already in use by another application."):alert(`Camera error: ${R.message}`):alert("Unable to access camera. Please try again or use the file upload option.")}},re=R=>{const $=new DataTransfer;$.items.add(R),p($.files),S(!1),b(null),O(`Cropped image ready for upload (${He(R.size)})`)},ge=()=>{S(!1),b(null);const R=document.getElementById("boxImage");R&&(R.value=""),p(null)},ve=R=>{const $=R.target.value.replace(/[^0-9.]/g,"");if(h($),$&&!isNaN(parseFloat($))){const te=parseFloat($);f(`$${te.toFixed(2)}`)}else f("")},we=async()=>{if(r.trim()){_(!0),q([]),W([]);try{const R=x.find(de=>de.id===a),$=(R==null?void 0:R.name)||"",te=`${r.trim()} ${$}`.trim(),ue=await fetch("https://dthxptbozocrbvmhwvao.supabase.co/functions/v1/search-images",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0aHhwdGJvem9jcmJ2bWh3dmFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyOTY0MzMsImV4cCI6MjA3MDg3MjQzM30.gFt4oRFZ7Mh4y8DgeKNbcKKDwTYjEdXRoBlqTNjvdRg","Content-Type":"application/json"},body:JSON.stringify({query:te,count:6})});if(!ue.ok)throw new Error("Failed to search for images");const ce=(await ue.json()).images||[];q(ce),W(ce),F(!0)}catch(R){console.error("Error searching for images:",R),F(!1)}finally{_(!1)}}},Ue=async()=>{if(r.trim()){se(!0);try{const R=x.find(ye=>ye.id===a),$=(R==null?void 0:R.name)||"",te=`${r.trim()} ${$}`.trim();console.log("Finding more images with exclude:",G);const ue=await fetch("https://dthxptbozocrbvmhwvao.supabase.co/functions/v1/search-images",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0aHhwdGJvem9jcmJ2bWh3dmFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyOTY0MzMsImV4cCI6MjA3MDg3MjQzM30.gFt4oRFZ7Mh4y8DgeKNbcKKDwTYjEdXRoBlqTNjvdRg","Content-Type":"application/json"},body:JSON.stringify({query:te,count:6,exclude:G})});if(!ue.ok)throw new Error("Failed to search for more images");const ce=(await ue.json()).images||[];console.log("Received additional images:",ce),console.log("Previous results count:",G.length),console.log("New results count:",ce.length);const de=ce.filter(ye=>!G.includes(ye));console.log("Unique new images after filtering:",de),q(de),W([...G,...de])}catch(R){console.error("Error searching for more images:",R)}finally{se(!1)}}},Fe=R=>{p(null),O(`Selected image: ${R}`),F(!1),K(R)},V=async R=>{if(R.preventDefault(),!(!r.trim()||!M)){w(!0),v("");try{let $="";if(E)$=E;else if(m&&m.length>0){const he=m[0];if(L.includes("Cropped image ready")){T(!0);try{const de=await yn(he,1200,1200,.8);console.log(`Cropped image compressed: ${He(he.size)}  ${He(de.size)}`);const ye=de.name.split(".").pop(),Ce=`${M.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${ye}`,{data:Le,error:Oe}=await Y.storage.from("model-images").upload(Ce,de);if(Oe)throw console.error("Compressed cropped image upload error:",Oe),new Error(`Failed to upload image: ${Oe.message}`);{const{data:st}=Y.storage.from("model-images").getPublicUrl(Le.path);$=st.publicUrl,console.log("Uploaded compressed cropped image URL:",$)}}catch(de){console.error("Cropped image compression error:",de);const ye=he.name.split(".").pop(),Ce=`${M.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${ye}`,{data:Le,error:Oe}=await Y.storage.from("model-images").upload(Ce,he);if(Oe)throw console.error("Fallback cropped image upload error:",Oe),new Error(`Failed to upload image: ${Oe.message}`);{const{data:st}=Y.storage.from("model-images").getPublicUrl(Le.path);$=st.publicUrl,console.log("Uploaded uncompressed cropped image URL:",$)}}finally{T(!1)}}else{T(!0);try{const de=await yn(he,1200,1200,.8);console.log(`Image compressed: ${He(he.size)}  ${He(de.size)}`);const ye=de.name.split(".").pop(),Ce=`${M.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${ye}`,{data:Le,error:Oe}=await Y.storage.from("model-images").upload(Ce,de);if(Oe)throw console.error("Image upload error:",Oe),new Error(`Failed to upload image: ${Oe.message}`);{const{data:st}=Y.storage.from("model-images").getPublicUrl(Le.path);$=st.publicUrl,console.log("Uploaded compressed image URL:",$)}}catch(de){console.error("Image compression error:",de);try{const ye=he.name.split(".").pop(),Ce=`${M.id}/${Date.now()}-${Math.random().toString(36).substring(2)}.${ye}`,{data:Le,error:Oe}=await Y.storage.from("model-images").upload(Ce,he);if(Oe)throw console.error("Original image upload error:",Oe),new Error(`Failed to upload image: ${Oe.message}`);{const{data:st}=Y.storage.from("model-images").getPublicUrl(Le.path);$=st.publicUrl,console.log("Uploaded original image URL:",$)}}catch(ye){throw console.error("Fallback upload failed:",ye),new Error("Failed to upload image after compression fallback")}}finally{T(!1)}}}const{data:te,error:ue}=await Y.from("boxes").insert({name:r.trim(),game_id:a||null,purchase_date:l||null,user_id:M.id,image_url:$}).select().single();if(ue)throw ue;return ae=te.id,i(""),o(""),c(""),h(""),f(""),p(null),O(""),K(""),F(!1),q([]),n(),te}catch($){throw v($ instanceof Error?$.message:"Failed to add box"),$}finally{w(!1),T(!1)}}},X=async R=>{try{await V(R),t()}catch{}},oe=async R=>{await V(R),t()},Se=r.trim().length>0&&!P&&!C;if(!e)return null;const rt=R=>{R.target===R.currentTarget&&t()};return s.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:rt,children:[s.jsxs("div",{className:`bg-modal-bg rounded-lg max-w-lg w-full p-6 overflow-y-auto transition-all duration-300 ease-out transform
        fixed inset-0 sm:relative sm:inset-auto sm:max-w-lg sm:h-auto sm:rounded-lg sm:max-h-[90vh] h-screen w-screen sm:w-full overflow-y-auto rounded-none sm:rounded-lg p-6 sm:p-6
        ${e?"translate-y-0 opacity-100":"translate-y-full opacity-0"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-lg font-bold text-secondary-text uppercase tracking-wide text-center flex-1",children:"Add New Collection"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6 text-icon"})})]}),s.jsx("p",{className:"text-base text-secondary-text text-center mb-8",children:"Collections are a way to sort your models into groups. You can use this to track boxes you've bought, squads you've assembled, or simply to organise your collection."}),s.jsxs("form",{onSubmit:V,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{htmlFor:"boxName",className:"block text-sm font-medium text-input-label font-overpass",children:"Collection Name"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Required"})]}),s.jsx("input",{type:"text",id:"boxName",value:r,onChange:R=>i(R.target.value),placeholder:'eg. "Kill Team Collection", "Space Marine Heroes", "Warhammer 40k Elite Edition", etc.',className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] placeholder-secondary-text bg-bg-primary text-text"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"game",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game"}),s.jsx(Yr,{games:x,selectedGame:a,onGameSelect:Ie,placeholder:"Choose a Game",favoriteGames:je()})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"purchaseDate",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Purchase Date"}),s.jsxs("div",{className:"relative",children:[s.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"date",id:"purchaseDate",value:l,onChange:R=>c(R.target.value),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] text-text bg-bg-primary [&::-webkit-calendar-picker-indicator]:hidden [&::-webkit-calendar-picker-indicator]:appearance-none"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"purchasePrice",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Purchase Price"}),s.jsxs("div",{className:"relative",children:[s.jsx(dx,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"number",id:"purchasePrice",value:u,onChange:ve,placeholder:"Enter Purchase Price",step:"0.01",min:"0",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] placeholder-secondary-text bg-bg-primary text-text"})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass",children:"Collection Image"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Optional"})]}),s.jsx("div",{className:"border-2 border-dashed border-border-custom rounded-lg p-6 text-center hover:border-[var(--color-brand)] transition-colors",children:m&&m.length>0?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative mx-auto w-32 h-32",children:[s.jsx("img",{src:URL.createObjectURL(m[0]),alt:"Selected collection image",className:"w-full h-full object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>{p(null),A(""),O("")},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",children:s.jsx(fe,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-sm text-secondary-text",children:m[0].name})]}):E?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative mx-auto w-32 h-32",children:[s.jsx("img",{src:E,alt:"Selected collection image",className:"w-full h-full object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>{K(""),A(""),O("")},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",children:s.jsx(fe,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-sm text-secondary-text",children:"Selected image"})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-center space-x-4",children:[s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:ne,className:"hidden",disabled:N}),s.jsxs("div",{className:"flex flex-col items-center space-y-2 p-4 rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx(En,{className:"w-8 h-8 text-icon"}),s.jsx("span",{className:"text-sm font-medium text-text",children:"Upload Image"})]})]}),s.jsxs("button",{type:"button",onClick:Q,disabled:N,className:"flex flex-col items-center space-y-2 p-4 rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx(zs,{className:"w-8 h-8 text-icon"}),s.jsx("span",{className:"text-sm font-medium text-text",children:"Take Photo"})]})]}),s.jsx("p",{className:"text-xs text-secondary-text",children:"JPEG, PNG, or WebP up to 50MB"})]})}),r.trim()&&!m&&!E&&s.jsx("div",{className:"mt-3",children:s.jsx(Si,{variant:"secondary",width:"full",size:"small",onClick:we,disabled:B,children:B?"Searching for images...":"Find images for this collection"})}),P&&s.jsx("p",{className:"text-red-600 text-sm mt-2",children:P}),L&&s.jsx("p",{className:"text-blue-600 text-sm mt-2",children:L})]}),L&&s.jsx("div",{className:"text-blue-600 text-sm bg-blue-50 p-3 rounded-lg",children:L}),P&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:P}),I&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:I}),s.jsxs("div",{className:"flex flex-col space-y-3 pt-4",children:[s.jsx(Si,{className:"btn-primary",variant:Se&&!N?"primary":"disabled",width:"full",onClick:X,disabled:!Se||N,children:C?"Compressing Image...":N?"Adding...":"Add Empty Collection"}),s.jsx(Si,{variant:Se&&!N?"primary":"disabled",width:"full",onClick:oe,disabled:!Se||N,children:C?"Compressing Image...":N?"Adding...":"Add Models to Collection"})]})]})]}),g&&s.jsx(qn,{isOpen:y,onClose:ge,onCrop:re,imageFile:g}),H&&s.jsx(Gx,{isOpen:H,onClose:()=>F(!1),images:z,onImageSelect:Fe,searchQuery:`${r} ${((D=x.find(R=>R.id===a))==null?void 0:D.name)||""}`.trim(),onFindMoreImages:Ue,isLoadingMore:le})]})}function Sj({onBack:e}){const[t,n]=j.useState([]),[r,i]=j.useState(!0),[a,o]=j.useState(null);j.useEffect(()=>{l()},[]);const l=async()=>{try{const{data:u,error:h}=await Y.from("users").select("*").order("created_at",{ascending:!1});if(h)throw h;const{data:d,error:f}=await Y.from("locations").select("id, name, address, admins").order("name");if(f)throw f;const m=(u||[]).map(p=>{const y=(d||[]).filter(S=>S.admins&&S.admins.includes(p.id));return{...p,adminLocations:y}});n(m)}catch(u){o(u instanceof Error?u.message:"Failed to fetch users")}finally{i(!1)}},c=u=>jt(u,{year:"numeric",month:"short",day:"numeric"});return r?s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text",children:"Loading users..."})]})}):s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(Tt,{className:"w-5 h-5"}),s.jsx("span",{children:"Back to Admin"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title",children:"MANAGE USERS"})]}),a&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:a})}),s.jsx("div",{className:"space-y-4",children:t.map(u=>s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6 flex items-center justify-between gap-6",children:[s.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[s.jsx($t,{className:"w-6 h-6 text-secondary-text"}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-text truncate",children:u.email||"No email"}),s.jsxs("div",{className:"text-sm text-secondary-text space-y-1",children:[s.jsxs("p",{children:["Joined ",c(u.created_at)]}),u.user_name_public&&s.jsxs("p",{className:"text-brand",children:["Public name: ",u.user_name_public]}),u.adminLocations.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:u.adminLocations.map(h=>s.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[s.jsx(wr,{className:"w-3 h-3 mr-1"}),h.name]},h.id))})]})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-2",children:[s.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex-shrink-0 ${u.is_admin?"bg-amber-100 text-amber-800":"bg-gray-100 text-gray-800"}`,children:u.is_admin?"Admin":"User"}),u.adminLocations.length>0&&s.jsxs("span",{className:"text-xs text-secondary-text",children:[u.adminLocations.length," location",u.adminLocations.length!==1?"s":""," admin"]})]})]},u.id))}),t.length===0&&!r&&s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-base text-secondary-text",children:"No users found."})})]})}function _j({isOpen:e,onClose:t,onGameUpdated:n,game:r}){const[i,a]=j.useState({name:"",manufacturer_id:"",image:"",icon:""}),[o,l]=j.useState([]),[c,u]=j.useState(null),[h,d]=j.useState(null),[f,m]=j.useState(!1),[p,y]=j.useState(!1),[S,g]=j.useState(null),[b,x]=j.useState(null),[k,N]=j.useState(null),[w,C]=j.useState(null),[T,I]=j.useState(!1),[v,P]=j.useState(!1),[A,L]=j.useState("");j.useEffect(()=>{r&&a({name:r.name,manufacturer_id:r.manufacturer_id||"",image:r.image||"",icon:r.icon||""})},[r]),j.useEffect(()=>{e&&O()},[e]);const O=async()=>{try{const{data:E,error:K}=await Y.from("manufacturers").select("id, name").order("name");if(K)throw K;l(E||[])}catch(E){console.error("Error fetching manufacturers:",E)}},M=E=>{var G;const K=(G=E.target.files)==null?void 0:G[0];if(K){if(!bn(K)){alert("Please select a valid image file");return}u(K),g(K),m(!0)}},U=E=>{var G;const K=(G=E.target.files)==null?void 0:G[0];if(K){if(!bn(K)){alert("Please select a valid image file");return}d(K),x(K),y(!0)}},H=E=>{N(E),m(!1),g(null)},F=E=>{C(E),y(!1),x(null)},B=async(E,K,G)=>{const W=(c==null?void 0:c.name.split(".").pop())||"jpg",le=`${G}/${Date.now()}-${Math.random().toString(36).substring(2)}.${W}`,{data:se,error:ae}=await Y.storage.from(K).upload(le,E);if(ae)throw ae;const{data:be}=Y.storage.from(K).getPublicUrl(se.path);return be.publicUrl},_=async E=>{if(E.preventDefault(),!!r){I(!0),L("");try{let K=i.image,G=i.icon;if(k){P(!0);const le=await yn(k,1200,1200,.8);K=await B(le,"game-assets","images")}if(w){P(!0);const le=await yn(w,512,512,.9);G=await B(le,"game-assets","icons")}const{error:W}=await Y.from("games").update({name:i.name,manufacturer_id:i.manufacturer_id||null,image:K,icon:G}).eq("id",r.id);if(W)throw W;n()}catch(K){L(K instanceof Error?K.message:"Failed to update game")}finally{I(!1),P(!1)}}},z=()=>{r&&a({name:r.name,manufacturer_id:r.manufacturer_id||"",image:r.image||"",icon:r.icon||""}),u(null),d(null),N(null),C(null),L("")};if(!e||!r)return null;const q=E=>{E.target===E.currentTarget&&t()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:q,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-lg font-bold text-title",children:"Edit Game"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6"})})]}),s.jsxs("form",{onSubmit:_,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"gameName",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game Name"}),s.jsxs("div",{className:"relative",children:[s.jsx(Wo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"text",id:"gameName",value:i.name,onChange:E=>a({...i,name:E.target.value}),placeholder:"Enter game name...",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"manufacturer",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Manufacturer"}),s.jsxs("div",{className:"relative",children:[s.jsx($v,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsxs("select",{id:"manufacturer",value:i.manufacturer_id,onChange:E=>a({...i,manufacturer_id:E.target.value}),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",children:[s.jsx("option",{value:"",children:"Select a manufacturer..."}),o.map(E=>s.jsx("option",{value:E.id,children:E.name},E.id))]})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"gameImage",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game Image"}),s.jsxs("div",{className:"relative",children:[s.jsx(En,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"file",id:"gameImage",accept:"image/*",onChange:M,className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-amber-50 file:text-amber-700 hover:file:bg-amber-100 bg-bg-primary text-text"})]}),k&&s.jsx("p",{className:"text-sm text-green-600 mt-1",children:" New image ready for upload"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"gameIcon",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game Icon"}),s.jsxs("div",{className:"relative",children:[s.jsx(En,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"file",id:"gameIcon",accept:"image/*",onChange:U,className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-amber-50 file:text-amber-700 hover:file:bg-amber-100 bg-bg-primary text-text"})]}),w&&s.jsx("p",{className:"text-sm text-green-600 mt-1",children:" New icon ready for upload"})]}),A&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:A}),s.jsxs("div",{className:"flex space-x-3 pt-4",children:[s.jsx("button",{type:"button",onClick:z,className:"btn-ghost btn-flex",children:"Discard Changes"}),s.jsx("button",{type:"submit",disabled:T||v,className:"btn-primary btn-flex",children:v?"Processing...":T?"Saving...":"Save Changes"})]})]})]})}),S&&s.jsx(qn,{isOpen:f,onClose:()=>{m(!1),g(null),u(null)},onCrop:H,imageFile:S}),b&&s.jsx(qn,{isOpen:p,onClose:()=>{y(!1),x(null),d(null)},onCrop:F,imageFile:b})]})}function Cj({onBack:e}){const[t,n]=j.useState([]),[r,i]=j.useState(!0),[a,o]=j.useState(null),[l,c]=j.useState({isOpen:!1,game:null});j.useEffect(()=>{u()},[]);const u=async()=>{try{const{data:f,error:m}=await Y.from("games").select(`
          *,
          manufacturer:manufacturers(name)
        `).order("name");if(m)throw m;n(f||[])}catch(f){o(f instanceof Error?f.message:"Failed to fetch games")}finally{i(!1)}},h=f=>{c({isOpen:!0,game:f})},d=()=>{u(),c({isOpen:!1,game:null})};return r?s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text",children:"Loading games..."})]})}):s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(Tt,{className:"w-5 h-5"}),s.jsx("span",{children:"Back to Admin"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title",children:"MANAGE GAMES"})]}),a&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:a})}),s.jsx("div",{className:"space-y-4",children:t.map(f=>{var m;return s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6 flex items-center justify-between gap-6",children:[s.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[f.icon?s.jsx("img",{src:f.icon,alt:`${f.name} icon`,className:"w-12 h-12 object-contain rounded",onError:p=>{const y=p.target;y.style.display="none";const S=y.nextElementSibling;S&&S.classList.contains("icon-fallback")&&(S.style.display="flex")}}):null,s.jsx("div",{className:"w-12 h-12 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:f.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-sm font-bold",children:f.name.charAt(0)})}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-text truncate",children:f.name}),s.jsx("p",{className:"text-sm text-secondary-text",children:((m=f.manufacturer)==null?void 0:m.name)||"No manufacturer"})]})]}),s.jsxs("button",{onClick:()=>h(f),className:"btn-secondary-sm btn-with-icon-sm",children:[s.jsx(Vs,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]})]},f.id)})}),t.length===0&&!r&&s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-base text-secondary-text",children:"No games found."})}),s.jsx(_j,{isOpen:l.isOpen,onClose:()=>c({isOpen:!1,game:null}),onGameUpdated:d,game:l.game})]})}function Ej({isOpen:e,onClose:t,location:n}){const[r,i]=j.useState([]),[a,o]=j.useState(!0),[l,c]=j.useState(null),[u,h]=j.useState(!1),[d,f]=j.useState(null),[m,p]=j.useState({name:"",start_time:"",end_time:"",availability:[]}),[y,S]=j.useState(!1),g=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];j.useEffect(()=>{e&&b()},[e,n.id]);const b=async()=>{try{o(!0);const{data:v,error:P}=await Y.from("timeslots").select("*").eq("location_id",n.id).order("start_time");if(P)throw P;i(v||[])}catch(v){c(v instanceof Error?v.message:"Failed to fetch timeslots")}finally{o(!1)}},x=()=>{p({name:"",start_time:"",end_time:"",availability:[]}),f(null),h(!1)},k=v=>{p({name:v.name,start_time:v.start_time,end_time:v.end_time,availability:v.availability||[]}),f(v),h(!0)},N=async v=>{if(confirm("Are you sure you want to delete this timeslot?"))try{const{error:P}=await Y.from("timeslots").delete().eq("id",v);if(P)throw P;await b()}catch(P){console.error("Error deleting timeslot:",P),alert("Failed to delete timeslot")}},w=v=>{p(P=>({...P,availability:P.availability.includes(v)?P.availability.filter(A=>A!==v):[...P.availability,v]}))},C=async v=>{if(v.preventDefault(),!(!m.name.trim()||!m.start_time||!m.end_time)){S(!0),c(null);try{if(d){const{error:P}=await Y.from("timeslots").update({name:m.name.trim(),start_time:m.start_time,end_time:m.end_time,availability:m.availability}).eq("id",d.id);if(P)throw P}else{const{error:P}=await Y.from("timeslots").insert({name:m.name.trim(),start_time:m.start_time,end_time:m.end_time,location_id:n.id,availability:m.availability});if(P)throw P}await b(),x()}catch(P){c(P instanceof Error?P.message:"Failed to save timeslot")}finally{S(!1)}}},T=v=>new Date(`2000-01-01T${v}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});if(!e)return null;const I=v=>{v.target===v.currentTarget&&t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",onClick:I,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-4xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-lg font-bold text-title",children:["Manage Timeslots - ",n.name]}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6"})})]}),l&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:l})}),!u&&s.jsx("div",{className:"mb-6",children:s.jsxs("button",{onClick:()=>h(!0),className:"btn-primary btn-with-icon",children:[s.jsx(Pn,{className:"w-4 h-4"}),s.jsx("span",{children:"Add Timeslot"})]})}),u&&s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-title mb-4",children:d?"Edit Timeslot":"Add New Timeslot"}),s.jsxs("form",{onSubmit:C,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Timeslot Name"}),s.jsx("input",{type:"text",value:m.name,onChange:v=>p({...m,name:v.target.value}),placeholder:"e.g., Morning Session, Evening Games",className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Start Time"}),s.jsx("input",{type:"time",value:m.start_time,onChange:v=>p({...m,start_time:v.target.value}),className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"End Time"}),s.jsx("input",{type:"time",value:m.end_time,onChange:v=>p({...m,end_time:v.target.value}),className:"w-full px-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Available Days"}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:g.map(v=>s.jsx("button",{type:"button",onClick:()=>w(v),className:`px-3 py-2 rounded-lg text-sm font-overpass font-medium transition-colors ${m.availability.includes(v)?"bg-brand text-white":"bg-bg-primary border border-border-custom text-text hover:bg-bg-secondary"}`,children:v.slice(0,3)},v))})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{type:"button",onClick:x,className:"btn-ghost btn-flex",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:y,className:"btn-primary btn-flex",children:y?"Saving...":d?"Update Timeslot":"Add Timeslot"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-title",children:"Current Timeslots"}),a?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"Loading timeslots..."})]}):r.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Us,{className:"w-12 h-12 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"No timeslots configured for this location."})]}):r.map(v=>{var P;return s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-text",children:v.name}),s.jsxs("p",{className:"text-sm text-secondary-text",children:[T(v.start_time)," - ",T(v.end_time)]}),s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:(P=v.availability)==null?void 0:P.map(A=>s.jsx("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 text-xs rounded-full",children:A.slice(0,3)},A))})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>k(v),className:"p-2 text-secondary-text hover:text-text transition-colors",children:s.jsx(Vs,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>N(v.id),className:"p-2 text-icon hover:text-icon-hover transition-colors",children:s.jsx(Hn,{className:"w-4 h-4"})})]})]},v.id)})]})]})})}function Pj({isOpen:e,onClose:t,location:n,onAdminsUpdated:r}){const[i,a]=j.useState([]),[o,l]=j.useState([]),[c,u]=j.useState(""),[h,d]=j.useState(!0),[f,m]=j.useState(!1),[p,y]=j.useState("");j.useEffect(()=>{e&&n&&(S(),g())},[e,n]);const S=async()=>{try{const{data:N,error:w}=await Y.from("users").select("id, email").order("email");if(w)throw w;a(N||[])}catch(N){console.error("Error fetching users:",N),y("Failed to fetch users")}finally{d(!1)}},g=async()=>{if(!(n!=null&&n.admins)){l([]);return}try{const{data:N,error:w}=await Y.from("users").select("id, email").in("id",n.admins).order("email");if(w)throw w;l(N||[])}catch(N){console.error("Error fetching admin users:",N)}},b=async()=>{if(!(!c.trim()||!n)){m(!0),y("");try{const N=i.find(T=>T.email.toLowerCase()===c.toLowerCase().trim());if(!N){y("User not found"),m(!1);return}if(n.admins.includes(N.id)){y("User is already an admin"),m(!1);return}const w=[...n.admins,N.id],{error:C}=await Y.from("locations").update({admins:w}).eq("id",n.id);if(C)throw C;l([...o,N]),r(w),u("")}catch(N){y(N instanceof Error?N.message:"Failed to add admin")}finally{m(!1)}}},x=async N=>{if(n)try{const w=n.admins.filter(T=>T!==N),{error:C}=await Y.from("locations").update({admins:w}).eq("id",n.id);if(C)throw C;l(o.filter(T=>T.id!==N)),r(w)}catch(w){y(w instanceof Error?w.message:"Failed to remove admin")}};if(!e||!n)return null;const k=N=>{N.target===N.currentTarget&&t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",onClick:k,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-lg font-bold text-title",children:["Edit Location Admins - ",n.name]}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6"})})]}),p&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:p})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-md font-semibold text-title mb-3",children:"Add New Admin"}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Ko,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-4 h-4"}),s.jsx("input",{type:"text",value:c,onChange:N=>u(N.target.value),placeholder:"Search users by email...",className:"w-full pl-10 pr-4 py-2 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text"})]}),s.jsxs("button",{onClick:b,disabled:!c.trim()||f,className:"btn-primary-sm btn-with-icon-sm",children:[s.jsx(Pn,{className:"w-4 h-4"}),s.jsx("span",{children:f?"Adding...":"Add"})]})]}),s.jsx("p",{className:"text-xs text-secondary-text mt-2",children:"Enter the exact email address of the user you want to add as an admin."})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-md font-semibold text-title mb-3",children:"Current Admins"}),h?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"Loading admins..."})]}):o.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Wi,{className:"w-12 h-12 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"No admins assigned to this location."})]}):s.jsx("div",{className:"space-y-3",children:o.map(N=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-secondary rounded-lg border border-border-custom",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Wi,{className:"w-5 h-5 text-secondary-text"}),s.jsx("span",{className:"text-text font-medium",children:N.email})]}),s.jsx("button",{onClick:()=>x(N.id),className:"p-2 text-icon hover:text-icon-hover hover:bg-red-50 rounded-lg transition-colors",title:"Remove admin",children:s.jsx(Hn,{className:"w-4 h-4"})})]},N.id))})]}),s.jsx("div",{className:"mt-6 pt-4 border-t border-border-custom",children:s.jsx("button",{onClick:t,className:"btn-primary btn-full",children:"Done"})})]})})}function Tj({isOpen:e,onClose:t,onLocationUpdated:n,location:r}){const[i,a]=j.useState({name:"",address:"",icon:"",tables:1,admins:[]}),[o,l]=j.useState(null),[c,u]=j.useState(!1),[h,d]=j.useState(null),[f,m]=j.useState(null),[p,y]=j.useState(!1),[S,g]=j.useState(!1),[b,x]=j.useState(""),[k,N]=j.useState(!1),[w,C]=j.useState(!1);j.useEffect(()=>{r&&a({name:r.name,address:r.address,icon:r.icon||"",tables:r.tables||1,admins:r.admins||[]})},[r]);const T=M=>{var H;const U=(H=M.target.files)==null?void 0:H[0];if(U){if(!bn(U)){alert("Please select a valid image file");return}l(U),d(U),u(!0)}},I=M=>{m(M),u(!1),d(null)},v=async(M,U,H)=>{const F=(o==null?void 0:o.name.split(".").pop())||"jpg",B=`${H}/${Date.now()}-${Math.random().toString(36).substring(2)}.${F}`,{data:_,error:z}=await Y.storage.from(U).upload(B,M);if(z)throw z;const{data:q}=Y.storage.from(U).getPublicUrl(_.path);return q.publicUrl},P=async M=>{if(M.preventDefault(),!!r){y(!0),x("");try{let U=i.icon;if(f){g(!0);const F=await yn(f,512,512,.9);U=await v(F,"location-assets","icons")}const{error:H}=await Y.from("locations").update({name:i.name,address:i.address,icon:U,tables:i.tables,admins:i.admins}).eq("id",r.id);if(H)throw H;n()}catch(U){x(U instanceof Error?U.message:"Failed to update location")}finally{y(!1),g(!1)}}},A=()=>{r&&a({name:r.name,address:r.address,icon:r.icon||"",tables:r.tables||1,admins:r.admins||[]}),l(null),m(null),x("")},L=M=>{a(U=>({...U,admins:M}))};if(!e||!r)return null;const O=M=>{M.target===M.currentTarget&&t()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:O,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-lg font-bold text-title",children:"Edit Location"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6"})})]}),s.jsxs("form",{onSubmit:P,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"locationName",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Location Name"}),s.jsxs("div",{className:"relative",children:[s.jsx(wr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"text",id:"locationName",value:i.name,onChange:M=>a({...i,name:M.target.value}),placeholder:"Enter location name...",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Address"}),s.jsxs("div",{className:"relative",children:[s.jsx(Bv,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"text",id:"address",value:i.address,onChange:M=>a({...i,address:M.target.value}),placeholder:"Enter full address...",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"tables",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Number of Tables"}),s.jsxs("div",{className:"relative",children:[s.jsx(Yo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"number",id:"tables",value:i.tables,onChange:M=>a({...i,tables:parseInt(M.target.value)||0}),min:"1",placeholder:"Enter number of tables...",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"locationIcon",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Location Icon"}),s.jsxs("div",{className:"relative",children:[s.jsx(En,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"file",id:"locationIcon",accept:"image/*",onChange:T,className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-amber-50 file:text-amber-700 hover:file:bg-amber-100 bg-bg-primary text-text"})]}),f&&s.jsx("p",{className:"text-sm text-green-600 mt-1",children:" New icon ready for upload"})]}),b&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:b}),s.jsxs("div",{className:"space-y-3 pt-4",children:[s.jsxs("button",{type:"button",onClick:()=>N(!0),className:"btn-secondary btn-with-icon",children:[s.jsx(Us,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit Timeslots"})]}),s.jsxs("button",{type:"button",onClick:()=>C(!0),className:"btn-secondary btn-with-icon",children:[s.jsx(Wi,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit Admins"})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{type:"button",onClick:A,className:"btn-ghost btn-flex",children:"Discard Changes"}),s.jsx("button",{type:"submit",disabled:p||S,className:"btn-primary btn-flex",children:S?"Processing...":p?"Saving...":"Save Changes"})]})]})]})]})}),h&&s.jsx(qn,{isOpen:c,onClose:()=>{u(!1),d(null),l(null)},onCrop:I,imageFile:h}),s.jsx(Ej,{isOpen:k,onClose:()=>N(!1),location:r}),s.jsx(Pj,{isOpen:w,onClose:()=>C(!1),location:r,onAdminsUpdated:L})]})}function Ij({onBack:e,isLocationAdmin:t=!1}){const[n,r]=j.useState([]),[i,a]=j.useState(!0),[o,l]=j.useState(null),{user:c}=Ge(),[u,h]=j.useState({isOpen:!1,location:null});j.useEffect(()=>{d()},[]);const d=async()=>{try{let p=Y.from("locations").select("*").order("name");t&&!(c!=null&&c.is_admin)&&(c!=null&&c.id)&&(p=p.contains("admins",[c.id]));const{data:y,error:S}=await p;if(S)throw S;r(y||[])}catch(p){l(p instanceof Error?p.message:"Failed to fetch locations")}finally{a(!1)}},f=p=>{h({isOpen:!0,location:p})},m=()=>{d(),h({isOpen:!1,location:null})};return i?s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text",children:"Loading locations..."})]})}):s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(Tt,{className:"w-5 h-5"}),s.jsx("span",{children:"Back to Admin"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title",children:"MANAGE LOCATIONS"})]}),o&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:o})}),s.jsx("div",{className:"space-y-4",children:n.map(p=>s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6 flex items-center justify-between gap-6",children:[s.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[p.icon?s.jsx("img",{src:p.icon,alt:`${p.name} icon`,className:"w-12 h-12 object-contain rounded",onError:y=>{const S=y.target;S.style.display="none";const g=S.nextElementSibling;g&&g.classList.contains("icon-fallback")&&(g.style.display="flex")}}):null,s.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center icon-fallback",style:{display:p.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-sm font-bold",children:p.name.charAt(0)})}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-text truncate",children:p.name}),s.jsx("p",{className:"text-sm text-secondary-text truncate",children:p.address}),s.jsxs("p",{className:"text-xs text-secondary-text",children:[p.tables," table",p.tables!==1?"s":""]})]})]}),s.jsxs("button",{onClick:()=>f(p),className:"btn-secondary-sm btn-with-icon-sm",children:[s.jsx(Vs,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]})]},p.id))}),n.length===0&&!i&&s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-base text-secondary-text",children:"No locations found."})}),s.jsx(Tj,{isOpen:u.isOpen,onClose:()=>h({isOpen:!1,location:null}),onLocationUpdated:m,location:u.location})]})}function Hx(){const[e,t]=j.useState([]),[n,r]=j.useState(!0),[i,a]=j.useState(null),{user:o}=Ge();j.useEffect(()=>{if(!o){t([]),r(!1);return}l()},[o]);const l=async()=>{try{const{data:c,error:u}=await Y.from("models").select(`
          id,
          name,
          status,
          count,
          image_url,
          game_id,
          notes,
          painted_date,
          purchase_date,
          created_at,
          lore_name,
          lore_description,
          painting_notes,
          public,
          box:boxes(
            id,
            name,
            purchase_date,
            game:games(id, name, icon, image)
          ),
          game:games(id, name, icon, image)
        `).eq("user_id",o==null?void 0:o.id).order("created_at",{ascending:!1});if(u)throw u;const h=(c||[]).map(d=>({...d,box:d.box&&Array.isArray(d.box)?d.box[0]:d.box,game:d.game&&Array.isArray(d.game)?d.game[0]:d.game}));t(h)}catch(c){a(c instanceof Error?c.message:"Failed to fetch models")}finally{r(!1)}};return{models:e,loading:n,error:i,refetch:l}}function Wx(){const[e,t]=j.useState([]),[n,r]=j.useState(!0),[i,a]=j.useState(null),{user:o}=Ge();j.useEffect(()=>{if(!o){t([]),r(!1);return}l()},[o]);const l=async()=>{try{if(!(o!=null&&o.id)){t([]);return}const{data:c,error:u}=await Y.from("boxes").select(`
          id,
          name,
          purchase_date,
          image_url,
          public,
          game:games(id, name, icon, image)
        `).eq("user_id",o.id).order("created_at",{ascending:!1}).limit(10);if(u)throw u;const h=(c||[]).map(f=>({...f,game:f.game&&Array.isArray(f.game)?f.game[0]:f.game})),d=await Promise.all(h.map(async f=>{const{data:m,error:p}=await Y.from("models").select("count").eq("box_id",f.id);if(p)return console.error(`Error fetching models for box ${f.id}:`,p),{...f,models_count:0};const y=(m||[]).reduce((S,g)=>S+(g.count||0),0);return{...f,models_count:y}}));t(d)}catch(c){a(c instanceof Error?c.message:"Failed to fetch boxes")}finally{r(!1)}};return{boxes:e,loading:n,error:i,refetch:l}}function Mj(e,t){const n={};return(e[e.length-1]===""?[...e,""]:e).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const Aj=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Lj=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Dj={};function Gm(e,t){return(Dj.jsx?Lj:Aj).test(e)}const Oj=/[ \t\n\f\r]/g;function Rj(e){return typeof e=="object"?e.type==="text"?Hm(e.value):!1:Hm(e)}function Hm(e){return e.replace(Oj,"")===""}class la{constructor(t,n,r){this.normal=n,this.property=t,r&&(this.space=r)}}la.prototype.normal={};la.prototype.property={};la.prototype.space=void 0;function Yx(e,t){const n={},r={};for(const i of e)Object.assign(n,i.property),Object.assign(r,i.normal);return new la(n,r,t)}function pu(e){return e.toLowerCase()}class zt{constructor(t,n){this.attribute=n,this.property=t}}zt.prototype.attribute="";zt.prototype.booleanish=!1;zt.prototype.boolean=!1;zt.prototype.commaOrSpaceSeparated=!1;zt.prototype.commaSeparated=!1;zt.prototype.defined=!1;zt.prototype.mustUseProperty=!1;zt.prototype.number=!1;zt.prototype.overloadedBoolean=!1;zt.prototype.property="";zt.prototype.spaceSeparated=!1;zt.prototype.space=void 0;let Fj=0;const _e=Kr(),tt=Kr(),gu=Kr(),ee=Kr(),ze=Kr(),Ss=Kr(),Bt=Kr();function Kr(){return 2**++Fj}const xu=Object.freeze(Object.defineProperty({__proto__:null,boolean:_e,booleanish:tt,commaOrSpaceSeparated:Bt,commaSeparated:Ss,number:ee,overloadedBoolean:gu,spaceSeparated:ze},Symbol.toStringTag,{value:"Module"})),Gl=Object.keys(xu);class Ld extends zt{constructor(t,n,r,i){let a=-1;if(super(t,n),Wm(this,"space",i),typeof r=="number")for(;++a<Gl.length;){const o=Gl[a];Wm(this,Gl[a],(r&xu[o])===xu[o])}}}Ld.prototype.defined=!0;function Wm(e,t,n){n&&(e[t]=n)}function Ws(e){const t={},n={};for(const[r,i]of Object.entries(e.properties)){const a=new Ld(r,e.transform(e.attributes||{},r),i,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(a.mustUseProperty=!0),t[r]=a,n[pu(r)]=r,n[pu(a.attribute)]=r}return new la(t,n,e.space)}const Kx=Ws({properties:{ariaActiveDescendant:null,ariaAtomic:tt,ariaAutoComplete:null,ariaBusy:tt,ariaChecked:tt,ariaColCount:ee,ariaColIndex:ee,ariaColSpan:ee,ariaControls:ze,ariaCurrent:null,ariaDescribedBy:ze,ariaDetails:null,ariaDisabled:tt,ariaDropEffect:ze,ariaErrorMessage:null,ariaExpanded:tt,ariaFlowTo:ze,ariaGrabbed:tt,ariaHasPopup:null,ariaHidden:tt,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ze,ariaLevel:ee,ariaLive:null,ariaModal:tt,ariaMultiLine:tt,ariaMultiSelectable:tt,ariaOrientation:null,ariaOwns:ze,ariaPlaceholder:null,ariaPosInSet:ee,ariaPressed:tt,ariaReadOnly:tt,ariaRelevant:null,ariaRequired:tt,ariaRoleDescription:ze,ariaRowCount:ee,ariaRowIndex:ee,ariaRowSpan:ee,ariaSelected:tt,ariaSetSize:ee,ariaSort:null,ariaValueMax:ee,ariaValueMin:ee,ariaValueNow:ee,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function Jx(e,t){return t in e?e[t]:t}function Qx(e,t){return Jx(e,t.toLowerCase())}const $j=Ws({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Ss,acceptCharset:ze,accessKey:ze,action:null,allow:null,allowFullScreen:_e,allowPaymentRequest:_e,allowUserMedia:_e,alt:null,as:null,async:_e,autoCapitalize:null,autoComplete:ze,autoFocus:_e,autoPlay:_e,blocking:ze,capture:null,charSet:null,checked:_e,cite:null,className:ze,cols:ee,colSpan:null,content:null,contentEditable:tt,controls:_e,controlsList:ze,coords:ee|Ss,crossOrigin:null,data:null,dateTime:null,decoding:null,default:_e,defer:_e,dir:null,dirName:null,disabled:_e,download:gu,draggable:tt,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:_e,formTarget:null,headers:ze,height:ee,hidden:gu,high:ee,href:null,hrefLang:null,htmlFor:ze,httpEquiv:ze,id:null,imageSizes:null,imageSrcSet:null,inert:_e,inputMode:null,integrity:null,is:null,isMap:_e,itemId:null,itemProp:ze,itemRef:ze,itemScope:_e,itemType:ze,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:_e,low:ee,manifest:null,max:null,maxLength:ee,media:null,method:null,min:null,minLength:ee,multiple:_e,muted:_e,name:null,nonce:null,noModule:_e,noValidate:_e,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:_e,optimum:ee,pattern:null,ping:ze,placeholder:null,playsInline:_e,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:_e,referrerPolicy:null,rel:ze,required:_e,reversed:_e,rows:ee,rowSpan:ee,sandbox:ze,scope:null,scoped:_e,seamless:_e,selected:_e,shadowRootClonable:_e,shadowRootDelegatesFocus:_e,shadowRootMode:null,shape:null,size:ee,sizes:null,slot:null,span:ee,spellCheck:tt,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ee,step:null,style:null,tabIndex:ee,target:null,title:null,translate:null,type:null,typeMustMatch:_e,useMap:null,value:tt,width:ee,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ze,axis:null,background:null,bgColor:null,border:ee,borderColor:null,bottomMargin:ee,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:_e,declare:_e,event:null,face:null,frame:null,frameBorder:null,hSpace:ee,leftMargin:ee,link:null,longDesc:null,lowSrc:null,marginHeight:ee,marginWidth:ee,noResize:_e,noHref:_e,noShade:_e,noWrap:_e,object:null,profile:null,prompt:null,rev:null,rightMargin:ee,rules:null,scheme:null,scrolling:tt,standby:null,summary:null,text:null,topMargin:ee,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ee,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:_e,disableRemotePlayback:_e,prefix:null,property:null,results:ee,security:null,unselectable:null},space:"html",transform:Qx}),zj=Ws({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Bt,accentHeight:ee,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ee,amplitude:ee,arabicForm:null,ascent:ee,attributeName:null,attributeType:null,azimuth:ee,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ee,by:null,calcMode:null,capHeight:ee,className:ze,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ee,diffuseConstant:ee,direction:null,display:null,dur:null,divisor:ee,dominantBaseline:null,download:_e,dx:null,dy:null,edgeMode:null,editable:null,elevation:ee,enableBackground:null,end:null,event:null,exponent:ee,externalResourcesRequired:null,fill:null,fillOpacity:ee,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Ss,g2:Ss,glyphName:Ss,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ee,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ee,horizOriginX:ee,horizOriginY:ee,id:null,ideographic:ee,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ee,k:ee,k1:ee,k2:ee,k3:ee,k4:ee,kernelMatrix:Bt,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ee,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ee,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ee,overlineThickness:ee,paintOrder:null,panose1:null,path:null,pathLength:ee,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ze,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ee,pointsAtY:ee,pointsAtZ:ee,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Bt,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Bt,rev:Bt,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Bt,requiredFeatures:Bt,requiredFonts:Bt,requiredFormats:Bt,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ee,specularExponent:ee,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ee,strikethroughThickness:ee,string:null,stroke:null,strokeDashArray:Bt,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ee,strokeOpacity:ee,strokeWidth:null,style:null,surfaceScale:ee,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Bt,tabIndex:ee,tableValues:null,target:null,targetX:ee,targetY:ee,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Bt,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ee,underlineThickness:ee,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ee,values:null,vAlphabetic:ee,vMathematical:ee,vectorEffect:null,vHanging:ee,vIdeographic:ee,version:null,vertAdvY:ee,vertOriginX:ee,vertOriginY:ee,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ee,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:Jx}),Xx=Ws({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),Zx=Ws({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:Qx}),ey=Ws({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),Bj={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},Uj=/[A-Z]/g,Ym=/-[a-z]/g,Vj=/^data[-\w.:]+$/i;function qj(e,t){const n=pu(t);let r=t,i=zt;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&Vj.test(t)){if(t.charAt(4)==="-"){const a=t.slice(5).replace(Ym,Hj);r="data"+a.charAt(0).toUpperCase()+a.slice(1)}else{const a=t.slice(4);if(!Ym.test(a)){let o=a.replace(Uj,Gj);o.charAt(0)!=="-"&&(o="-"+o),t="data"+o}}i=Ld}return new i(r,t)}function Gj(e){return"-"+e.toLowerCase()}function Hj(e){return e.charAt(1).toUpperCase()}const Wj=Yx([Kx,$j,Xx,Zx,ey],"html"),Dd=Yx([Kx,zj,Xx,Zx,ey],"svg");function Yj(e){return e.join(" ").trim()}var Od={},Km=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,Kj=/\n/g,Jj=/^\s*/,Qj=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,Xj=/^:\s*/,Zj=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,ek=/^[;\s]*/,tk=/^\s+|\s+$/g,nk=`
`,Jm="/",Qm="*",Ar="",rk="comment",sk="declaration",ik=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var n=1,r=1;function i(p){var y=p.match(Kj);y&&(n+=y.length);var S=p.lastIndexOf(nk);r=~S?p.length-S:r+p.length}function a(){var p={line:n,column:r};return function(y){return y.position=new o(p),u(),y}}function o(p){this.start=p,this.end={line:n,column:r},this.source=t.source}o.prototype.content=e;function l(p){var y=new Error(t.source+":"+n+":"+r+": "+p);if(y.reason=p,y.filename=t.source,y.line=n,y.column=r,y.source=e,!t.silent)throw y}function c(p){var y=p.exec(e);if(y){var S=y[0];return i(S),e=e.slice(S.length),y}}function u(){c(Jj)}function h(p){var y;for(p=p||[];y=d();)y!==!1&&p.push(y);return p}function d(){var p=a();if(!(Jm!=e.charAt(0)||Qm!=e.charAt(1))){for(var y=2;Ar!=e.charAt(y)&&(Qm!=e.charAt(y)||Jm!=e.charAt(y+1));)++y;if(y+=2,Ar===e.charAt(y-1))return l("End of comment missing");var S=e.slice(2,y-2);return r+=2,i(S),e=e.slice(y),r+=2,p({type:rk,comment:S})}}function f(){var p=a(),y=c(Qj);if(y){if(d(),!c(Xj))return l("property missing ':'");var S=c(Zj),g=p({type:sk,property:Xm(y[0].replace(Km,Ar)),value:S?Xm(S[0].replace(Km,Ar)):Ar});return c(ek),g}}function m(){var p=[];h(p);for(var y;y=f();)y!==!1&&(p.push(y),h(p));return p}return u(),m()};function Xm(e){return e?e.replace(tk,Ar):Ar}var ak=vt&&vt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Od,"__esModule",{value:!0});Od.default=lk;var ok=ak(ik);function lk(e,t){var n=null;if(!e||typeof e!="string")return n;var r=(0,ok.default)(e),i=typeof t=="function";return r.forEach(function(a){if(a.type==="declaration"){var o=a.property,l=a.value;i?t(o,l,a):l&&(n=n||{},n[o]=l)}}),n}var sl={};Object.defineProperty(sl,"__esModule",{value:!0});sl.camelCase=void 0;var ck=/^--[a-zA-Z0-9_-]+$/,uk=/-([a-z])/g,dk=/^[^-]+$/,hk=/^-(webkit|moz|ms|o|khtml)-/,mk=/^-(ms)-/,fk=function(e){return!e||dk.test(e)||ck.test(e)},pk=function(e,t){return t.toUpperCase()},Zm=function(e,t){return"".concat(t,"-")},gk=function(e,t){return t===void 0&&(t={}),fk(e)?e:(e=e.toLowerCase(),t.reactCompat?e=e.replace(mk,Zm):e=e.replace(hk,Zm),e.replace(uk,pk))};sl.camelCase=gk;var xk=vt&&vt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},yk=xk(Od),bk=sl;function yu(e,t){var n={};return!e||typeof e!="string"||(0,yk.default)(e,function(r,i){r&&i&&(n[(0,bk.camelCase)(r,t)]=i)}),n}yu.default=yu;var vk=yu;const wk=Pu(vk),ty=ny("end"),Rd=ny("start");function ny(e){return t;function t(n){const r=n&&n.position&&n.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function jk(e){const t=Rd(e),n=ty(e);if(t&&n)return{start:t,end:n}}function _i(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?ef(e.position):"start"in e||"end"in e?ef(e):"line"in e||"column"in e?bu(e):""}function bu(e){return tf(e&&e.line)+":"+tf(e&&e.column)}function ef(e){return bu(e&&e.start)+"-"+bu(e&&e.end)}function tf(e){return e&&typeof e=="number"?e:1}class kt extends Error{constructor(t,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let i="",a={},o=!1;if(n&&("line"in n&&"column"in n?a={place:n}:"start"in n&&"end"in n?a={place:n}:"type"in n?a={ancestors:[n],place:n.position}:a={...n}),typeof t=="string"?i=t:!a.cause&&t&&(o=!0,i=t.message,a.cause=t),!a.ruleId&&!a.source&&typeof r=="string"){const c=r.indexOf(":");c===-1?a.ruleId=r:(a.source=r.slice(0,c),a.ruleId=r.slice(c+1))}if(!a.place&&a.ancestors&&a.ancestors){const c=a.ancestors[a.ancestors.length-1];c&&(a.place=c.position)}const l=a.place&&"start"in a.place?a.place.start:a.place;this.ancestors=a.ancestors||void 0,this.cause=a.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file="",this.message=i,this.line=l?l.line:void 0,this.name=_i(a.place)||"1:1",this.place=a.place||void 0,this.reason=this.message,this.ruleId=a.ruleId||void 0,this.source=a.source||void 0,this.stack=o&&a.cause&&typeof a.cause.stack=="string"?a.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}kt.prototype.file="";kt.prototype.name="";kt.prototype.reason="";kt.prototype.message="";kt.prototype.stack="";kt.prototype.column=void 0;kt.prototype.line=void 0;kt.prototype.ancestors=void 0;kt.prototype.cause=void 0;kt.prototype.fatal=void 0;kt.prototype.place=void 0;kt.prototype.ruleId=void 0;kt.prototype.source=void 0;const Fd={}.hasOwnProperty,kk=new Map,Nk=/[A-Z]/g,Sk=new Set(["table","tbody","thead","tfoot","tr"]),_k=new Set(["td","th"]),ry="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function Ck(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let r;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=Dk(n,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=Lk(n,t.jsx,t.jsxs)}const i={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:r,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?Dd:Wj,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},a=sy(i,e,void 0);return a&&typeof a!="string"?a:i.create(e,i.Fragment,{children:a||void 0},void 0)}function sy(e,t,n){if(t.type==="element")return Ek(e,t,n);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return Pk(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return Ik(e,t,n);if(t.type==="mdxjsEsm")return Tk(e,t);if(t.type==="root")return Mk(e,t,n);if(t.type==="text")return Ak(e,t)}function Ek(e,t,n){const r=e.schema;let i=r;t.tagName.toLowerCase()==="svg"&&r.space==="html"&&(i=Dd,e.schema=i),e.ancestors.push(t);const a=ay(e,t.tagName,!1),o=Ok(e,t);let l=zd(e,t);return Sk.has(t.tagName)&&(l=l.filter(function(c){return typeof c=="string"?!Rj(c):!0})),iy(e,o,a,t),$d(o,l),e.ancestors.pop(),e.schema=r,e.create(t,a,o,n)}function Pk(e,t){if(t.data&&t.data.estree&&e.evaluater){const r=t.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}Ji(e,t.position)}function Tk(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);Ji(e,t.position)}function Ik(e,t,n){const r=e.schema;let i=r;t.name==="svg"&&r.space==="html"&&(i=Dd,e.schema=i),e.ancestors.push(t);const a=t.name===null?e.Fragment:ay(e,t.name,!0),o=Rk(e,t),l=zd(e,t);return iy(e,o,a,t),$d(o,l),e.ancestors.pop(),e.schema=r,e.create(t,a,o,n)}function Mk(e,t,n){const r={};return $d(r,zd(e,t)),e.create(t,e.Fragment,r,n)}function Ak(e,t){return t.value}function iy(e,t,n,r){typeof n!="string"&&n!==e.Fragment&&e.passNode&&(t.node=r)}function $d(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function Lk(e,t,n){return r;function r(i,a,o,l){const u=Array.isArray(o.children)?n:t;return l?u(a,o,l):u(a,o)}}function Dk(e,t){return n;function n(r,i,a,o){const l=Array.isArray(a.children),c=Rd(r);return t(i,a,o,l,{columnNumber:c?c.column-1:void 0,fileName:e,lineNumber:c?c.line:void 0},void 0)}}function Ok(e,t){const n={};let r,i;for(i in t.properties)if(i!=="children"&&Fd.call(t.properties,i)){const a=Fk(e,i,t.properties[i]);if(a){const[o,l]=a;e.tableCellAlignToStyle&&o==="align"&&typeof l=="string"&&_k.has(t.tagName)?r=l:n[o]=l}}if(r){const a=n.style||(n.style={});a[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function Rk(e,t){const n={};for(const r of t.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const a=r.data.estree.body[0];a.type;const o=a.expression;o.type;const l=o.properties[0];l.type,Object.assign(n,e.evaluater.evaluateExpression(l.argument))}else Ji(e,t.position);else{const i=r.name;let a;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const l=r.value.data.estree.body[0];l.type,a=e.evaluater.evaluateExpression(l.expression)}else Ji(e,t.position);else a=r.value===null?!0:r.value;n[i]=a}return n}function zd(e,t){const n=[];let r=-1;const i=e.passKeys?new Map:kk;for(;++r<t.children.length;){const a=t.children[r];let o;if(e.passKeys){const c=a.type==="element"?a.tagName:a.type==="mdxJsxFlowElement"||a.type==="mdxJsxTextElement"?a.name:void 0;if(c){const u=i.get(c)||0;o=c+"-"+u,i.set(c,u+1)}}const l=sy(e,a,o);l!==void 0&&n.push(l)}return n}function Fk(e,t,n){const r=qj(e.schema,t);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?Mj(n):Yj(n)),r.property==="style"){let i=typeof n=="object"?n:$k(e,String(n));return e.stylePropertyNameCase==="css"&&(i=zk(i)),["style",i]}return[e.elementAttributeNameCase==="react"&&r.space?Bj[r.property]||r.property:r.attribute,n]}}function $k(e,t){try{return wk(t,{reactCompat:!0})}catch(n){if(e.ignoreInvalidStyle)return{};const r=n,i=new kt("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw i.file=e.filePath||void 0,i.url=ry+"#cannot-parse-style-attribute",i}}function ay(e,t,n){let r;if(!n)r={type:"Literal",value:t};else if(t.includes(".")){const i=t.split(".");let a=-1,o;for(;++a<i.length;){const l=Gm(i[a])?{type:"Identifier",name:i[a]}:{type:"Literal",value:i[a]};o=o?{type:"MemberExpression",object:o,property:l,computed:!!(a&&l.type==="Literal"),optional:!1}:l}r=o}else r=Gm(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(r.type==="Literal"){const i=r.value;return Fd.call(e.components,i)?e.components[i]:i}if(e.evaluater)return e.evaluater.evaluateExpression(r);Ji(e)}function Ji(e,t){const n=new kt("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=ry+"#cannot-handle-mdx-estrees-without-createevaluater",n}function zk(e){const t={};let n;for(n in e)Fd.call(e,n)&&(t[Bk(n)]=e[n]);return t}function Bk(e){let t=e.replace(Nk,Uk);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function Uk(e){return"-"+e.toLowerCase()}const Hl={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},Vk={};function Bd(e,t){const n=Vk,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,i=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return oy(e,r,i)}function oy(e,t,n){if(qk(e)){if("value"in e)return e.type==="html"&&!n?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return nf(e.children,t,n)}return Array.isArray(e)?nf(e,t,n):""}function nf(e,t,n){const r=[];let i=-1;for(;++i<e.length;)r[i]=oy(e[i],t,n);return r.join("")}function qk(e){return!!(e&&typeof e=="object")}const rf=document.createElement("i");function Ud(e){const t="&"+e+";";rf.innerHTML=t;const n=rf.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function Ht(e,t,n,r){const i=e.length;let a=0,o;if(t<0?t=-t>i?0:i+t:t=t>i?i:t,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(t,n),e.splice(...o);else for(n&&e.splice(t,n);a<r.length;)o=r.slice(a,a+1e4),o.unshift(t,0),e.splice(...o),a+=1e4,t+=1e4}function Zt(e,t){return e.length>0?(Ht(e,e.length,0,t),e):t}const sf={}.hasOwnProperty;function ly(e){const t={};let n=-1;for(;++n<e.length;)Gk(t,e[n]);return t}function Gk(e,t){let n;for(n in t){const i=(sf.call(e,n)?e[n]:void 0)||(e[n]={}),a=t[n];let o;if(a)for(o in a){sf.call(i,o)||(i[o]=[]);const l=a[o];Hk(i[o],Array.isArray(l)?l:l?[l]:[])}}}function Hk(e,t){let n=-1;const r=[];for(;++n<t.length;)(t[n].add==="after"?e:r).push(t[n]);Ht(e,0,0,r)}function cy(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"":String.fromCodePoint(n)}function gn(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const _t=kr(/[A-Za-z]/),bt=kr(/[\dA-Za-z]/),Wk=kr(/[#-'*+\--9=?A-Z^-~]/);function Co(e){return e!==null&&(e<32||e===127)}const vu=kr(/\d/),Yk=kr(/[\dA-Fa-f]/),Kk=kr(/[!-/:-@[-`{-~]/);function pe(e){return e!==null&&e<-2}function Re(e){return e!==null&&(e<0||e===32)}function Pe(e){return e===-2||e===-1||e===32}const il=kr(new RegExp("\\p{P}|\\p{S}","u")),qr=kr(/\s/);function kr(e){return t;function t(n){return n!==null&&n>-1&&e.test(String.fromCharCode(n))}}function Ys(e){const t=[];let n=-1,r=0,i=0;for(;++n<e.length;){const a=e.charCodeAt(n);let o="";if(a===37&&bt(e.charCodeAt(n+1))&&bt(e.charCodeAt(n+2)))i=2;else if(a<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(a))||(o=String.fromCharCode(a));else if(a>55295&&a<57344){const l=e.charCodeAt(n+1);a<56320&&l>56319&&l<57344?(o=String.fromCharCode(a,l),i=1):o=""}else o=String.fromCharCode(a);o&&(t.push(e.slice(r,n),encodeURIComponent(o)),r=n+i+1,o=""),i&&(n+=i,i=0)}return t.join("")+e.slice(r)}function Me(e,t,n,r){const i=r?r-1:Number.POSITIVE_INFINITY;let a=0;return o;function o(c){return Pe(c)?(e.enter(n),l(c)):t(c)}function l(c){return Pe(c)&&a++<i?(e.consume(c),l):(e.exit(n),t(c))}}const Jk={tokenize:Qk};function Qk(e){const t=e.attempt(this.parser.constructs.contentInitial,r,i);let n;return t;function r(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),Me(e,t,"linePrefix")}function i(l){return e.enter("paragraph"),a(l)}function a(l){const c=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=c),n=c,o(l)}function o(l){if(l===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(l);return}return pe(l)?(e.consume(l),e.exit("chunkText"),a):(e.consume(l),o)}}const Xk={tokenize:Zk},af={tokenize:eN};function Zk(e){const t=this,n=[];let r=0,i,a,o;return l;function l(x){if(r<n.length){const k=n[r];return t.containerState=k[1],e.attempt(k[0].continuation,c,u)(x)}return u(x)}function c(x){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,i&&b();const k=t.events.length;let N=k,w;for(;N--;)if(t.events[N][0]==="exit"&&t.events[N][1].type==="chunkFlow"){w=t.events[N][1].end;break}g(r);let C=k;for(;C<t.events.length;)t.events[C][1].end={...w},C++;return Ht(t.events,N+1,0,t.events.slice(k)),t.events.length=C,u(x)}return l(x)}function u(x){if(r===n.length){if(!i)return f(x);if(i.currentConstruct&&i.currentConstruct.concrete)return p(x);t.interrupt=!!(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(af,h,d)(x)}function h(x){return i&&b(),g(r),f(x)}function d(x){return t.parser.lazy[t.now().line]=r!==n.length,o=t.now().offset,p(x)}function f(x){return t.containerState={},e.attempt(af,m,p)(x)}function m(x){return r++,n.push([t.currentConstruct,t.containerState]),f(x)}function p(x){if(x===null){i&&b(),g(0),e.consume(x);return}return i=i||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:i,contentType:"flow",previous:a}),y(x)}function y(x){if(x===null){S(e.exit("chunkFlow"),!0),g(0),e.consume(x);return}return pe(x)?(e.consume(x),S(e.exit("chunkFlow")),r=0,t.interrupt=void 0,l):(e.consume(x),y)}function S(x,k){const N=t.sliceStream(x);if(k&&N.push(null),x.previous=a,a&&(a.next=x),a=x,i.defineSkip(x.start),i.write(N),t.parser.lazy[x.start.line]){let w=i.events.length;for(;w--;)if(i.events[w][1].start.offset<o&&(!i.events[w][1].end||i.events[w][1].end.offset>o))return;const C=t.events.length;let T=C,I,v;for(;T--;)if(t.events[T][0]==="exit"&&t.events[T][1].type==="chunkFlow"){if(I){v=t.events[T][1].end;break}I=!0}for(g(r),w=C;w<t.events.length;)t.events[w][1].end={...v},w++;Ht(t.events,T+1,0,t.events.slice(C)),t.events.length=w}}function g(x){let k=n.length;for(;k-- >x;){const N=n[k];t.containerState=N[1],N[0].exit.call(t,e)}n.length=x}function b(){i.write([null]),a=void 0,i=void 0,t.containerState._closeFlow=void 0}}function eN(e,t,n){return Me(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Os(e){if(e===null||Re(e)||qr(e))return 1;if(il(e))return 2}function al(e,t,n){const r=[];let i=-1;for(;++i<e.length;){const a=e[i].resolveAll;a&&!r.includes(a)&&(t=a(t,n),r.push(a))}return t}const wu={name:"attention",resolveAll:tN,tokenize:nN};function tN(e,t){let n=-1,r,i,a,o,l,c,u,h;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(r=n;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[r][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;c=e[r][1].end.offset-e[r][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const d={...e[r][1].end},f={...e[n][1].start};of(d,-c),of(f,c),o={type:c>1?"strongSequence":"emphasisSequence",start:d,end:{...e[r][1].end}},l={type:c>1?"strongSequence":"emphasisSequence",start:{...e[n][1].start},end:f},a={type:c>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[n][1].start}},i={type:c>1?"strong":"emphasis",start:{...o.start},end:{...l.end}},e[r][1].end={...o.start},e[n][1].start={...l.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=Zt(u,[["enter",e[r][1],t],["exit",e[r][1],t]])),u=Zt(u,[["enter",i,t],["enter",o,t],["exit",o,t],["enter",a,t]]),u=Zt(u,al(t.parser.constructs.insideSpan.null,e.slice(r+1,n),t)),u=Zt(u,[["exit",a,t],["enter",l,t],["exit",l,t],["exit",i,t]]),e[n][1].end.offset-e[n][1].start.offset?(h=2,u=Zt(u,[["enter",e[n][1],t],["exit",e[n][1],t]])):h=0,Ht(e,r-1,n-r+3,u),n=r+u.length-h-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function nN(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,i=Os(r);let a;return o;function o(c){return a=c,e.enter("attentionSequence"),l(c)}function l(c){if(c===a)return e.consume(c),l;const u=e.exit("attentionSequence"),h=Os(c),d=!h||h===2&&i||n.includes(c),f=!i||i===2&&h||n.includes(r);return u._open=!!(a===42?d:d&&(i||!f)),u._close=!!(a===42?f:f&&(h||!d)),t(c)}}function of(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const rN={name:"autolink",tokenize:sN};function sN(e,t,n){let r=0;return i;function i(m){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(m),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),a}function a(m){return _t(m)?(e.consume(m),o):m===64?n(m):u(m)}function o(m){return m===43||m===45||m===46||bt(m)?(r=1,l(m)):u(m)}function l(m){return m===58?(e.consume(m),r=0,c):(m===43||m===45||m===46||bt(m))&&r++<32?(e.consume(m),l):(r=0,u(m))}function c(m){return m===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(m),e.exit("autolinkMarker"),e.exit("autolink"),t):m===null||m===32||m===60||Co(m)?n(m):(e.consume(m),c)}function u(m){return m===64?(e.consume(m),h):Wk(m)?(e.consume(m),u):n(m)}function h(m){return bt(m)?d(m):n(m)}function d(m){return m===46?(e.consume(m),r=0,h):m===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(m),e.exit("autolinkMarker"),e.exit("autolink"),t):f(m)}function f(m){if((m===45||bt(m))&&r++<63){const p=m===45?f:d;return e.consume(m),p}return n(m)}}const ca={partial:!0,tokenize:iN};function iN(e,t,n){return r;function r(a){return Pe(a)?Me(e,i,"linePrefix")(a):i(a)}function i(a){return a===null||pe(a)?t(a):n(a)}}const uy={continuation:{tokenize:oN},exit:lN,name:"blockQuote",tokenize:aN};function aN(e,t,n){const r=this;return i;function i(o){if(o===62){const l=r.containerState;return l.open||(e.enter("blockQuote",{_container:!0}),l.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),a}return n(o)}function a(o){return Pe(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(o))}}function oN(e,t,n){const r=this;return i;function i(o){return Pe(o)?Me(e,a,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):a(o)}function a(o){return e.attempt(uy,t,n)(o)}}function lN(e){e.exit("blockQuote")}const dy={name:"characterEscape",tokenize:cN};function cN(e,t,n){return r;function r(a){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(a),e.exit("escapeMarker"),i}function i(a){return Kk(a)?(e.enter("characterEscapeValue"),e.consume(a),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(a)}}const hy={name:"characterReference",tokenize:uN};function uN(e,t,n){const r=this;let i=0,a,o;return l;function l(d){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(d),e.exit("characterReferenceMarker"),c}function c(d){return d===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(d),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),a=31,o=bt,h(d))}function u(d){return d===88||d===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(d),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),a=6,o=Yk,h):(e.enter("characterReferenceValue"),a=7,o=vu,h(d))}function h(d){if(d===59&&i){const f=e.exit("characterReferenceValue");return o===bt&&!Ud(r.sliceSerialize(f))?n(d):(e.enter("characterReferenceMarker"),e.consume(d),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return o(d)&&i++<a?(e.consume(d),h):n(d)}}const lf={partial:!0,tokenize:hN},cf={concrete:!0,name:"codeFenced",tokenize:dN};function dN(e,t,n){const r=this,i={partial:!0,tokenize:N};let a=0,o=0,l;return c;function c(w){return u(w)}function u(w){const C=r.events[r.events.length-1];return a=C&&C[1].type==="linePrefix"?C[2].sliceSerialize(C[1],!0).length:0,l=w,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(w)}function h(w){return w===l?(o++,e.consume(w),h):o<3?n(w):(e.exit("codeFencedFenceSequence"),Pe(w)?Me(e,d,"whitespace")(w):d(w))}function d(w){return w===null||pe(w)?(e.exit("codeFencedFence"),r.interrupt?t(w):e.check(lf,y,k)(w)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),f(w))}function f(w){return w===null||pe(w)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),d(w)):Pe(w)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Me(e,m,"whitespace")(w)):w===96&&w===l?n(w):(e.consume(w),f)}function m(w){return w===null||pe(w)?d(w):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),p(w))}function p(w){return w===null||pe(w)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),d(w)):w===96&&w===l?n(w):(e.consume(w),p)}function y(w){return e.attempt(i,k,S)(w)}function S(w){return e.enter("lineEnding"),e.consume(w),e.exit("lineEnding"),g}function g(w){return a>0&&Pe(w)?Me(e,b,"linePrefix",a+1)(w):b(w)}function b(w){return w===null||pe(w)?e.check(lf,y,k)(w):(e.enter("codeFlowValue"),x(w))}function x(w){return w===null||pe(w)?(e.exit("codeFlowValue"),b(w)):(e.consume(w),x)}function k(w){return e.exit("codeFenced"),t(w)}function N(w,C,T){let I=0;return v;function v(M){return w.enter("lineEnding"),w.consume(M),w.exit("lineEnding"),P}function P(M){return w.enter("codeFencedFence"),Pe(M)?Me(w,A,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(M):A(M)}function A(M){return M===l?(w.enter("codeFencedFenceSequence"),L(M)):T(M)}function L(M){return M===l?(I++,w.consume(M),L):I>=o?(w.exit("codeFencedFenceSequence"),Pe(M)?Me(w,O,"whitespace")(M):O(M)):T(M)}function O(M){return M===null||pe(M)?(w.exit("codeFencedFence"),C(M)):T(M)}}}function hN(e,t,n){const r=this;return i;function i(o){return o===null?n(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a)}function a(o){return r.parser.lazy[r.now().line]?n(o):t(o)}}const Wl={name:"codeIndented",tokenize:fN},mN={partial:!0,tokenize:pN};function fN(e,t,n){const r=this;return i;function i(u){return e.enter("codeIndented"),Me(e,a,"linePrefix",5)(u)}function a(u){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?o(u):n(u)}function o(u){return u===null?c(u):pe(u)?e.attempt(mN,o,c)(u):(e.enter("codeFlowValue"),l(u))}function l(u){return u===null||pe(u)?(e.exit("codeFlowValue"),o(u)):(e.consume(u),l)}function c(u){return e.exit("codeIndented"),t(u)}}function pN(e,t,n){const r=this;return i;function i(o){return r.parser.lazy[r.now().line]?n(o):pe(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),i):Me(e,a,"linePrefix",5)(o)}function a(o){const l=r.events[r.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(o):pe(o)?i(o):n(o)}}const gN={name:"codeText",previous:yN,resolve:xN,tokenize:bN};function xN(e){let t=e.length-4,n=3,r,i;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)i===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(i=r):(r===t||e[r][1].type==="lineEnding")&&(e[i][1].type="codeTextData",r!==i+2&&(e[i][1].end=e[r-1][1].end,e.splice(i+2,r-i-2),t-=r-i-2,r=i+2),i=void 0);return e}function yN(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function bN(e,t,n){let r=0,i,a;return o;function o(d){return e.enter("codeText"),e.enter("codeTextSequence"),l(d)}function l(d){return d===96?(e.consume(d),r++,l):(e.exit("codeTextSequence"),c(d))}function c(d){return d===null?n(d):d===32?(e.enter("space"),e.consume(d),e.exit("space"),c):d===96?(a=e.enter("codeTextSequence"),i=0,h(d)):pe(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),c):(e.enter("codeTextData"),u(d))}function u(d){return d===null||d===32||d===96||pe(d)?(e.exit("codeTextData"),c(d)):(e.consume(d),u)}function h(d){return d===96?(e.consume(d),i++,h):i===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(d)):(a.type="codeTextData",u(d))}}class vN{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(t,r):t>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(t,n,r){const i=n||0;this.setCursor(Math.trunc(t));const a=this.right.splice(this.right.length-i,Number.POSITIVE_INFINITY);return r&&si(this.left,r),a.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),si(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),si(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const n=this.left.splice(t,Number.POSITIVE_INFINITY);si(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);si(this.left,n.reverse())}}}function si(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function my(e){const t={};let n=-1,r,i,a,o,l,c,u;const h=new vN(e);for(;++n<h.length;){for(;n in t;)n=t[n];if(r=h.get(n),n&&r[1].type==="chunkFlow"&&h.get(n-1)[1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,a=0,a<c.length&&c[a][1].type==="lineEndingBlank"&&(a+=2),a<c.length&&c[a][1].type==="content"))for(;++a<c.length&&c[a][1].type!=="content";)c[a][1].type==="chunkText"&&(c[a][1]._isInFirstContentOfListItem=!0,a++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,wN(h,n)),n=t[n],u=!0);else if(r[1]._container){for(a=n,i=void 0;a--;)if(o=h.get(a),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(i&&(h.get(i)[1].type="lineEndingBlank"),o[1].type="lineEnding",i=a);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;i&&(r[1].end={...h.get(i)[1].start},l=h.slice(i,n),l.unshift(r),h.splice(i,n-i+1,l))}}return Ht(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!u}function wN(e,t){const n=e.get(t)[1],r=e.get(t)[2];let i=t-1;const a=[];let o=n._tokenizer;o||(o=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const l=o.events,c=[],u={};let h,d,f=-1,m=n,p=0,y=0;const S=[y];for(;m;){for(;e.get(++i)[1]!==m;);a.push(i),m._tokenizer||(h=r.sliceStream(m),m.next||h.push(null),d&&o.defineSkip(m.start),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(h),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),d=m,m=m.next}for(m=n;++f<l.length;)l[f][0]==="exit"&&l[f-1][0]==="enter"&&l[f][1].type===l[f-1][1].type&&l[f][1].start.line!==l[f][1].end.line&&(y=f+1,S.push(y),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(o.events=[],m?(m._tokenizer=void 0,m.previous=void 0):S.pop(),f=S.length;f--;){const g=l.slice(S[f],S[f+1]),b=a.pop();c.push([b,b+g.length-1]),e.splice(b,2,g)}for(c.reverse(),f=-1;++f<c.length;)u[p+c[f][0]]=p+c[f][1],p+=c[f][1]-c[f][0]-1;return u}const jN={resolve:NN,tokenize:SN},kN={partial:!0,tokenize:_N};function NN(e){return my(e),e}function SN(e,t){let n;return r;function r(l){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),i(l)}function i(l){return l===null?a(l):pe(l)?e.check(kN,o,a)(l):(e.consume(l),i)}function a(l){return e.exit("chunkContent"),e.exit("content"),t(l)}function o(l){return e.consume(l),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,i}}function _N(e,t,n){const r=this;return i;function i(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),Me(e,a,"linePrefix")}function a(o){if(o===null||pe(o))return n(o);const l=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(o):e.interrupt(r.parser.constructs.flow,n,t)(o)}}function fy(e,t,n,r,i,a,o,l,c){const u=c||Number.POSITIVE_INFINITY;let h=0;return d;function d(g){return g===60?(e.enter(r),e.enter(i),e.enter(a),e.consume(g),e.exit(a),f):g===null||g===32||g===41||Co(g)?n(g):(e.enter(r),e.enter(o),e.enter(l),e.enter("chunkString",{contentType:"string"}),y(g))}function f(g){return g===62?(e.enter(a),e.consume(g),e.exit(a),e.exit(i),e.exit(r),t):(e.enter(l),e.enter("chunkString",{contentType:"string"}),m(g))}function m(g){return g===62?(e.exit("chunkString"),e.exit(l),f(g)):g===null||g===60||pe(g)?n(g):(e.consume(g),g===92?p:m)}function p(g){return g===60||g===62||g===92?(e.consume(g),m):m(g)}function y(g){return!h&&(g===null||g===41||Re(g))?(e.exit("chunkString"),e.exit(l),e.exit(o),e.exit(r),t(g)):h<u&&g===40?(e.consume(g),h++,y):g===41?(e.consume(g),h--,y):g===null||g===32||g===40||Co(g)?n(g):(e.consume(g),g===92?S:y)}function S(g){return g===40||g===41||g===92?(e.consume(g),y):y(g)}}function py(e,t,n,r,i,a){const o=this;let l=0,c;return u;function u(m){return e.enter(r),e.enter(i),e.consume(m),e.exit(i),e.enter(a),h}function h(m){return l>999||m===null||m===91||m===93&&!c||m===94&&!l&&"_hiddenFootnoteSupport"in o.parser.constructs?n(m):m===93?(e.exit(a),e.enter(i),e.consume(m),e.exit(i),e.exit(r),t):pe(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),d(m))}function d(m){return m===null||m===91||m===93||pe(m)||l++>999?(e.exit("chunkString"),h(m)):(e.consume(m),c||(c=!Pe(m)),m===92?f:d)}function f(m){return m===91||m===92||m===93?(e.consume(m),l++,d):d(m)}}function gy(e,t,n,r,i,a){let o;return l;function l(f){return f===34||f===39||f===40?(e.enter(r),e.enter(i),e.consume(f),e.exit(i),o=f===40?41:f,c):n(f)}function c(f){return f===o?(e.enter(i),e.consume(f),e.exit(i),e.exit(r),t):(e.enter(a),u(f))}function u(f){return f===o?(e.exit(a),c(o)):f===null?n(f):pe(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),Me(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(f))}function h(f){return f===o||f===null||pe(f)?(e.exit("chunkString"),u(f)):(e.consume(f),f===92?d:h)}function d(f){return f===o||f===92?(e.consume(f),h):h(f)}}function Ci(e,t){let n;return r;function r(i){return pe(i)?(e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),n=!0,r):Pe(i)?Me(e,r,n?"linePrefix":"lineSuffix")(i):t(i)}}const CN={name:"definition",tokenize:PN},EN={partial:!0,tokenize:TN};function PN(e,t,n){const r=this;let i;return a;function a(m){return e.enter("definition"),o(m)}function o(m){return py.call(r,e,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(m)}function l(m){return i=gn(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),m===58?(e.enter("definitionMarker"),e.consume(m),e.exit("definitionMarker"),c):n(m)}function c(m){return Re(m)?Ci(e,u)(m):u(m)}function u(m){return fy(e,h,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(m)}function h(m){return e.attempt(EN,d,d)(m)}function d(m){return Pe(m)?Me(e,f,"whitespace")(m):f(m)}function f(m){return m===null||pe(m)?(e.exit("definition"),r.parser.defined.push(i),t(m)):n(m)}}function TN(e,t,n){return r;function r(l){return Re(l)?Ci(e,i)(l):n(l)}function i(l){return gy(e,a,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function a(l){return Pe(l)?Me(e,o,"whitespace")(l):o(l)}function o(l){return l===null||pe(l)?t(l):n(l)}}const IN={name:"hardBreakEscape",tokenize:MN};function MN(e,t,n){return r;function r(a){return e.enter("hardBreakEscape"),e.consume(a),i}function i(a){return pe(a)?(e.exit("hardBreakEscape"),t(a)):n(a)}}const AN={name:"headingAtx",resolve:LN,tokenize:DN};function LN(e,t){let n=e.length-2,r=3,i,a;return e[r][1].type==="whitespace"&&(r+=2),n-2>r&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&e[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(i={type:"atxHeadingText",start:e[r][1].start,end:e[n][1].end},a={type:"chunkText",start:e[r][1].start,end:e[n][1].end,contentType:"text"},Ht(e,r,n-r+1,[["enter",i,t],["enter",a,t],["exit",a,t],["exit",i,t]])),e}function DN(e,t,n){let r=0;return i;function i(h){return e.enter("atxHeading"),a(h)}function a(h){return e.enter("atxHeadingSequence"),o(h)}function o(h){return h===35&&r++<6?(e.consume(h),o):h===null||Re(h)?(e.exit("atxHeadingSequence"),l(h)):n(h)}function l(h){return h===35?(e.enter("atxHeadingSequence"),c(h)):h===null||pe(h)?(e.exit("atxHeading"),t(h)):Pe(h)?Me(e,l,"whitespace")(h):(e.enter("atxHeadingText"),u(h))}function c(h){return h===35?(e.consume(h),c):(e.exit("atxHeadingSequence"),l(h))}function u(h){return h===null||h===35||Re(h)?(e.exit("atxHeadingText"),l(h)):(e.consume(h),u)}}const ON=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],uf=["pre","script","style","textarea"],RN={concrete:!0,name:"htmlFlow",resolveTo:zN,tokenize:BN},FN={partial:!0,tokenize:VN},$N={partial:!0,tokenize:UN};function zN(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function BN(e,t,n){const r=this;let i,a,o,l,c;return u;function u(E){return h(E)}function h(E){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(E),d}function d(E){return E===33?(e.consume(E),f):E===47?(e.consume(E),a=!0,y):E===63?(e.consume(E),i=3,r.interrupt?t:_):_t(E)?(e.consume(E),o=String.fromCharCode(E),S):n(E)}function f(E){return E===45?(e.consume(E),i=2,m):E===91?(e.consume(E),i=5,l=0,p):_t(E)?(e.consume(E),i=4,r.interrupt?t:_):n(E)}function m(E){return E===45?(e.consume(E),r.interrupt?t:_):n(E)}function p(E){const K="CDATA[";return E===K.charCodeAt(l++)?(e.consume(E),l===K.length?r.interrupt?t:A:p):n(E)}function y(E){return _t(E)?(e.consume(E),o=String.fromCharCode(E),S):n(E)}function S(E){if(E===null||E===47||E===62||Re(E)){const K=E===47,G=o.toLowerCase();return!K&&!a&&uf.includes(G)?(i=1,r.interrupt?t(E):A(E)):ON.includes(o.toLowerCase())?(i=6,K?(e.consume(E),g):r.interrupt?t(E):A(E)):(i=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(E):a?b(E):x(E))}return E===45||bt(E)?(e.consume(E),o+=String.fromCharCode(E),S):n(E)}function g(E){return E===62?(e.consume(E),r.interrupt?t:A):n(E)}function b(E){return Pe(E)?(e.consume(E),b):v(E)}function x(E){return E===47?(e.consume(E),v):E===58||E===95||_t(E)?(e.consume(E),k):Pe(E)?(e.consume(E),x):v(E)}function k(E){return E===45||E===46||E===58||E===95||bt(E)?(e.consume(E),k):N(E)}function N(E){return E===61?(e.consume(E),w):Pe(E)?(e.consume(E),N):x(E)}function w(E){return E===null||E===60||E===61||E===62||E===96?n(E):E===34||E===39?(e.consume(E),c=E,C):Pe(E)?(e.consume(E),w):T(E)}function C(E){return E===c?(e.consume(E),c=null,I):E===null||pe(E)?n(E):(e.consume(E),C)}function T(E){return E===null||E===34||E===39||E===47||E===60||E===61||E===62||E===96||Re(E)?N(E):(e.consume(E),T)}function I(E){return E===47||E===62||Pe(E)?x(E):n(E)}function v(E){return E===62?(e.consume(E),P):n(E)}function P(E){return E===null||pe(E)?A(E):Pe(E)?(e.consume(E),P):n(E)}function A(E){return E===45&&i===2?(e.consume(E),U):E===60&&i===1?(e.consume(E),H):E===62&&i===4?(e.consume(E),z):E===63&&i===3?(e.consume(E),_):E===93&&i===5?(e.consume(E),B):pe(E)&&(i===6||i===7)?(e.exit("htmlFlowData"),e.check(FN,q,L)(E)):E===null||pe(E)?(e.exit("htmlFlowData"),L(E)):(e.consume(E),A)}function L(E){return e.check($N,O,q)(E)}function O(E){return e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),M}function M(E){return E===null||pe(E)?L(E):(e.enter("htmlFlowData"),A(E))}function U(E){return E===45?(e.consume(E),_):A(E)}function H(E){return E===47?(e.consume(E),o="",F):A(E)}function F(E){if(E===62){const K=o.toLowerCase();return uf.includes(K)?(e.consume(E),z):A(E)}return _t(E)&&o.length<8?(e.consume(E),o+=String.fromCharCode(E),F):A(E)}function B(E){return E===93?(e.consume(E),_):A(E)}function _(E){return E===62?(e.consume(E),z):E===45&&i===2?(e.consume(E),_):A(E)}function z(E){return E===null||pe(E)?(e.exit("htmlFlowData"),q(E)):(e.consume(E),z)}function q(E){return e.exit("htmlFlow"),t(E)}}function UN(e,t,n){const r=this;return i;function i(o){return pe(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a):n(o)}function a(o){return r.parser.lazy[r.now().line]?n(o):t(o)}}function VN(e,t,n){return r;function r(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),e.attempt(ca,t,n)}}const qN={name:"htmlText",tokenize:GN};function GN(e,t,n){const r=this;let i,a,o;return l;function l(_){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(_),c}function c(_){return _===33?(e.consume(_),u):_===47?(e.consume(_),N):_===63?(e.consume(_),x):_t(_)?(e.consume(_),T):n(_)}function u(_){return _===45?(e.consume(_),h):_===91?(e.consume(_),a=0,p):_t(_)?(e.consume(_),b):n(_)}function h(_){return _===45?(e.consume(_),m):n(_)}function d(_){return _===null?n(_):_===45?(e.consume(_),f):pe(_)?(o=d,H(_)):(e.consume(_),d)}function f(_){return _===45?(e.consume(_),m):d(_)}function m(_){return _===62?U(_):_===45?f(_):d(_)}function p(_){const z="CDATA[";return _===z.charCodeAt(a++)?(e.consume(_),a===z.length?y:p):n(_)}function y(_){return _===null?n(_):_===93?(e.consume(_),S):pe(_)?(o=y,H(_)):(e.consume(_),y)}function S(_){return _===93?(e.consume(_),g):y(_)}function g(_){return _===62?U(_):_===93?(e.consume(_),g):y(_)}function b(_){return _===null||_===62?U(_):pe(_)?(o=b,H(_)):(e.consume(_),b)}function x(_){return _===null?n(_):_===63?(e.consume(_),k):pe(_)?(o=x,H(_)):(e.consume(_),x)}function k(_){return _===62?U(_):x(_)}function N(_){return _t(_)?(e.consume(_),w):n(_)}function w(_){return _===45||bt(_)?(e.consume(_),w):C(_)}function C(_){return pe(_)?(o=C,H(_)):Pe(_)?(e.consume(_),C):U(_)}function T(_){return _===45||bt(_)?(e.consume(_),T):_===47||_===62||Re(_)?I(_):n(_)}function I(_){return _===47?(e.consume(_),U):_===58||_===95||_t(_)?(e.consume(_),v):pe(_)?(o=I,H(_)):Pe(_)?(e.consume(_),I):U(_)}function v(_){return _===45||_===46||_===58||_===95||bt(_)?(e.consume(_),v):P(_)}function P(_){return _===61?(e.consume(_),A):pe(_)?(o=P,H(_)):Pe(_)?(e.consume(_),P):I(_)}function A(_){return _===null||_===60||_===61||_===62||_===96?n(_):_===34||_===39?(e.consume(_),i=_,L):pe(_)?(o=A,H(_)):Pe(_)?(e.consume(_),A):(e.consume(_),O)}function L(_){return _===i?(e.consume(_),i=void 0,M):_===null?n(_):pe(_)?(o=L,H(_)):(e.consume(_),L)}function O(_){return _===null||_===34||_===39||_===60||_===61||_===96?n(_):_===47||_===62||Re(_)?I(_):(e.consume(_),O)}function M(_){return _===47||_===62||Re(_)?I(_):n(_)}function U(_){return _===62?(e.consume(_),e.exit("htmlTextData"),e.exit("htmlText"),t):n(_)}function H(_){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(_),e.exit("lineEnding"),F}function F(_){return Pe(_)?Me(e,B,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(_):B(_)}function B(_){return e.enter("htmlTextData"),o(_)}}const Vd={name:"labelEnd",resolveAll:KN,resolveTo:JN,tokenize:QN},HN={tokenize:XN},WN={tokenize:ZN},YN={tokenize:e2};function KN(e){let t=-1;const n=[];for(;++t<e.length;){const r=e[t][1];if(n.push(e[t]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const i=r.type==="labelImage"?4:2;r.type="data",t+=i}}return e.length!==n.length&&Ht(e,0,e.length,n),e}function JN(e,t){let n=e.length,r=0,i,a,o,l;for(;n--;)if(i=e[n][1],a){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;e[n][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(o){if(e[n][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(a=n,i.type!=="labelLink")){r=2;break}}else i.type==="labelEnd"&&(o=n);const c={type:e[a][1].type==="labelLink"?"link":"image",start:{...e[a][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[a][1].start},end:{...e[o][1].end}},h={type:"labelText",start:{...e[a+r+2][1].end},end:{...e[o-2][1].start}};return l=[["enter",c,t],["enter",u,t]],l=Zt(l,e.slice(a+1,a+r+3)),l=Zt(l,[["enter",h,t]]),l=Zt(l,al(t.parser.constructs.insideSpan.null,e.slice(a+r+4,o-3),t)),l=Zt(l,[["exit",h,t],e[o-2],e[o-1],["exit",u,t]]),l=Zt(l,e.slice(o+1)),l=Zt(l,[["exit",c,t]]),Ht(e,a,e.length,l),e}function QN(e,t,n){const r=this;let i=r.events.length,a,o;for(;i--;)if((r.events[i][1].type==="labelImage"||r.events[i][1].type==="labelLink")&&!r.events[i][1]._balanced){a=r.events[i][1];break}return l;function l(f){return a?a._inactive?d(f):(o=r.parser.defined.includes(gn(r.sliceSerialize({start:a.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelEnd"),c):n(f)}function c(f){return f===40?e.attempt(HN,h,o?h:d)(f):f===91?e.attempt(WN,h,o?u:d)(f):o?h(f):d(f)}function u(f){return e.attempt(YN,h,d)(f)}function h(f){return t(f)}function d(f){return a._balanced=!0,n(f)}}function XN(e,t,n){return r;function r(d){return e.enter("resource"),e.enter("resourceMarker"),e.consume(d),e.exit("resourceMarker"),i}function i(d){return Re(d)?Ci(e,a)(d):a(d)}function a(d){return d===41?h(d):fy(e,o,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(d)}function o(d){return Re(d)?Ci(e,c)(d):h(d)}function l(d){return n(d)}function c(d){return d===34||d===39||d===40?gy(e,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(d):h(d)}function u(d){return Re(d)?Ci(e,h)(d):h(d)}function h(d){return d===41?(e.enter("resourceMarker"),e.consume(d),e.exit("resourceMarker"),e.exit("resource"),t):n(d)}}function ZN(e,t,n){const r=this;return i;function i(l){return py.call(r,e,a,o,"reference","referenceMarker","referenceString")(l)}function a(l){return r.parser.defined.includes(gn(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(l):n(l)}function o(l){return n(l)}}function e2(e,t,n){return r;function r(a){return e.enter("reference"),e.enter("referenceMarker"),e.consume(a),e.exit("referenceMarker"),i}function i(a){return a===93?(e.enter("referenceMarker"),e.consume(a),e.exit("referenceMarker"),e.exit("reference"),t):n(a)}}const t2={name:"labelStartImage",resolveAll:Vd.resolveAll,tokenize:n2};function n2(e,t,n){const r=this;return i;function i(l){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(l),e.exit("labelImageMarker"),a}function a(l){return l===91?(e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelImage"),o):n(l)}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(l):t(l)}}const r2={name:"labelStartLink",resolveAll:Vd.resolveAll,tokenize:s2};function s2(e,t,n){const r=this;return i;function i(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),a}function a(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):t(o)}}const Yl={name:"lineEnding",tokenize:i2};function i2(e,t){return n;function n(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),Me(e,t,"linePrefix")}}const Ja={name:"thematicBreak",tokenize:a2};function a2(e,t,n){let r=0,i;return a;function a(u){return e.enter("thematicBreak"),o(u)}function o(u){return i=u,l(u)}function l(u){return u===i?(e.enter("thematicBreakSequence"),c(u)):r>=3&&(u===null||pe(u))?(e.exit("thematicBreak"),t(u)):n(u)}function c(u){return u===i?(e.consume(u),r++,c):(e.exit("thematicBreakSequence"),Pe(u)?Me(e,l,"whitespace")(u):l(u))}}const Mt={continuation:{tokenize:u2},exit:h2,name:"list",tokenize:c2},o2={partial:!0,tokenize:m2},l2={partial:!0,tokenize:d2};function c2(e,t,n){const r=this,i=r.events[r.events.length-1];let a=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,o=0;return l;function l(m){const p=r.containerState.type||(m===42||m===43||m===45?"listUnordered":"listOrdered");if(p==="listUnordered"?!r.containerState.marker||m===r.containerState.marker:vu(m)){if(r.containerState.type||(r.containerState.type=p,e.enter(p,{_container:!0})),p==="listUnordered")return e.enter("listItemPrefix"),m===42||m===45?e.check(Ja,n,u)(m):u(m);if(!r.interrupt||m===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),c(m)}return n(m)}function c(m){return vu(m)&&++o<10?(e.consume(m),c):(!r.interrupt||o<2)&&(r.containerState.marker?m===r.containerState.marker:m===41||m===46)?(e.exit("listItemValue"),u(m)):n(m)}function u(m){return e.enter("listItemMarker"),e.consume(m),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||m,e.check(ca,r.interrupt?n:h,e.attempt(o2,f,d))}function h(m){return r.containerState.initialBlankLine=!0,a++,f(m)}function d(m){return Pe(m)?(e.enter("listItemPrefixWhitespace"),e.consume(m),e.exit("listItemPrefixWhitespace"),f):n(m)}function f(m){return r.containerState.size=a+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(m)}}function u2(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(ca,i,a);function i(l){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Me(e,t,"listItemIndent",r.containerState.size+1)(l)}function a(l){return r.containerState.furtherBlankLines||!Pe(l)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(l)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(l2,t,o)(l))}function o(l){return r.containerState._closeFlow=!0,r.interrupt=void 0,Me(e,e.attempt(Mt,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function d2(e,t,n){const r=this;return Me(e,i,"listItemIndent",r.containerState.size+1);function i(a){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?t(a):n(a)}}function h2(e){e.exit(this.containerState.type)}function m2(e,t,n){const r=this;return Me(e,i,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function i(a){const o=r.events[r.events.length-1];return!Pe(a)&&o&&o[1].type==="listItemPrefixWhitespace"?t(a):n(a)}}const df={name:"setextUnderline",resolveTo:f2,tokenize:p2};function f2(e,t){let n=e.length,r,i,a;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){r=n;break}e[n][1].type==="paragraph"&&(i=n)}else e[n][1].type==="content"&&e.splice(n,1),!a&&e[n][1].type==="definition"&&(a=n);const o={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[i][1].type="setextHeadingText",a?(e.splice(i,0,["enter",o,t]),e.splice(a+1,0,["exit",e[r][1],t]),e[r][1].end={...e[a][1].end}):e[r][1]=o,e.push(["exit",o,t]),e}function p2(e,t,n){const r=this;let i;return a;function a(u){let h=r.events.length,d;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){d=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||d)?(e.enter("setextHeadingLine"),i=u,o(u)):n(u)}function o(u){return e.enter("setextHeadingLineSequence"),l(u)}function l(u){return u===i?(e.consume(u),l):(e.exit("setextHeadingLineSequence"),Pe(u)?Me(e,c,"lineSuffix")(u):c(u))}function c(u){return u===null||pe(u)?(e.exit("setextHeadingLine"),t(u)):n(u)}}const g2={tokenize:x2};function x2(e){const t=this,n=e.attempt(ca,r,e.attempt(this.parser.constructs.flowInitial,i,Me(e,e.attempt(this.parser.constructs.flow,i,e.attempt(jN,i)),"linePrefix")));return n;function r(a){if(a===null){e.consume(a);return}return e.enter("lineEndingBlank"),e.consume(a),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function i(a){if(a===null){e.consume(a);return}return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const y2={resolveAll:yy()},b2=xy("string"),v2=xy("text");function xy(e){return{resolveAll:yy(e==="text"?w2:void 0),tokenize:t};function t(n){const r=this,i=this.parser.constructs[e],a=n.attempt(i,o,l);return o;function o(h){return u(h)?a(h):l(h)}function l(h){if(h===null){n.consume(h);return}return n.enter("data"),n.consume(h),c}function c(h){return u(h)?(n.exit("data"),a(h)):(n.consume(h),c)}function u(h){if(h===null)return!0;const d=i[h];let f=-1;if(d)for(;++f<d.length;){const m=d[f];if(!m.previous||m.previous.call(r,r.previous))return!0}return!1}}}function yy(e){return t;function t(n,r){let i=-1,a;for(;++i<=n.length;)a===void 0?n[i]&&n[i][1].type==="data"&&(a=i,i++):(!n[i]||n[i][1].type!=="data")&&(i!==a+2&&(n[a][1].end=n[i-1][1].end,n.splice(a+2,i-a-2),i=a+2),a=void 0);return e?e(n,r):n}}function w2(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const r=e[n-1][1],i=t.sliceStream(r);let a=i.length,o=-1,l=0,c;for(;a--;){const u=i[a];if(typeof u=="string"){for(o=u.length;u.charCodeAt(o-1)===32;)l++,o--;if(o)break;o=-1}else if(u===-2)c=!0,l++;else if(u!==-1){a++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(l=0),l){const u={type:n===e.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:a?o:r.start._bufferIndex+o,_index:r.start._index+a,line:r.end.line,column:r.end.column-l,offset:r.end.offset-l},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(n,0,["enter",u,t],["exit",u,t]),n+=2)}n++}return e}const j2={42:Mt,43:Mt,45:Mt,48:Mt,49:Mt,50:Mt,51:Mt,52:Mt,53:Mt,54:Mt,55:Mt,56:Mt,57:Mt,62:uy},k2={91:CN},N2={[-2]:Wl,[-1]:Wl,32:Wl},S2={35:AN,42:Ja,45:[df,Ja],60:RN,61:df,95:Ja,96:cf,126:cf},_2={38:hy,92:dy},C2={[-5]:Yl,[-4]:Yl,[-3]:Yl,33:t2,38:hy,42:wu,60:[rN,qN],91:r2,92:[IN,dy],93:Vd,95:wu,96:gN},E2={null:[wu,y2]},P2={null:[42,95]},T2={null:[]},I2=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:P2,contentInitial:k2,disable:T2,document:j2,flow:S2,flowInitial:N2,insideSpan:E2,string:_2,text:C2},Symbol.toStringTag,{value:"Module"}));function M2(e,t,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const i={},a=[];let o=[],l=[];const c={attempt:C(N),check:C(w),consume:b,enter:x,exit:k,interrupt:C(w,{interrupt:!0})},u={code:null,containerState:{},defineSkip:y,events:[],now:p,parser:e,previous:null,sliceSerialize:f,sliceStream:m,write:d};let h=t.tokenize.call(u,c);return t.resolveAll&&a.push(t),u;function d(P){return o=Zt(o,P),S(),o[o.length-1]!==null?[]:(T(t,0),u.events=al(a,u.events,u),u.events)}function f(P,A){return L2(m(P),A)}function m(P){return A2(o,P)}function p(){const{_bufferIndex:P,_index:A,line:L,column:O,offset:M}=r;return{_bufferIndex:P,_index:A,line:L,column:O,offset:M}}function y(P){i[P.line]=P.column,v()}function S(){let P;for(;r._index<o.length;){const A=o[r._index];if(typeof A=="string")for(P=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===P&&r._bufferIndex<A.length;)g(A.charCodeAt(r._bufferIndex));else g(A)}}function g(P){h=h(P)}function b(P){pe(P)?(r.line++,r.column=1,r.offset+=P===-3?2:1,v()):P!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=P}function x(P,A){const L=A||{};return L.type=P,L.start=p(),u.events.push(["enter",L,u]),l.push(L),L}function k(P){const A=l.pop();return A.end=p(),u.events.push(["exit",A,u]),A}function N(P,A){T(P,A.from)}function w(P,A){A.restore()}function C(P,A){return L;function L(O,M,U){let H,F,B,_;return Array.isArray(O)?q(O):"tokenize"in O?q([O]):z(O);function z(W){return le;function le(se){const ae=se!==null&&W[se],be=se!==null&&W.null,je=[...Array.isArray(ae)?ae:ae?[ae]:[],...Array.isArray(be)?be:be?[be]:[]];return q(je)(se)}}function q(W){return H=W,F=0,W.length===0?U:E(W[F])}function E(W){return le;function le(se){return _=I(),B=W,W.partial||(u.currentConstruct=W),W.name&&u.parser.constructs.disable.null.includes(W.name)?G():W.tokenize.call(A?Object.assign(Object.create(u),A):u,c,K,G)(se)}}function K(W){return P(B,_),M}function G(W){return _.restore(),++F<H.length?E(H[F]):U}}}function T(P,A){P.resolveAll&&!a.includes(P)&&a.push(P),P.resolve&&Ht(u.events,A,u.events.length-A,P.resolve(u.events.slice(A),u)),P.resolveTo&&(u.events=P.resolveTo(u.events,u))}function I(){const P=p(),A=u.previous,L=u.currentConstruct,O=u.events.length,M=Array.from(l);return{from:O,restore:U};function U(){r=P,u.previous=A,u.currentConstruct=L,u.events.length=O,l=M,v()}}function v(){r.line in i&&r.column<2&&(r.column=i[r.line],r.offset+=i[r.line]-1)}}function A2(e,t){const n=t.start._index,r=t.start._bufferIndex,i=t.end._index,a=t.end._bufferIndex;let o;if(n===i)o=[e[n].slice(r,a)];else{if(o=e.slice(n,i),r>-1){const l=o[0];typeof l=="string"?o[0]=l.slice(r):o.shift()}a>0&&o.push(e[i].slice(0,a))}return o}function L2(e,t){let n=-1;const r=[];let i;for(;++n<e.length;){const a=e[n];let o;if(typeof a=="string")o=a;else switch(a){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=t?" ":"	";break}case-1:{if(!t&&i)continue;o=" ";break}default:o=String.fromCharCode(a)}i=a===-2,r.push(o)}return r.join("")}function D2(e){const r={constructs:ly([I2,...(e||{}).extensions||[]]),content:i(Jk),defined:[],document:i(Xk),flow:i(g2),lazy:{},string:i(b2),text:i(v2)};return r;function i(a){return o;function o(l){return M2(r,a,l)}}}function O2(e){for(;!my(e););return e}const hf=/[\0\t\n\r]/g;function R2(){let e=1,t="",n=!0,r;return i;function i(a,o,l){const c=[];let u,h,d,f,m;for(a=t+(typeof a=="string"?a.toString():new TextDecoder(o||void 0).decode(a)),d=0,t="",n&&(a.charCodeAt(0)===65279&&d++,n=void 0);d<a.length;){if(hf.lastIndex=d,u=hf.exec(a),f=u&&u.index!==void 0?u.index:a.length,m=a.charCodeAt(f),!u){t=a.slice(d);break}if(m===10&&d===f&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),d<f&&(c.push(a.slice(d,f)),e+=f-d),m){case 0:{c.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,c.push(-2);e++<h;)c.push(-1);break}case 10:{c.push(-4),e=1;break}default:r=!0,e=1}d=f+1}return l&&(r&&c.push(-5),t&&c.push(t),c.push(null)),c}}const F2=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function $2(e){return e.replace(F2,z2)}function z2(e,t,n){if(t)return t;if(n.charCodeAt(0)===35){const i=n.charCodeAt(1),a=i===120||i===88;return cy(n.slice(a?2:1),a?16:10)}return Ud(n)||e}const by={}.hasOwnProperty;function B2(e,t,n){return typeof t!="string"&&(n=t,t=void 0),U2(n)(O2(D2(n).document().write(R2()(e,t,!0))))}function U2(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:a(Ue),autolinkProtocol:I,autolinkEmail:I,atxHeading:a(re),blockQuote:a(be),characterEscape:I,characterReference:I,codeFenced:a(je),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:a(je,o),codeText:a(Ie,o),codeTextData:I,data:I,codeFlowValue:I,definition:a(ne),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:a(Q),hardBreakEscape:a(ge),hardBreakTrailing:a(ge),htmlFlow:a(ve,o),htmlFlowData:I,htmlText:a(ve,o),htmlTextData:I,image:a(we),label:o,link:a(Ue),listItem:a(V),listItemValue:f,listOrdered:a(Fe,d),listUnordered:a(Fe),paragraph:a(X),reference:E,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:a(re),strong:a(oe),thematicBreak:a(rt)},exit:{atxHeading:c(),atxHeadingSequence:N,autolink:c(),autolinkEmail:ae,autolinkProtocol:se,blockQuote:c(),characterEscapeValue:v,characterReferenceMarkerHexadecimal:G,characterReferenceMarkerNumeric:G,characterReferenceValue:W,characterReference:le,codeFenced:c(S),codeFencedFence:y,codeFencedFenceInfo:m,codeFencedFenceMeta:p,codeFlowValue:v,codeIndented:c(g),codeText:c(M),codeTextData:v,data:v,definition:c(),definitionDestinationString:k,definitionLabelString:b,definitionTitleString:x,emphasis:c(),hardBreakEscape:c(A),hardBreakTrailing:c(A),htmlFlow:c(L),htmlFlowData:v,htmlText:c(O),htmlTextData:v,image:c(H),label:B,labelText:F,lineEnding:P,link:c(U),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:K,resourceDestinationString:_,resourceTitleString:z,resource:q,setextHeading:c(T),setextHeadingLineSequence:C,setextHeadingText:w,strong:c(),thematicBreak:c()}};vy(t,(e||{}).mdastExtensions||[]);const n={};return r;function r(D){let R={type:"root",children:[]};const $={stack:[R],tokenStack:[],config:t,enter:l,exit:u,buffer:o,resume:h,data:n},te=[];let ue=-1;for(;++ue<D.length;)if(D[ue][1].type==="listOrdered"||D[ue][1].type==="listUnordered")if(D[ue][0]==="enter")te.push(ue);else{const he=te.pop();ue=i(D,he,ue)}for(ue=-1;++ue<D.length;){const he=t[D[ue][0]];by.call(he,D[ue][1].type)&&he[D[ue][1].type].call(Object.assign({sliceSerialize:D[ue][2].sliceSerialize},$),D[ue][1])}if($.tokenStack.length>0){const he=$.tokenStack[$.tokenStack.length-1];(he[1]||mf).call($,void 0,he[0])}for(R.position={start:Qn(D.length>0?D[0][1].start:{line:1,column:1,offset:0}),end:Qn(D.length>0?D[D.length-2][1].end:{line:1,column:1,offset:0})},ue=-1;++ue<t.transforms.length;)R=t.transforms[ue](R)||R;return R}function i(D,R,$){let te=R-1,ue=-1,he=!1,ce,de,ye,Ce;for(;++te<=$;){const Le=D[te];switch(Le[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Le[0]==="enter"?ue++:ue--,Ce=void 0;break}case"lineEndingBlank":{Le[0]==="enter"&&(ce&&!Ce&&!ue&&!ye&&(ye=te),Ce=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Ce=void 0}if(!ue&&Le[0]==="enter"&&Le[1].type==="listItemPrefix"||ue===-1&&Le[0]==="exit"&&(Le[1].type==="listUnordered"||Le[1].type==="listOrdered")){if(ce){let Oe=te;for(de=void 0;Oe--;){const st=D[Oe];if(st[1].type==="lineEnding"||st[1].type==="lineEndingBlank"){if(st[0]==="exit")continue;de&&(D[de][1].type="lineEndingBlank",he=!0),st[1].type="lineEnding",de=Oe}else if(!(st[1].type==="linePrefix"||st[1].type==="blockQuotePrefix"||st[1].type==="blockQuotePrefixWhitespace"||st[1].type==="blockQuoteMarker"||st[1].type==="listItemIndent"))break}ye&&(!de||ye<de)&&(ce._spread=!0),ce.end=Object.assign({},de?D[de][1].start:Le[1].end),D.splice(de||te,0,["exit",ce,Le[2]]),te++,$++}if(Le[1].type==="listItemPrefix"){const Oe={type:"listItem",_spread:!1,start:Object.assign({},Le[1].start),end:void 0};ce=Oe,D.splice(te,0,["enter",Oe,Le[2]]),te++,$++,ye=void 0,Ce=!0}}}return D[R][1]._spread=he,$}function a(D,R){return $;function $(te){l.call(this,D(te),te),R&&R.call(this,te)}}function o(){this.stack.push({type:"fragment",children:[]})}function l(D,R,$){this.stack[this.stack.length-1].children.push(D),this.stack.push(D),this.tokenStack.push([R,$||void 0]),D.position={start:Qn(R.start),end:void 0}}function c(D){return R;function R($){D&&D.call(this,$),u.call(this,$)}}function u(D,R){const $=this.stack.pop(),te=this.tokenStack.pop();if(te)te[0].type!==D.type&&(R?R.call(this,D,te[0]):(te[1]||mf).call(this,D,te[0]));else throw new Error("Cannot close `"+D.type+"` ("+_i({start:D.start,end:D.end})+"): its not open");$.position.end=Qn(D.end)}function h(){return Bd(this.stack.pop())}function d(){this.data.expectingFirstListItemValue=!0}function f(D){if(this.data.expectingFirstListItemValue){const R=this.stack[this.stack.length-2];R.start=Number.parseInt(this.sliceSerialize(D),10),this.data.expectingFirstListItemValue=void 0}}function m(){const D=this.resume(),R=this.stack[this.stack.length-1];R.lang=D}function p(){const D=this.resume(),R=this.stack[this.stack.length-1];R.meta=D}function y(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function S(){const D=this.resume(),R=this.stack[this.stack.length-1];R.value=D.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function g(){const D=this.resume(),R=this.stack[this.stack.length-1];R.value=D.replace(/(\r?\n|\r)$/g,"")}function b(D){const R=this.resume(),$=this.stack[this.stack.length-1];$.label=R,$.identifier=gn(this.sliceSerialize(D)).toLowerCase()}function x(){const D=this.resume(),R=this.stack[this.stack.length-1];R.title=D}function k(){const D=this.resume(),R=this.stack[this.stack.length-1];R.url=D}function N(D){const R=this.stack[this.stack.length-1];if(!R.depth){const $=this.sliceSerialize(D).length;R.depth=$}}function w(){this.data.setextHeadingSlurpLineEnding=!0}function C(D){const R=this.stack[this.stack.length-1];R.depth=this.sliceSerialize(D).codePointAt(0)===61?1:2}function T(){this.data.setextHeadingSlurpLineEnding=void 0}function I(D){const $=this.stack[this.stack.length-1].children;let te=$[$.length-1];(!te||te.type!=="text")&&(te=Se(),te.position={start:Qn(D.start),end:void 0},$.push(te)),this.stack.push(te)}function v(D){const R=this.stack.pop();R.value+=this.sliceSerialize(D),R.position.end=Qn(D.end)}function P(D){const R=this.stack[this.stack.length-1];if(this.data.atHardBreak){const $=R.children[R.children.length-1];$.position.end=Qn(D.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(R.type)&&(I.call(this,D),v.call(this,D))}function A(){this.data.atHardBreak=!0}function L(){const D=this.resume(),R=this.stack[this.stack.length-1];R.value=D}function O(){const D=this.resume(),R=this.stack[this.stack.length-1];R.value=D}function M(){const D=this.resume(),R=this.stack[this.stack.length-1];R.value=D}function U(){const D=this.stack[this.stack.length-1];if(this.data.inReference){const R=this.data.referenceType||"shortcut";D.type+="Reference",D.referenceType=R,delete D.url,delete D.title}else delete D.identifier,delete D.label;this.data.referenceType=void 0}function H(){const D=this.stack[this.stack.length-1];if(this.data.inReference){const R=this.data.referenceType||"shortcut";D.type+="Reference",D.referenceType=R,delete D.url,delete D.title}else delete D.identifier,delete D.label;this.data.referenceType=void 0}function F(D){const R=this.sliceSerialize(D),$=this.stack[this.stack.length-2];$.label=$2(R),$.identifier=gn(R).toLowerCase()}function B(){const D=this.stack[this.stack.length-1],R=this.resume(),$=this.stack[this.stack.length-1];if(this.data.inReference=!0,$.type==="link"){const te=D.children;$.children=te}else $.alt=R}function _(){const D=this.resume(),R=this.stack[this.stack.length-1];R.url=D}function z(){const D=this.resume(),R=this.stack[this.stack.length-1];R.title=D}function q(){this.data.inReference=void 0}function E(){this.data.referenceType="collapsed"}function K(D){const R=this.resume(),$=this.stack[this.stack.length-1];$.label=R,$.identifier=gn(this.sliceSerialize(D)).toLowerCase(),this.data.referenceType="full"}function G(D){this.data.characterReferenceType=D.type}function W(D){const R=this.sliceSerialize(D),$=this.data.characterReferenceType;let te;$?(te=cy(R,$==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):te=Ud(R);const ue=this.stack[this.stack.length-1];ue.value+=te}function le(D){const R=this.stack.pop();R.position.end=Qn(D.end)}function se(D){v.call(this,D);const R=this.stack[this.stack.length-1];R.url=this.sliceSerialize(D)}function ae(D){v.call(this,D);const R=this.stack[this.stack.length-1];R.url="mailto:"+this.sliceSerialize(D)}function be(){return{type:"blockquote",children:[]}}function je(){return{type:"code",lang:null,meta:null,value:""}}function Ie(){return{type:"inlineCode",value:""}}function ne(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Q(){return{type:"emphasis",children:[]}}function re(){return{type:"heading",depth:0,children:[]}}function ge(){return{type:"break"}}function ve(){return{type:"html",value:""}}function we(){return{type:"image",title:null,url:"",alt:null}}function Ue(){return{type:"link",title:null,url:"",children:[]}}function Fe(D){return{type:"list",ordered:D.type==="listOrdered",start:null,spread:D._spread,children:[]}}function V(D){return{type:"listItem",spread:D._spread,checked:null,children:[]}}function X(){return{type:"paragraph",children:[]}}function oe(){return{type:"strong",children:[]}}function Se(){return{type:"text",value:""}}function rt(){return{type:"thematicBreak"}}}function Qn(e){return{line:e.line,column:e.column,offset:e.offset}}function vy(e,t){let n=-1;for(;++n<t.length;){const r=t[n];Array.isArray(r)?vy(e,r):V2(e,r)}}function V2(e,t){let n;for(n in t)if(by.call(t,n))switch(n){case"canContainEols":{const r=t[n];r&&e[n].push(...r);break}case"transforms":{const r=t[n];r&&e[n].push(...r);break}case"enter":case"exit":{const r=t[n];r&&Object.assign(e[n],r);break}}}function mf(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+_i({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+_i({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+_i({start:t.start,end:t.end})+") is still open")}function q2(e){const t=this;t.parser=n;function n(r){return B2(r,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function G2(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)}function H2(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:`
`}]}function W2(e,t){const n=t.value?t.value+`
`:"",r={};t.lang&&(r.className=["language-"+t.lang]);let i={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(i.data={meta:t.meta}),e.patch(t,i),i=e.applyData(t,i),i={type:"element",tagName:"pre",properties:{},children:[i]},e.patch(t,i),i}function Y2(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function K2(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function J2(e,t){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),i=Ys(r.toLowerCase()),a=e.footnoteOrder.indexOf(r);let o,l=e.footnoteCounts.get(r);l===void 0?(l=0,e.footnoteOrder.push(r),o=e.footnoteOrder.length):o=a+1,l+=1,e.footnoteCounts.set(r,l);const c={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+i,id:n+"fnref-"+i+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(t,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return e.patch(t,u),e.applyData(t,u)}function Q2(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function X2(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}}function wy(e,t){const n=t.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+r}];const i=e.all(t),a=i[0];a&&a.type==="text"?a.value="["+a.value:i.unshift({type:"text",value:"["});const o=i[i.length-1];return o&&o.type==="text"?o.value+=r:i.push({type:"text",value:r}),i}function Z2(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return wy(e,t);const i={src:Ys(r.url||""),alt:t.alt};r.title!==null&&r.title!==void 0&&(i.title=r.title);const a={type:"element",tagName:"img",properties:i,children:[]};return e.patch(t,a),e.applyData(t,a)}function eS(e,t){const n={src:Ys(t.url)};t.alt!==null&&t.alt!==void 0&&(n.alt=t.alt),t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,r),e.applyData(t,r)}function tS(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,r),e.applyData(t,r)}function nS(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return wy(e,t);const i={href:Ys(r.url||"")};r.title!==null&&r.title!==void 0&&(i.title=r.title);const a={type:"element",tagName:"a",properties:i,children:e.all(t)};return e.patch(t,a),e.applyData(t,a)}function rS(e,t){const n={href:Ys(t.url)};t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function sS(e,t,n){const r=e.all(t),i=n?iS(n):jy(t),a={},o=[];if(typeof t.checked=="boolean"){const h=r[0];let d;h&&h.type==="element"&&h.tagName==="p"?d=h:(d={type:"element",tagName:"p",properties:{},children:[]},r.unshift(d)),d.children.length>0&&d.children.unshift({type:"text",value:" "}),d.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),a.className=["task-list-item"]}let l=-1;for(;++l<r.length;){const h=r[l];(i||l!==0||h.type!=="element"||h.tagName!=="p")&&o.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!i?o.push(...h.children):o.push(h)}const c=r[r.length-1];c&&(i||c.type!=="element"||c.tagName!=="p")&&o.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:a,children:o};return e.patch(t,u),e.applyData(t,u)}function iS(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const n=e.children;let r=-1;for(;!t&&++r<n.length;)t=jy(n[r])}return t}function jy(e){const t=e.spread;return t??e.children.length>1}function aS(e,t){const n={},r=e.all(t);let i=-1;for(typeof t.start=="number"&&t.start!==1&&(n.start=t.start);++i<r.length;){const o=r[i];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const a={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(r,!0)};return e.patch(t,a),e.applyData(t,a)}function oS(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function lS(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)}function cS(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function uS(e,t){const n=e.all(t),r=n.shift(),i=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],o),i.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},l=Rd(t.children[1]),c=ty(t.children[t.children.length-1]);l&&c&&(o.position={start:l,end:c}),i.push(o)}const a={type:"element",tagName:"table",properties:{},children:e.wrap(i,!0)};return e.patch(t,a),e.applyData(t,a)}function dS(e,t,n){const r=n?n.children:void 0,a=(r?r.indexOf(t):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,l=o?o.length:t.children.length;let c=-1;const u=[];for(;++c<l;){const d=t.children[c],f={},m=o?o[c]:void 0;m&&(f.align=m);let p={type:"element",tagName:a,properties:f,children:[]};d&&(p.children=e.all(d),e.patch(d,p),p=e.applyData(d,p)),u.push(p)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(t,h),e.applyData(t,h)}function hS(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}const ff=9,pf=32;function mS(e){const t=String(e),n=/\r?\n|\r/g;let r=n.exec(t),i=0;const a=[];for(;r;)a.push(gf(t.slice(i,r.index),i>0,!0),r[0]),i=r.index+r[0].length,r=n.exec(t);return a.push(gf(t.slice(i),i>0,!1)),a.join("")}function gf(e,t,n){let r=0,i=e.length;if(t){let a=e.codePointAt(r);for(;a===ff||a===pf;)r++,a=e.codePointAt(r)}if(n){let a=e.codePointAt(i-1);for(;a===ff||a===pf;)i--,a=e.codePointAt(i-1)}return i>r?e.slice(r,i):""}function fS(e,t){const n={type:"text",value:mS(String(t.value))};return e.patch(t,n),e.applyData(t,n)}function pS(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)}const gS={blockquote:G2,break:H2,code:W2,delete:Y2,emphasis:K2,footnoteReference:J2,heading:Q2,html:X2,imageReference:Z2,image:eS,inlineCode:tS,linkReference:nS,link:rS,listItem:sS,list:aS,paragraph:oS,root:lS,strong:cS,table:uS,tableCell:hS,tableRow:dS,text:fS,thematicBreak:pS,toml:La,yaml:La,definition:La,footnoteDefinition:La};function La(){}const ky=-1,ol=0,Ei=1,Eo=2,qd=3,Gd=4,Hd=5,Wd=6,Ny=7,Sy=8,xf=typeof self=="object"?self:globalThis,xS=(e,t)=>{const n=(i,a)=>(e.set(a,i),i),r=i=>{if(e.has(i))return e.get(i);const[a,o]=t[i];switch(a){case ol:case ky:return n(o,i);case Ei:{const l=n([],i);for(const c of o)l.push(r(c));return l}case Eo:{const l=n({},i);for(const[c,u]of o)l[r(c)]=r(u);return l}case qd:return n(new Date(o),i);case Gd:{const{source:l,flags:c}=o;return n(new RegExp(l,c),i)}case Hd:{const l=n(new Map,i);for(const[c,u]of o)l.set(r(c),r(u));return l}case Wd:{const l=n(new Set,i);for(const c of o)l.add(r(c));return l}case Ny:{const{name:l,message:c}=o;return n(new xf[l](c),i)}case Sy:return n(BigInt(o),i);case"BigInt":return n(Object(BigInt(o)),i);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:l}=new Uint8Array(o);return n(new DataView(l),o)}}return n(new xf[a](o),i)};return r},yf=e=>xS(new Map,e)(0),rs="",{toString:yS}={},{keys:bS}=Object,ii=e=>{const t=typeof e;if(t!=="object"||!e)return[ol,t];const n=yS.call(e).slice(8,-1);switch(n){case"Array":return[Ei,rs];case"Object":return[Eo,rs];case"Date":return[qd,rs];case"RegExp":return[Gd,rs];case"Map":return[Hd,rs];case"Set":return[Wd,rs];case"DataView":return[Ei,n]}return n.includes("Array")?[Ei,n]:n.includes("Error")?[Ny,n]:[Eo,n]},Da=([e,t])=>e===ol&&(t==="function"||t==="symbol"),vS=(e,t,n,r)=>{const i=(o,l)=>{const c=r.push(o)-1;return n.set(l,c),c},a=o=>{if(n.has(o))return n.get(o);let[l,c]=ii(o);switch(l){case ol:{let h=o;switch(c){case"bigint":l=Sy,h=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+c);h=null;break;case"undefined":return i([ky],o)}return i([l,h],o)}case Ei:{if(c){let f=o;return c==="DataView"?f=new Uint8Array(o.buffer):c==="ArrayBuffer"&&(f=new Uint8Array(o)),i([c,[...f]],o)}const h=[],d=i([l,h],o);for(const f of o)h.push(a(f));return d}case Eo:{if(c)switch(c){case"BigInt":return i([c,o.toString()],o);case"Boolean":case"Number":case"String":return i([c,o.valueOf()],o)}if(t&&"toJSON"in o)return a(o.toJSON());const h=[],d=i([l,h],o);for(const f of bS(o))(e||!Da(ii(o[f])))&&h.push([a(f),a(o[f])]);return d}case qd:return i([l,o.toISOString()],o);case Gd:{const{source:h,flags:d}=o;return i([l,{source:h,flags:d}],o)}case Hd:{const h=[],d=i([l,h],o);for(const[f,m]of o)(e||!(Da(ii(f))||Da(ii(m))))&&h.push([a(f),a(m)]);return d}case Wd:{const h=[],d=i([l,h],o);for(const f of o)(e||!Da(ii(f)))&&h.push(a(f));return d}}const{message:u}=o;return i([l,{name:c,message:u}],o)};return a},bf=(e,{json:t,lossy:n}={})=>{const r=[];return vS(!(t||n),!!t,new Map,r)(e),r},Po=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?yf(bf(e,t)):structuredClone(e):(e,t)=>yf(bf(e,t));function wS(e,t){const n=[{type:"text",value:""}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function jS(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function kS(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||wS,r=e.options.footnoteBackLabel||jS,i=e.options.footnoteLabel||"Footnotes",a=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[c]);if(!u)continue;const h=e.all(u),d=String(u.identifier).toUpperCase(),f=Ys(d.toLowerCase());let m=0;const p=[],y=e.footnoteCounts.get(d);for(;y!==void 0&&++m<=y;){p.length>0&&p.push({type:"text",value:" "});let b=typeof n=="string"?n:n(c,m);typeof b=="string"&&(b={type:"text",value:b}),p.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+f+(m>1?"-"+m:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(c,m),className:["data-footnote-backref"]},children:Array.isArray(b)?b:[b]})}const S=h[h.length-1];if(S&&S.type==="element"&&S.tagName==="p"){const b=S.children[S.children.length-1];b&&b.type==="text"?b.value+=" ":S.children.push({type:"text",value:" "}),S.children.push(...p)}else h.push(...p);const g={type:"element",tagName:"li",properties:{id:t+"fn-"+f},children:e.wrap(h,!0)};e.patch(u,g),l.push(g)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:a,properties:{...Po(o),id:"footnote-label"},children:[{type:"text",value:i}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(l,!0)},{type:"text",value:`
`}]}}const ll=function(e){if(e==null)return CS;if(typeof e=="function")return cl(e);if(typeof e=="object")return Array.isArray(e)?NS(e):SS(e);if(typeof e=="string")return _S(e);throw new Error("Expected function, string, or object as test")};function NS(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=ll(e[n]);return cl(r);function r(...i){let a=-1;for(;++a<t.length;)if(t[a].apply(this,i))return!0;return!1}}function SS(e){const t=e;return cl(n);function n(r){const i=r;let a;for(a in e)if(i[a]!==t[a])return!1;return!0}}function _S(e){return cl(t);function t(n){return n&&n.type===e}}function cl(e){return t;function t(n,r,i){return!!(ES(n)&&e.call(this,n,typeof r=="number"?r:void 0,i||void 0))}}function CS(){return!0}function ES(e){return e!==null&&typeof e=="object"&&"type"in e}const _y=[],PS=!0,ju=!1,TS="skip";function Cy(e,t,n,r){let i;typeof t=="function"&&typeof n!="function"?(r=n,n=t):i=t;const a=ll(i),o=r?-1:1;l(e,void 0,[])();function l(c,u,h){const d=c&&typeof c=="object"?c:{};if(typeof d.type=="string"){const m=typeof d.tagName=="string"?d.tagName:typeof d.name=="string"?d.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(c.type+(m?"<"+m+">":""))+")"})}return f;function f(){let m=_y,p,y,S;if((!t||a(c,u,h[h.length-1]||void 0))&&(m=IS(n(c,h)),m[0]===ju))return m;if("children"in c&&c.children){const g=c;if(g.children&&m[0]!==TS)for(y=(r?g.children.length:-1)+o,S=h.concat(g);y>-1&&y<g.children.length;){const b=g.children[y];if(p=l(b,y,S)(),p[0]===ju)return p;y=typeof p[1]=="number"?p[1]:y+o}}return m}}}function IS(e){return Array.isArray(e)?e:typeof e=="number"?[PS,e]:e==null?_y:[e]}function Yd(e,t,n,r){let i,a,o;typeof t=="function"&&typeof n!="function"?(a=void 0,o=t,i=n):(a=t,o=n,i=r),Cy(e,a,l,i);function l(c,u){const h=u[u.length-1],d=h?h.children.indexOf(c):void 0;return o(c,d,h)}}const ku={}.hasOwnProperty,MS={};function AS(e,t){const n=t||MS,r=new Map,i=new Map,a=new Map,o={...gS,...n.handlers},l={all:u,applyData:DS,definitionById:r,footnoteById:i,footnoteCounts:a,footnoteOrder:[],handlers:o,one:c,options:n,patch:LS,wrap:RS};return Yd(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const d=h.type==="definition"?r:i,f=String(h.identifier).toUpperCase();d.has(f)||d.set(f,h)}}),l;function c(h,d){const f=h.type,m=l.handlers[f];if(ku.call(l.handlers,f)&&m)return m(l,h,d);if(l.options.passThrough&&l.options.passThrough.includes(f)){if("children"in h){const{children:y,...S}=h,g=Po(S);return g.children=l.all(h),g}return Po(h)}return(l.options.unknownHandler||OS)(l,h,d)}function u(h){const d=[];if("children"in h){const f=h.children;let m=-1;for(;++m<f.length;){const p=l.one(f[m],h);if(p){if(m&&f[m-1].type==="break"&&(!Array.isArray(p)&&p.type==="text"&&(p.value=vf(p.value)),!Array.isArray(p)&&p.type==="element")){const y=p.children[0];y&&y.type==="text"&&(y.value=vf(y.value))}Array.isArray(p)?d.push(...p):d.push(p)}}}return d}}function LS(e,t){e.position&&(t.position=jk(e))}function DS(e,t){let n=t;if(e&&e.data){const r=e.data.hName,i=e.data.hChildren,a=e.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const o="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:o}}n.type==="element"&&a&&Object.assign(n.properties,Po(a)),"children"in n&&n.children&&i!==null&&i!==void 0&&(n.children=i)}return n}function OS(e,t){const n=t.data||{},r="value"in t&&!(ku.call(n,"hProperties")||ku.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function RS(e,t){const n=[];let r=-1;for(t&&n.push({type:"text",value:`
`});++r<e.length;)r&&n.push({type:"text",value:`
`}),n.push(e[r]);return t&&e.length>0&&n.push({type:"text",value:`
`}),n}function vf(e){let t=0,n=e.charCodeAt(t);for(;n===9||n===32;)t++,n=e.charCodeAt(t);return e.slice(t)}function wf(e,t){const n=AS(e,t),r=n.one(e,void 0),i=kS(n),a=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return i&&a.children.push({type:"text",value:`
`},i),a}function FS(e,t){return e&&"run"in e?async function(n,r){const i=wf(n,{file:r,...t});await e.run(i,r)}:function(n,r){return wf(n,{file:r,...e||t})}}function jf(e){if(e)throw e}var Qa=Object.prototype.hasOwnProperty,Ey=Object.prototype.toString,kf=Object.defineProperty,Nf=Object.getOwnPropertyDescriptor,Sf=function(t){return typeof Array.isArray=="function"?Array.isArray(t):Ey.call(t)==="[object Array]"},_f=function(t){if(!t||Ey.call(t)!=="[object Object]")return!1;var n=Qa.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&Qa.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;var i;for(i in t);return typeof i>"u"||Qa.call(t,i)},Cf=function(t,n){kf&&n.name==="__proto__"?kf(t,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):t[n.name]=n.newValue},Ef=function(t,n){if(n==="__proto__")if(Qa.call(t,n)){if(Nf)return Nf(t,n).value}else return;return t[n]},$S=function e(){var t,n,r,i,a,o,l=arguments[0],c=1,u=arguments.length,h=!1;for(typeof l=="boolean"&&(h=l,l=arguments[1]||{},c=2),(l==null||typeof l!="object"&&typeof l!="function")&&(l={});c<u;++c)if(t=arguments[c],t!=null)for(n in t)r=Ef(l,n),i=Ef(t,n),l!==i&&(h&&i&&(_f(i)||(a=Sf(i)))?(a?(a=!1,o=r&&Sf(r)?r:[]):o=r&&_f(r)?r:{},Cf(l,{name:n,newValue:e(h,o,i)})):typeof i<"u"&&Cf(l,{name:n,newValue:i}));return l};const Kl=Pu($S);function Nu(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function zS(){const e=[],t={run:n,use:r};return t;function n(...i){let a=-1;const o=i.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);l(null,...i);function l(c,...u){const h=e[++a];let d=-1;if(c){o(c);return}for(;++d<i.length;)(u[d]===null||u[d]===void 0)&&(u[d]=i[d]);i=u,h?BS(h,l)(...u):o(null,...u)}}function r(i){if(typeof i!="function")throw new TypeError("Expected `middelware` to be a function, not "+i);return e.push(i),t}}function BS(e,t){let n;return r;function r(...o){const l=e.length>o.length;let c;l&&o.push(i);try{c=e.apply(this,o)}catch(u){const h=u;if(l&&n)throw h;return i(h)}l||(c&&c.then&&typeof c.then=="function"?c.then(a,i):c instanceof Error?i(c):a(c))}function i(o,...l){n||(n=!0,t(o,...l))}function a(o){i(null,o)}}const Nn={basename:US,dirname:VS,extname:qS,join:GS,sep:"/"};function US(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');ua(e);let n=0,r=-1,i=e.length,a;if(t===void 0||t.length===0||t.length>e.length){for(;i--;)if(e.codePointAt(i)===47){if(a){n=i+1;break}}else r<0&&(a=!0,r=i+1);return r<0?"":e.slice(n,r)}if(t===e)return"";let o=-1,l=t.length-1;for(;i--;)if(e.codePointAt(i)===47){if(a){n=i+1;break}}else o<0&&(a=!0,o=i+1),l>-1&&(e.codePointAt(i)===t.codePointAt(l--)?l<0&&(r=i):(l=-1,r=o));return n===r?r=o:r<0&&(r=e.length),e.slice(n,r)}function VS(e){if(ua(e),e.length===0)return".";let t=-1,n=e.length,r;for(;--n;)if(e.codePointAt(n)===47){if(r){t=n;break}}else r||(r=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function qS(e){ua(e);let t=e.length,n=-1,r=0,i=-1,a=0,o;for(;t--;){const l=e.codePointAt(t);if(l===47){if(o){r=t+1;break}continue}n<0&&(o=!0,n=t+1),l===46?i<0?i=t:a!==1&&(a=1):i>-1&&(a=-1)}return i<0||n<0||a===0||a===1&&i===n-1&&i===r+1?"":e.slice(i,n)}function GS(...e){let t=-1,n;for(;++t<e.length;)ua(e[t]),e[t]&&(n=n===void 0?e[t]:n+"/"+e[t]);return n===void 0?".":HS(n)}function HS(e){ua(e);const t=e.codePointAt(0)===47;let n=WS(e,!t);return n.length===0&&!t&&(n="."),n.length>0&&e.codePointAt(e.length-1)===47&&(n+="/"),t?"/"+n:n}function WS(e,t){let n="",r=0,i=-1,a=0,o=-1,l,c;for(;++o<=e.length;){if(o<e.length)l=e.codePointAt(o);else{if(l===47)break;l=47}if(l===47){if(!(i===o-1||a===1))if(i!==o-1&&a===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(c=n.lastIndexOf("/"),c!==n.length-1){c<0?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),i=o,a=0;continue}}else if(n.length>0){n="",r=0,i=o,a=0;continue}}t&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(i+1,o):n=e.slice(i+1,o),r=o-i-1;i=o,a=0}else l===46&&a>-1?a++:a=-1}return n}function ua(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const YS={cwd:KS};function KS(){return"/"}function Su(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function JS(e){if(typeof e=="string")e=new URL(e);else if(!Su(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return QS(e)}function QS(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const t=e.pathname;let n=-1;for(;++n<t.length;)if(t.codePointAt(n)===37&&t.codePointAt(n+1)===50){const r=t.codePointAt(n+2);if(r===70||r===102){const i=new TypeError("File URL path must not include encoded / characters");throw i.code="ERR_INVALID_FILE_URL_PATH",i}}return decodeURIComponent(t)}const Jl=["history","path","basename","stem","extname","dirname"];class Py{constructor(t){let n;t?Su(t)?n={path:t}:typeof t=="string"||XS(t)?n={value:t}:n=t:n={},this.cwd="cwd"in n?"":YS.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<Jl.length;){const a=Jl[r];a in n&&n[a]!==void 0&&n[a]!==null&&(this[a]=a==="history"?[...n[a]]:n[a])}let i;for(i in n)Jl.includes(i)||(this[i]=n[i])}get basename(){return typeof this.path=="string"?Nn.basename(this.path):void 0}set basename(t){Xl(t,"basename"),Ql(t,"basename"),this.path=Nn.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Nn.dirname(this.path):void 0}set dirname(t){Pf(this.basename,"dirname"),this.path=Nn.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Nn.extname(this.path):void 0}set extname(t){if(Ql(t,"extname"),Pf(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Nn.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){Su(t)&&(t=JS(t)),Xl(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Nn.basename(this.path,this.extname):void 0}set stem(t){Xl(t,"stem"),Ql(t,"stem"),this.path=Nn.join(this.dirname||"",t+(this.extname||""))}fail(t,n,r){const i=this.message(t,n,r);throw i.fatal=!0,i}info(t,n,r){const i=this.message(t,n,r);return i.fatal=void 0,i}message(t,n,r){const i=new kt(t,n,r);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function Ql(e,t){if(e&&e.includes(Nn.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Nn.sep+"`")}function Xl(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function Pf(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function XS(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const ZS=function(e){const r=this.constructor.prototype,i=r[e],a=function(){return i.apply(a,arguments)};return Object.setPrototypeOf(a,r),a},e_={}.hasOwnProperty;class Kd extends ZS{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=zS()}copy(){const t=new Kd;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];t.use(...r)}return t.data(Kl(!0,{},this.namespace)),t}data(t,n){return typeof t=="string"?arguments.length===2?(tc("data",this.frozen),this.namespace[t]=n,this):e_.call(this.namespace,t)&&this.namespace[t]||void 0:t?(tc("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const i=n.call(t,...r);typeof i=="function"&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const n=Oa(t),r=this.parser||this.Parser;return Zl("parse",r),r(String(n),n)}process(t,n){const r=this;return this.freeze(),Zl("process",this.parser||this.Parser),ec("process",this.compiler||this.Compiler),n?i(void 0,n):new Promise(i);function i(a,o){const l=Oa(t),c=r.parse(l);r.run(c,l,function(h,d,f){if(h||!d||!f)return u(h);const m=d,p=r.stringify(m,f);r_(p)?f.value=p:f.result=p,u(h,f)});function u(h,d){h||!d?o(h):a?a(d):n(void 0,d)}}}processSync(t){let n=!1,r;return this.freeze(),Zl("processSync",this.parser||this.Parser),ec("processSync",this.compiler||this.Compiler),this.process(t,i),If("processSync","process",n),r;function i(a,o){n=!0,jf(a),r=o}}run(t,n,r){Tf(t),this.freeze();const i=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?a(void 0,r):new Promise(a);function a(o,l){const c=Oa(n);i.run(t,c,u);function u(h,d,f){const m=d||t;h?l(h):o?o(m):r(void 0,m,f)}}}runSync(t,n){let r=!1,i;return this.run(t,n,a),If("runSync","run",r),i;function a(o,l){jf(o),i=l,r=!0}}stringify(t,n){this.freeze();const r=Oa(n),i=this.compiler||this.Compiler;return ec("stringify",i),Tf(t),i(t,r)}use(t,...n){const r=this.attachers,i=this.namespace;if(tc("use",this.frozen),t!=null)if(typeof t=="function")c(t,n);else if(typeof t=="object")Array.isArray(t)?l(t):o(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function a(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[h,...d]=u;c(h,d)}else o(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function o(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(u.plugins),u.settings&&(i.settings=Kl(!0,i.settings,u.settings))}function l(u){let h=-1;if(u!=null)if(Array.isArray(u))for(;++h<u.length;){const d=u[h];a(d)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,h){let d=-1,f=-1;for(;++d<r.length;)if(r[d][0]===u){f=d;break}if(f===-1)r.push([u,...h]);else if(h.length>0){let[m,...p]=h;const y=r[f][1];Nu(y)&&Nu(m)&&(m=Kl(!0,y,m)),r[f]=[u,m,...p]}}}}const t_=new Kd().freeze();function Zl(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function ec(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function tc(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Tf(e){if(!Nu(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function If(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function Oa(e){return n_(e)?e:new Py(e)}function n_(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function r_(e){return typeof e=="string"||s_(e)}function s_(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const i_="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Mf=[],Af={allowDangerousHtml:!0},a_=/^(https?|ircs?|mailto|xmpp)$/i,o_=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function _s(e){const t=l_(e),n=c_(e);return u_(t.runSync(t.parse(n),n),e)}function l_(e){const t=e.rehypePlugins||Mf,n=e.remarkPlugins||Mf,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...Af}:Af;return t_().use(q2).use(n).use(FS,r).use(t)}function c_(e){const t=e.children||"",n=new Py;return typeof t=="string"&&(n.value=t),n}function u_(e,t){const n=t.allowedElements,r=t.allowElement,i=t.components,a=t.disallowedElements,o=t.skipHtml,l=t.unwrapDisallowed,c=t.urlTransform||d_;for(const h of o_)Object.hasOwn(t,h.from)&&(""+h.from+(h.to?"use `"+h.to+"` instead":"remove it")+i_+h.id,void 0);return Yd(e,u),Ck(e,{Fragment:s.Fragment,components:i,ignoreInvalidStyle:!0,jsx:s.jsx,jsxs:s.jsxs,passKeys:!0,passNode:!0});function u(h,d,f){if(h.type==="raw"&&f&&typeof d=="number")return o?f.children.splice(d,1):f.children[d]={type:"text",value:h.value},d;if(h.type==="element"){let m;for(m in Hl)if(Object.hasOwn(Hl,m)&&Object.hasOwn(h.properties,m)){const p=h.properties[m],y=Hl[m];(y===null||y.includes(h.tagName))&&(h.properties[m]=c(String(p||""),m,h))}}if(h.type==="element"){let m=n?!n.includes(h.tagName):a?a.includes(h.tagName):!1;if(!m&&r&&typeof d=="number"&&(m=!r(h,d,f)),m&&f&&typeof d=="number")return l&&h.children?f.children.splice(d,1,...h.children):f.children.splice(d,1),d}}}function d_(e){const t=e.indexOf(":"),n=e.indexOf("?"),r=e.indexOf("#"),i=e.indexOf("/");return t===-1||i!==-1&&t>i||n!==-1&&t>n||r!==-1&&t>r||a_.test(e.slice(0,t))?e:""}function Lf(e,t){const n=String(e);if(typeof t!="string")throw new TypeError("Expected character");let r=0,i=n.indexOf(t);for(;i!==-1;)r++,i=n.indexOf(t,i+t.length);return r}function h_(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function m_(e,t,n){const i=ll((n||{}).ignore||[]),a=f_(t);let o=-1;for(;++o<a.length;)Cy(e,"text",l);function l(u,h){let d=-1,f;for(;++d<h.length;){const m=h[d],p=f?f.children:void 0;if(i(m,p?p.indexOf(m):void 0,f))return;f=m}if(f)return c(u,h)}function c(u,h){const d=h[h.length-1],f=a[o][0],m=a[o][1];let p=0;const S=d.children.indexOf(u);let g=!1,b=[];f.lastIndex=0;let x=f.exec(u.value);for(;x;){const k=x.index,N={index:x.index,input:x.input,stack:[...h,u]};let w=m(...x,N);if(typeof w=="string"&&(w=w.length>0?{type:"text",value:w}:void 0),w===!1?f.lastIndex=k+1:(p!==k&&b.push({type:"text",value:u.value.slice(p,k)}),Array.isArray(w)?b.push(...w):w&&b.push(w),p=k+x[0].length,g=!0),!f.global)break;x=f.exec(u.value)}return g?(p<u.value.length&&b.push({type:"text",value:u.value.slice(p)}),d.children.splice(S,1,...b)):b=[u],S+b.length}}function f_(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<n.length;){const i=n[r];t.push([p_(i[0]),g_(i[1])])}return t}function p_(e){return typeof e=="string"?new RegExp(h_(e),"g"):e}function g_(e){return typeof e=="function"?e:function(){return e}}const nc="phrasing",rc=["autolink","link","image","label"];function x_(){return{transforms:[N_],enter:{literalAutolink:b_,literalAutolinkEmail:sc,literalAutolinkHttp:sc,literalAutolinkWww:sc},exit:{literalAutolink:k_,literalAutolinkEmail:j_,literalAutolinkHttp:v_,literalAutolinkWww:w_}}}function y_(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:nc,notInConstruct:rc},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:nc,notInConstruct:rc},{character:":",before:"[ps]",after:"\\/",inConstruct:nc,notInConstruct:rc}]}}function b_(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function sc(e){this.config.enter.autolinkProtocol.call(this,e)}function v_(e){this.config.exit.autolinkProtocol.call(this,e)}function w_(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function j_(e){this.config.exit.autolinkEmail.call(this,e)}function k_(e){this.exit(e)}function N_(e){m_(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,S_],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),__]],{ignore:["link","linkReference"]})}function S_(e,t,n,r,i){let a="";if(!Ty(i)||(/^w/i.test(t)&&(n=t+n,t="",a="http://"),!C_(n)))return!1;const o=E_(n+r);if(!o[0])return!1;const l={type:"link",title:null,url:a+t+o[0],children:[{type:"text",value:t+o[0]}]};return o[1]?[l,{type:"text",value:o[1]}]:l}function __(e,t,n,r){return!Ty(r,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function C_(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function E_(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let n=t[0],r=n.indexOf(")");const i=Lf(e,"(");let a=Lf(e,")");for(;r!==-1&&i>a;)e+=n.slice(0,r+1),n=n.slice(r+1),r=n.indexOf(")"),a++;return[e,n]}function Ty(e,t){const n=e.input.charCodeAt(e.index-1);return(e.index===0||qr(n)||il(n))&&(!t||n!==47)}Iy.peek=R_;function P_(){this.buffer()}function T_(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function I_(){this.buffer()}function M_(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function A_(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=gn(this.sliceSerialize(e)).toLowerCase(),n.label=t}function L_(e){this.exit(e)}function D_(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=gn(this.sliceSerialize(e)).toLowerCase(),n.label=t}function O_(e){this.exit(e)}function R_(){return"["}function Iy(e,t,n,r){const i=n.createTracker(r);let a=i.move("[^");const o=n.enter("footnoteReference"),l=n.enter("reference");return a+=i.move(n.safe(n.associationId(e),{after:"]",before:a})),l(),o(),a+=i.move("]"),a}function F_(){return{enter:{gfmFootnoteCallString:P_,gfmFootnoteCall:T_,gfmFootnoteDefinitionLabelString:I_,gfmFootnoteDefinition:M_},exit:{gfmFootnoteCallString:A_,gfmFootnoteCall:L_,gfmFootnoteDefinitionLabelString:D_,gfmFootnoteDefinition:O_}}}function $_(e){let t=!1;return e&&e.firstLineBlank&&(t=!0),{handlers:{footnoteDefinition:n,footnoteReference:Iy},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(r,i,a,o){const l=a.createTracker(o);let c=l.move("[^");const u=a.enter("footnoteDefinition"),h=a.enter("label");return c+=l.move(a.safe(a.associationId(r),{before:c,after:"]"})),h(),c+=l.move("]:"),r.children&&r.children.length>0&&(l.shift(4),c+=l.move((t?`
`:" ")+a.indentLines(a.containerFlow(r,l.current()),t?My:z_))),u(),c}}function z_(e,t,n){return t===0?e:My(e,t,n)}function My(e,t,n){return(n?"":"    ")+e}const B_=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];Ay.peek=H_;function U_(){return{canContainEols:["delete"],enter:{strikethrough:q_},exit:{strikethrough:G_}}}function V_(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:B_}],handlers:{delete:Ay}}}function q_(e){this.enter({type:"delete",children:[]},e)}function G_(e){this.exit(e)}function Ay(e,t,n,r){const i=n.createTracker(r),a=n.enter("strikethrough");let o=i.move("~~");return o+=n.containerPhrasing(e,{...i.current(),before:o,after:"~"}),o+=i.move("~~"),a(),o}function H_(){return"~"}function W_(e){return e.length}function Y_(e,t){const n=t||{},r=(n.align||[]).concat(),i=n.stringLength||W_,a=[],o=[],l=[],c=[];let u=0,h=-1;for(;++h<e.length;){const y=[],S=[];let g=-1;for(e[h].length>u&&(u=e[h].length);++g<e[h].length;){const b=K_(e[h][g]);if(n.alignDelimiters!==!1){const x=i(b);S[g]=x,(c[g]===void 0||x>c[g])&&(c[g]=x)}y.push(b)}o[h]=y,l[h]=S}let d=-1;if(typeof r=="object"&&"length"in r)for(;++d<u;)a[d]=Df(r[d]);else{const y=Df(r);for(;++d<u;)a[d]=y}d=-1;const f=[],m=[];for(;++d<u;){const y=a[d];let S="",g="";y===99?(S=":",g=":"):y===108?S=":":y===114&&(g=":");let b=n.alignDelimiters===!1?1:Math.max(1,c[d]-S.length-g.length);const x=S+"-".repeat(b)+g;n.alignDelimiters!==!1&&(b=S.length+b+g.length,b>c[d]&&(c[d]=b),m[d]=b),f[d]=x}o.splice(1,0,f),l.splice(1,0,m),h=-1;const p=[];for(;++h<o.length;){const y=o[h],S=l[h];d=-1;const g=[];for(;++d<u;){const b=y[d]||"";let x="",k="";if(n.alignDelimiters!==!1){const N=c[d]-(S[d]||0),w=a[d];w===114?x=" ".repeat(N):w===99?N%2?(x=" ".repeat(N/2+.5),k=" ".repeat(N/2-.5)):(x=" ".repeat(N/2),k=x):k=" ".repeat(N)}n.delimiterStart!==!1&&!d&&g.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&b==="")&&(n.delimiterStart!==!1||d)&&g.push(" "),n.alignDelimiters!==!1&&g.push(x),g.push(b),n.alignDelimiters!==!1&&g.push(k),n.padding!==!1&&g.push(" "),(n.delimiterEnd!==!1||d!==u-1)&&g.push("|")}p.push(n.delimiterEnd===!1?g.join("").replace(/ +$/,""):g.join(""))}return p.join(`
`)}function K_(e){return e==null?"":String(e)}function Df(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}function J_(e,t,n,r){const i=n.enter("blockquote"),a=n.createTracker(r);a.move("> "),a.shift(2);const o=n.indentLines(n.containerFlow(e,a.current()),Q_);return i(),o}function Q_(e,t,n){return">"+(n?"":" ")+e}function X_(e,t){return Of(e,t.inConstruct,!0)&&!Of(e,t.notInConstruct,!1)}function Of(e,t,n){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return n;let r=-1;for(;++r<t.length;)if(e.includes(t[r]))return!0;return!1}function Rf(e,t,n,r){let i=-1;for(;++i<n.unsafe.length;)if(n.unsafe[i].character===`
`&&X_(n.stack,n.unsafe[i]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function Z_(e,t){const n=String(e);let r=n.indexOf(t),i=r,a=0,o=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===i?++a>o&&(o=a):a=1,i=r+t.length,r=n.indexOf(t,i);return o}function eC(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function tC(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function nC(e,t,n,r){const i=tC(n),a=e.value||"",o=i==="`"?"GraveAccent":"Tilde";if(eC(e,n)){const d=n.enter("codeIndented"),f=n.indentLines(a,rC);return d(),f}const l=n.createTracker(r),c=i.repeat(Math.max(Z_(a,i)+1,3)),u=n.enter("codeFenced");let h=l.move(c);if(e.lang){const d=n.enter(`codeFencedLang${o}`);h+=l.move(n.safe(e.lang,{before:h,after:" ",encode:["`"],...l.current()})),d()}if(e.lang&&e.meta){const d=n.enter(`codeFencedMeta${o}`);h+=l.move(" "),h+=l.move(n.safe(e.meta,{before:h,after:`
`,encode:["`"],...l.current()})),d()}return h+=l.move(`
`),a&&(h+=l.move(a+`
`)),h+=l.move(c),u(),h}function rC(e,t,n){return(n?"":"    ")+e}function Jd(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function sC(e,t,n,r){const i=Jd(n),a=i==='"'?"Quote":"Apostrophe",o=n.enter("definition");let l=n.enter("label");const c=n.createTracker(r);let u=c.move("[");return u+=c.move(n.safe(n.associationId(e),{before:u,after:"]",...c.current()})),u+=c.move("]: "),l(),!e.url||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),u+=c.move("<"),u+=c.move(n.safe(e.url,{before:u,after:">",...c.current()})),u+=c.move(">")):(l=n.enter("destinationRaw"),u+=c.move(n.safe(e.url,{before:u,after:e.title?" ":`
`,...c.current()}))),l(),e.title&&(l=n.enter(`title${a}`),u+=c.move(" "+i),u+=c.move(n.safe(e.title,{before:u,after:i,...c.current()})),u+=c.move(i),l()),o(),u}function iC(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function Qi(e){return"&#x"+e.toString(16).toUpperCase()+";"}function To(e,t,n){const r=Os(e),i=Os(t);return r===void 0?i===void 0?n==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:i===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?i===void 0?{inside:!1,outside:!1}:i===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:i===void 0?{inside:!1,outside:!1}:i===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}Ly.peek=aC;function Ly(e,t,n,r){const i=iC(n),a=n.enter("emphasis"),o=n.createTracker(r),l=o.move(i);let c=o.move(n.containerPhrasing(e,{after:i,before:l,...o.current()}));const u=c.charCodeAt(0),h=To(r.before.charCodeAt(r.before.length-1),u,i);h.inside&&(c=Qi(u)+c.slice(1));const d=c.charCodeAt(c.length-1),f=To(r.after.charCodeAt(0),d,i);f.inside&&(c=c.slice(0,-1)+Qi(d));const m=o.move(i);return a(),n.attentionEncodeSurroundingInfo={after:f.outside,before:h.outside},l+c+m}function aC(e,t,n){return n.options.emphasis||"*"}function oC(e,t){let n=!1;return Yd(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return n=!0,ju}),!!((!e.depth||e.depth<3)&&Bd(e)&&(t.options.setext||n))}function lC(e,t,n,r){const i=Math.max(Math.min(6,e.depth||1),1),a=n.createTracker(r);if(oC(e,n)){const h=n.enter("headingSetext"),d=n.enter("phrasing"),f=n.containerPhrasing(e,{...a.current(),before:`
`,after:`
`});return d(),h(),f+`
`+(i===1?"=":"-").repeat(f.length-(Math.max(f.lastIndexOf("\r"),f.lastIndexOf(`
`))+1))}const o="#".repeat(i),l=n.enter("headingAtx"),c=n.enter("phrasing");a.move(o+" ");let u=n.containerPhrasing(e,{before:"# ",after:`
`,...a.current()});return/^[\t ]/.test(u)&&(u=Qi(u.charCodeAt(0))+u.slice(1)),u=u?o+" "+u:o,n.options.closeAtx&&(u+=" "+o),c(),l(),u}Dy.peek=cC;function Dy(e){return e.value||""}function cC(){return"<"}Oy.peek=uC;function Oy(e,t,n,r){const i=Jd(n),a=i==='"'?"Quote":"Apostrophe",o=n.enter("image");let l=n.enter("label");const c=n.createTracker(r);let u=c.move("![");return u+=c.move(n.safe(e.alt,{before:u,after:"]",...c.current()})),u+=c.move("]("),l(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),u+=c.move("<"),u+=c.move(n.safe(e.url,{before:u,after:">",...c.current()})),u+=c.move(">")):(l=n.enter("destinationRaw"),u+=c.move(n.safe(e.url,{before:u,after:e.title?" ":")",...c.current()}))),l(),e.title&&(l=n.enter(`title${a}`),u+=c.move(" "+i),u+=c.move(n.safe(e.title,{before:u,after:i,...c.current()})),u+=c.move(i),l()),u+=c.move(")"),o(),u}function uC(){return"!"}Ry.peek=dC;function Ry(e,t,n,r){const i=e.referenceType,a=n.enter("imageReference");let o=n.enter("label");const l=n.createTracker(r);let c=l.move("![");const u=n.safe(e.alt,{before:c,after:"]",...l.current()});c+=l.move(u+"]["),o();const h=n.stack;n.stack=[],o=n.enter("reference");const d=n.safe(n.associationId(e),{before:c,after:"]",...l.current()});return o(),n.stack=h,a(),i==="full"||!u||u!==d?c+=l.move(d+"]"):i==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function dC(){return"!"}Fy.peek=hC;function Fy(e,t,n){let r=e.value||"",i="`",a=-1;for(;new RegExp("(^|[^`])"+i+"([^`]|$)").test(r);)i+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++a<n.unsafe.length;){const o=n.unsafe[a],l=n.compilePattern(o);let c;if(o.atBreak)for(;c=l.exec(r);){let u=c.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(c.index+1)}}return i+r+i}function hC(){return"`"}function $y(e,t){const n=Bd(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}zy.peek=mC;function zy(e,t,n,r){const i=Jd(n),a=i==='"'?"Quote":"Apostrophe",o=n.createTracker(r);let l,c;if($y(e,n)){const h=n.stack;n.stack=[],l=n.enter("autolink");let d=o.move("<");return d+=o.move(n.containerPhrasing(e,{before:d,after:">",...o.current()})),d+=o.move(">"),l(),n.stack=h,d}l=n.enter("link"),c=n.enter("label");let u=o.move("[");return u+=o.move(n.containerPhrasing(e,{before:u,after:"](",...o.current()})),u+=o.move("]("),c(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(c=n.enter("destinationLiteral"),u+=o.move("<"),u+=o.move(n.safe(e.url,{before:u,after:">",...o.current()})),u+=o.move(">")):(c=n.enter("destinationRaw"),u+=o.move(n.safe(e.url,{before:u,after:e.title?" ":")",...o.current()}))),c(),e.title&&(c=n.enter(`title${a}`),u+=o.move(" "+i),u+=o.move(n.safe(e.title,{before:u,after:i,...o.current()})),u+=o.move(i),c()),u+=o.move(")"),l(),u}function mC(e,t,n){return $y(e,n)?"<":"["}By.peek=fC;function By(e,t,n,r){const i=e.referenceType,a=n.enter("linkReference");let o=n.enter("label");const l=n.createTracker(r);let c=l.move("[");const u=n.containerPhrasing(e,{before:c,after:"]",...l.current()});c+=l.move(u+"]["),o();const h=n.stack;n.stack=[],o=n.enter("reference");const d=n.safe(n.associationId(e),{before:c,after:"]",...l.current()});return o(),n.stack=h,a(),i==="full"||!u||u!==d?c+=l.move(d+"]"):i==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function fC(){return"["}function Qd(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function pC(e){const t=Qd(e),n=e.options.bulletOther;if(!n)return t==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+n+"`) to be different");return n}function gC(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function Uy(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function xC(e,t,n,r){const i=n.enter("list"),a=n.bulletCurrent;let o=e.ordered?gC(n):Qd(n);const l=e.ordered?o==="."?")":".":pC(n);let c=t&&n.bulletLastUsed?o===n.bulletLastUsed:!1;if(!e.ordered){const h=e.children?e.children[0]:void 0;if((o==="*"||o==="-")&&h&&(!h.children||!h.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(c=!0),Uy(n)===o&&h){let d=-1;for(;++d<e.children.length;){const f=e.children[d];if(f&&f.type==="listItem"&&f.children&&f.children[0]&&f.children[0].type==="thematicBreak"){c=!0;break}}}}c&&(o=l),n.bulletCurrent=o;const u=n.containerFlow(e,r);return n.bulletLastUsed=o,n.bulletCurrent=a,i(),u}function yC(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function bC(e,t,n,r){const i=yC(n);let a=n.bulletCurrent||Qd(n);t&&t.type==="list"&&t.ordered&&(a=(typeof t.start=="number"&&t.start>-1?t.start:1)+(n.options.incrementListMarker===!1?0:t.children.indexOf(e))+a);let o=a.length+1;(i==="tab"||i==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(o=Math.ceil(o/4)*4);const l=n.createTracker(r);l.move(a+" ".repeat(o-a.length)),l.shift(o);const c=n.enter("listItem"),u=n.indentLines(n.containerFlow(e,l.current()),h);return c(),u;function h(d,f,m){return f?(m?"":" ".repeat(o))+d:(m?a:a+" ".repeat(o-a.length))+d}}function vC(e,t,n,r){const i=n.enter("paragraph"),a=n.enter("phrasing"),o=n.containerPhrasing(e,r);return a(),i(),o}const wC=ll(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function jC(e,t,n,r){return(e.children.some(function(o){return wC(o)})?n.containerPhrasing:n.containerFlow).call(n,e,r)}function kC(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}Vy.peek=NC;function Vy(e,t,n,r){const i=kC(n),a=n.enter("strong"),o=n.createTracker(r),l=o.move(i+i);let c=o.move(n.containerPhrasing(e,{after:i,before:l,...o.current()}));const u=c.charCodeAt(0),h=To(r.before.charCodeAt(r.before.length-1),u,i);h.inside&&(c=Qi(u)+c.slice(1));const d=c.charCodeAt(c.length-1),f=To(r.after.charCodeAt(0),d,i);f.inside&&(c=c.slice(0,-1)+Qi(d));const m=o.move(i+i);return a(),n.attentionEncodeSurroundingInfo={after:f.outside,before:h.outside},l+c+m}function NC(e,t,n){return n.options.strong||"*"}function SC(e,t,n,r){return n.safe(e.value,r)}function _C(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function CC(e,t,n){const r=(Uy(n)+(n.options.ruleSpaces?" ":"")).repeat(_C(n));return n.options.ruleSpaces?r.slice(0,-1):r}const qy={blockquote:J_,break:Rf,code:nC,definition:sC,emphasis:Ly,hardBreak:Rf,heading:lC,html:Dy,image:Oy,imageReference:Ry,inlineCode:Fy,link:zy,linkReference:By,list:xC,listItem:bC,paragraph:vC,root:jC,strong:Vy,text:SC,thematicBreak:CC};function EC(){return{enter:{table:PC,tableData:Ff,tableHeader:Ff,tableRow:IC},exit:{codeText:MC,table:TC,tableData:ic,tableHeader:ic,tableRow:ic}}}function PC(e){const t=e._align;this.enter({type:"table",align:t.map(function(n){return n==="none"?null:n}),children:[]},e),this.data.inTable=!0}function TC(e){this.exit(e),this.data.inTable=void 0}function IC(e){this.enter({type:"tableRow",children:[]},e)}function ic(e){this.exit(e)}function Ff(e){this.enter({type:"tableCell",children:[]},e)}function MC(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,AC));const n=this.stack[this.stack.length-1];n.type,n.value=t,this.exit(e)}function AC(e,t){return t==="|"?t:e}function LC(e){const t=e||{},n=t.tableCellPadding,r=t.tablePipeAlign,i=t.stringLength,a=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:f,table:o,tableCell:c,tableRow:l}};function o(m,p,y,S){return u(h(m,y,S),m.align)}function l(m,p,y,S){const g=d(m,y,S),b=u([g]);return b.slice(0,b.indexOf(`
`))}function c(m,p,y,S){const g=y.enter("tableCell"),b=y.enter("phrasing"),x=y.containerPhrasing(m,{...S,before:a,after:a});return b(),g(),x}function u(m,p){return Y_(m,{align:p,alignDelimiters:r,padding:n,stringLength:i})}function h(m,p,y){const S=m.children;let g=-1;const b=[],x=p.enter("table");for(;++g<S.length;)b[g]=d(S[g],p,y);return x(),b}function d(m,p,y){const S=m.children;let g=-1;const b=[],x=p.enter("tableRow");for(;++g<S.length;)b[g]=c(S[g],m,p,y);return x(),b}function f(m,p,y){let S=qy.inlineCode(m,p,y);return y.stack.includes("tableCell")&&(S=S.replace(/\|/g,"\\$&")),S}}function DC(){return{exit:{taskListCheckValueChecked:$f,taskListCheckValueUnchecked:$f,paragraph:RC}}}function OC(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:FC}}}function $f(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function RC(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const n=this.stack[this.stack.length-1];n.type;const r=n.children[0];if(r&&r.type==="text"){const i=t.children;let a=-1,o;for(;++a<i.length;){const l=i[a];if(l.type==="paragraph"){o=l;break}}o===n&&(r.value=r.value.slice(1),r.value.length===0?n.children.shift():n.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,n.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function FC(e,t,n,r){const i=e.children[0],a=typeof e.checked=="boolean"&&i&&i.type==="paragraph",o="["+(e.checked?"x":" ")+"] ",l=n.createTracker(r);a&&l.move(o);let c=qy.listItem(e,t,n,{...r,...l.current()});return a&&(c=c.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),c;function u(h){return h+o}}function $C(){return[x_(),F_(),U_(),EC(),DC()]}function zC(e){return{extensions:[y_(),$_(e),V_(),LC(e),OC()]}}const BC={tokenize:WC,partial:!0},Gy={tokenize:YC,partial:!0},Hy={tokenize:KC,partial:!0},Wy={tokenize:JC,partial:!0},UC={tokenize:QC,partial:!0},Yy={name:"wwwAutolink",tokenize:GC,previous:Jy},Ky={name:"protocolAutolink",tokenize:HC,previous:Qy},Wn={name:"emailAutolink",tokenize:qC,previous:Xy},Tn={};function VC(){return{text:Tn}}let Cr=48;for(;Cr<123;)Tn[Cr]=Wn,Cr++,Cr===58?Cr=65:Cr===91&&(Cr=97);Tn[43]=Wn;Tn[45]=Wn;Tn[46]=Wn;Tn[95]=Wn;Tn[72]=[Wn,Ky];Tn[104]=[Wn,Ky];Tn[87]=[Wn,Yy];Tn[119]=[Wn,Yy];function qC(e,t,n){const r=this;let i,a;return o;function o(d){return!_u(d)||!Xy.call(r,r.previous)||Xd(r.events)?n(d):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),l(d))}function l(d){return _u(d)?(e.consume(d),l):d===64?(e.consume(d),c):n(d)}function c(d){return d===46?e.check(UC,h,u)(d):d===45||d===95||bt(d)?(a=!0,e.consume(d),c):h(d)}function u(d){return e.consume(d),i=!0,c}function h(d){return a&&i&&_t(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(d)):n(d)}}function GC(e,t,n){const r=this;return i;function i(o){return o!==87&&o!==119||!Jy.call(r,r.previous)||Xd(r.events)?n(o):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(BC,e.attempt(Gy,e.attempt(Hy,a),n),n)(o))}function a(o){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(o)}}function HC(e,t,n){const r=this;let i="",a=!1;return o;function o(d){return(d===72||d===104)&&Qy.call(r,r.previous)&&!Xd(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),i+=String.fromCodePoint(d),e.consume(d),l):n(d)}function l(d){if(_t(d)&&i.length<5)return i+=String.fromCodePoint(d),e.consume(d),l;if(d===58){const f=i.toLowerCase();if(f==="http"||f==="https")return e.consume(d),c}return n(d)}function c(d){return d===47?(e.consume(d),a?u:(a=!0,c)):n(d)}function u(d){return d===null||Co(d)||Re(d)||qr(d)||il(d)?n(d):e.attempt(Gy,e.attempt(Hy,h),n)(d)}function h(d){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(d)}}function WC(e,t,n){let r=0;return i;function i(o){return(o===87||o===119)&&r<3?(r++,e.consume(o),i):o===46&&r===3?(e.consume(o),a):n(o)}function a(o){return o===null?n(o):t(o)}}function YC(e,t,n){let r,i,a;return o;function o(u){return u===46||u===95?e.check(Wy,c,l)(u):u===null||Re(u)||qr(u)||u!==45&&il(u)?c(u):(a=!0,e.consume(u),o)}function l(u){return u===95?r=!0:(i=r,r=void 0),e.consume(u),o}function c(u){return i||r||!a?n(u):t(u)}}function KC(e,t){let n=0,r=0;return i;function i(o){return o===40?(n++,e.consume(o),i):o===41&&r<n?a(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?e.check(Wy,t,a)(o):o===null||Re(o)||qr(o)?t(o):(e.consume(o),i)}function a(o){return o===41&&r++,e.consume(o),i}}function JC(e,t,n){return r;function r(l){return l===33||l===34||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===63||l===95||l===126?(e.consume(l),r):l===38?(e.consume(l),a):l===93?(e.consume(l),i):l===60||l===null||Re(l)||qr(l)?t(l):n(l)}function i(l){return l===null||l===40||l===91||Re(l)||qr(l)?t(l):r(l)}function a(l){return _t(l)?o(l):n(l)}function o(l){return l===59?(e.consume(l),r):_t(l)?(e.consume(l),o):n(l)}}function QC(e,t,n){return r;function r(a){return e.consume(a),i}function i(a){return bt(a)?n(a):t(a)}}function Jy(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||Re(e)}function Qy(e){return!_t(e)}function Xy(e){return!(e===47||_u(e))}function _u(e){return e===43||e===45||e===46||e===95||bt(e)}function Xd(e){let t=e.length,n=!1;for(;t--;){const r=e[t][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){n=!0;break}if(r._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const XC={tokenize:aE,partial:!0};function ZC(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:rE,continuation:{tokenize:sE},exit:iE}},text:{91:{name:"gfmFootnoteCall",tokenize:nE},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:eE,resolveTo:tE}}}}function eE(e,t,n){const r=this;let i=r.events.length;const a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o;for(;i--;){const c=r.events[i][1];if(c.type==="labelImage"){o=c;break}if(c.type==="gfmFootnoteCall"||c.type==="labelLink"||c.type==="label"||c.type==="image"||c.type==="link")break}return l;function l(c){if(!o||!o._balanced)return n(c);const u=gn(r.sliceSerialize({start:o.end,end:r.now()}));return u.codePointAt(0)!==94||!a.includes(u.slice(1))?n(c):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(c),e.exit("gfmFootnoteCallLabelMarker"),t(c))}}function tE(e,t){let n=e.length;for(;n--;)if(e[n][1].type==="labelImage"&&e[n][0]==="enter"){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},i={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};i.end.column++,i.end.offset++,i.end._bufferIndex++;const a={type:"gfmFootnoteCallString",start:Object.assign({},i.end),end:Object.assign({},e[e.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},a.start),end:Object.assign({},a.end)},l=[e[n+1],e[n+2],["enter",r,t],e[n+3],e[n+4],["enter",i,t],["exit",i,t],["enter",a,t],["enter",o,t],["exit",o,t],["exit",a,t],e[e.length-2],e[e.length-1],["exit",r,t]];return e.splice(n,e.length-n+1,...l),e}function nE(e,t,n){const r=this,i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let a=0,o;return l;function l(d){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(d),e.exit("gfmFootnoteCallLabelMarker"),c}function c(d){return d!==94?n(d):(e.enter("gfmFootnoteCallMarker"),e.consume(d),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(d){if(a>999||d===93&&!o||d===null||d===91||Re(d))return n(d);if(d===93){e.exit("chunkString");const f=e.exit("gfmFootnoteCallString");return i.includes(gn(r.sliceSerialize(f)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(d),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(d)}return Re(d)||(o=!0),a++,e.consume(d),d===92?h:u}function h(d){return d===91||d===92||d===93?(e.consume(d),a++,u):u(d)}}function rE(e,t,n){const r=this,i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let a,o=0,l;return c;function c(p){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(p),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(p){return p===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(p),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",h):n(p)}function h(p){if(o>999||p===93&&!l||p===null||p===91||Re(p))return n(p);if(p===93){e.exit("chunkString");const y=e.exit("gfmFootnoteDefinitionLabelString");return a=gn(r.sliceSerialize(y)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(p),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),f}return Re(p)||(l=!0),o++,e.consume(p),p===92?d:h}function d(p){return p===91||p===92||p===93?(e.consume(p),o++,h):h(p)}function f(p){return p===58?(e.enter("definitionMarker"),e.consume(p),e.exit("definitionMarker"),i.includes(a)||i.push(a),Me(e,m,"gfmFootnoteDefinitionWhitespace")):n(p)}function m(p){return t(p)}}function sE(e,t,n){return e.check(ca,t,e.attempt(XC,t,n))}function iE(e){e.exit("gfmFootnoteDefinition")}function aE(e,t,n){const r=this;return Me(e,i,"gfmFootnoteDefinitionIndent",5);function i(a){const o=r.events[r.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?t(a):n(a)}}function oE(e){let n=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:a,resolveAll:i};return n==null&&(n=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function i(o,l){let c=-1;for(;++c<o.length;)if(o[c][0]==="enter"&&o[c][1].type==="strikethroughSequenceTemporary"&&o[c][1]._close){let u=c;for(;u--;)if(o[u][0]==="exit"&&o[u][1].type==="strikethroughSequenceTemporary"&&o[u][1]._open&&o[c][1].end.offset-o[c][1].start.offset===o[u][1].end.offset-o[u][1].start.offset){o[c][1].type="strikethroughSequence",o[u][1].type="strikethroughSequence";const h={type:"strikethrough",start:Object.assign({},o[u][1].start),end:Object.assign({},o[c][1].end)},d={type:"strikethroughText",start:Object.assign({},o[u][1].end),end:Object.assign({},o[c][1].start)},f=[["enter",h,l],["enter",o[u][1],l],["exit",o[u][1],l],["enter",d,l]],m=l.parser.constructs.insideSpan.null;m&&Ht(f,f.length,0,al(m,o.slice(u+1,c),l)),Ht(f,f.length,0,[["exit",d,l],["enter",o[c][1],l],["exit",o[c][1],l],["exit",h,l]]),Ht(o,u-1,c-u+3,f),c=u+f.length-2;break}}for(c=-1;++c<o.length;)o[c][1].type==="strikethroughSequenceTemporary"&&(o[c][1].type="data");return o}function a(o,l,c){const u=this.previous,h=this.events;let d=0;return f;function f(p){return u===126&&h[h.length-1][1].type!=="characterEscape"?c(p):(o.enter("strikethroughSequenceTemporary"),m(p))}function m(p){const y=Os(u);if(p===126)return d>1?c(p):(o.consume(p),d++,m);if(d<2&&!n)return c(p);const S=o.exit("strikethroughSequenceTemporary"),g=Os(p);return S._open=!g||g===2&&!!y,S._close=!y||y===2&&!!g,l(p)}}}class lE{constructor(){this.map=[]}add(t,n,r){cE(this,t,n,r)}consume(t){if(this.map.sort(function(a,o){return a[0]-o[0]}),this.map.length===0)return;let n=this.map.length;const r=[];for(;n>0;)n-=1,r.push(t.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),t.length=this.map[n][0];r.push(t.slice()),t.length=0;let i=r.pop();for(;i;){for(const a of i)t.push(a);i=r.pop()}this.map.length=0}}function cE(e,t,n,r){let i=0;if(!(n===0&&r.length===0)){for(;i<e.map.length;){if(e.map[i][0]===t){e.map[i][1]+=n,e.map[i][2].push(...r);return}i+=1}e.map.push([t,n,r])}}function uE(e,t){let n=!1;const r=[];for(;t<e.length;){const i=e[t];if(n){if(i[0]==="enter")i[1].type==="tableContent"&&r.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(i[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const a=r.length-1;r[a]=r[a]==="left"?"center":"right"}}else if(i[1].type==="tableDelimiterRow")break}else i[0]==="enter"&&i[1].type==="tableDelimiterRow"&&(n=!0);t+=1}return r}function dE(){return{flow:{null:{name:"table",tokenize:hE,resolveAll:mE}}}}function hE(e,t,n){const r=this;let i=0,a=0,o;return l;function l(v){let P=r.events.length-1;for(;P>-1;){const O=r.events[P][1].type;if(O==="lineEnding"||O==="linePrefix")P--;else break}const A=P>-1?r.events[P][1].type:null,L=A==="tableHead"||A==="tableRow"?w:c;return L===w&&r.parser.lazy[r.now().line]?n(v):L(v)}function c(v){return e.enter("tableHead"),e.enter("tableRow"),u(v)}function u(v){return v===124||(o=!0,a+=1),h(v)}function h(v){return v===null?n(v):pe(v)?a>1?(a=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),m):n(v):Pe(v)?Me(e,h,"whitespace")(v):(a+=1,o&&(o=!1,i+=1),v===124?(e.enter("tableCellDivider"),e.consume(v),e.exit("tableCellDivider"),o=!0,h):(e.enter("data"),d(v)))}function d(v){return v===null||v===124||Re(v)?(e.exit("data"),h(v)):(e.consume(v),v===92?f:d)}function f(v){return v===92||v===124?(e.consume(v),d):d(v)}function m(v){return r.interrupt=!1,r.parser.lazy[r.now().line]?n(v):(e.enter("tableDelimiterRow"),o=!1,Pe(v)?Me(e,p,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(v):p(v))}function p(v){return v===45||v===58?S(v):v===124?(o=!0,e.enter("tableCellDivider"),e.consume(v),e.exit("tableCellDivider"),y):N(v)}function y(v){return Pe(v)?Me(e,S,"whitespace")(v):S(v)}function S(v){return v===58?(a+=1,o=!0,e.enter("tableDelimiterMarker"),e.consume(v),e.exit("tableDelimiterMarker"),g):v===45?(a+=1,g(v)):v===null||pe(v)?k(v):N(v)}function g(v){return v===45?(e.enter("tableDelimiterFiller"),b(v)):N(v)}function b(v){return v===45?(e.consume(v),b):v===58?(o=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(v),e.exit("tableDelimiterMarker"),x):(e.exit("tableDelimiterFiller"),x(v))}function x(v){return Pe(v)?Me(e,k,"whitespace")(v):k(v)}function k(v){return v===124?p(v):v===null||pe(v)?!o||i!==a?N(v):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(v)):N(v)}function N(v){return n(v)}function w(v){return e.enter("tableRow"),C(v)}function C(v){return v===124?(e.enter("tableCellDivider"),e.consume(v),e.exit("tableCellDivider"),C):v===null||pe(v)?(e.exit("tableRow"),t(v)):Pe(v)?Me(e,C,"whitespace")(v):(e.enter("data"),T(v))}function T(v){return v===null||v===124||Re(v)?(e.exit("data"),C(v)):(e.consume(v),v===92?I:T)}function I(v){return v===92||v===124?(e.consume(v),T):T(v)}}function mE(e,t){let n=-1,r=!0,i=0,a=[0,0,0,0],o=[0,0,0,0],l=!1,c=0,u,h,d;const f=new lE;for(;++n<e.length;){const m=e[n],p=m[1];m[0]==="enter"?p.type==="tableHead"?(l=!1,c!==0&&(zf(f,t,c,u,h),h=void 0,c=0),u={type:"table",start:Object.assign({},p.start),end:Object.assign({},p.end)},f.add(n,0,[["enter",u,t]])):p.type==="tableRow"||p.type==="tableDelimiterRow"?(r=!0,d=void 0,a=[0,0,0,0],o=[0,n+1,0,0],l&&(l=!1,h={type:"tableBody",start:Object.assign({},p.start),end:Object.assign({},p.end)},f.add(n,0,[["enter",h,t]])),i=p.type==="tableDelimiterRow"?2:h?3:1):i&&(p.type==="data"||p.type==="tableDelimiterMarker"||p.type==="tableDelimiterFiller")?(r=!1,o[2]===0&&(a[1]!==0&&(o[0]=o[1],d=Ra(f,t,a,i,void 0,d),a=[0,0,0,0]),o[2]=n)):p.type==="tableCellDivider"&&(r?r=!1:(a[1]!==0&&(o[0]=o[1],d=Ra(f,t,a,i,void 0,d)),a=o,o=[a[1],n,0,0])):p.type==="tableHead"?(l=!0,c=n):p.type==="tableRow"||p.type==="tableDelimiterRow"?(c=n,a[1]!==0?(o[0]=o[1],d=Ra(f,t,a,i,n,d)):o[1]!==0&&(d=Ra(f,t,o,i,n,d)),i=0):i&&(p.type==="data"||p.type==="tableDelimiterMarker"||p.type==="tableDelimiterFiller")&&(o[3]=n)}for(c!==0&&zf(f,t,c,u,h),f.consume(t.events),n=-1;++n<t.events.length;){const m=t.events[n];m[0]==="enter"&&m[1].type==="table"&&(m[1]._align=uE(t.events,n))}return e}function Ra(e,t,n,r,i,a){const o=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",l="tableContent";n[0]!==0&&(a.end=Object.assign({},as(t.events,n[0])),e.add(n[0],0,[["exit",a,t]]));const c=as(t.events,n[1]);if(a={type:o,start:Object.assign({},c),end:Object.assign({},c)},e.add(n[1],0,[["enter",a,t]]),n[2]!==0){const u=as(t.events,n[2]),h=as(t.events,n[3]),d={type:l,start:Object.assign({},u),end:Object.assign({},h)};if(e.add(n[2],0,[["enter",d,t]]),r!==2){const f=t.events[n[2]],m=t.events[n[3]];if(f[1].end=Object.assign({},m[1].end),f[1].type="chunkText",f[1].contentType="text",n[3]>n[2]+1){const p=n[2]+1,y=n[3]-n[2]-1;e.add(p,y,[])}}e.add(n[3]+1,0,[["exit",d,t]])}return i!==void 0&&(a.end=Object.assign({},as(t.events,i)),e.add(i,0,[["exit",a,t]]),a=void 0),a}function zf(e,t,n,r,i){const a=[],o=as(t.events,n);i&&(i.end=Object.assign({},o),a.push(["exit",i,t])),r.end=Object.assign({},o),a.push(["exit",r,t]),e.add(n+1,0,a)}function as(e,t){const n=e[t],r=n[0]==="enter"?"start":"end";return n[1][r]}const fE={name:"tasklistCheck",tokenize:gE};function pE(){return{text:{91:fE}}}function gE(e,t,n){const r=this;return i;function i(c){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?n(c):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),a)}function a(c){return Re(c)?(e.enter("taskListCheckValueUnchecked"),e.consume(c),e.exit("taskListCheckValueUnchecked"),o):c===88||c===120?(e.enter("taskListCheckValueChecked"),e.consume(c),e.exit("taskListCheckValueChecked"),o):n(c)}function o(c){return c===93?(e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),l):n(c)}function l(c){return pe(c)?t(c):Pe(c)?e.check({tokenize:xE},t,n)(c):n(c)}}function xE(e,t,n){return Me(e,r,"whitespace");function r(i){return i===null?n(i):t(i)}}function yE(e){return ly([VC(),ZC(),oE(e),dE(),pE()])}const bE={};function Cs(e){const t=this,n=e||bE,r=t.data(),i=r.micromarkExtensions||(r.micromarkExtensions=[]),a=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);i.push(yE(n)),a.push($C()),o.push(zC(n))}function Zy(){const[e,t]=j.useState(null),[n,r]=j.useState(!0),[i,a]=j.useState(null),o=async()=>{try{r(!0),a(null);const{data:l,error:c}=await Y.from("version").select("*").order("created_at",{ascending:!1}).limit(1);if(c){if(c.code==="42501"||c.code==="42P01"||c.code==="PGRST116"){console.warn("Version table not accessible, using default version"),t({id:0,ver_number:1,created_at:new Date().toISOString(),ver_notes:"Default version"});return}throw c}!l||l.length===0?(console.warn("No version found in database, using default version"),t({id:0,ver_number:1,created_at:new Date().toISOString(),ver_notes:"Default version"})):t(l[0])}catch(l){console.error("Error fetching version:",l),t({id:0,ver_number:1,created_at:new Date().toISOString(),ver_notes:"Default version"})}finally{r(!1)}};return j.useEffect(()=>{o()},[]),{currentVersion:e,loading:n,error:i,fetchCurrentVersion:o}}function cn(){const{currentVersion:e,loading:t,error:n}=Zy();return s.jsx("footer",{className:"mt-12 pt-8 pb-20 border-t border-border-custom",children:s.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[s.jsx("img",{src:"Battleplan-Logo-Purple.svg",alt:"BattlePlan",className:"h-8"}),t&&s.jsx("span",{className:"text-xs text-secondary-text",children:"Loading version..."}),!t&&e&&s.jsxs("span",{className:"text-xs text-secondary-text",children:["Version ",e.ver_number.toFixed(2)]}),!t&&!e&&s.jsx("span",{className:"text-xs text-secondary-text",children:"Version not available"}),n&&s.jsxs("span",{className:"text-xs text-red-500",children:["Error: ",n]})]})})}function eb({tabs:e,activeTab:t,onTabChange:n,className:r=""}){return s.jsx("div",{className:`flex space-x-1 bg-bg-secondary rounded-lg p-1 ${r}`,children:e.map(i=>{const a=i.icon,o=t===i.id;return s.jsxs("button",{onClick:()=>n(i.id),className:`flex-1 flex items-center justify-center space-x-2 py-2 px-4 rounded-md text-sm font-medium transition-colors ${o?"bg-white text-brand shadow-sm":"text-secondary-text hover:text-text"}`,children:[s.jsx(a,{className:`w-4 h-4 ${o?"text-brand":"text-secondary-text"}`}),s.jsx("span",{children:i.label})]},i.id)})})}function tb({modelId:e,onBack:t,breadcrumbs:n}){var S;const[r,i]=j.useState(null),[a,o]=j.useState(!0),[l,c]=j.useState(null),[u,h]=j.useState(!1),[d,f]=j.useState("details");Md();const m=[{id:"details",label:"Details",icon:mx},{id:"lore",label:"Lore",icon:Zc},{id:"painting",label:"Painting",icon:vi}];j.useEffect(()=>{const g=b=>{const x=b.target;u&&!x.closest(".profile-dropdown")&&h(!1)};return document.addEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)}},[u]),j.useEffect(()=>{p()},[e]);const p=async()=>{try{o(!0),c(null);const{data:g,error:b}=await Y.from("models").select(`
          id,
          name,
          status,
          count,
          image_url,
          notes,
          public,
          lore_name,
          lore_description,
          painting_notes,
          painted_date,
          purchase_date,
          user_id,
          game:games(
            id,
            name,
            icon
          ),
          box:boxes(
            id,
            name,
            purchase_date,
            game:games(id, name, icon, image)
          )
        `).eq("id",e).eq("public",!0).single();if(b){if(b.code==="PGRST116")c("Model not found or not publicly accessible");else throw b;return}const x={...g,game:g.game&&Array.isArray(g.game)?g.game[0]:g.game,box:g.box&&Array.isArray(g.box)?g.box[0]:g.box};if(g.user_id){const{data:k,error:N}=await Y.from("public_usernames").select("id, user_name_public").eq("id",g.user_id).single();!N&&k&&(x.user={id:k.id,username:k.user_name_public})}i(x)}catch(g){c(g instanceof Error?g.message:"Failed to load model")}finally{o(!1)}},y=g=>jt(g,{month:"2-digit",day:"2-digit",year:"2-digit"});return a?s.jsx("div",{className:"min-h-screen bg-bg-secondary",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-8 bg-gray-300 rounded w-1/3 mb-4"}),s.jsx("div",{className:"h-64 bg-gray-300 rounded mb-6"}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4"}),s.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"}),s.jsx("div",{className:"h-4 bg-gray-300 rounded w-2/3"})]})]})})}):l||!r?s.jsx("div",{className:"min-h-screen bg-bg-secondary",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-2xl font-bold text-text mb-4",children:"Model Not Found"}),s.jsx("p",{className:"text-secondary-text mb-6",children:l||"The requested model could not be found."}),s.jsx("button",{onClick:t,className:"bg-[var(--color-brand)] text-white px-6 py-2 rounded-lg hover:bg-[var(--color-brand)]/90 transition-colors",children:"Go Back"})]})})}):s.jsxs("div",{className:"min-h-screen bg-bg-secondary px-[10%] pt-6",children:[t&&s.jsx("div",{className:"bg-[var(--color-brand)] text-white px-4 py-3",children:s.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[s.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-white hover:text-white/80 transition-colors",children:[s.jsx(Tt,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Back"})]}),s.jsx("span",{className:"text-sm font-medium",children:"This is just a preview."}),s.jsx("div",{className:"w-16"})," "]})}),n&&s.jsx("div",{className:"mb-4",children:s.jsxs("nav",{className:"flex items-center space-x-2 text-sm text-secondary-text",children:[s.jsx("a",{href:`/shared/collection/${n.collectionId}`,className:"hover:text-text transition-colors",children:n.collectionName}),s.jsx("span",{children:"/"}),s.jsx("span",{className:"text-text",children:(r==null?void 0:r.name)||"Loading..."})]})}),s.jsxs("main",{children:[r.image_url&&s.jsx("div",{className:"w-full relative",children:s.jsx("img",{src:r.image_url,alt:r.name,className:"w-full max-h-[70vh] object-contain rounded-lg"})}),s.jsxs("div",{className:"max-w-4xl mx-auto py-8",children:[s.jsx("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6 mb-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-3xl font-bold text-title mb-2",children:r.name}),((S=r.user)==null?void 0:S.username)&&s.jsxs("p",{className:"text-secondary-text mb-3",children:["by ",r.user.username]}),r.game&&s.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-3",children:[r.game.icon&&s.jsx("img",{src:r.game.icon,alt:r.game.name,className:"w-6 h-6"}),s.jsx("span",{className:"text-secondary-text",children:r.game.name})]}),s.jsxs("div",{className:"flex items-center justify-center space-x-4 text-sm text-secondary-text",children:[s.jsxs("span",{children:["Status: ",r.status]}),s.jsxs("span",{children:["Count: ",r.count]})]})]})}),s.jsx(eb,{tabs:m,activeTab:d,onTabChange:g=>f(g),className:"mb-6"}),d==="details"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(vn,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("span",{className:"text-base text-text font-medium",children:[r.count," model",r.count!==1?"s":""]})]})}),r.purchase_date&&s.jsx("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Xe,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("span",{className:"text-base text-text font-medium",children:["Purchased ",y(r.purchase_date)]})]})}),r.notes&&s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-title mb-4",children:"Notes"}),s.jsx("div",{className:"prose prose-sm max-w-none text-text",children:s.jsx(_s,{remarkPlugins:[Cs],children:r.notes})})]})]}),d==="lore"&&s.jsxs("div",{className:"space-y-6",children:[r.lore_name&&s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-title mb-4",children:"Lore Name"}),s.jsx("p",{className:"text-text",children:r.lore_name})]}),r.lore_description&&s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-title mb-4",children:"Lore Description"}),s.jsx("div",{className:"prose prose-sm max-w-none text-text",children:s.jsx(_s,{remarkPlugins:[Cs],children:r.lore_description})})]}),!r.lore_name&&!r.lore_description&&s.jsx("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6",children:s.jsxs("div",{className:"text-center text-secondary-text",children:[s.jsx(Zc,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{children:"No lore information available"})]})})]}),d==="painting"&&s.jsxs("div",{className:"space-y-6",children:[r.painted_date&&s.jsx("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(vi,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("span",{className:"text-base text-text font-medium",children:["Painted ",y(r.painted_date)]})]})}),r.painting_notes&&s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-title mb-4",children:"Painting Information"}),s.jsx("div",{className:"prose prose-sm max-w-none text-text",children:s.jsx(_s,{remarkPlugins:[Cs],children:r.painting_notes})})]}),!r.painted_date&&!r.painting_notes&&s.jsx("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6",children:s.jsxs("div",{className:"text-center text-secondary-text",children:[s.jsx(vi,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{children:"No painting information available"})]})})]}),s.jsx(cn,{})]})]})]})}function nb({collectionId:e,onBack:t}){var k,N,w,C,T;const[n,r]=j.useState(null),[i,a]=j.useState([]),[o,l]=j.useState(!0),[c,u]=j.useState(null),[h,d]=j.useState(!1),[f,m]=j.useState(!1);Md(),j.useEffect(()=>{const I=v=>{const P=v.target;f&&!P.closest(".profile-dropdown")&&m(!1)};return document.addEventListener("mousedown",I),()=>{document.removeEventListener("mousedown",I)}},[f]),j.useEffect(()=>{p()},[e]);const p=async()=>{try{l(!0),u(null);const{data:I,error:v}=await Y.from("boxes").select(`
          id,
          name,
          purchase_date,
          image_url,
          public,
          user_id,
          game:games(
            id,
            name,
            icon,
            image
          )
        `).eq("id",e).eq("public",!0).single();if(v){if(v.code==="PGRST116")d(!0);else throw v;return}if(I.user_id){const{data:L,error:O}=await Y.from("public_usernames").select("id, user_name_public").eq("id",I.user_id).single();!O&&L&&(I.user={id:L.id,username:L.user_name_public})}r(I);const{data:P,error:A}=await Y.from("models").select(`
          id,
          name,
          status,
          count,
          image_url,
          notes,
          game:games(
            id,
            name,
            icon
          )
        `).eq("box_id",e).order("created_at",{ascending:!1});if(A)throw A;a(P||[])}catch(I){u(I instanceof Error?I.message:"Failed to load collection")}finally{l(!1)}},y=I=>jt(I,{month:"2-digit",day:"2-digit",year:"2-digit"}),S=()=>{var v;if(!n)return"";if(n.image_url&&typeof n.image_url=="string"&&n.image_url.trim()!==""&&n.image_url!=="undefined"&&n.image_url!=="null"&&(n.image_url.startsWith("http")||n.image_url.startsWith("/")))return n.image_url;const I=(v=n.game)==null?void 0:v.image;return I&&typeof I=="string"&&I.trim()!==""&&I!=="undefined"&&I!=="null"&&I.startsWith("http")?I:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"},g=I=>{var P;if(I.image_url&&typeof I.image_url=="string"&&I.image_url.trim()!==""&&I.image_url!=="undefined"&&I.image_url!=="null"&&(I.image_url.startsWith("http")||I.image_url.startsWith("/")))return{src:I.image_url,isGameFallback:!1};const v=(P=I.game)==null?void 0:P.icon;return v&&typeof v=="string"&&v.trim()!==""&&v!=="undefined"&&v!=="null"&&v.startsWith("http")?{src:v,isGameFallback:!0}:{src:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg",isGameFallback:!1}},b=I=>{switch(I){case"Painted":return"bg-green-100 text-green-800";case"Partially Painted":return"bg-yellow-100 text-yellow-800";case"Primed":return"bg-blue-100 text-blue-800";case"Assembled":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},x=()=>{window.history.back()};return o?s.jsx("div",{className:"min-h-screen bg-bg-primary",children:s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),s.jsx("div",{className:"h-64 bg-gray-200 rounded mb-8"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})]})})}):h||c?s.jsx("div",{className:"min-h-screen bg-bg-primary flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Nd,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h1",{className:"text-2xl font-bold text-title mb-2",children:h?"Collection Not Found":"Error Loading Collection"}),s.jsx("p",{className:"text-secondary-text mb-6",children:h?"This collection may be private or no longer exists.":c||"Something went wrong while loading the collection."}),s.jsx("button",{onClick:t||x,className:"btn-secondary",children:s.jsx("span",{children:"Go Back"})})]})}):n?s.jsxs("div",{className:"min-h-screen bg-bg-primary px-[10%] pt-6",children:[t?s.jsx(s.Fragment,{children:s.jsx("div",{className:"bg-[var(--color-brand)] text-white px-4 py-3",children:s.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[s.jsxs("button",{onClick:t,className:"flex items-center space-x-2 text-white hover:text-white/80 transition-colors",children:[s.jsx(Tt,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Back"})]}),s.jsx("span",{className:"text-sm font-medium",children:"This is just a preview."}),s.jsx("div",{className:"w-16"})," "]})})}):null,s.jsx("div",{className:"w-full relative",children:s.jsx("img",{src:S(),alt:n.name,className:"w-full max-h-[70vh] object-contain rounded-lg",loading:"lazy",onError:I=>{const v=I.target,P="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg";v.src!==P&&(v.src=P)}})}),s.jsxs("div",{className:"max-w-4xl mx-auto py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-title mb-4 text-center",children:n.name}),((k=n.user)==null?void 0:k.username)&&s.jsxs("p",{className:"text-secondary-text text-center",children:["by ",n.user.username]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[s.jsx("div",{className:"bg-bg-card rounded-lg p-6 border border-border-custom",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[(N=n.game)!=null&&N.icon?s.jsx("img",{src:n.game.icon,alt:`${n.game.name} icon`,className:"w-12 h-12 object-cover rounded",onError:I=>{const v=I.target;v.style.display="none";const P=v.nextElementSibling;P&&P.classList.contains("icon-fallback")&&(P.style.display="flex")},onLoad:I=>{const P=I.target.nextElementSibling;P&&P.classList.contains("icon-fallback")&&(P.style.display="none")}}):null,s.jsx("div",{className:"w-12 h-12 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:(w=n.game)!=null&&w.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-sm font-bold",children:(((C=n.game)==null?void 0:C.name)||"Unknown Game").charAt(0)})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-text",children:"Game"}),s.jsx("p",{className:"text-secondary-text",children:((T=n.game)==null?void 0:T.name)||"Unknown Game"})]})]})}),n.purchase_date&&s.jsx("div",{className:"bg-bg-card rounded-lg p-6 border border-border-custom",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Xe,{className:"w-6 h-6 text-secondary-text"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-text",children:"Purchase Date"}),s.jsx("p",{className:"text-secondary-text",children:y(n.purchase_date)})]})]})})]}),s.jsxs("div",{className:"bg-bg-card rounded-lg border border-border-custom overflow-hidden",children:[s.jsx("div",{className:"p-6 border-b border-border-custom",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Wi,{className:"w-6 h-6 text-secondary-text"}),s.jsxs("h2",{className:"text-xl font-bold text-title",children:["Models (",i.length,")"]})]})}),i.length===0?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx(vn,{className:"w-12 h-12 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"No models in this collection."})]}):s.jsx("div",{className:"divide-y divide-border-custom",children:i.map(I=>s.jsx("div",{className:"p-6 hover:bg-bg-secondary transition-colors cursor-pointer",onClick:()=>{const v=new URLSearchParams({from:e,collectionName:encodeURIComponent((n==null?void 0:n.name)||"")});window.location.href=`/shared/model/${I.id}?${v.toString()}`},children:s.jsxs("div",{className:"flex items-start space-x-4",children:[s.jsx("div",{className:"flex-shrink-0",children:(()=>{const v=g(I);return s.jsx("img",{src:v.src,alt:I.name,className:`w-16 h-16 object-cover rounded ${v.isGameFallback?"opacity-10":""}`,onError:P=>{const A=P.target;A.src="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"}})})()}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-text mb-2",children:I.name}),s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-secondary-text mb-2",children:[I.count&&s.jsxs("span",{children:[I.count," model",I.count!==1?"s":""]}),I.status&&I.status!=="None"&&s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b(I.status)}`,children:I.status})]}),I.notes&&s.jsx("div",{className:"text-sm text-secondary-text",children:s.jsx(_s,{remarkPlugins:[Cs],className:"prose prose-sm max-w-none",components:{p:({children:v})=>s.jsx("p",{className:"mb-1 last:mb-0 text-sm text-secondary-text",children:v}),h1:({children:v})=>s.jsx("h1",{className:"text-sm font-bold mb-1 text-secondary-text",children:v}),h2:({children:v})=>s.jsx("h2",{className:"text-sm font-bold mb-1 text-secondary-text",children:v}),h3:({children:v})=>s.jsx("h3",{className:"text-xs font-bold mb-1 text-secondary-text",children:v}),ul:({children:v})=>s.jsx("ul",{className:"list-disc list-inside mb-1 space-y-0.5",children:v}),ol:({children:v})=>s.jsx("ol",{className:"list-decimal list-inside mb-1 space-y-0.5",children:v}),li:({children:v})=>s.jsx("li",{className:"text-sm text-secondary-text",children:v}),strong:({children:v})=>s.jsx("strong",{className:"font-semibold text-secondary-text",children:v}),em:({children:v})=>s.jsx("em",{className:"italic text-secondary-text",children:v}),code:({children:v})=>s.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 py-0.5 rounded text-xs font-mono",children:v}),pre:({children:v})=>s.jsx("pre",{className:"bg-gray-100 dark:bg-gray-800 p-1 rounded text-xs font-mono overflow-x-auto mb-1",children:v}),blockquote:({children:v})=>s.jsx("blockquote",{className:"border-l-2 border-gray-300 dark:border-gray-600 pl-2 italic mb-1 text-secondary-text",children:v})},children:I.notes})})]})]})},I.id))})]}),s.jsx(cn,{})]})]}):null}function vE({onBack:e}){const[t,n]=j.useState("model"),[r,i]=j.useState(""),[a,o]=j.useState(""),[l,c]=j.useState("selection"),{models:u,loading:h}=Hx(),{boxes:d,loading:f}=Wx();Ge();const m=u.find(b=>b.id===r),p=d.find(b=>b.id===a),y=()=>{c(t==="model"?"model-preview":"collection-preview")},S=()=>{c("selection")},g=()=>t==="model"?!r:!a;return l==="model-preview"&&r?s.jsx(tb,{modelId:r,onBack:S}):l==="collection-preview"&&a?s.jsx(nb,{collectionId:a,onBack:S}):s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(Tt,{className:"w-5 h-5"}),s.jsx("span",{children:"Back to Admin Panel"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title",children:"Share Preview"}),s.jsx("p",{className:"text-secondary-text mt-2",children:"Select a model or collection to preview its share page"})]}),s.jsx("div",{className:"max-w-2xl",children:s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6",children:[s.jsxs("div",{className:"flex space-x-1 bg-bg-secondary rounded-lg p-1 mb-6",children:[s.jsxs("button",{onClick:()=>{n("model"),i(""),o("")},className:`flex-1 flex items-center justify-center space-x-2 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="model"?"bg-white text-text shadow-sm":"text-secondary-text hover:text-text"}`,children:[s.jsx(fx,{className:"w-4 h-4"}),s.jsx("span",{children:"Model"})]}),s.jsxs("button",{onClick:()=>{n("collection"),i(""),o("")},className:`flex-1 flex items-center justify-center space-x-2 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="collection"?"bg-white text-text shadow-sm":"text-secondary-text hover:text-text"}`,children:[s.jsx(vn,{className:"w-4 h-4"}),s.jsx("span",{children:"Collection"})]})]}),s.jsxs("div",{className:"space-y-6",children:[t==="model"&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"model-select",className:"block text-sm font-medium text-text mb-2",children:"Select Model"}),s.jsxs("select",{id:"model-select",value:r,onChange:b=>i(b.target.value),className:"w-full bg-bg-secondary border border-border-custom rounded-lg px-4 py-3 text-text focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)] focus:border-transparent",disabled:h,children:[s.jsx("option",{value:"",children:"Choose a model..."}),u.map(b=>s.jsxs("option",{value:b.id,children:[b.name," ",b.game&&`(${b.game.name})`]},b.id))]}),h&&s.jsx("p",{className:"text-sm text-secondary-text mt-2",children:"Loading models..."})]}),t==="collection"&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"collection-select",className:"block text-sm font-medium text-text mb-2",children:"Select Collection"}),s.jsxs("select",{id:"collection-select",value:a,onChange:b=>o(b.target.value),className:"w-full bg-bg-secondary border border-border-custom rounded-lg px-4 py-3 text-text focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)] focus:border-transparent",disabled:f,children:[s.jsx("option",{value:"",children:"Choose a collection..."}),d.map(b=>s.jsxs("option",{value:b.id,children:[b.name," ",b.game&&`(${b.game.name})`]},b.id))]}),f&&s.jsx("p",{className:"text-sm text-secondary-text mt-2",children:"Loading collections..."})]}),t==="model"&&m&&s.jsxs("div",{className:"bg-bg-secondary border border-border-custom rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold text-text mb-2",children:"Selected Model"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[m.image_url&&s.jsx("img",{src:m.image_url,alt:m.name,className:"w-16 h-16 object-cover rounded-lg"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-text",children:m.name}),m.game&&s.jsx("p",{className:"text-sm text-secondary-text",children:m.game.name}),s.jsxs("p",{className:"text-sm text-secondary-text",children:["Count: ",m.count]})]})]})]}),t==="collection"&&p&&s.jsxs("div",{className:"bg-bg-secondary border border-border-custom rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold text-text mb-2",children:"Selected Collection"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[p.image_url&&s.jsx("img",{src:p.image_url,alt:p.name,className:"w-16 h-16 object-cover rounded-lg"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-text",children:p.name}),p.game&&s.jsx("p",{className:"text-sm text-secondary-text",children:p.game.name}),s.jsxs("p",{className:"text-sm text-secondary-text",children:["Purchase Date: ",jt(p.purchase_date)]}),s.jsxs("p",{className:"text-sm text-secondary-text",children:["Public: ",p.public?"Yes":"No"]})]})]})]}),s.jsx("div",{className:"pt-4",children:s.jsxs("button",{onClick:y,disabled:g(),className:`w-full flex items-center justify-center space-x-2 px-6 py-3 rounded-lg font-medium transition-all ${g()?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-[var(--color-brand)] text-white hover:bg-[var(--color-brand)]/90 shadow-lg hover:shadow-xl"}`,children:[s.jsx(tu,{className:"w-5 h-5"}),s.jsx("span",{children:"Preview"})]})})]})]})})]})}function wE(e){console.log("parseCSVToObjects called with text length:",e.length);const t=e.split(`
`).filter(a=>a.trim());if(console.log("Filtered lines:",t.length),t.length===0)return console.log("No lines found, returning empty array"),[];console.log("First line (headers):",t[0]);const n=Bf(t[0]).map(a=>a.toLowerCase().trim());console.log("Parsed headers:",n);const r=t.slice(1);console.log("Data rows count:",r.length);const i=r.map((a,o)=>{console.log(`Parsing data row ${o+1}:`,a);const l=Bf(a);console.log(`Row ${o+1} values:`,l);const c={};return n.forEach((u,h)=>{c[u]=l[h]||""}),console.log(`Row ${o+1} object:`,c),c});return console.log("Final result:",i),i}function Bf(e){console.log("parseCSVLine called with:",e);const t=[];let n="",r=!1;for(let a=0;a<e.length;a++){const o=e[a];o==='"'?r=!r:o===","&&!r?(t.push(n.trim()),n=""):n+=o}t.push(n.trim());const i=t.map(a=>a.replace(/^"|"$/g,""));return console.log("parseCSVLine result:",i),i}function jE(e,t){if(e.length<2)return{isValid:!1,error:"CSV must have at least a header row and one data row"};const n=e[0].map(r=>r.toLowerCase().trim());if(t==="models"){const i=["name","status","count","game_name"].filter(a=>!n.includes(a));if(i.length>0)return{isValid:!1,error:`Missing required headers: ${i.join(", ")}`}}else{const i=["name","game_name"].filter(a=>!n.includes(a));if(i.length>0)return{isValid:!1,error:`Missing required headers: ${i.join(", ")}`}}return{isValid:!0,error:null}}function kE(e){var r,i,a,o;if(!((r=e.name)!=null&&r.trim()))return{isValid:!1,error:"Name is required"};if(!((i=e.status)!=null&&i.trim()))return{isValid:!1,error:"Status is required"};if(!((a=e.count)!=null&&a.trim()))return{isValid:!1,error:"Count is required"};if(!((o=e.game_name)!=null&&o.trim()))return{isValid:!1,error:"Game name is required"};const t=["None","Assembled","Primed","Partially Painted","Painted"];if(!t.includes(e.status))return{isValid:!1,error:`Invalid status. Must be one of: ${t.join(", ")}`};const n=parseInt(e.count);return isNaN(n)||n<1?{isValid:!1,error:"Count must be a positive number"}:e.purchase_date&&!Cu(e.purchase_date)?{isValid:!1,error:"Invalid purchase date format (use YYYY-MM-DD)"}:e.painted_date&&!Cu(e.painted_date)?{isValid:!1,error:"Invalid painted date format (use YYYY-MM-DD)"}:{isValid:!0,error:null}}function NE(e){var t,n;return(t=e.name)!=null&&t.trim()?(n=e.game_name)!=null&&n.trim()?e.purchase_date&&!Cu(e.purchase_date)?{isValid:!1,error:"Invalid purchase date format (use YYYY-MM-DD)"}:{isValid:!0,error:null}:{isValid:!1,error:"Game name is required"}:{isValid:!1,error:"Name is required"}}function Cu(e){const t=new Date(e);return t instanceof Date&&!isNaN(t.getTime())&&e.match(/^\d{4}-\d{2}-\d{2}$/)}function Uf(e){return e.toLowerCase()==="true"}function Er(e){return e.trim().replace(/[<>]/g,"")}function SE({isOpen:e,onClose:t,onConfirm:n,csvHeaders:r,uploadType:i}){const[a,o]=j.useState({}),c=i==="models"?[{key:"name",label:"Name",required:!0},{key:"status",label:"Status",required:!0},{key:"count",label:"Count",required:!0},{key:"game_name",label:"Game Name",required:!0},{key:"box_name",label:"Box Name",required:!1},{key:"notes",label:"Notes",required:!1},{key:"purchase_date",label:"Purchase Date",required:!1},{key:"painted_date",label:"Painted Date",required:!1},{key:"public",label:"Public",required:!1}]:[{key:"name",label:"Name",required:!0},{key:"game_name",label:"Game Name",required:!0},{key:"purchase_date",label:"Purchase Date",required:!1},{key:"public",label:"Public",required:!1}],u=(f,m)=>{o(p=>({...p,[f]:m}))},h=()=>{const f=c.filter(m=>m.required).filter(m=>!a[m.key]);if(f.length>0){alert(`Please map all required properties: ${f.map(m=>m.label).join(", ")}`);return}n(a)},d=()=>{o({})};return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"bg-bg-card border border-border-custom rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-title",children:"Map CSV Columns"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-secondary-text",children:"Map your CSV columns to the required properties. Required fields are marked with an asterisk (*)."}),s.jsx("div",{className:"space-y-4",children:c.map(f=>s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("label",{className:"flex-1 text-text font-medium",children:[f.label,f.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),s.jsxs("select",{value:a[f.key]||"",onChange:m=>u(f.key,m.target.value),className:"flex-1 bg-bg-secondary border border-border-custom rounded-lg px-3 py-2 text-text focus:outline-none focus:ring-2 focus:ring-brand",children:[s.jsx("option",{value:"",children:"Select a column..."}),r.map(m=>s.jsx("option",{value:m,children:m},m))]})]},f.key))}),s.jsxs("div",{className:"flex space-x-3 pt-4",children:[s.jsx("button",{onClick:h,className:"flex-1 bg-brand text-white px-4 py-2 rounded-lg hover:bg-brand/90 transition-colors",children:"Confirm Mapping"}),s.jsx("button",{onClick:d,className:"px-4 py-2 bg-bg-secondary text-text rounded-lg border border-border-custom hover:bg-bg-card transition-colors",children:"Reset"}),s.jsx("button",{onClick:t,className:"px-4 py-2 bg-bg-secondary text-text rounded-lg border border-border-custom hover:bg-bg-card transition-colors",children:"Cancel"})]})]})]})})}):null}function _E({onBack:e}){console.log("=== CSVUploadPage rendering ==="),console.log("onBack function:",e);const[t,n]=j.useState("models"),[r,i]=j.useState(null),[a,o]=j.useState({isUploading:!1,progress:0,successCount:0,errorCount:0,errors:[]}),[l,c]=j.useState(null),u=j.useRef(null),{user:h}=Ge(),[d,f]=j.useState(!1),[m,p]=j.useState([]),[y,S]=j.useState([]),[g,b]=j.useState({});console.log("CSVUploadPage user:",h),console.log("CSVUploadPage user is_admin:",h==null?void 0:h.is_admin);const x=L=>{var U;console.log("handleFileSelect called",L.target.files);const O=(U=L.target.files)==null?void 0:U[0];if(!O){console.log("No file selected");return}if(console.log("File selected:",O.name,O.size,O.type),!O.name.toLowerCase().endsWith(".csv")){console.log("Invalid file type:",O.name),c("Please select a valid CSV file");return}const M=5*1024*1024;if(O.size>M){console.log("File too large:",O.size,"bytes"),c("File size must be 5MB or less");return}console.log("File validation passed, setting selected file"),i(O),c(null)},k=async()=>{if(console.log("handleUpload called"),console.log("selectedFile:",r),console.log("user:",h),!r||!h){console.log("Missing file or user, returning early");return}console.log("Starting upload process..."),o({isUploading:!0,progress:0,successCount:0,errorCount:0,errors:[]});try{console.log("Reading file text...");const L=await r.text();console.log("File text length:",L.length),console.log("File text preview:",L.substring(0,200)),console.log("Parsing CSV...");const O=wE(L);if(console.log("Parsed CSV rows:",O.length),console.log("First row:",O[0]),O.length===0)throw new Error("CSV file is empty");const M=Object.keys(O[0]);if(console.log("CSV headers:",M),p(M),S(O),(t==="models"?["name","status","count","game_name"]:["name","game_name"]).filter(F=>!M.includes(F)).length>0){console.log("Missing headers, showing column mapping modal"),f(!0),o({isUploading:!1,progress:0,successCount:0,errorCount:0,errors:[]});return}await w(O,{})}catch(L){console.error("Upload error:",L),o({isUploading:!1,progress:0,successCount:0,errorCount:0,errors:[L instanceof Error?L.message:"Upload failed"]})}},N=async L=>{console.log("Column mapping confirmed:",L),b(L),f(!1);const O=y.map(M=>{const U={};return Object.entries(L).forEach(([H,F])=>{F&&M[F]!==void 0&&(U[H]=M[F])}),U});console.log("Transformed rows:",O),await w(O,L)},w=async(L,O)=>{console.log("Processing uploaded data with mapping:",O),o({isUploading:!0,progress:0,successCount:0,errorCount:0,errors:[]});try{const M=[Object.keys(L[0]),...L.map(F=>Object.values(F))];console.log("Converted to array format for validation"),console.log("Validating CSV structure...");const U=jE(M,t);if(console.log("Validation result:",U),!U.isValid)throw new Error(`Invalid CSV structure: ${U.error}`);console.log("Processing CSV data...");const H=await C(L,t,h.id);console.log("Processing result:",H),o({isUploading:!1,progress:100,successCount:H.successCount,errorCount:H.errorCount,errors:H.errors})}catch(M){console.error("Processing error:",M),o({isUploading:!1,progress:0,successCount:0,errorCount:0,errors:[M instanceof Error?M.message:"Processing failed"]})}},C=async(L,O,M)=>{console.log("processCSVData called with:",{csvRows:L.length,type:O,userId:M});let U=0,H=0;const F=[];for(let B=0;B<L.length;B++){const _=L[B],z=B+2;console.log(`Processing row ${z}:`,_);try{O==="models"?(console.log("Processing as model row"),await T(_,M,z)):(console.log("Processing as collection row"),await I(_,M,z)),U++,console.log(`Row ${z} processed successfully`)}catch(q){console.error(`Error processing row ${z}:`,q),H++,F.push(`Row ${z}: ${q instanceof Error?q.message:"Unknown error"}`)}o(q=>({...q,progress:Math.round((B+1)/L.length*100)}))}return console.log("Processing complete:",{successCount:U,errorCount:H,errors:F}),{successCount:U,errorCount:H,errors:F}},T=async(L,O,M)=>{console.log("processModelRow called with:",{row:L,userId:O}),console.log("Validating model data...");const U=kE(L);if(console.log("Validation result:",U),!U.isValid)throw new Error(U.error||"Validation failed");const H=Er(L.name||""),F=Er(L.status||""),B=parseInt(L.count||"0"),_=Er(L.game_name||""),z=Er(L.box_name||""),q=Er(L.notes||""),E=L.purchase_date||null,K=L.painted_date||null,G=Uf(L.public||"false");console.log("Processed values:",{name:H,status:F,count:B,gameName:_,boxName:z,notes:q,purchaseDate:E,paintedDate:K,isPublic:G}),console.log("Getting or creating game:",_);const W=await v(_);console.log("Game ID:",W);let le=null;z&&(console.log("Getting or creating box:",z),le=await P(z,W,O),console.log("Box ID:",le)),console.log("Creating model in database...");const{error:se}=await Y.from("models").insert({name:H,status:F,count:B,game_id:W,box_id:le,user_id:O,notes:q||null,purchase_date:E,painted_date:K,public:G});if(se)throw console.error("Database error:",se),new Error(`Database error: ${se.message}`);console.log("Model created successfully")},I=async(L,O,M)=>{const U=NE(L);if(!U.isValid)throw new Error(U.error||"Validation failed");const H=Er(L.name||""),F=Er(L.game_name||""),B=L.purchase_date||null,_=Uf(L.public||"false"),z=await v(F),{error:q}=await Y.from("boxes").insert({name:H,game_id:z,user_id:O,purchase_date:B,public:_});if(q)throw new Error(`Database error: ${q.message}`)},v=async L=>{console.log("getOrCreateGame called with:",L),console.log("Looking for existing game...");const{data:O,error:M}=await Y.from("games").select("id").eq("name",L).single();if(M&&M.code!=="PGRST116")throw console.error("Error finding game:",M),new Error(`Failed to find game: ${M.message}`);if(O)return console.log("Found existing game:",O.id),O.id;console.log("Creating new game...");const{data:U,error:H}=await Y.from("games").insert({name:L}).select("id").single();if(H)throw console.error("Error creating game:",H),new Error(`Failed to create game: ${H.message}`);return console.log("Created new game:",U.id),U.id},P=async(L,O,M)=>{console.log("getOrCreateBox called with:",{boxName:L,gameId:O,userId:M}),console.log("Looking for existing box...");const{data:U,error:H}=await Y.from("boxes").select("id").eq("name",L).eq("user_id",M).single();if(H&&H.code!=="PGRST116")throw console.error("Error finding box:",H),new Error(`Failed to find box: ${H.message}`);if(U)return console.log("Found existing box:",U.id),U.id;console.log("Creating new box...");const{data:F,error:B}=await Y.from("boxes").insert({name:L,game_id:O,user_id:M}).select("id").single();if(B)throw console.error("Error creating box:",B),new Error(`Failed to create box: ${B.message}`);return console.log("Created new box:",F.id),F.id},A=()=>{i(null),c(null),o({isUploading:!1,progress:0,successCount:0,errorCount:0,errors:[]}),f(!1),p([]),S([]),b({}),u.current&&(u.current.value="")};return s.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(Tt,{className:"w-5 h-5"}),s.jsx("span",{children:"Back to Admin"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title",children:"CSV UPLOAD"}),s.jsx("p",{className:"text-secondary-text mt-2",children:"Upload CSV files to bulk import models and collections"})]}),s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6 mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-text mb-4",children:"Upload Type"}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("button",{onClick:()=>n("models"),className:`px-4 py-2 rounded-lg border transition-colors ${t==="models"?"bg-brand text-white border-brand":"bg-bg-secondary text-text border-border-custom hover:bg-bg-card"}`,children:"Models"}),s.jsx("button",{onClick:()=>n("collections"),className:`px-4 py-2 rounded-lg border transition-colors ${t==="collections"?"bg-brand text-white border-brand":"bg-bg-secondary text-text border-border-custom hover:bg-bg-card"}`,children:"Collections"})]})]}),s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6 mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-text mb-4",children:"CSV Format"}),s.jsx("div",{className:"space-y-4",children:t==="models"?s.jsxs("div",{children:[s.jsx("p",{className:"text-secondary-text mb-2",children:"Required columns for models:"}),s.jsx("div",{className:"bg-bg-secondary rounded p-3 font-mono text-sm",children:"name,status,count,game_name,box_name,notes,purchase_date,painted_date,public"}),s.jsx("p",{className:"text-sm text-secondary-text mt-2",children:"Status must be: None, Assembled, Primed, Partially Painted, or Painted"}),s.jsxs("p",{className:"text-sm text-secondary-text mt-2",children:[s.jsx("strong",{children:"Note:"})," If your CSV headers don't match exactly, you'll be able to map them after upload."]}),s.jsxs("div",{className:"mt-4 space-y-2",children:[s.jsx("div",{children:s.jsx("a",{href:"/sample-models.csv",download:!0,className:"text-brand hover:text-brand/80 transition-colors text-sm",children:"Download sample models CSV (standard headers)"})}),s.jsx("div",{children:s.jsx("a",{href:"/sample-models-custom-headers.csv",download:!0,className:"text-brand hover:text-brand/80 transition-colors text-sm",children:"Download sample models CSV (custom headers - requires mapping)"})})]})]}):s.jsxs("div",{children:[s.jsx("p",{className:"text-secondary-text mb-2",children:"Required columns for collections:"}),s.jsx("div",{className:"bg-bg-secondary rounded p-3 font-mono text-sm",children:"name,game_name,purchase_date,public"}),s.jsxs("p",{className:"text-sm text-secondary-text mt-2",children:[s.jsx("strong",{children:"Note:"})," If your CSV headers don't match exactly, you'll be able to map them after upload."]}),s.jsxs("div",{className:"mt-4 space-y-2",children:[s.jsx("div",{children:s.jsx("a",{href:"/sample-collections.csv",download:!0,className:"text-brand hover:text-brand/80 transition-colors text-sm",children:"Download sample collections CSV (standard headers)"})}),s.jsx("div",{children:s.jsx("a",{href:"/sample-collections-custom-headers.csv",download:!0,className:"text-brand hover:text-brand/80 transition-colors text-sm",children:"Download sample collections CSV (custom headers - requires mapping)"})})]})]})})]}),s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6 mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-text mb-4",children:"Upload File"}),s.jsxs("div",{className:"border-2 border-dashed border-border-custom rounded-lg p-8 text-center",children:[s.jsx("input",{ref:u,type:"file",accept:".csv",onChange:x,className:"hidden",disabled:a.isUploading}),r?s.jsxs("div",{children:[s.jsx(Hi,{className:"w-12 h-12 text-brand mx-auto mb-4"}),s.jsx("p",{className:"text-text mb-2",children:r.name}),s.jsxs("p",{className:"text-sm text-secondary-text mb-4",children:["Size: ",(r.size/1024/1024).toFixed(2)," MB"]}),s.jsxs("div",{className:"flex space-x-2 justify-center",children:[s.jsx("button",{onClick:()=>{console.log("Upload button clicked!"),k()},className:"bg-brand text-white px-4 py-2 rounded-lg hover:bg-brand/90 transition-colors",disabled:a.isUploading,children:a.isUploading?"Uploading...":"Upload"}),s.jsx("button",{onClick:A,className:"bg-bg-secondary text-text px-4 py-2 rounded-lg border border-border-custom hover:bg-bg-card transition-colors",disabled:a.isUploading,children:"Reset"})]})]}):s.jsxs("div",{children:[s.jsx(_d,{className:"w-12 h-12 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-text mb-2",children:"Click to select a CSV file"}),s.jsx("p",{className:"text-sm text-secondary-text mb-4",children:"Maximum file size: 5MB"}),s.jsx("button",{onClick:()=>{var L;console.log("Select File button clicked!"),console.log("fileInputRef.current:",u.current),(L=u.current)==null||L.click()},className:"bg-brand text-white px-4 py-2 rounded-lg hover:bg-brand/90 transition-colors",disabled:a.isUploading,children:"Select File"})]})]}),l&&s.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(vm,{className:"w-5 h-5 text-red-600"}),s.jsx("p",{className:"text-red-600",children:l})]})})]}),a.isUploading&&s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6 mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-text mb-4",children:"Upload Progress"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"w-full bg-bg-secondary rounded-full h-2",children:s.jsx("div",{className:"bg-brand h-2 rounded-full transition-all duration-300",style:{width:`${a.progress}%`}})}),s.jsxs("p",{className:"text-secondary-text",children:[a.progress,"% complete"]})]})]}),!a.isUploading&&(a.successCount>0||a.errorCount>0)&&s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-text mb-4",children:"Upload Results"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(lx,{className:"w-5 h-5 text-green-600"}),s.jsxs("span",{className:"text-green-600",children:[a.successCount," successful"]})]}),a.errorCount>0&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(vm,{className:"w-5 h-5 text-red-600"}),s.jsxs("span",{className:"text-red-600",children:[a.errorCount," errors"]})]})]}),a.errors.length>0&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold text-red-800 mb-2",children:"Errors:"}),s.jsx("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:a.errors.map((L,O)=>s.jsx("p",{className:"text-sm text-red-600",children:L},O))})]})]})]}),s.jsx(SE,{isOpen:d,onClose:()=>f(!1),onConfirm:N,csvHeaders:m,uploadType:t})]})}function Xi({value:e,onChange:t,placeholder:n="Enter text...",label:r="Notes",rows:i=3}){const a=j.useRef(null),o=c=>{t(c.target.value)},l=c=>{if(!a.current)return;const u=a.current,h=u.selectionStart,d=u.selectionEnd,f=u.value,m=f.substring(0,h)+c+f.substring(d);t(m),setTimeout(()=>{u.focus(),u.setSelectionRange(h+c.length,h+c.length)},0)};return s.jsxs("div",{children:[s.jsx("div",{className:"mb-2",children:s.jsx("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:r})}),s.jsxs("div",{className:"flex items-center space-x-1 p-2 border border-gray-300 dark:border-gray-600 border-b-0 rounded-t-md bg-gray-50 dark:bg-gray-800",children:[s.jsx("button",{type:"button",onClick:()=>l("**"),className:"p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",title:"Bold (**text**)",children:s.jsx(Fv,{className:"w-4 h-4"})}),s.jsx("button",{type:"button",onClick:()=>l("*"),className:"p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",title:"Italic (*text*)",children:s.jsx(Uv,{className:"w-4 h-4"})}),s.jsx("button",{type:"button",onClick:()=>l("__"),className:"p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",title:"Underline (__text__)",children:s.jsx(Jv,{className:"w-4 h-4"})}),s.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1"}),s.jsx("button",{type:"button",onClick:()=>l("- "),className:"p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",title:"Bullet List",children:s.jsx(qv,{className:"w-4 h-4"})}),s.jsx("button",{type:"button",onClick:()=>l("1. "),className:"p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",title:"Numbered List",children:s.jsx(Vv,{className:"w-4 h-4"})})]}),s.jsx("textarea",{ref:a,value:e,onChange:o,placeholder:n,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-b-md focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)] dark:bg-gray-700 dark:text-white resize-none",style:{minHeight:`${i*1.5}rem`,direction:"ltr",textAlign:"left"},rows:i})]})}function CE({onBack:e}){console.log("=== ReleaseManagementPage rendering ===");const{currentVersion:t,loading:n,error:r,fetchCurrentVersion:i}=Zy(),[a,o]=j.useState([]),[l,c]=j.useState(!0),[u,h]=j.useState(!1),[d,f]=j.useState(null),[m,p]=j.useState({ver_number:"",ver_title:"",ver_notes:""}),[y,S]=j.useState({ver_number:"",ver_title:"",ver_notes:""}),g=()=>{},b=T=>{},x=async()=>{try{c(!0);const{data:T,error:I}=await Y.from("version").select("*").order("created_at",{ascending:!1});if(I)throw I;o(T||[])}catch(T){console.error("Error fetching versions:",T)}finally{c(!1)}},k=async()=>{try{const{data:T,error:I}=await Y.from("version").insert({ver_number:parseFloat(m.ver_number),ver_title:m.ver_title,ver_notes:m.ver_notes||null,created_at:new Date().toISOString()}).select().single();if(I)throw I;p({ver_number:"",ver_title:"",ver_notes:""}),h(!1),await x(),await i()}catch(T){console.error("Error creating version:",T),alert("Failed to create version")}},N=T=>{f(T.id),S({ver_number:T.ver_number.toString(),ver_title:T.ver_title,ver_notes:T.ver_notes||""})},w=async()=>{if(d)try{const{error:T}=await Y.from("version").update({ver_number:parseFloat(y.ver_number),ver_title:y.ver_title,ver_notes:y.ver_notes||null}).eq("id",d);if(T)throw T;f(null),S({ver_number:"",ver_title:"",ver_notes:""}),await x(),await i()}catch(T){console.error("Error updating version:",T),alert("Failed to update version")}},C=()=>{f(null),S({ver_number:"",ver_title:"",ver_notes:""})};return j.useEffect(()=>{x()},[]),s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(Dn,{onAddModel:()=>{},onAdminClick:g,onSettingsClick:()=>{},activeTab:"collection",onTabChange:b}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(Tt,{className:"w-5 h-5"}),s.jsx("span",{children:"Back to Admin Panel"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title",children:"RELEASE MANAGEMENT"})]}),s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6 mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-text mb-2",children:"Current Version"}),n?s.jsx("p",{className:"text-secondary-text",children:"Loading..."}):r?s.jsxs("p",{className:"text-red-500",children:["Error: ",r]}):t?s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("span",{className:"text-2xl font-bold text-brand",children:["Version ",t.ver_number.toFixed(2)]}),t.ver_title&&s.jsxs("span",{className:"text-lg text-text",children:["- ",t.ver_title]})]}):s.jsx("p",{className:"text-secondary-text",children:"No version information available"})]}),s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-text",children:"Create New Version"}),s.jsxs("button",{onClick:()=>h(!u),className:"flex items-center space-x-2 bg-brand text-white px-4 py-2 rounded-lg hover:bg-brand/90 transition-colors",children:[s.jsx(Pn,{className:"w-4 h-4"}),s.jsx("span",{children:u?"Cancel":"New Version"})]})]}),u&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text mb-2",children:"Version Number *"}),s.jsx("input",{type:"number",step:"0.1",value:m.ver_number,onChange:T=>p({...m,ver_number:T.target.value}),className:"w-full px-3 py-2 border border-border-custom rounded-lg bg-bg-secondary text-text focus:outline-none focus:ring-2 focus:ring-brand",placeholder:"1.0"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text mb-2",children:"Version Title *"}),s.jsx("input",{type:"text",value:m.ver_title,onChange:T=>p({...m,ver_title:T.target.value}),className:"w-full px-3 py-2 border border-border-custom rounded-lg bg-bg-secondary text-text focus:outline-none focus:ring-2 focus:ring-brand",placeholder:"Initial Release"})]})]}),s.jsx("div",{children:s.jsx(Xi,{value:m.ver_notes,onChange:T=>p({...m,ver_notes:T}),placeholder:"Optional notes about this version...",label:"Version Notes",rows:4})}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:k,disabled:!m.ver_number||!m.ver_title,className:"bg-brand text-white px-6 py-2 rounded-lg hover:bg-brand/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Create Version"})})]})]}),s.jsxs("div",{className:"bg-bg-card border border-border-custom rounded-lg p-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-text mb-4",children:"Version History"}),l?s.jsx("p",{className:"text-secondary-text",children:"Loading versions..."}):a.length===0?s.jsx("p",{className:"text-secondary-text",children:"No versions found"}):s.jsx("div",{className:"space-y-4",children:a.map(T=>s.jsx("div",{className:"border border-border-custom rounded-lg p-4",children:d===T.id?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text mb-2",children:"Version Number *"}),s.jsx("input",{type:"number",step:"0.1",value:y.ver_number,onChange:I=>S({...y,ver_number:I.target.value}),className:"w-full px-3 py-2 border border-border-custom rounded-lg bg-bg-secondary text-text focus:outline-none focus:ring-2 focus:ring-brand"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text mb-2",children:"Version Title *"}),s.jsx("input",{type:"text",value:y.ver_title,onChange:I=>S({...y,ver_title:I.target.value}),className:"w-full px-3 py-2 border border-border-custom rounded-lg bg-bg-secondary text-text focus:outline-none focus:ring-2 focus:ring-brand"})]})]}),s.jsx("div",{children:s.jsx(Xi,{value:y.ver_notes,onChange:I=>S({...y,ver_notes:I}),placeholder:"Optional notes about this version...",label:"Version Notes",rows:4})}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsxs("button",{onClick:C,className:"flex items-center space-x-2 px-4 py-2 border border-border-custom rounded-lg text-text hover:bg-bg-secondary transition-colors",children:[s.jsx(fe,{className:"w-4 h-4"}),s.jsx("span",{children:"Cancel"})]}),s.jsxs("button",{onClick:w,disabled:!y.ver_number||!y.ver_title,className:"flex items-center space-x-2 bg-brand text-white px-4 py-2 rounded-lg hover:bg-brand/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(xx,{className:"w-4 h-4"}),s.jsx("span",{children:"Save"})]})]})]}):s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("span",{className:"text-lg font-semibold text-brand",children:["Version ",T.ver_number.toFixed(2)]}),s.jsx("span",{className:"text-text",children:T.ver_title}),s.jsx("span",{className:"text-secondary-text text-sm",children:new Date(T.created_at).toLocaleDateString()})]}),s.jsxs("button",{onClick:()=>N(T),className:"flex items-center space-x-2 px-3 py-1 border border-border-custom rounded-lg text-text hover:bg-bg-secondary transition-colors",children:[s.jsx(Hv,{className:"w-4 h-4"}),s.jsx("span",{children:"Edit"})]})]}),T.ver_notes&&s.jsx("div",{className:"bg-bg-secondary rounded-lg p-3",children:s.jsx(_s,{remarkPlugins:[Cs],components:{p:({children:I})=>s.jsx("p",{className:"mb-2 last:mb-0 text-sm text-text",children:I}),h1:({children:I})=>s.jsx("h1",{className:"text-base font-bold mb-2 text-text",children:I}),h2:({children:I})=>s.jsx("h2",{className:"text-sm font-bold mb-2 text-text",children:I}),h3:({children:I})=>s.jsx("h3",{className:"text-xs font-bold mb-1 text-text",children:I}),ul:({children:I})=>s.jsx("ul",{className:"list-disc list-inside mb-2 space-y-1",children:I}),ol:({children:I})=>s.jsx("ol",{className:"list-decimal list-inside mb-2 space-y-1",children:I}),li:({children:I})=>s.jsx("li",{className:"text-sm text-text",children:I}),strong:({children:I})=>s.jsx("strong",{className:"font-semibold text-text",children:I}),em:({children:I})=>s.jsx("em",{className:"italic text-text",children:I}),code:({children:I})=>s.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 py-0.5 rounded text-xs font-mono",children:I}),pre:({children:I})=>s.jsx("pre",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs font-mono overflow-x-auto mb-2",children:I}),blockquote:({children:I})=>s.jsx("blockquote",{className:"border-l-4 border-gray-300 dark:border-gray-600 pl-3 italic mb-2 text-text",children:I})},children:T.ver_notes})})]})},T.id))})]})]}),s.jsx(tr,{activeTab:"collection",onTabChange:T=>{}})]})}function EE({onBack:e}){console.log("=== AdminPage rendering ===");const[t,n]=j.useState("main"),{user:r}=Ge();console.log("AdminPage user:",r),console.log("AdminPage user is_admin:",r==null?void 0:r.is_admin),console.log("AdminPage currentView:",t);const i=()=>{},a=o=>{};return t==="users"?s.jsx(Sj,{onBack:()=>n("main")}):t==="games"?s.jsx(Cj,{onBack:()=>n("main")}):t==="locations"?s.jsx(Ij,{onBack:()=>n("main"),isLocationAdmin:(r==null?void 0:r.is_location_admin)||!1}):t==="share-preview"?s.jsx(vE,{onBack:()=>n("main")}):t==="csv-upload"?(console.log("Rendering CSVUploadPage"),s.jsx(_E,{onBack:()=>n("main")})):t==="release-management"?(console.log("Rendering ReleaseManagementPage"),s.jsx(CE,{onBack:()=>n("main")})):s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(Dn,{onAddModel:()=>{},onAdminClick:i,onSettingsClick:()=>{},activeTab:"collection",onTabChange:a}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(Tt,{className:"w-5 h-5"}),s.jsx("span",{children:"Back to Collection"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title",children:"ADMIN PANEL"})]}),s.jsxs("div",{className:"space-y-4 max-w-md",children:[(r==null?void 0:r.is_admin)&&s.jsxs("button",{onClick:()=>n("users"),className:"w-full bg-bg-card border border-border-custom rounded-lg p-6 hover:bg-bg-secondary transition-colors flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(Wi,{className:"w-6 h-6 text-secondary-text"}),s.jsx("span",{className:"text-lg font-semibold text-text",children:"Manage Users"})]}),s.jsx(Vt,{className:"w-5 h-5 text-icon"})]}),(r==null?void 0:r.is_admin)&&s.jsxs("button",{onClick:()=>n("games"),className:"w-full bg-bg-card border border-border-custom rounded-lg p-6 hover:bg-bg-secondary transition-colors flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(Wo,{className:"w-6 h-6 text-secondary-text"}),s.jsx("span",{className:"text-lg font-semibold text-text",children:"Manage Games"})]}),s.jsx(Vt,{className:"w-5 h-5 text-icon"})]}),s.jsxs("button",{onClick:()=>n("locations"),className:"w-full bg-bg-card border border-border-custom rounded-lg p-6 hover:bg-bg-secondary transition-colors flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(wr,{className:"w-6 h-6 text-secondary-text"}),s.jsx("span",{className:"text-lg font-semibold text-text",children:"Manage Locations"})]}),s.jsx(Vt,{className:"w-5 h-5 text-icon"})]}),s.jsxs("button",{onClick:()=>n("share-preview"),className:"w-full bg-bg-card border border-border-custom rounded-lg p-6 hover:bg-bg-secondary transition-colors flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(sa,{className:"w-6 h-6 text-secondary-text"}),s.jsx("span",{className:"text-lg font-semibold text-text",children:"Share Preview"})]}),s.jsx(Vt,{className:"w-5 h-5 text-icon"})]}),(r==null?void 0:r.is_admin)&&s.jsxs("button",{onClick:()=>{console.log("CSV Upload button clicked!"),n("csv-upload")},className:"w-full bg-bg-card border border-border-custom rounded-lg p-6 hover:bg-bg-secondary transition-colors flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(_d,{className:"w-6 h-6 text-secondary-text"}),s.jsx("span",{className:"text-lg font-semibold text-text",children:"CSV Upload"})]}),s.jsx(Vt,{className:"w-5 h-5 text-icon"})]}),(r==null?void 0:r.is_admin)&&s.jsxs("button",{onClick:()=>{console.log("Release Management button clicked!"),n("release-management")},className:"w-full bg-bg-card border border-border-custom rounded-lg p-6 hover:bg-bg-secondary transition-colors flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(zv,{className:"w-6 h-6 text-secondary-text"}),s.jsx("span",{className:"text-lg font-semibold text-text",children:"Release Management"})]}),s.jsx(Vt,{className:"w-5 h-5 text-icon"})]})]})]}),s.jsx(tr,{activeTab:"collection",onTabChange:o=>{}})]})}function PE({onBack:e}){return s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(Tt,{className:"w-5 h-5"}),s.jsx("span",{children:"Back"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title text-center",children:"About this app"})]}),s.jsx("div",{children:s.jsx("div",{className:"bg-bg-card border border-border-custom rounded-lg p-8",children:s.jsxs("div",{className:"space-y-6 text-base text-text leading-relaxed",children:[s.jsx("p",{children:"You're using a very, very early version of the Mini Myths app. Our hope is that one day you'll be able to use this app to manage your tabletop wargaming collection, and book a table at nearby gaming store."}),s.jsx("p",{children:"We're still in very early development, so make sure to let us know if you run into any issues along the way. You can flag issues in the Mini Myths Discord."})]})})})]})}function Vf({date:e,bookings:t,isExpanded:n,onToggle:r,onBookingClick:i,onCancelBooking:a}){const o=l=>Ux(l);return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("button",{onClick:r,className:"w-full flex items-center justify-between text-left border-b border-border-custom pb-2 hover:bg-bg-secondary transition-colors rounded-lg px-2 py-1",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("h2",{className:"text-xl font-bold text-title",children:o(e)}),s.jsxs("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 text-sm font-medium rounded-full",children:[t.length," booking",t.length!==1?"s":""]})]}),n?s.jsx(Bs,{className:"w-5 h-5 text-icon"}):s.jsx(Vt,{className:"w-5 h-5 text-icon"})]}),n&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(l=>s.jsx(Vx,{booking:l,onClick:()=>i(l),onCancelBooking:a,isPast:e==="past"},l.id))})]})}function TE({isOpen:e,onClose:t,onBookingCancelled:n,booking:r}){const[i,a]=j.useState(!1),[o,l]=j.useState(!1),c=async()=>{if(r){a(!0);try{const{error:d}=await Y.from("bookings").delete().eq("id",r.id);if(d)throw d;n()}catch(d){console.error("Error cancelling booking:",d),alert("Failed to cancel booking. Please try again.")}finally{a(!1),l(!1)}}},u=d=>jt(d,{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0});if(!e||!r)return null;const h=d=>{d.target===d.currentTarget&&t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:h,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-bold text-title",children:"Booking Details"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Xe,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-text",children:Ux(r.date)}),s.jsx("p",{className:"text-sm text-secondary-text",children:jt(r.date)})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Us,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-text",children:r.timeslot.name}),s.jsxs("p",{className:"text-sm text-secondary-text",children:[_o(r.timeslot.start_time)," - ",_o(r.timeslot.end_time)]})]})]}),s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(wr,{className:"w-5 h-5 text-secondary-text mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-text",children:r.location.name}),s.jsx("p",{className:"text-sm text-secondary-text",children:r.location.address})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx($t,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-text",children:r.user_name?r.user_name:"Booked by"}),s.jsx("p",{className:"text-sm text-secondary-text",children:r.user_email||r.user.email})]})]}),r.game&&s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[r.game.icon?s.jsx("img",{src:r.game.icon,alt:`${r.game.name} icon`,className:"w-5 h-5 object-contain rounded",onError:d=>{const f=d.target;f.style.display="none";const m=f.nextElementSibling;m&&m.classList.contains("icon-fallback")&&(m.style.display="flex")}}):null,s.jsx("div",{className:"w-5 h-5 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:r.game.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-xs font-bold",children:r.game.name.charAt(0)})})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-text",children:"Game"}),s.jsx("p",{className:"text-sm text-secondary-text",children:r.game.name})]})]}),s.jsx("div",{className:"border-t border-border-custom pt-4",children:s.jsxs("p",{className:"text-sm text-secondary-text",children:["Booking created: ",u(r.created_at)]})})]}),s.jsx("div",{className:"mt-8 pt-6 border-t border-border-custom",children:o?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsx("p",{className:"text-red-800 font-medium mb-2",children:"Are you sure?"}),s.jsx("p",{className:"text-red-700 text-sm",children:"This will permanently delete this booking and make the table available for others to book."})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>l(!1),disabled:i,className:"btn-ghost btn-flex",children:"Keep Booking"}),s.jsx("button",{onClick:c,disabled:i,className:"btn-danger btn-flex",children:i?"Cancelling...":"Yes, Cancel Booking"})]})]}):s.jsxs("button",{onClick:()=>l(!0),className:"btn-danger-outline btn-with-icon",children:[s.jsx(Hn,{className:"w-4 h-4"}),s.jsx("span",{children:"Cancel This Booking"})]})})]})})}function IE(){const[e,t]=j.useState([]),[n,r]=j.useState(!0),[i,a]=j.useState(null),{user:o}=Ge(),l=async()=>{try{r(!0);let c=Y.from("bookings").select(`
          id,
          date,
          created_at,
          user_id,
          user_name,
          user_email,
          location:locations(
            id,
            name,
            address,
            icon
          ),
          timeslot:timeslots(
            id,
            name,
            start_time,
            end_time
          ),
          game:games(
            id,
            name,
            icon
          )
        `);if(o!=null&&o.is_location_admin&&!(o!=null&&o.is_admin)&&(o!=null&&o.id)){const{data:g,error:b}=await Y.from("locations").select("id").contains("admins",[o.id]);if(b)throw b;const x=(g==null?void 0:g.map(k=>k.id))||[];if(x.length===0){t([]);return}c=c.in("location_id",x)}const{data:u,error:h}=await c;if(h)throw h;const d=[...new Set((u==null?void 0:u.map(g=>g.user_id))||[])],{data:f,error:m}=await Y.from("users").select("id, email").in("id",d);if(m)throw m;const p=new Map((f==null?void 0:f.map(g=>[g.id,g]))||[]),S=((u==null?void 0:u.map(g=>({...g,user:p.get(g.user_id)||{id:g.user_id,email:"Unknown User"}})))||[]).sort((g,b)=>{const x=fu(g.date),k=fu(b.date);if(x&&!k)return 1;if(!x&&k)return-1;const N=new Date(b.date).getTime()-new Date(g.date).getTime();return N!==0?N:new Date(b.created_at).getTime()-new Date(g.created_at).getTime()});t(S)}catch(c){a(c instanceof Error?c.message:"Failed to fetch bookings")}finally{r(!1)}};return j.useEffect(()=>{l()},[]),{bookings:e,loading:n,error:i,refetch:l}}function ME({onBack:e}){const[t,n]=j.useState(new Set),[r,i]=j.useState(null),[a,o]=j.useState(!1),[l,c]=j.useState({isOpen:!1,bookingId:null}),[u,h]=j.useState(!1),{bookings:d,loading:f,error:m,refetch:p}=IE(),y=N=>{i(N),o(!0)},S=()=>{o(!1),i(null),p()},g=N=>{console.log("Attempting to cancel booking with ID:",N),c({isOpen:!0,bookingId:N})},b=async()=>{if(console.log("Confirming cancellation for booking ID:",l.bookingId),!!l.bookingId){h(!0);try{const{error:N}=await Y.from("bookings").delete().eq("id",l.bookingId);if(N)throw N;console.log("Booking cancelled successfully"),await p(),c({isOpen:!1,bookingId:null})}catch(N){console.error("Error cancelling booking:",N),alert("Failed to cancel booking. Please try again.")}finally{h(!1)}}},x=Ne.useMemo(()=>{const N=[],w=[];d.forEach(A=>{fu(A.date)?w.push(A):N.push(A)});const C={},T={};N.forEach(A=>{const L=A.date;C[L]||(C[L]=[]),C[L].push(A)}),w.forEach(A=>{const L=A.date;T[L]||(T[L]=[]),T[L].push(A)}),Object.keys(C).forEach(A=>{C[A].sort((L,O)=>L.timeslot.start_time.localeCompare(O.timeslot.start_time))}),Object.keys(T).forEach(A=>{T[A].sort((L,O)=>L.timeslot.start_time.localeCompare(O.timeslot.start_time))});const I=Object.keys(C).sort((A,L)=>A.localeCompare(L)),v=Object.keys(T).sort((A,L)=>L.localeCompare(A)),P=I.map(A=>({date:A,bookings:C[A],isPast:!1}));return v.forEach(A=>{P.push({date:A,bookings:T[A],isPast:!0})}),P},[d]);Ne.useEffect(()=>{if(x.length>0){const N=new Set(x.slice(0,3).map(w=>w.date));n(N)}},[x]);const k=N=>{n(w=>{const C=new Set(w);return C.has(N)?C.delete(N):C.add(N),C})};return f?s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text",children:"Loading all bookings..."})]})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-secondary-text hover:text-text transition-colors mb-4",children:[s.jsx(Tt,{className:"w-5 h-5"}),s.jsx("span",{children:"Back"})]}),s.jsx("h1",{className:"text-4xl font-bold text-title",children:"ALL BOOKINGS"}),s.jsx("p",{className:"text-base text-secondary-text mt-2",children:"View and manage all table bookings across all locations"})]}),m&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:m})}),d.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Xe,{className:"w-16 h-16 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text",children:"No bookings found."})]}):s.jsxs("div",{className:"space-y-8",children:[x.filter(N=>!N.isPast).length>0&&s.jsx("div",{className:"space-y-6",children:x.filter(N=>!N.isPast).map(({date:N,bookings:w,isPast:C})=>s.jsx(Vf,{date:N,bookings:w,isExpanded:t.has(N),onToggle:()=>k(N),onBookingClick:y,onCancelBooking:g},N))}),x.filter(N=>N.isPast).length>0&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"border-t border-border-custom pt-8",children:s.jsx("h2",{className:"text-2xl font-bold text-title mb-6",children:"Past Bookings"})}),x.filter(N=>N.isPast).map(({date:N,bookings:w,isPast:C})=>s.jsx(Vf,{date:N,bookings:w,isExpanded:t.has(N),onToggle:()=>k(N),onBookingClick:y,onCancelBooking:g},N))]})]})]}),s.jsx(TE,{isOpen:a,onClose:()=>o(!1),onBookingCancelled:S,booking:r}),s.jsx(qx,{isOpen:l.isOpen,onClose:()=>c({isOpen:!1,bookingId:null}),onConfirm:b,loading:u})]})}function AE(){const[e,t]=j.useState([]),[n,r]=j.useState(!0),[i,a]=j.useState(null),{user:o}=Ge(),l=async()=>{try{r(!0),a(null);let c=Y.from("blocked_dates").select("*, locations(*)").order("date",{ascending:!0});if(o!=null&&o.is_location_admin&&!(o!=null&&o.is_admin)){const{data:d,error:f}=await Y.from("locations").select("id").contains("admins",[o.id]);if(f)throw console.error("Error fetching user locations:",f),f;if(d&&d.length>0){const m=d.map(p=>p.id);c=c.in("location_id",m)}else{t([]);return}}const{data:u,error:h}=await c;if(h)throw h;t(u||[])}catch(c){console.error("Error fetching blocked dates:",c),a("Failed to load blocked dates")}finally{r(!1)}};return j.useEffect(()=>{l()},[o]),{blockedDates:e,loading:n,error:i,refetch:l}}function LE({isOpen:e,onClose:t,onBlockedDateCreated:n}){const[r,i]=j.useState([]),[a,o]=j.useState(""),[l,c]=j.useState(""),[u,h]=j.useState(""),[d,f]=j.useState(!1),[m,p]=j.useState(null),{user:y}=Ge();j.useEffect(()=>{e&&(S(),g())},[e]);const S=async()=>{try{let k=Y.from("locations").select("id, name, address").order("name");y!=null&&y.is_location_admin&&!(y!=null&&y.is_admin)&&(y!=null&&y.id)&&(k=k.contains("admins",[y.id]));const{data:N,error:w}=await k;if(w)throw w;i(N||[])}catch(k){console.error("Error fetching locations:",k),p("Failed to load locations")}},g=()=>{o(""),c(""),h(""),p(null)},b=async k=>{if(k.preventDefault(),!a||!l){p("Please fill in all required fields");return}const N=new Date(l),w=new Date;if(w.setHours(0,0,0,0),N<w){p("Date must be in the future");return}f(!0),p(null);try{console.log("Submitting blocked date:",{location_id:a,date:l,description:u||null});const{data:C,error:T}=await Y.from("blocked_dates").insert({location_id:a,date:l,description:u||null}).select();if(T)throw console.error("Supabase error:",T),T;console.log("Blocked date created successfully:",C),g(),n(),t()}catch(C){console.error("Error creating blocked date:",C),p("Failed to create blocked date")}finally{f(!1)}},x=k=>{k.target===k.currentTarget&&t()};return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-[70]",onClick:x,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-lg font-bold text-title",children:"Add Blocked Date"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6"})})]}),s.jsxs("form",{onSubmit:b,className:"space-y-4",children:[m&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsx("p",{className:"text-red-600",children:m})}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-text mb-2",children:["Location ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(wr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-icon"}),s.jsxs("select",{value:a,onChange:k=>o(k.target.value),disabled:d,className:"w-full pl-10 pr-4 py-3 border border-border-custom rounded-lg bg-bg-secondary text-text focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent disabled:opacity-50",required:!0,children:[s.jsx("option",{value:"",children:"Select a location"}),r.map(k=>s.jsx("option",{value:k.id,children:k.name},k.id))]})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-text mb-2",children:["Date ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-icon"}),s.jsx("input",{type:"date",value:l,onChange:k=>c(k.target.value),disabled:d,min:new Date().toISOString().split("T")[0],className:"w-full pl-10 pr-4 py-3 border border-border-custom rounded-lg bg-bg-secondary text-text focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent disabled:opacity-50",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-text mb-2",children:"Description"}),s.jsxs("div",{className:"relative",children:[s.jsx(Hi,{className:"absolute left-3 top-3 w-5 h-5 text-icon"}),s.jsx("textarea",{value:u,onChange:k=>h(k.target.value),disabled:d,placeholder:"Optional description for this blocked date...",rows:3,className:"w-full pl-10 pr-4 py-3 border border-border-custom rounded-lg bg-bg-secondary text-text focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent disabled:opacity-50 resize-none"})]})]}),s.jsxs("div",{className:"flex space-x-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,disabled:d,className:"btn-ghost btn-flex flex-1",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:d||!a||!l,className:"btn-primary btn-flex flex-1",children:d?"Creating...":"Create Blocked Date"})]})]})]})}):null}function DE({onBack:e}){const[t,n]=j.useState(!1),{blockedDates:r,loading:i,error:a,refetch:o}=AE(),l=async u=>{if(confirm("Are you sure you want to delete this blocked date?"))try{const{error:h}=await Y.from("blocked_dates").delete().eq("id",u);if(h)throw h;o()}catch(h){console.error("Error deleting blocked date:",h),alert("Failed to delete blocked date")}},c=u=>jt(u,{weekday:"long",year:"numeric",month:"long",day:"numeric"});return s.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:e,className:"p-2 hover:bg-bg-secondary rounded-lg transition-colors",children:s.jsx(Tt,{className:"w-5 h-5 text-icon"})}),s.jsx("h1",{className:"text-2xl font-bold text-title",children:"Blocked Dates"})]}),s.jsxs("button",{onClick:()=>n(!0),className:"btn-primary btn-with-icon",children:[s.jsx(Pn,{className:"w-4 h-4"}),s.jsx("span",{children:"Add blocked date"})]})]}),a&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:a})}),i?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"Loading blocked dates..."})]}):r.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ox,{className:"w-16 h-16 text-secondary-text mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-title mb-2",children:"No blocked dates"}),s.jsx("p",{className:"text-secondary-text mb-6",children:r.length===0?"You haven't blocked any dates yet. Click 'Add blocked date' to get started.":"No blocked dates found for your locations."})]}):s.jsx("div",{className:"space-y-4",children:r.map(u=>{var h;return s.jsx("div",{className:"bg-bg-secondary border border-border-custom rounded-lg p-4 hover:bg-bg-tertiary transition-colors",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(wr,{className:"w-4 h-4 text-icon"}),s.jsx("span",{className:"font-medium text-text",children:((h=u.locations)==null?void 0:h.name)||"Unknown Location"})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(Xe,{className:"w-4 h-4 text-icon"}),s.jsx("span",{className:"text-text",children:c(u.date)})]}),u.description&&s.jsx("p",{className:"text-secondary-text text-sm",children:u.description})]}),s.jsx("button",{onClick:()=>l(u.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Delete blocked date",children:s.jsx(Hn,{className:"w-4 h-4"})})]})},u.id)})}),s.jsx(LE,{isOpen:t,onClose:()=>n(!1),onBlockedDateCreated:o})]})}function OE({battle:e,onViewBattle:t,onDeleteBattle:n}){var a,o;const r=l=>{l.stopPropagation(),n(e.id)},i=l=>!!(l&&typeof l=="string"&&l.trim()!==""&&l!=="undefined"&&l!=="null"&&l.startsWith("http")&&l.includes("game-assets"));return s.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-bg-secondary transition-colors cursor-pointer border-b border-border-custom last:border-b-0",onClick:t,children:[s.jsxs("div",{className:"flex items-center space-x-4 flex-1 min-w-0",children:[s.jsxs("div",{className:"flex-shrink-0",children:[e.image_url?s.jsx("img",{src:e.image_url,alt:"Battle image",className:"w-10 h-10 object-cover rounded flex-shrink-0",onError:l=>{const c=l.target;console.warn("Battle image failed to load:",e.image_url,"Falling back to game icon"),c.style.display="none";const u=c.nextElementSibling;u&&u.classList.contains("game-icon-fallback")&&(u.style.display="block")}}):null,s.jsx("div",{className:"game-icon-fallback",style:{display:e.image_url?"none":"block"},children:i(e.game_icon)?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:e.game_icon||"",alt:`${e.game_name||"Unknown Game"} icon`,className:"w-10 h-10 object-contain rounded flex-shrink-0",onError:l=>{const c=l.target;console.warn("Game icon failed to load:",e.game_icon,"Falling back to letter icon"),c.style.display="none";const u=c.nextElementSibling;u&&u.classList.contains("icon-fallback")&&(u.style.display="flex")},onLoad:l=>{const u=l.target.nextElementSibling;u&&u.classList.contains("icon-fallback")&&(u.style.display="none")}}),s.jsx("div",{className:"w-10 h-10 bg-red-600 rounded-full flex items-center justify-center icon-fallback",children:s.jsx("span",{className:"text-white text-sm font-bold",children:((a=e.game_name)==null?void 0:a.charAt(0))||"?"})})]}):s.jsx("div",{className:"w-10 h-10 bg-red-600 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white text-sm font-bold",children:((o=e.game_name)==null?void 0:o.charAt(0))||"?"})})})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"text-lg font-semibold text-title truncate mb-1",children:e.battle_name||"Untitled Battle"}),s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-secondary-text",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Wo,{className:"w-4 h-4"}),s.jsx("span",{className:"truncate",children:e.game_name||"Unknown Game"})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Xe,{className:"w-4 h-4"}),s.jsx("span",{children:e.date_played?jt(e.date_played,{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"No date"})]}),e.opp_name&&s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx($t,{className:"w-4 h-4"}),s.jsxs("span",{className:"truncate",children:["vs ",e.opp_name]})]})]})]})]}),s.jsx("div",{className:"flex-shrink-0 ml-4",children:s.jsx("button",{onClick:r,className:"text-red-500 hover:text-red-700 transition-colors p-2 rounded-full hover:bg-red-50",title:"Delete Battle",children:s.jsx(Hn,{className:"w-5 h-5"})})})]})}function rb({isOpen:e,onClose:t,onConfirm:n,loading:r=!1}){return e?s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t}),s.jsxs("div",{className:"relative bg-bg-primary rounded-lg shadow-lg max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border-custom",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(ax,{className:"w-6 h-6 text-red-500"}),s.jsx("h2",{className:"text-xl font-semibold text-title",children:"Delete Battle"})]}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",disabled:r,children:s.jsx(fe,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"p-6",children:[s.jsx("p",{className:"text-base text-secondary-text mb-6",children:"Are you sure you want to delete this battle? This action cannot be undone."}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:t,className:"flex-1 btn-secondary",disabled:r,children:"Cancel"}),s.jsx("button",{onClick:n,className:"flex-1 btn-danger",disabled:r,children:r?"Deleting...":"Delete Battle"})]})]})]})]}):null}function RE({isOpen:e,onClose:t,battle:n,onBattleUpdated:r}){const[i,a]=j.useState(""),[o,l]=j.useState(""),[c,u]=j.useState(""),[h,d]=j.useState(null),[f,m]=j.useState(!1),[p,y]=j.useState(null),[S,g]=j.useState(null),[b,x]=j.useState([]),[k,N]=j.useState(!1),[w,C]=j.useState(!1),[T,I]=j.useState(""),[v,P]=j.useState(""),[A,L]=j.useState(""),{user:O}=Ge(),{addRecentGame:M}=Hs();j.useEffect(()=>{n&&(a(n.date_played||""),l(n.opp_name||""),u(n.game_uid||""),g(n.image_url),d(null))},[n]),Ne.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]),j.useEffect(()=>{e&&U()},[e]);const U=async()=>{try{const{data:K,error:G}=await Y.from("games").select("id, name, icon").order("name");if(G)throw G;x(K||[])}catch(K){console.error("Error fetching games:",K),I("Failed to load games")}},H=()=>!(O!=null&&O.fav_games)||O.fav_games.length===0?[]:b.filter(K=>{var G;return(G=O.fav_games)==null?void 0:G.includes(K.id)}),F=async K=>{if(K.preventDefault(),!!n){if(!i){I("Date played is required");return}if(!o.trim()){I("Opponent name is required");return}if(!c){I("Game is required");return}N(!0),I("");try{const G=b.find(ae=>ae.id===c),W=`${(G==null?void 0:G.name)||"Unknown Game"} against ${o.trim()}`;let le=S;if(h){C(!0);try{const ae=await yn(h),be=ae.name.split(".").pop(),je=`battle-images/${O==null?void 0:O.id}/${Date.now()}.${be}`,{data:Ie,error:ne}=await Y.storage.from("battle-images").upload(je,ae,{cacheControl:"3600",upsert:!0});if(ne)throw ne;const{data:Q}=Y.storage.from("battle-images").getPublicUrl(je);le=Q.publicUrl}catch(ae){console.error("Error uploading image:",ae),I("Failed to upload image. Please try again."),C(!1);return}finally{C(!1)}}const{error:se}=await Y.from("battles").update({battle_name:W,date_played:i,opp_name:o.trim(),game_name:(G==null?void 0:G.name)||"",game_uid:c,image_url:le}).eq("id",n.id);if(se)throw se;r(),t()}catch(G){console.error("Error updating battle:",G),I("Failed to update battle. Please try again.")}finally{N(!1)}}},B=K=>{u(K);const G=b.find(W=>W.id===K);G&&M(G)},_=K=>{const G=K.target.files;if(P(""),L(""),G&&G.length>0){const W=G[0];if(!bn(W)){P("Please select a valid image file (JPEG, PNG, or WebP)"),d(null),K.target.value="";return}const le=50*1024*1024;W.size>le?(P(`Your image must be 50MB or less. Current size: ${He(W.size)}`),d(null),K.target.value=""):(d(W),y(W),m(!0),W.size>1024*1024&&L(`Original size: ${He(W.size)}. Image will be automatically compressed before upload.`))}else d(null)},z=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){P("Camera is not available on this device");return}P("");const K=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280,max:1920},height:{ideal:720,max:1080}}}),G=document.createElement("video");G.srcObject=K,G.autoplay=!0,G.playsInline=!0,G.muted=!0,G.style.position="fixed",G.style.top="0",G.style.left="0",G.style.width="100%",G.style.height="100%",G.style.zIndex="9999",G.style.objectFit="cover",G.style.backgroundColor="#000";const W=document.createElement("canvas"),le=W.getContext("2d");if(!le)throw new Error("Could not get canvas context");const se=document.createElement("button");se.textContent=" Take Photo",se.style.position="fixed",se.style.bottom="20px",se.style.left="50%",se.style.transform="translateX(-50%)",se.style.zIndex="10000",se.style.padding="12px 24px",se.style.backgroundColor="#007bff",se.style.color="white",se.style.border="none",se.style.borderRadius="8px",se.style.fontSize="16px",se.style.fontWeight="bold",se.style.cursor="pointer";const ae=document.createElement("button");ae.textContent=" Cancel",ae.style.position="fixed",ae.style.bottom="20px",ae.style.right="20px",ae.style.zIndex="10000",ae.style.padding="12px 24px",ae.style.backgroundColor="#dc3545",ae.style.color="white",ae.style.border="none",ae.style.borderRadius="8px",ae.style.fontSize="16px",ae.style.fontWeight="bold",ae.style.cursor="pointer";const be=()=>{try{W.width=G.videoWidth,W.height=G.videoHeight,le.drawImage(G,0,0,W.width,W.height),W.toBlob(Ie=>{if(Ie){const ne=new File([Ie],`battle-photo-${Date.now()}.jpg`,{type:"image/jpeg",lastModified:Date.now()});if(!bn(ne)){P("Please select a valid image file (JPEG, PNG, or WebP)");return}const Q=50*1024*1024;ne.size>Q?P(`Your image must be 50MB or less. Current size: ${He(ne.size)}`):(d(ne),P(""),L(""),y(ne),m(!0),ne.size>1024*1024&&L(`Original size: ${He(ne.size)}. Image will be automatically compressed before upload.`))}je()},"image/jpeg",.9)}catch(Ie){console.error("Error capturing photo:",Ie),P("Error capturing photo. Please try again."),je()}},je=()=>{try{K&&K.getTracks().forEach(Ie=>Ie.stop()),document.body.contains(G)&&document.body.removeChild(G),document.body.contains(se)&&document.body.removeChild(se),document.body.contains(ae)&&document.body.removeChild(ae)}catch(Ie){console.error("Error during cleanup:",Ie)}};se.addEventListener("click",be),ae.addEventListener("click",je),document.body.appendChild(G),document.body.appendChild(se),document.body.appendChild(ae),G.addEventListener("loadedmetadata",()=>{console.log("Video ready, dimensions:",G.videoWidth,"x",G.videoHeight)}),G.addEventListener("error",Ie=>{console.error("Video error:",Ie),P("Error loading camera feed. Please try again."),je()})}catch(K){console.error("Error accessing camera:",K),K instanceof DOMException?K.name==="NotAllowedError"?P("Camera access denied. Please allow camera permissions and try again."):K.name==="NotFoundError"?P("No camera found on this device."):K.name==="NotReadableError"?P("Camera is already in use by another application."):P(`Camera error: ${K.message}`):P("Unable to access camera. Please try again or use the file upload option.")}},q=K=>{d(K),m(!1),y(null)},E=K=>{K.target===K.currentTarget&&t()};return!e||!n?null:s.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:E,children:[s.jsxs("div",{className:`bg-modal-bg rounded-lg max-w-lg w-full p-6 overflow-y-auto transition-all duration-300 ease-out transform\r
        fixed inset-0 sm:relative sm:inset-auto sm:max-w-lg sm:h-auto sm:rounded-lg sm:max-h-[90vh] h-screen w-screen sm:w-full overflow-y-auto rounded-none sm:rounded-lg p-6 sm:p-6`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-text font-overpass",children:"Edit Battle"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6"})})]}),s.jsxs("form",{onSubmit:F,className:"space-y-6",children:[T&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsx("p",{className:"text-red-600",children:T})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{htmlFor:"datePlayed",className:"block text-sm font-medium text-input-label font-overpass",children:"Date Played"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Required"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-icon"}),s.jsx("input",{type:"date",id:"datePlayed",value:i,onChange:K=>a(K.target.value),max:new Date().toISOString().split("T")[0],className:"w-full pl-10 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text",disabled:k})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{htmlFor:"opponentName",className:"block text-sm font-medium text-input-label font-overpass",children:"Opponent"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Required"})]}),s.jsxs("div",{className:"relative",children:[s.jsx($t,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-icon"}),s.jsx("input",{type:"text",id:"opponentName",value:o,onChange:K=>l(K.target.value),placeholder:"Enter opponent's name",className:"w-full pl-10 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] placeholder-secondary-text bg-bg-primary text-text",disabled:k})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{htmlFor:"game",className:"block text-sm font-medium text-input-label font-overpass",children:"Game"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Required"})]}),s.jsx(Yr,{games:b,selectedGame:c,onGameSelect:B,placeholder:"Choose a Game",favoriteGames:H()})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass",children:"Battle Image"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Optional"})]}),s.jsx("div",{className:"border-2 border-dashed border-border-custom rounded-lg p-6 text-center hover:border-[var(--color-brand)] transition-colors",children:h?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative mx-auto w-32 h-32",children:[s.jsx("img",{src:URL.createObjectURL(h),alt:"Selected battle image",className:"w-full h-full object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>{d(null),P(""),L("")},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",children:s.jsx(fe,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-sm text-secondary-text",children:h.name})]}):S?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative mx-auto w-32 h-32",children:[s.jsx("img",{src:S,alt:"Current battle image",className:"w-full h-full object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>{g(null),P(""),L("")},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",title:"Remove current image",children:s.jsx(fe,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-sm text-secondary-text",children:"Current image"})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-center space-x-4",children:[s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:_,className:"hidden",disabled:k}),s.jsxs("div",{className:"flex flex-col items-center space-y-2 p-4 rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx(En,{className:"w-8 h-8 text-icon"}),s.jsx("span",{className:"text-sm font-medium text-text",children:"Upload Image"})]})]}),s.jsxs("button",{type:"button",onClick:z,disabled:k,className:"flex flex-col items-center space-y-2 p-4 rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx(zs,{className:"w-8 h-8 text-icon"}),s.jsx("span",{className:"text-sm font-medium text-text",children:"Take Photo"})]})]}),s.jsx("p",{className:"text-xs text-secondary-text",children:"JPEG, PNG, or WebP up to 50MB"})]})}),v&&s.jsx("p",{className:"text-red-600 text-sm mt-2",children:v}),A&&s.jsx("p",{className:"text-blue-600 text-sm mt-2",children:A})]}),s.jsxs("div",{className:"flex space-x-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"flex-1 btn-secondary",disabled:k,children:"Cancel"}),s.jsx("button",{type:"submit",className:"flex-1 btn-primary",disabled:k||w,children:w?"Compressing...":k?"Updating...":"Update Battle"})]})]})]}),f&&p&&s.jsx(qn,{isOpen:f,onClose:()=>{m(!1),y(null)},onCrop:q,imageFile:p})]})}function FE({isOpen:e,onClose:t,onBattleDeleted:n,onBattleUpdated:r,battle:i}){var p,y;const[a,o]=j.useState(!1),[l,c]=j.useState(!1),[u,h]=j.useState(!1),d=S=>!!(S&&typeof S=="string"&&S.trim()!==""&&S!=="undefined"&&S!=="null"&&S.startsWith("http")&&S.includes("game-assets"));if(!e||!i)return null;const f=S=>{if(!S)return"text-secondary-text";const g=S.toLowerCase();return g.includes("win")||g.includes("victory")?"text-green-600":g.includes("loss")||g.includes("defeat")?"text-red-600":g.includes("draw")||g.includes("tie")?"text-yellow-600":"text-secondary-text"},m=S=>{S.target===S.currentTarget&&t()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:m,children:s.jsxs("div",{className:`bg-modal-bg rounded-lg max-w-2xl w-full p-6 overflow-y-auto transition-all duration-300 ease-out transform\r
          fixed inset-0 sm:relative sm:inset-auto sm:max-w-2xl sm:h-auto sm:rounded-lg sm:max-h-[90vh] h-screen w-screen sm:w-full overflow-y-auto rounded-none sm:rounded-lg p-6 sm:p-6`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-text font-overpass",children:"Battle Details"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>c(!0),className:"text-secondary-text hover:text-text transition-colors p-2 rounded-full hover:bg-bg-secondary",title:"Edit Battle",children:s.jsx(Vs,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>o(!0),className:"text-red-500 hover:text-red-700 transition-colors p-2 rounded-full hover:bg-red-50",title:"Delete Battle",children:s.jsx(Hn,{className:"w-5 h-5"})}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors p-2 rounded-full hover:bg-bg-secondary",children:s.jsx(fe,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{children:s.jsx("h3",{className:"text-2xl font-bold text-title mb-2",children:i.battle_name||"Untitled Battle"})}),i.image_url&&s.jsxs("div",{className:"col-span-full mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx(En,{className:"w-5 h-5 text-icon"}),s.jsx("h3",{className:"text-lg font-semibold text-text",children:"Battle Image"})]}),s.jsx("div",{className:"relative",children:s.jsx("img",{src:i.image_url,alt:"Battle image",className:"w-full max-w-md mx-auto rounded-lg shadow-lg",onError:S=>{const g=S.target;g.style.display="none"}})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-bg-secondary rounded-lg",children:[d(i.game_icon)?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:i.game_icon||"",alt:`${i.game_name||"Unknown Game"} icon`,className:"w-10 h-10 object-contain rounded flex-shrink-0",onError:S=>{const g=S.target;console.warn("Game icon failed to load:",i.game_icon,"Falling back to letter icon"),g.style.display="none";const b=g.nextElementSibling;b&&b.classList.contains("icon-fallback")&&(b.style.display="flex")},onLoad:S=>{const b=S.target.nextElementSibling;b&&b.classList.contains("icon-fallback")&&(b.style.display="none")}}),s.jsx("div",{className:"w-10 h-10 bg-red-600 rounded-full flex items-center justify-center icon-fallback flex-shrink-0",children:s.jsx("span",{className:"text-white text-sm font-bold",children:((p=i.game_name)==null?void 0:p.charAt(0))||"?"})})]}):s.jsx("div",{className:"w-10 h-10 bg-red-600 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx("span",{className:"text-white text-sm font-bold",children:((y=i.game_name)==null?void 0:y.charAt(0))||"?"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-secondary-text",children:"Game"}),s.jsx("p",{className:"font-medium text-text",children:i.game_name||"Unknown Game"})]})]}),s.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-bg-secondary rounded-lg",children:[s.jsx(Xe,{className:"w-10 h-10 text-icon flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-secondary-text",children:"Date Played"}),s.jsx("p",{className:"font-medium text-text",children:i.date_played?jt(i.date_played,{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"No date"})]})]}),s.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-bg-secondary rounded-lg",children:[s.jsx($t,{className:"w-10 h-10 text-icon flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-secondary-text",children:"Opponent"}),s.jsx("p",{className:"font-medium text-text",children:i.opp_name||"No opponent"})]})]}),s.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-bg-secondary rounded-lg",children:[s.jsx(Kv,{className:"w-10 h-10 text-icon flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-secondary-text",children:"Result"}),s.jsx("p",{className:`font-medium ${f(i.result)}`,children:i.result||"No result recorded"})]})]})]}),s.jsx("div",{className:"pt-4 border-t border-border-custom",children:s.jsxs("p",{className:"text-sm text-secondary-text",children:["Battle logged on ",jt(i.created_at,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})})]})]})}),s.jsx(rb,{isOpen:a,onClose:()=>o(!1),onConfirm:async()=>{h(!0);try{n==null||n(),o(!1),t()}catch(S){console.error("Error deleting battle:",S)}finally{h(!1)}},loading:u}),s.jsx(RE,{isOpen:l,onClose:()=>c(!1),battle:i,onBattleUpdated:()=>{r==null||r(),c(!1)}})]})}function $E({isOpen:e,onClose:t,onBattleCreated:n}){const[r,i]=j.useState(""),[a,o]=j.useState(""),[l,c]=j.useState(""),[u,h]=j.useState(null),[d,f]=j.useState(!1),[m,p]=j.useState(null);j.useState(null);const[y,S]=j.useState([]),[g,b]=j.useState(!1),[x,k]=j.useState(!1),[N,w]=j.useState(""),[C,T]=j.useState(""),[I,v]=j.useState(""),{user:P}=Ge(),{addRecentGame:A}=Hs();Ne.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]),j.useEffect(()=>{e&&L()},[e]);const L=async()=>{try{const{data:z,error:q}=await Y.from("games").select("id, name, icon").order("name");if(q)throw q;S(z||[])}catch(z){console.error("Error fetching games:",z),w("Failed to load games")}},O=()=>!(P!=null&&P.fav_games)||P.fav_games.length===0?[]:y.filter(z=>{var q;return(q=P.fav_games)==null?void 0:q.includes(z.id)}),M=z=>{c(z);const q=y.find(E=>E.id===z);q&&A(q)},U=z=>{const q=z.target.files;if(T(""),v(""),q&&q.length>0){const E=q[0];if(!bn(E)){T("Please select a valid image file (JPEG, PNG, or WebP)"),h(null),z.target.value="";return}const K=50*1024*1024;E.size>K?(T(`Your image must be 50MB or less. Current size: ${He(E.size)}`),h(null),z.target.value=""):(h(E),p(E),f(!0),E.size>1024*1024&&v(`Original size: ${He(E.size)}. Image will be automatically compressed before upload.`))}else h(null)},H=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){T("Camera is not available on this device");return}T("");const z=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280,max:1920},height:{ideal:720,max:1080}}}),q=document.createElement("video");q.srcObject=z,q.autoplay=!0,q.playsInline=!0,q.muted=!0,q.style.position="fixed",q.style.top="0",q.style.left="0",q.style.width="100%",q.style.height="100%",q.style.zIndex="9999",q.style.objectFit="cover",q.style.backgroundColor="#000";const E=document.createElement("canvas"),K=E.getContext("2d");if(!K)throw new Error("Could not get canvas context");const G=document.createElement("button");G.textContent=" Take Photo",G.style.position="fixed",G.style.bottom="20px",G.style.left="50%",G.style.transform="translateX(-50%)",G.style.zIndex="10000",G.style.padding="12px 24px",G.style.backgroundColor="#007bff",G.style.color="white",G.style.border="none",G.style.borderRadius="8px",G.style.fontSize="16px",G.style.fontWeight="bold",G.style.cursor="pointer";const W=document.createElement("button");W.textContent=" Cancel",W.style.position="fixed",W.style.bottom="20px",W.style.right="20px",W.style.zIndex="10000",W.style.padding="12px 24px",W.style.backgroundColor="#dc3545",W.style.color="white",W.style.border="none",W.style.borderRadius="8px",W.style.fontSize="16px",W.style.fontWeight="bold",W.style.cursor="pointer";const le=()=>{try{E.width=q.videoWidth,E.height=q.videoHeight,K.drawImage(q,0,0,E.width,E.height),E.toBlob(ae=>{if(ae){const be=new File([ae],`battle-photo-${Date.now()}.jpg`,{type:"image/jpeg",lastModified:Date.now()});if(!bn(be)){T("Please select a valid image file (JPEG, PNG, or WebP)");return}const je=50*1024*1024;be.size>je?T(`Your image must be 50MB or less. Current size: ${He(be.size)}`):(h(be),T(""),v(""),p(be),f(!0),be.size>1024*1024&&v(`Original size: ${He(be.size)}. Image will be automatically compressed before upload.`))}se()},"image/jpeg",.9)}catch(ae){console.error("Error capturing photo:",ae),T("Error capturing photo. Please try again."),se()}},se=()=>{try{z&&z.getTracks().forEach(ae=>ae.stop()),document.body.contains(q)&&document.body.removeChild(q),document.body.contains(G)&&document.body.removeChild(G),document.body.contains(W)&&document.body.removeChild(W)}catch(ae){console.error("Error during cleanup:",ae)}};G.addEventListener("click",le),W.addEventListener("click",se),document.body.appendChild(q),document.body.appendChild(G),document.body.appendChild(W),q.addEventListener("loadedmetadata",()=>{console.log("Video ready, dimensions:",q.videoWidth,"x",q.videoHeight)}),q.addEventListener("error",ae=>{console.error("Video error:",ae),T("Error loading camera feed. Please try again."),se()})}catch(z){console.error("Error accessing camera:",z),z instanceof DOMException?z.name==="NotAllowedError"?T("Camera access denied. Please allow camera permissions and try again."):z.name==="NotFoundError"?T("No camera found on this device."):z.name==="NotReadableError"?T("Camera is already in use by another application."):T(`Camera error: ${z.message}`):T("Unable to access camera. Please try again or use the file upload option.")}},F=z=>{h(z),f(!1),p(null)},B=z=>{z.target===z.currentTarget&&t()},_=async z=>{if(z.preventDefault(),!!P){if(!r){w("Date played is required");return}if(!a.trim()){w("Opponent name is required");return}if(!l){w("Game is required");return}b(!0),w("");try{const q=y.find(W=>W.id===l),E=`${(q==null?void 0:q.name)||"Unknown Game"} against ${a.trim()}`;let K=null;if(u){k(!0);try{const W=await yn(u),le=W.name.split(".").pop(),se=`battle-images/${P.id}/${Date.now()}.${le}`,{data:ae,error:be}=await Y.storage.from("battle-images").upload(se,W,{cacheControl:"3600",upsert:!0});if(be)throw be;const{data:je}=Y.storage.from("battle-images").getPublicUrl(se);K=je.publicUrl}catch(W){console.error("Error uploading image:",W),w("Failed to upload image. Please try again."),k(!1);return}finally{k(!1)}}const{error:G}=await Y.from("battles").insert({battle_name:E,date_played:r,opp_name:a.trim(),game_name:(q==null?void 0:q.name)||"",game_uid:l,image_url:K,user_id:P.id});if(G)throw G;n(),t()}catch(q){console.error("Error creating battle:",q),w("Failed to create battle. Please try again.")}finally{b(!1)}}};return e?s.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:B,children:[s.jsxs("div",{className:`bg-modal-bg rounded-lg max-w-lg w-full p-6 overflow-y-auto transition-all duration-300 ease-out transform\r
        fixed inset-0 sm:relative sm:inset-auto sm:max-w-lg sm:h-auto sm:rounded-lg sm:max-h-[90vh] h-screen w-screen sm:w-full overflow-y-auto rounded-none sm:rounded-lg p-6 sm:p-6`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-text font-overpass",children:"Log New Battle"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6"})})]}),s.jsxs("form",{onSubmit:_,className:"space-y-6",children:[N&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsx("p",{className:"text-red-600",children:N})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{htmlFor:"datePlayed",className:"block text-sm font-medium text-input-label font-overpass",children:"Date Played"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Required"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-icon"}),s.jsx("input",{type:"date",id:"datePlayed",value:r,onChange:z=>i(z.target.value),max:new Date().toISOString().split("T")[0],className:"w-full pl-10 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text",disabled:g})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{htmlFor:"opponentName",className:"block text-sm font-medium text-input-label font-overpass",children:"Opponent"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Required"})]}),s.jsxs("div",{className:"relative",children:[s.jsx($t,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-icon"}),s.jsx("input",{type:"text",id:"opponentName",value:a,onChange:z=>o(z.target.value),placeholder:"Enter opponent's name",className:"w-full pl-10 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] placeholder-secondary-text bg-bg-primary text-text",disabled:g})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{htmlFor:"game",className:"block text-sm font-medium text-input-label font-overpass",children:"Game"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Required"})]}),s.jsx(Yr,{games:y,selectedGame:l,onGameSelect:M,placeholder:"Choose a Game",favoriteGames:O()})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass",children:"Battle Image"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Optional"})]}),s.jsx("div",{className:"border-2 border-dashed border-border-custom rounded-lg p-6 text-center hover:border-[var(--color-brand)] transition-colors",children:u?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative mx-auto w-32 h-32",children:[s.jsx("img",{src:URL.createObjectURL(u),alt:"Selected battle image",className:"w-full h-full object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>{h(null),T(""),v("")},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",children:s.jsx(fe,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-sm text-secondary-text",children:u.name})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-center space-x-4",children:[s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:U,className:"hidden",disabled:g}),s.jsxs("div",{className:"flex flex-col items-center space-y-2 p-4 rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx(En,{className:"w-8 h-8 text-icon"}),s.jsx("span",{className:"text-sm font-medium text-text",children:"Upload Image"})]})]}),s.jsxs("button",{type:"button",onClick:H,disabled:g,className:"flex flex-col items-center space-y-2 p-4 rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx(zs,{className:"w-8 h-8 text-icon"}),s.jsx("span",{className:"text-sm font-medium text-text",children:"Take Photo"})]})]}),s.jsx("p",{className:"text-xs text-secondary-text",children:"JPEG, PNG, or WebP up to 50MB"})]})}),C&&s.jsx("p",{className:"text-red-600 text-sm mt-2",children:C}),I&&s.jsx("p",{className:"text-blue-600 text-sm mt-2",children:I})]}),s.jsxs("div",{className:"flex space-x-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"flex-1 btn-secondary",disabled:g,children:"Cancel"}),s.jsx("button",{type:"submit",className:"flex-1 btn-primary",disabled:g||x||!r||!a.trim()||!l,children:x?"Compressing...":g?"Creating...":"Log Battle"})]})]})]}),d&&m&&s.jsx(qn,{isOpen:d,onClose:()=>{f(!1),p(null)},onCrop:F,imageFile:m})]}):null}function zE(){const[e,t]=j.useState([]),[n,r]=j.useState(!0),[i,a]=j.useState(!1),{user:o,loading:l}=Ge(),c=async()=>{if(l){r(!0),a(!1);return}if(!o){t([]),r(!1),a(!0);return}const h=Date.now(),d=500;try{r(!0);const{data:f,error:m}=await Y.from("battles").select("*").eq("user_id",o.id).order("date_played",{ascending:!1}).order("created_at",{ascending:!1});if(m)console.error("Error fetching battles:",m),t([]);else{const p=await Promise.all((f||[]).map(async y=>{if(y.game_uid)try{const{data:S}=await Y.from("games").select("icon").eq("id",y.game_uid).single();return{...y,game_icon:(S==null?void 0:S.icon)||null}}catch(S){return console.warn("Failed to fetch game icon for battle:",y.id,S),{...y,game_icon:null}}else return{...y,game_icon:null}}));t(p)}}catch(f){console.error("Error fetching battles:",f),t([])}finally{const f=Date.now()-h,m=Math.max(0,d-f);setTimeout(()=>{r(!1),a(!0)},m)}};j.useEffect(()=>{c()},[o,l]);const u=()=>{c()};return console.log("useBattles state:",{loading:n,hasInitialized:i,battlesLength:e.length,authLoading:l}),{battles:e,loading:n,hasInitialized:i,refetch:u}}function BE({onBack:e}){const[t,n]=j.useState({isOpen:!1,battleId:null}),[r,i]=j.useState({isOpen:!1,battle:null}),[a,o]=j.useState(!1),[l,c]=j.useState(!1),{battles:u,loading:h,hasInitialized:d,refetch:f}=zE();console.log("BattlesPage render:",{loading:h,hasInitialized:d,battlesLength:u.length});const m=x=>{n({isOpen:!0,battleId:x})},p=async()=>{if(t.battleId){c(!0);try{const{error:x}=await Y.from("battles").delete().eq("id",t.battleId);if(x)throw x;await f(),n({isOpen:!1,battleId:null})}catch(x){console.error("Error deleting battle:",x)}finally{c(!1)}}},y=()=>{f()},S=x=>{i({isOpen:!0,battle:x})},g=()=>{f()},b=async()=>{if(await f(),r.isOpen&&r.battle){const x=await Y.from("battles").select("*").eq("id",r.battle.id).single();x.data&&i({isOpen:!0,battle:x.data})}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[s.jsx("div",{className:"text-center mb-8",children:s.jsx("h1",{className:"text-4xl font-bold text-title mb-4",children:"YOUR BATTLES"})}),s.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-8",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(ax,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-sm font-medium text-amber-800 mb-1",children:"Battle tracking is still under construction!"}),s.jsx("p",{className:"text-sm text-amber-700",children:"Please feel free to experiment with this feature - but be warned! Your data may be lost as we continue to build this feature."})]})]})}),s.jsx("div",{className:"mb-8",children:h||!d?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Array.from({length:4}).map((x,k)=>s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm border border-border-custom p-4 animate-pulse",children:[s.jsx("div",{className:"h-6 bg-secondary-text opacity-20 rounded w-3/4 mb-3"}),s.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[s.jsx("div",{className:"w-4 h-4 bg-secondary-text opacity-20 rounded"}),s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-1/3"})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[s.jsx("div",{className:"w-4 h-4 bg-secondary-text opacity-20 rounded"}),s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-1/2"})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[s.jsx("div",{className:"w-4 h-4 bg-secondary-text opacity-20 rounded"}),s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-2/3"})]})]},k))}):!h&&d&&u.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Sd,{className:"w-16 h-16 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text mb-4",children:"No battles logged yet."}),s.jsx("div",{className:"flex justify-center",children:s.jsxs("button",{className:"btn-primary",onClick:()=>o(!0),children:[s.jsx(Pn,{className:"w-4 h-4 mr-2"}),"Log Your First Battle"]})})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"bg-bg-card rounded-lg border border-border-custom overflow-hidden",children:s.jsx("div",{className:"divide-y divide-border-custom",children:u.map(x=>s.jsx(OE,{battle:x,onViewBattle:()=>S(x),onDeleteBattle:m},x.id))})}),s.jsx("div",{className:"fixed bottom-20 right-4 z-30",children:s.jsx("button",{onClick:()=>o(!0),className:"bg-brand hover:bg-brand/90 text-white rounded-full p-4 shadow-lg transition-colors",title:"Add New Battle",children:s.jsx(Pn,{className:"w-6 h-6"})})})]})})]}),s.jsx(rb,{isOpen:t.isOpen,onClose:()=>n({isOpen:!1,battleId:null}),onConfirm:p,loading:l}),s.jsx($E,{isOpen:a,onClose:()=>o(!1),onBattleCreated:y}),s.jsx(FE,{isOpen:r.isOpen,onClose:()=>i({isOpen:!1,battle:null}),onBattleDeleted:g,onBattleUpdated:b,battle:r.battle})]})}function UE({isOpen:e,onClose:t,onConfirm:n,modelName:r,loading:i=!1}){if(!e)return null;const a=o=>{o.target===o.currentTarget&&t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:a,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h2",{className:"text-xl font-bold text-title",children:["Are you sure you want to delete ",r,"?"]}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text",children:s.jsx(fe,{className:"w-6 h-6"})})]}),s.jsx("p",{className:"text-base text-secondary-text mb-6",children:"This cannot be undone. If you've added images or notes, these will be deleted as well."}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:t,disabled:i,className:"btn-ghost btn-flex",children:"Cancel"}),s.jsx("button",{onClick:n,disabled:i,className:"btn-danger btn-flex",children:i?"Deleting...":"Delete Model"})]})]})})}function VE({isOpen:e,onClose:t,model:n,onModelUpdated:r}){var L;const{user:i}=Ge(),[a,o]=j.useState({name:"",count:1,purchase_date:"",notes:"",game_id:"",status:"",painted_date:""}),[l,c]=j.useState(null),[u,h]=j.useState(!1),[d,f]=j.useState(!1),[m,p]=j.useState(!1),[y,S]=j.useState(null),[g,b]=j.useState(null),[x,k]=j.useState([]),[N,w]=j.useState(!1);j.useEffect(()=>{n&&o({name:n.name,count:n.count,purchase_date:n.purchase_date||"",notes:n.notes||"",game_id:n.game_id||"",status:n.status||"",painted_date:n.painted_date||""})},[n]),j.useEffect(()=>{e&&(async()=>{const{data:M,error:U}=await Y.from("games").select("id, name, icon").order("name");U?console.error("Error fetching games:",U):k(M||[])})()},[e]);const C=O=>{var U;const M=(U=O.target.files)==null?void 0:U[0];if(M){if(!M.type.startsWith("image/")){alert("Please select an image file");return}c(M),S(M),p(!0)}},T=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){alert("Camera is not available on this device");return}const O=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280,max:1920},height:{ideal:720,max:1080}}}),M=document.createElement("video");M.srcObject=O,M.autoplay=!0,M.playsInline=!0,M.muted=!0,M.style.position="fixed",M.style.top="0",M.style.left="0",M.style.width="100%",M.style.height="100%",M.style.zIndex="9999",M.style.objectFit="cover",M.style.backgroundColor="#000";const U=document.createElement("canvas"),H=U.getContext("2d");if(!H)throw new Error("Could not get canvas context");const F=document.createElement("button");F.textContent=" Take Photo",F.style.position="fixed",F.style.bottom="20px",F.style.left="50%",F.style.transform="translateX(-50%)",F.style.zIndex="10000",F.style.padding="12px 24px",F.style.backgroundColor="#007bff",F.style.color="white",F.style.border="none",F.style.borderRadius="8px",F.style.fontSize="16px",F.style.fontWeight="bold",F.style.cursor="pointer";const B=document.createElement("button");B.textContent=" Cancel",B.style.position="fixed",B.style.bottom="20px",B.style.right="20px",B.style.zIndex="10000",B.style.padding="12px 24px",B.style.backgroundColor="#dc3545",B.style.color="white",B.style.border="none",B.style.borderRadius="8px",B.style.fontSize="16px",B.style.fontWeight="bold",B.style.cursor="pointer";const _=()=>{try{U.width=M.videoWidth,U.height=M.videoHeight,H.drawImage(M,0,0,U.width,U.height),U.toBlob(q=>{if(q){const E=new File([q],`model-photo-${Date.now()}.jpg`,{type:"image/jpeg",lastModified:Date.now()});c(E),S(E),p(!0)}z()},"image/jpeg",.9)}catch(q){console.error("Error capturing photo:",q),alert("Error capturing photo. Please try again."),z()}},z=()=>{try{O&&O.getTracks().forEach(q=>q.stop()),document.body.contains(M)&&document.body.removeChild(M),document.body.contains(F)&&document.body.removeChild(F),document.body.contains(B)&&document.body.removeChild(B)}catch(q){console.error("Error during cleanup:",q)}};F.addEventListener("click",_),B.addEventListener("click",z),document.body.appendChild(M),document.body.appendChild(F),document.body.appendChild(B),M.addEventListener("loadedmetadata",()=>{console.log("Video ready, dimensions:",M.videoWidth,"x",M.videoHeight)}),M.addEventListener("error",q=>{console.error("Video error:",q),alert("Error loading camera feed. Please try again."),z()})}catch(O){console.error("Error accessing camera:",O),O instanceof DOMException?O.name==="NotAllowedError"?alert("Camera access denied. Please allow camera permissions and try again."):O.name==="NotFoundError"?alert("No camera found on this device."):O.name==="NotReadableError"?alert("Camera is already in use by another application."):alert(`Camera error: ${O.message}`):alert("Unable to access camera. Please try again or use the file upload option.")}},I=async O=>{try{f(!0),console.log("Original cropped size:",(O.size/1024).toFixed(2),"KB");const M=await yn(O,1200,1200,.8);console.log("Compressed size:",(M.size/1024).toFixed(2),"KB"),b(M)}catch(M){console.error("Compression failed, using original cropped image:",M),b(O)}finally{f(!1),p(!1)}},v=()=>{w(!0),b(null),c(null)},P=async O=>{if(O.preventDefault(),!!i){h(!0);try{let M=n.image_url;if(N){if(n.image_url&&n.image_url.includes("supabase"))try{const H=n.image_url.split("/"),F=H.findIndex(B=>B==="model-images");if(F!==-1){const B=H.slice(F+1).join("/");await Y.storage.from("model-images").remove([B])}}catch(H){console.warn("Failed to delete old image:",H)}M=null}else if(g){if(n.image_url&&n.image_url.includes("supabase"))try{const E=n.image_url.split("/"),K=E.findIndex(G=>G==="model-images");if(K!==-1){const G=E.slice(K+1).join("/");await Y.storage.from("model-images").remove([G])}}catch(E){console.warn("Failed to delete old image:",E)}const H=(l==null?void 0:l.name.split(".").pop())||"jpg",F=`${Date.now()}-${Math.random().toString(36).substring(2)}.${H}`,B=`${i.id}/${F}`,{data:_,error:z}=await Y.storage.from("model-images").upload(B,g);if(z)throw console.error("Upload error:",z),new Error(`Failed to upload image: ${z.message}`);const{data:q}=Y.storage.from("model-images").getPublicUrl(_.path);M=q.publicUrl,console.log("New image uploaded:",M)}const{error:U}=await Y.from("models").update({name:a.name,count:a.count,purchase_date:a.purchase_date||null,notes:a.notes||null,game_id:a.game_id||null,image_url:M,status:a.status||"None",painted_date:a.painted_date||null}).eq("id",n.id);if(U)throw U;r(),t(),c(null),b(null),S(null),w(!1)}catch(M){console.error("Error updating model:",M),alert("Failed to update model. Please try again.")}finally{h(!1)}}};if(!e)return null;const A=O=>{O.target===O.currentTarget&&t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",onClick:A,children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",onClick:O=>O.stopPropagation(),children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Edit Model"}),s.jsx("button",{onClick:t,className:"text-icon hover:text-icon-hover",children:s.jsx(fe,{className:"w-6 h-6"})})]}),m&&y&&s.jsx(qn,{isOpen:m,imageFile:y,onCrop:I,onClose:()=>{p(!1),S(null),c(null)}}),!m&&s.jsxs("form",{onSubmit:P,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(Hi,{className:"w-4 h-4 mr-2"}),"Model Name"]}),s.jsx("input",{type:"text",value:a.name,onChange:O=>o({...a,name:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)] dark:bg-gray-700 dark:text-white",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(vn,{className:"w-4 h-4 mr-2"}),"Box"]}),s.jsx("input",{type:"text",value:((L=n.box)==null?void 0:L.name)||"No Collection (Loose Model)",disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 cursor-not-allowed"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Box assignment cannot be changed in edit mode."})]}),!n.box&&s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(Wo,{className:"w-4 h-4 mr-2"}),"Game"]}),s.jsx(Yr,{games:x,selectedGame:a.game_id,onGameSelect:O=>o({...a,game_id:O})})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(Hi,{className:"w-4 h-4 mr-2"}),"Painted Status"]}),s.jsxs("select",{value:a.status,onChange:O=>o({...a,status:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)] dark:bg-gray-700 dark:text-white",children:[s.jsx("option",{value:"",children:"Select Status"}),s.jsx("option",{value:"Assembled",children:"Assembled"}),s.jsx("option",{value:"Primed",children:"Primed"}),s.jsx("option",{value:"Partially Painted",children:"Partially Painted"}),s.jsx("option",{value:"Painted",children:"Painted"})]})]}),a.status==="Painted"&&s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(Xe,{className:"w-4 h-4 mr-2"}),"Painted Date"]}),s.jsx(Ki,{value:a.painted_date,onChange:O=>o({...a,painted_date:O}),placeholder:"Select painted date",minDate:""})]}),!n.box&&s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(Xe,{className:"w-4 h-4 mr-2"}),"Purchase Date"]}),s.jsx(Ki,{value:a.purchase_date,onChange:O=>o({...a,purchase_date:O}),placeholder:"Select purchase date",minDate:""})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[s.jsx(Yo,{className:"w-4 h-4 mr-2"}),"Number of Models"]}),s.jsx("input",{type:"number",min:"1",value:a.count,onChange:O=>o({...a,count:parseInt(O.target.value)||1}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)] dark:bg-gray-700 dark:text-white",required:!0})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass",children:"Model Image"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Optional"})]}),s.jsx("div",{className:"border-2 border-dashed border-border-custom rounded-lg p-6 text-center hover:border-[var(--color-brand)] transition-colors",children:l?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative mx-auto w-32 h-32",children:[s.jsx("img",{src:URL.createObjectURL(l),alt:"Selected model image",className:"w-full h-full object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>{c(null),b(null)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",children:s.jsx(fe,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-sm text-secondary-text",children:l.name})]}):n.image_url&&!N?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative mx-auto w-32 h-32",children:[s.jsx("img",{src:n.image_url,alt:"Current model image",className:"w-full h-full object-cover rounded-lg",onError:O=>{const M=O.target;M.style.display="none"}}),s.jsx("button",{type:"button",onClick:v,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",title:"Remove current image",children:s.jsx(Hn,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-sm text-secondary-text",children:"Current image"})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-center space-x-4",children:[s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:C,className:"hidden",disabled:u}),s.jsxs("div",{className:"flex flex-col items-center space-y-2 p-4 rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx(En,{className:"w-8 h-8 text-icon"}),s.jsx("span",{className:"text-sm font-medium text-text",children:"Upload Image"})]})]}),s.jsxs("button",{type:"button",onClick:T,disabled:u,className:"flex flex-col items-center space-y-2 p-4 rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx(zs,{className:"w-8 h-8 text-icon"}),s.jsx("span",{className:"text-sm font-medium text-text",children:"Take Photo"})]})]}),s.jsx("p",{className:"text-xs text-secondary-text",children:"JPEG, PNG, or WebP up to 50MB"})]})}),g&&s.jsxs("p",{className:"text-green-600 text-sm mt-2",children:[" Cropped image ready for upload (",(g.size/1024).toFixed(1)," KB)"]}),d&&s.jsx("p",{className:"text-blue-600 text-sm mt-2",children:"Compressing image..."}),N&&s.jsx("p",{className:"text-red-600 text-sm mt-2",children:" Image will be deleted when you save changes"})]}),s.jsx(Xi,{value:a.notes,onChange:O=>o({...a,notes:O}),placeholder:"Optional notes about this model...",label:"Notes",rows:4}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"btn-ghost btn-flex",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:u||d,className:"btn-primary btn-flex",children:u?s.jsxs(s.Fragment,{children:[s.jsx(_d,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating..."]}):"Update Model"})]})]})]})})}function qE({isOpen:e,onClose:t,onModelUpdated:n,model:r}){const[i,a]=j.useState(!1),[o,l]=j.useState(!1),[c,u]=j.useState(!1),[h,d]=j.useState(""),[f,m]=j.useState(!1),[p,y]=j.useState("");j.useEffect(()=>{r&&a(r.public??!1)},[r]);const S=async()=>{if(r){l(!0),d("");try{const{error:x}=await Y.from("models").update({public:!i}).eq("id",r.id);if(x)throw x;a(!i),n==null||n()}catch(x){d(x instanceof Error?x.message:"Failed to update model visibility")}finally{l(!1)}}},g=async()=>{if(r){u(!0),d("");try{const x=So(`/shared/model/${r.id}`);await navigator.clipboard.writeText(x),y(`${r.name}'s URL has been copied to your clipboard!`),m(!0)}catch(x){console.error("Error copying URL:",x);const k=So(`/shared/model/${r.id}`),N=document.createElement("textarea");N.value=k,document.body.appendChild(N),N.select(),document.execCommand("copy"),document.body.removeChild(N),y(`${r.name}'s URL has been copied to your clipboard!`),m(!0)}finally{u(!1)}}},b=x=>{x.target===x.currentTarget&&t()};return!e||!r?null:s.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[70]",onClick:b,children:[s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-lg font-bold text-title",children:["Share ",r.name]}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6 text-icon"})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"text-sm text-secondary-text",children:"Sharing a model makes it visible to other users who have the link to it."}),s.jsx("div",{className:"space-y-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(sa,{className:"w-5 h-5 text-icon"}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-input-label",children:"Make Public"}),s.jsx("p",{className:"text-xs text-secondary-text",children:"Allow anyone to view this model"})]})]}),s.jsx("button",{onClick:S,disabled:o,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-brand focus:ring-offset-2 disabled:opacity-50 ${i?"bg-brand":"bg-secondary-text"}`,children:s.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i?"translate-x-6":"translate-x-1"}`})})]})}),i&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Nd,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm text-green-800",children:"This model is now public and can be viewed by anyone with the link."})]})}),!i&&s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(px,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"text-sm text-gray-800",children:"This model is private and only visible to you."})]})}),i&&s.jsxs("button",{onClick:g,disabled:c,className:"btn-secondary btn-full btn-with-icon",children:[s.jsx(ux,{className:"w-4 h-4"}),s.jsx("span",{children:c?"Copying...":"Copy URL"})]}),h&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:h}),s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{onClick:t,className:"btn-secondary",children:"Done"})})]})]}),s.jsx(rl,{message:p,isVisible:f,onClose:()=>m(!1)})]})}function GE({isOpen:e,onClose:t,onModelDeleted:n,onModelUpdated:r,onViewBox:i,model:a}){var le,se,ae,be,je,Ie,ne,Q,re,ge,ve,we,Ue,Fe,V,X,oe,Se,rt;const[o,l]=Ne.useState(!1),[c,u]=Ne.useState(!1),[h,d]=Ne.useState(!1),[f,m]=Ne.useState(!1),[p,y]=Ne.useState(!1),[S,g]=Ne.useState(a),[b,x]=Ne.useState("details"),[k,N]=Ne.useState({lore_name:"",lore_description:""}),[w,C]=Ne.useState({lore_name:"",lore_description:""}),[T,I]=Ne.useState({painting_notes:""}),[v,P]=Ne.useState({painting_notes:""}),A=[{id:"details",label:"Details",icon:mx},{id:"lore",label:"Lore",icon:Zc},{id:"painting",label:"Painting",icon:vi}];Ne.useEffect(()=>{if(g(a),a){const D={lore_name:a.lore_name||"",lore_description:a.lore_description||""},R={painting_notes:a.painting_notes||""};N(D),C(D),I(R),P(R)}},[a]);const L=async()=>{r==null||r()};if(Ne.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]),!e||!a)return null;const O=D=>{c||D.target===D.currentTarget&&t()},M=D=>jt(D,{month:"2-digit",day:"2-digit",year:"2-digit"}),U=(D,R)=>`${R} Model${R>1?"s":""}`,H=()=>(a==null?void 0:a.painted_date)||null,F=()=>(a==null?void 0:a.notes)||null,B=()=>{l(!0)},_=async()=>{if(a){m(!0);try{if(a.image_url&&typeof a.image_url=="string"&&a.image_url.includes("supabase")){const R=a.image_url.split("/"),$=R.findIndex(te=>te==="model-images");if($!==-1){const te=R.slice($+1).join("/");await Y.storage.from("model-images").remove([te])}}const{error:D}=await Y.from("models").delete().eq("id",a.id);if(D)throw D;l(!1),t(),n&&n()}catch(D){console.error("Error deleting model:",D)}finally{m(!1)}}},z=()=>{d(!0)},q=async()=>{u(!1),t(),r&&await r()},E=async()=>{if(!S)return;const{error:D}=await Y.from("models").update({lore_name:k.lore_name,lore_description:k.lore_description}).eq("id",S.id);D?console.error("Error saving lore:",D):(g(R=>R?{...R,lore_name:k.lore_name,lore_description:k.lore_description}:null),C(k))},K=async()=>{if(!S)return;const{error:D}=await Y.from("models").update({painting_notes:T.painting_notes}).eq("id",S.id);D?console.error("Error saving painting notes:",D):(g(R=>R?{...R,painting_notes:T.painting_notes}:null),P(T))},G=k.lore_name!==w.lore_name||k.lore_description!==w.lore_description,W=T.painting_notes!==v.painting_notes;return!e||!S?null:s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`fixed inset-0 bg-black flex items-center justify-center p-4 z-50 ${c?"bg-opacity-25":"bg-opacity-50"}`,onClick:O,children:s.jsxs("div",{className:"bg-modal-bg max-w-2xl w-full overflow-y-auto md:rounded-lg md:max-w-2xl md:max-h-[90vh] fixed inset-0 md:relative md:inset-auto h-screen md:h-auto",children:[s.jsx("div",{className:"relative",children:s.jsx("img",{src:(()=>{var R,$,te;if(a.image_url&&typeof a.image_url=="string"&&a.image_url.trim()!==""&&a.image_url!=="undefined"&&a.image_url!=="null"&&(a.image_url.startsWith("http")||a.image_url.startsWith("/")))return a.image_url;const D=(($=(R=a.box)==null?void 0:R.game)==null?void 0:$.image)||((te=a.game)==null?void 0:te.image);return D&&typeof D=="string"&&D.trim()!==""&&D!=="undefined"&&D!=="null"&&D.startsWith("http")?D:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"})(),alt:a.name,className:"w-full max-h-[60%] object-cover",loading:"lazy",onError:D=>{const R=D.target,$="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg";R.src!==$&&(console.log("Modal image failed to load:",R.src,"Falling back to default"),R.src=$)}})}),s.jsx("button",{onClick:t,className:"fixed top-4 right-4 md:absolute text-white hover:text-gray-300 transition-colors bg-black bg-opacity-50 rounded-full p-2 z-20",children:s.jsx(fe,{className:"w-6 h-6 text-icon"})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"text-center mb-6 relative",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-title",children:a.name}),s.jsx("button",{onClick:()=>u(!0),className:"p-1 text-secondary-text hover:text-text transition-colors rounded",children:s.jsx(Vs,{className:"w-4 h-4"})})]}),a.box?s.jsx("button",{onClick:()=>{t(),i==null||i(a.box)},className:"text-base text-secondary-text mb-3 hover:text-amber-600 transition-colors",children:a.box.name}):null,s.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[(se=(le=a.box)==null?void 0:le.game)!=null&&se.icon||(ae=a.game)!=null&&ae.icon?s.jsx("img",{src:((je=(be=a.box)==null?void 0:be.game)==null?void 0:je.icon)||((Ie=a.game)==null?void 0:Ie.icon),alt:`${((Q=(ne=a.box)==null?void 0:ne.game)==null?void 0:Q.name)||((re=a.game)==null?void 0:re.name)||"Unknown Game"} icon`,className:"object-cover rounded max-h-[32px]",onError:D=>{const R=D.target;console.warn("Game icon failed to load:",R.src,"Falling back to letter icon"),R.style.display="none";const $=R.nextElementSibling;$&&$.classList.contains("icon-fallback")&&($.style.display="flex")},onLoad:D=>{const $=D.target.nextElementSibling;$&&$.classList.contains("icon-fallback")&&($.style.display="none")}}):null,s.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:(ve=(ge=a.box)==null?void 0:ge.game)!=null&&ve.icon||(we=a.game)!=null&&we.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-xs font-bold",children:(((Fe=(Ue=a.box)==null?void 0:Ue.game)==null?void 0:Fe.name)||((V=a.game)==null?void 0:V.name)||"Unknown Game").charAt(0)})}),s.jsx("span",{className:"text-lg font-semibold text-secondary-text",children:((oe=(X=a.box)==null?void 0:X.game)==null?void 0:oe.name)||((Se=a.game)==null?void 0:Se.name)||"Unknown Game"})]})]}),s.jsx(eb,{tabs:A,activeTab:b,onTabChange:D=>x(D),className:"mb-6"}),b==="details"&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 flex items-center space-x-3",children:[s.jsx(Yo,{className:"w-5 h-5 text-secondary-text"}),s.jsx("span",{className:"text-base text-text font-medium",children:U(a.status,a.count)})]}),((rt=a.box)==null?void 0:rt.purchase_date)&&s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 flex items-center space-x-3",children:[s.jsx(Xe,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("span",{className:"text-base text-text font-medium",children:["Purchased ",M(a.box.purchase_date)]})]}),H()&&s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 flex items-center space-x-3",children:[s.jsx(km,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("span",{className:"text-base text-text font-medium",children:["Painted ",M(H())]})]})]}),b==="lore"&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4",children:[s.jsx("label",{className:"block text-sm font-medium text-text mb-2",children:"Lore Name"}),s.jsx("input",{type:"text",value:k.lore_name,onChange:D=>N({...k,lore_name:D.target.value}),placeholder:"Enter lore name...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--color-brand)] dark:bg-gray-700 dark:text-white"})]}),s.jsx("div",{className:"bg-bg-secondary rounded-lg p-4",children:s.jsx(Xi,{value:k.lore_description,onChange:D=>N({...k,lore_description:D}),placeholder:"Enter lore description...",label:"Lore Description",rows:6})}),s.jsx("div",{className:"pt-4",children:s.jsx("button",{onClick:E,disabled:!G,className:"btn-secondary btn-full w-full disabled:opacity-50 disabled:cursor-not-allowed",children:"Save Lore"})})]}),b==="painting"&&s.jsxs("div",{className:"space-y-3",children:[H()&&s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 flex items-center space-x-3",children:[s.jsx(km,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("span",{className:"text-base text-text font-medium",children:["Painted ",M(H())]})]}),s.jsx("div",{className:"bg-bg-secondary rounded-lg p-4",children:s.jsx(Xi,{value:T.painting_notes,onChange:D=>I({...T,painting_notes:D}),placeholder:"Enter painting information...",label:"Painting Information",rows:6})}),s.jsx("div",{className:"pt-4",children:s.jsx("button",{onClick:K,disabled:!W,className:"btn-secondary btn-full w-full disabled:opacity-50 disabled:cursor-not-allowed",children:"Save Painting Information"})}),F()&&s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 flex items-start space-x-3",children:[s.jsx(Hi,{className:"w-5 h-5 text-secondary-text mt-0.5"}),s.jsx("div",{className:"flex-1",children:s.jsx(_s,{remarkPlugins:[Cs],components:{p:({children:D})=>s.jsx("p",{className:"mb-2 last:mb-0 text-base text-text",children:D}),h1:({children:D})=>s.jsx("h1",{className:"text-lg font-bold mb-2 text-text",children:D}),h2:({children:D})=>s.jsx("h2",{className:"text-base font-bold mb-2 text-text",children:D}),h3:({children:D})=>s.jsx("h3",{className:"text-sm font-bold mb-1 text-text",children:D}),ul:({children:D})=>s.jsx("ul",{className:"list-disc list-inside mb-2 space-y-1",children:D}),ol:({children:D})=>s.jsx("ol",{className:"list-decimal list-inside mb-2 space-y-1",children:D}),li:({children:D})=>s.jsx("li",{className:"text-sm text-text",children:D}),strong:({children:D})=>s.jsx("strong",{className:"font-semibold text-text",children:D}),em:({children:D})=>s.jsx("em",{className:"italic text-text",children:D}),code:({children:D})=>s.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 py-0.5 rounded text-xs font-mono",children:D}),pre:({children:D})=>s.jsx("pre",{className:"bg-gray-100 dark:bg-gray-800 p-2 rounded text-xs font-mono overflow-x-auto mb-2",children:D}),blockquote:({children:D})=>s.jsx("blockquote",{className:"border-l-4 border-gray-300 dark:border-gray-600 pl-3 italic mb-2 text-text",children:D})},children:F()})})]}),!H()&&!F()&&!T.painting_notes&&s.jsx("div",{className:"bg-bg-secondary rounded-lg p-4",children:s.jsxs("div",{className:"text-center text-secondary-text",children:[s.jsx(vi,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{children:"No painting information available"})]})})]}),s.jsx("div",{className:"pt-6",children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:z,className:"btn-primary btn-full btn-with-icon w-full",children:[s.jsx(sa,{className:"w-4 h-4"}),s.jsx("span",{children:"Share Model"})]}),s.jsx("button",{onClick:B,className:"btn-danger-outline w-full",children:"Delete this model"})]})})]})]})}),s.jsx(UE,{isOpen:o,onClose:()=>l(!1),onConfirm:_,modelName:a.name,loading:f}),s.jsx(VE,{isOpen:c,onClose:()=>u(!1),onModelUpdated:q,model:a}),s.jsx(qE,{isOpen:h,onClose:()=>d(!1),onModelUpdated:L,model:S}),s.jsx(rl,{message:"A share link has been copied to your clipboard",isVisible:p,onClose:()=>y(!1)})]})}function HE({isOpen:e,onClose:t,onConfirm:n,boxName:r,loading:i=!1}){if(!e)return null;const a=o=>{o.target===o.currentTarget&&t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:a,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h2",{className:"text-xl font-bold text-title",children:["Are you sure you want to delete ",r,"?"]}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text",children:s.jsx(fe,{className:"w-6 h-6"})})]}),s.jsx("p",{className:"text-base text-secondary-text mb-6",children:"This cannot be undone. If you've added images or notes, these will be deleted as well."}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:t,disabled:i,className:"btn-ghost btn-flex",children:"Cancel"}),s.jsx("button",{onClick:n,disabled:i,className:"btn-danger btn-flex",children:i?"Deleting...":"Delete Box"})]})]})})}function WE({isOpen:e,onClose:t,onModelsAdded:n,onAddNewModel:r,box:i}){var I;const[a,o]=j.useState([]),[l,c]=j.useState(new Set),[u,h]=j.useState(!0),[d,f]=j.useState(!1),[m,p]=j.useState(null),{user:y}=Ge();j.useEffect(()=>{e&&y&&S()},[e,y]);const S=async()=>{try{h(!0);const{data:v,error:P}=await Y.from("models").select(`
          id,
          name,
          status,
          count,
          image_url,
          game_id,
          box_id,
          game:games(
            id,
            name,
            icon,
            image
          )
        `).eq("user_id",y==null?void 0:y.id).is("box_id",null).order("created_at",{ascending:!1});if(P)throw P;const A=(v||[]).sort((L,O)=>{var H,F;const M=L.game_id===((H=i.game)==null?void 0:H.id),U=O.game_id===((F=i.game)==null?void 0:F.id);return M&&!U?-1:!M&&U?1:L.name.localeCompare(O.name)});o(A)}catch(v){p(v instanceof Error?v.message:"Failed to fetch models")}finally{h(!1)}},g=v=>{c(P=>{const A=new Set(P);return A.has(v)?A.delete(v):A.add(v),A})},b=async()=>{if(l.size!==0){f(!0),p(null);try{const v=Array.from(l),{error:P}=await Y.from("models").update({box_id:i.id,public:i.public}).in("id",v);if(P)throw P;n(),t(),c(new Set)}catch(v){p(v instanceof Error?v.message:"Failed to add models to box")}finally{f(!1)}}},x=()=>{try{localStorage.setItem("mini-myths-temp-box-context",JSON.stringify({id:i.id,name:i.name,game:i.game}))}catch(v){console.error("Error storing box context:",v)}r(),t()},k=v=>{switch(v){case"Painted":return"bg-green-100 text-green-800";case"Partially Painted":return"bg-yellow-100 text-yellow-800";case"Primed":return"bg-blue-100 text-blue-800";case"Assembled":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},N=v=>{var A;if(v.image_url&&typeof v.image_url=="string"&&v.image_url.trim()!==""&&v.image_url!=="undefined"&&v.image_url!=="null"&&(v.image_url.startsWith("http")||v.image_url.startsWith("/")))return{src:v.image_url,isGameFallback:!1};const P=(A=v.game)==null?void 0:A.icon;return P&&typeof P=="string"&&P.trim()!==""&&P!=="undefined"&&P!=="null"&&P.startsWith("http")?{src:P,isGameFallback:!0}:{src:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg",isGameFallback:!1}},w=a.filter(v=>{var P;return v.game_id===((P=i.game)==null?void 0:P.id)}),C=a.filter(v=>{var P;return v.game_id!==((P=i.game)==null?void 0:P.id)});if(!e)return null;const T=v=>{v.target===v.currentTarget&&t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",onClick:T,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-lg font-bold text-title",children:["Add Models to Collection: ",i.name]}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6"})})]}),m&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:s.jsx("p",{className:"text-red-600",children:m})}),u?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border---color-brand mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"Loading models..."})]}):a.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(vn,{className:"w-12 h-12 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text mb-4",children:"No unboxed models found in your collection."}),s.jsx("p",{className:"text-sm text-secondary-text mb-6",children:"All your models are already assigned to collections."}),s.jsxs(Si,{onClick:x,variant:"primary",width:"full",withIcon:!0,children:[s.jsx(Pn,{className:"w-4 h-4"}),s.jsx("span",{children:"Add new model to collection"})]})]}):s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-sm text-secondary-text mb-6",children:"Select models to add to this box. Models will be moved from their current unboxed state."}),s.jsxs("div",{className:"space-y-6 mb-6",children:[w.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-sm font-semibold text-title mb-3 uppercase tracking-wide",children:[((I=i.game)==null?void 0:I.name)||"Same Game"," Models"]}),s.jsx("div",{className:"space-y-2",children:w.map(v=>s.jsxs("div",{className:"flex items-center space-x-3 p-3 border border-border-custom rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx("button",{type:"button",onClick:()=>g(v.id),className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${l.has(v.id)?"bg-brand border---color-brand text-white":"border-border-custom hover:border---color-brand"}`,children:l.has(v.id)&&s.jsx(eu,{className:"w-3 h-3"})}),(()=>{const P=N(v);return s.jsx("img",{src:P.src,alt:v.name,className:`w-12 h-12 object-cover rounded ${P.isGameFallback?"opacity-10":""}`,onError:A=>{const L=A.target;L.src="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"}})})(),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-medium text-text truncate",children:v.name}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsxs("span",{className:"text-xs text-secondary-text",children:[v.count," model",v.count!==1?"s":""]}),v.status!=="None"&&s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${k(v.status)}`,children:v.status})]})]})]},v.id))})]}),C.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-title mb-3 uppercase tracking-wide",children:"Other Models"}),s.jsx("div",{className:"space-y-2",children:C.map(v=>{var P;return s.jsxs("div",{className:"flex items-center space-x-3 p-3 border border-border-custom rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx("button",{type:"button",onClick:()=>g(v.id),className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${l.has(v.id)?"bg-brand border---color-brand text-white":"border-border-custom hover:border---color-brand"}`,children:l.has(v.id)&&s.jsx(eu,{className:"w-3 h-3"})}),(()=>{const A=N(v);return s.jsx("img",{src:A.src,alt:v.name,className:`w-12 h-12 object-cover rounded ${A.isGameFallback?"opacity-10":""}`,onError:L=>{const O=L.target;O.src="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"}})})(),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-medium text-text truncate",children:v.name}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx("span",{className:"text-xs text-secondary-text",children:((P=v.game)==null?void 0:P.name)||"Unknown Game"}),s.jsx("span",{className:"text-xs text-secondary-text",children:""}),s.jsxs("span",{className:"text-xs text-secondary-text",children:[v.count," model",v.count!==1?"s":""]}),v.status!=="None"&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-xs text-secondary-text",children:""}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${k(v.status)}`,children:v.status})]})]})]})]},v.id)})})]})]}),s.jsx("div",{className:"pt-4 border-t border-border-custom",children:s.jsxs(Si,{onClick:x,variant:"secondary",width:"full",withIcon:!0,children:[s.jsx(Pn,{className:"w-4 h-4"}),s.jsx("span",{children:"Add new model to collection"})]})}),s.jsxs("div",{className:"flex space-x-3 pt-4 border-t border-border-custom",children:[s.jsx("button",{onClick:t,disabled:d,className:"btn-ghost btn-flex",children:"Cancel"}),s.jsx("button",{onClick:b,disabled:l.size===0||d,className:"btn-primary btn-flex",children:d?"Adding...":`Add ${l.size} Model${l.size!==1?"s":""}`})]})]})]})})}function YE({isOpen:e,onClose:t,onBoxUpdated:n,box:r}){var Ie;const[i,a]=j.useState({name:"",game_id:"",purchase_date:"",image_url:""}),[o,l]=j.useState([]),[c,u]=j.useState(null),[h,d]=j.useState(!1),[f,m]=j.useState(null),[p,y]=j.useState(null),[S,g]=j.useState(!1),[b,x]=j.useState(!1),[k,N]=j.useState(""),[w,C]=j.useState(!1),[T,I]=j.useState(!1),[v,P]=j.useState(!1),[A,L]=j.useState([]),[O,M]=j.useState(""),[U,H]=j.useState([]),[F,B]=j.useState(!1);j.useEffect(()=>{var ne;r&&a({name:r.name,game_id:r.game_id||((ne=r.game)==null?void 0:ne.id)||"",purchase_date:r.purchase_date||"",image_url:r.image_url||""})},[r]),j.useEffect(()=>{e&&_()},[e]),j.useEffect(()=>{e&&r&&_()},[e,r]);const _=async()=>{try{const{data:ne,error:Q}=await Y.from("games").select("id, name, icon").order("name");if(Q)throw Q;l(ne||[])}catch(ne){console.error("Error fetching games:",ne)}},z=ne=>{var re;const Q=(re=ne.target.files)==null?void 0:re[0];if(Q){if(!bn(Q)){alert("Please select a valid image file");return}u(Q),m(Q),d(!0)}},q=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){alert("Camera is not available on this device");return}const ne=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280,max:1920},height:{ideal:720,max:1080}}}),Q=document.createElement("video");Q.srcObject=ne,Q.autoplay=!0,Q.playsInline=!0,Q.muted=!0,Q.style.position="fixed",Q.style.top="0",Q.style.left="0",Q.style.width="100%",Q.style.height="100%",Q.style.zIndex="9999",Q.style.objectFit="cover",Q.style.backgroundColor="#000";const re=document.createElement("canvas"),ge=re.getContext("2d");if(!ge)throw new Error("Could not get canvas context");const ve=document.createElement("button");ve.textContent=" Take Photo",ve.style.position="fixed",ve.style.bottom="20px",ve.style.left="50%",ve.style.transform="translateX(-50%)",ve.style.zIndex="10000",ve.style.padding="12px 24px",ve.style.backgroundColor="#007bff",ve.style.color="white",ve.style.border="none",ve.style.borderRadius="8px",ve.style.fontSize="16px",ve.style.fontWeight="bold",ve.style.cursor="pointer";const we=document.createElement("button");we.textContent=" Cancel",we.style.position="fixed",we.style.bottom="20px",we.style.right="20px",we.style.zIndex="10000",we.style.padding="12px 24px",we.style.backgroundColor="#dc3545",we.style.color="white",we.style.border="none",we.style.borderRadius="8px",we.style.fontSize="16px",we.style.fontWeight="bold",we.style.cursor="pointer";const Ue=()=>{try{re.width=Q.videoWidth,re.height=Q.videoHeight,ge.drawImage(Q,0,0,re.width,re.height),re.toBlob(V=>{if(V){const X=new File([V],`collection-photo-${Date.now()}.jpg`,{type:"image/jpeg",lastModified:Date.now()});u(X),m(X),d(!0)}Fe()},"image/jpeg",.9)}catch(V){console.error("Error capturing photo:",V),alert("Error capturing photo. Please try again."),Fe()}},Fe=()=>{try{ne&&ne.getTracks().forEach(V=>V.stop()),document.body.contains(Q)&&document.body.removeChild(Q),document.body.contains(ve)&&document.body.removeChild(ve),document.body.contains(we)&&document.body.removeChild(we)}catch(V){console.error("Error during cleanup:",V)}};ve.addEventListener("click",Ue),we.addEventListener("click",Fe),document.body.appendChild(Q),document.body.appendChild(ve),document.body.appendChild(we),Q.addEventListener("loadedmetadata",()=>{console.log("Video ready, dimensions:",Q.videoWidth,"x",Q.videoHeight)}),Q.addEventListener("error",V=>{console.error("Video error:",V),alert("Error loading camera feed. Please try again."),Fe()})}catch(ne){console.error("Error accessing camera:",ne),ne instanceof DOMException?ne.name==="NotAllowedError"?alert("Camera access denied. Please allow camera permissions and try again."):ne.name==="NotFoundError"?alert("No camera found on this device."):ne.name==="NotReadableError"?alert("Camera is already in use by another application."):alert(`Camera error: ${ne.message}`):alert("Unable to access camera. Please try again or use the file upload option.")}},E=ne=>{y(ne),d(!1),m(null)},K=()=>{C(!0),y(null),u(null)},G=async()=>{if(i.name.trim()){P(!0),L([]),H([]);try{const ne=o.find(Ue=>Ue.id===i.game_id),Q=(ne==null?void 0:ne.name)||"",re=`${i.name.trim()} ${Q}`.trim(),ge=await fetch("https://dthxptbozocrbvmhwvao.supabase.co/functions/v1/search-images",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0aHhwdGJvem9jcmJ2bWh3dmFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyOTY0MzMsImV4cCI6MjA3MDg3MjQzM30.gFt4oRFZ7Mh4y8DgeKNbcKKDwTYjEdXRoBlqTNjvdRg","Content-Type":"application/json"},body:JSON.stringify({query:re,count:6})});if(!ge.ok)throw new Error("Failed to search for images");const we=(await ge.json()).images||[];L(we),H(we),I(!0)}catch(ne){console.error("Error searching for images:",ne),I(!1)}finally{P(!1)}}},W=ne=>{M(ne),I(!1)},le=async()=>{if(i.name.trim()){B(!0);try{const ne=o.find(Fe=>Fe.id===i.game_id),Q=(ne==null?void 0:ne.name)||"",re=`${i.name.trim()} ${Q}`.trim();console.log("Finding more images with exclude:",U);const ge=await fetch("https://dthxptbozocrbvmhwvao.supabase.co/functions/v1/search-images",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR0aHhwdGJvem9jcmJ2bWh3dmFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyOTY0MzMsImV4cCI6MjA3MDg3MjQzM30.gFt4oRFZ7Mh4y8DgeKNbcKKDwTYjEdXRoBlqTNjvdRg","Content-Type":"application/json"},body:JSON.stringify({query:re,count:6,exclude:U})});if(!ge.ok)throw new Error("Failed to search for more images");const we=(await ge.json()).images||[];console.log("Received additional images:",we),console.log("Previous results count:",U.length),console.log("New results count:",we.length);const Ue=we.filter(Fe=>!U.includes(Fe));console.log("Unique new images after filtering:",Ue),L(Ue),H([...U,...Ue])}catch(ne){console.error("Error searching for more images:",ne)}finally{B(!1)}}},se=async(ne,Q,re)=>{const ge=(c==null?void 0:c.name.split(".").pop())||"jpg",ve=`${re}/${Date.now()}-${Math.random().toString(36).substring(2)}.${ge}`,{data:we,error:Ue}=await Y.storage.from(Q).upload(ve,ne);if(Ue)throw Ue;const{data:Fe}=Y.storage.from(Q).getPublicUrl(we.path);return Fe.publicUrl},ae=async ne=>{if(ne.preventDefault(),!!r){g(!0),N("");try{let Q=i.image_url;if(w){if(i.image_url&&i.image_url.includes("supabase"))try{const ge=i.image_url.split("/"),ve=ge.findIndex(we=>we==="model-images");if(ve!==-1){const we=ge.slice(ve+1).join("/");await Y.storage.from("model-images").remove([we])}}catch(ge){console.warn("Failed to delete old image:",ge)}Q=null}else if(O)Q=O;else if(p){x(!0);const ge=await yn(p,1200,1200,.8);Q=await se(ge,"model-images","boxes")}const{error:re}=await Y.from("boxes").update({name:i.name,game_id:i.game_id||null,purchase_date:i.purchase_date||null,image_url:Q}).eq("id",r.id);if(re)throw re;n()}catch(Q){N(Q instanceof Error?Q.message:"Failed to update box")}finally{g(!1),x(!1)}}},be=()=>{var ne;r&&a({name:r.name,game_id:r.game_id||((ne=r.game)==null?void 0:ne.id)||"",purchase_date:r.purchase_date||"",image_url:r.image_url||""}),u(null),y(null),C(!1),M(""),I(!1),L([]),H([]),N("")};if(!e||!r)return null;const je=ne=>{ne.target===ne.currentTarget&&t()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",onClick:je,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-lg font-bold text-title",children:"Edit Collection"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6 text-icon"})})]}),s.jsxs("form",{onSubmit:ae,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"boxName",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Collection Name"}),s.jsxs("div",{className:"relative",children:[s.jsx(vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"text",id:"boxName",value:i.name,onChange:ne=>a({...i,name:ne.target.value}),placeholder:"Enter collection name...",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"game",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game"}),s.jsx(Yr,{games:o,selectedGame:i.game_id||"",onGameSelect:ne=>a({...i,game_id:ne}),placeholder:"Choose a Game"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"purchaseDate",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Purchase Date"}),s.jsxs("div",{className:"relative",children:[s.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"date",id:"purchaseDate",value:i.purchase_date,onChange:ne=>a({...i,purchase_date:ne.target.value}),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text [&::-webkit-calendar-picker-indicator]:hidden [&::-webkit-calendar-picker-indicator]:appearance-none"})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass",children:"Collection Image"}),s.jsx("span",{className:"text-sm text-gray-500",children:"Optional"})]}),s.jsx("div",{className:"border-2 border-dashed border-border-custom rounded-lg p-6 text-center hover:border-[var(--color-brand)] transition-colors",children:c?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative mx-auto w-32 h-32",children:[s.jsx("img",{src:URL.createObjectURL(c),alt:"Selected collection image",className:"w-full h-full object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>{u(null),y(null)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",children:s.jsx(fe,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-sm text-secondary-text",children:c.name})]}):i.image_url&&!w?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative mx-auto w-32 h-32",children:[s.jsx("img",{src:i.image_url,alt:"Current collection image",className:"w-full h-full object-cover rounded-lg",onError:ne=>{const Q=ne.target;Q.style.display="none"}}),s.jsx("button",{type:"button",onClick:K,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",title:"Remove current image",children:s.jsx(Hn,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-sm text-secondary-text",children:"Current image"})]}):O?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative mx-auto w-32 h-32",children:[s.jsx("img",{src:O,alt:"Selected collection image",className:"w-full h-full object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>{M("")},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",children:s.jsx(fe,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-sm text-secondary-text",children:"Selected image"})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-center space-x-4",children:[s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:z,className:"hidden",disabled:S}),s.jsxs("div",{className:"flex flex-col items-center space-y-2 p-4 rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx(En,{className:"w-8 h-8 text-icon"}),s.jsx("span",{className:"text-sm font-medium text-text",children:"Upload Image"})]})]}),s.jsxs("button",{type:"button",onClick:q,disabled:S,className:"flex flex-col items-center space-y-2 p-4 rounded-lg hover:bg-bg-secondary transition-colors",children:[s.jsx(zs,{className:"w-8 h-8 text-icon"}),s.jsx("span",{className:"text-sm font-medium text-text",children:"Take Photo"})]})]}),s.jsx("p",{className:"text-xs text-secondary-text",children:"JPEG, PNG, or WebP up to 50MB"})]})}),p&&s.jsx("p",{className:"text-green-600 text-sm mt-2",children:" New image ready for upload"}),w&&s.jsx("p",{className:"text-red-600 text-sm mt-2",children:" Image will be deleted when you save changes"}),!i.image_url&&!p&&!O&&i.name.trim()&&s.jsx("div",{className:"mt-3",children:s.jsx("button",{type:"button",onClick:G,disabled:v,className:"btn-secondary btn-full",children:v?"Searching for images...":"Find images for this collection"})})]}),k&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:k}),s.jsxs("div",{className:"flex space-x-3 pt-4",children:[s.jsx("button",{type:"button",onClick:be,className:"btn-ghost btn-flex",children:"Discard Changes"}),s.jsx("button",{type:"submit",disabled:S||b,className:"btn-primary btn-flex",children:b?"Processing...":S?"Saving...":"Save Changes"})]})]})]})}),f&&s.jsx(qn,{isOpen:h,onClose:()=>{d(!1),m(null),u(null)},onCrop:E,imageFile:f}),T&&s.jsx(Gx,{isOpen:T,onClose:()=>I(!1),images:A,onImageSelect:W,searchQuery:`${i.name} ${((Ie=o.find(ne=>ne.id===i.game_id))==null?void 0:Ie.name)||""}`.trim(),onFindMoreImages:le,isLoadingMore:F})]})}function KE({isOpen:e,onClose:t,onConfirm:n,modelName:r,boxName:i,loading:a=!1}){if(!e)return null;const o=l=>{l.target===l.currentTarget&&t()};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[70]",onClick:o,children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h2",{className:"text-xl font-bold text-title",children:["Remove ",r," from ",i,"?"]}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text",children:s.jsx(fe,{className:"w-6 h-6"})})]}),s.jsx("p",{className:"text-base text-secondary-text mb-6",children:"Are you sure you want to remove this model from this box? This won't delete the model or the box from your collection."}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:t,disabled:a,className:"btn-ghost btn-flex",children:"Cancel"}),s.jsx("button",{onClick:n,disabled:a,className:"btn-primary btn-flex",children:a?"Removing...":"Remove from Box"})]})]})})}function JE({isOpen:e,onClose:t,onCollectionUpdated:n,box:r}){const[i,a]=j.useState(!1),[o,l]=j.useState(!1),[c,u]=j.useState(!1),[h,d]=j.useState(""),[f,m]=j.useState(!1),[p,y]=j.useState("");j.useEffect(()=>{r&&a(r.public??!1)},[r]);const S=async()=>{if(r){l(!0),d("");try{const{error:x}=await Y.from("boxes").update({public:!i}).eq("id",r.id);if(x)throw x;const{error:k}=await Y.from("models").update({public:!i}).eq("box_id",r.id);if(k)throw k;a(!i),n==null||n()}catch(x){d(x instanceof Error?x.message:"Failed to update collection visibility")}finally{l(!1)}}},g=async()=>{if(r){u(!0),d("");try{const x=So(`/shared/collection/${r.id}`);await navigator.clipboard.writeText(x),y(`${r.name}'s URL has been copied to your clipboard!`),m(!0)}catch(x){console.error("Error copying URL:",x);const k=So(`/shared/collection/${r.id}`),N=document.createElement("textarea");N.value=k,document.body.appendChild(N),N.select(),document.execCommand("copy"),document.body.removeChild(N),y(`${r.name}'s URL has been copied to your clipboard!`),m(!0)}finally{u(!1)}}},b=x=>{x.target===x.currentTarget&&t()};return!e||!r?null:s.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[70]",onClick:b,children:[s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-lg font-bold text-title",children:["Share ",r.name]}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6 text-icon"})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"text-sm text-secondary-text",children:"Sharing a collection makes it visible to other users who have the link to it. Additionally, models inside a shared collection also become visible."}),s.jsx("div",{className:"space-y-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(sa,{className:"w-5 h-5 text-icon"}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-input-label",children:"Make Public"}),s.jsx("p",{className:"text-xs text-secondary-text",children:"Allow anyone to view this collection"})]})]}),s.jsx("button",{onClick:S,disabled:o,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-brand focus:ring-offset-2 disabled:opacity-50 ${i?"bg-brand":"bg-secondary-text"}`,children:s.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i?"translate-x-6":"translate-x-1"}`})})]})}),i&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Nd,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm text-green-800",children:"This collection is now public and can be viewed by anyone with the link."})]})}),!i&&s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(px,{className:"w-4 h-4 text-gray-600"}),s.jsx("span",{className:"text-sm text-gray-800",children:"This collection is private and only visible to you."})]})}),i&&s.jsxs("button",{onClick:g,disabled:c,className:"btn-secondary btn-full btn-with-icon",children:[s.jsx(ux,{className:"w-4 h-4"}),s.jsx("span",{children:c?"Copying...":"Copy URL"})]}),h&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:h}),s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx("button",{onClick:t,className:"btn-secondary",children:"Done"})})]})]}),s.jsx(rl,{message:p,isVisible:f,onClose:()=>m(!1)})]})}function QE({isOpen:e,onClose:t,onBoxDeleted:n,onModelsUpdated:r,onViewModel:i,onAddNewModel:a,box:o}){var ae,be,je,Ie,ne;const[l,c]=Ne.useState(!1),[u,h]=Ne.useState(!1),[d,f]=Ne.useState(!1),[m,p]=Ne.useState(!1),[y,S]=Ne.useState({isOpen:!1,model:null}),[g,b]=Ne.useState(!1),[x,k]=Ne.useState(!1),[N,w]=Ne.useState(!1),[C,T]=Ne.useState([]),[I,v]=Ne.useState(!0),[P,A]=Ne.useState(null);Ne.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]),Ne.useEffect(()=>{e&&o&&L()},[e,o]);const L=async()=>{if(o){v(!0),A(null);try{const{data:Q,error:re}=await Y.from("models").select(`
          id,
          name,
          status,
          count,
          image_url,
          game_id,
          notes,
          painted_date,
          purchase_date,
          lore_name,
          lore_description,
          painting_notes,
          game:games(
            id,
            name,
            icon
          )
        `).eq("box_id",o.id).order("created_at",{ascending:!1});if(re)throw re;T(Q||[])}catch(Q){A(Q instanceof Error?Q.message:"Failed to fetch models")}finally{v(!1)}}},O=()=>{h(!1),L(),r==null||r()},M=()=>{h(!1),b(!0),t()};Ne.useEffect(()=>{g&&!e&&(b(!1),a==null||a((o==null?void 0:o.id)||null))},[g,e,a,o==null?void 0:o.id]);const U=Q=>{S({isOpen:!0,model:Q})},H=async()=>{if(y.model){w(!0);try{const{error:Q}=await Y.from("models").update({box_id:null,public:!1}).eq("id",y.model.id);if(Q)throw Q;L(),r==null||r(),S({isOpen:!1,model:null})}catch(Q){console.error("Error removing model from box:",Q)}finally{w(!1)}}},F=Q=>{t(),i==null||i(Q)},B=()=>{f(!1),t(),r&&r()},_=()=>{r&&r()};if(!e||!o)return null;const z=Q=>{Q.target===Q.currentTarget&&t()},q=Q=>jt(Q,{month:"2-digit",day:"2-digit",year:"2-digit"}),E=()=>{var re;if(o.image_url&&typeof o.image_url=="string"&&o.image_url.trim()!==""&&o.image_url!=="undefined"&&o.image_url!=="null"&&(o.image_url.startsWith("http")||o.image_url.startsWith("/")))return o.image_url;const Q=(re=o.game)==null?void 0:re.image;return Q&&typeof Q=="string"&&Q.trim()!==""&&Q!=="undefined"&&Q!=="null"&&Q.startsWith("http")?Q:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"},K=Q=>{switch(Q){case"Painted":return"bg-green-100 text-green-800";case"Partially Painted":return"bg-yellow-100 text-yellow-800";case"Primed":return"bg-blue-100 text-blue-800";case"Assembled":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},G=Q=>{var ge;if(Q.image_url&&typeof Q.image_url=="string"&&Q.image_url.trim()!==""&&Q.image_url!=="undefined"&&Q.image_url!=="null"&&(Q.image_url.startsWith("http")||Q.image_url.startsWith("/")))return{src:Q.image_url,isGameFallback:!1};const re=(ge=Q.game)==null?void 0:ge.icon;return re&&typeof re=="string"&&re.trim()!==""&&re!=="undefined"&&re!=="null"&&re.startsWith("http")?{src:re,isGameFallback:!0}:{src:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg",isGameFallback:!1}},W=()=>{p(!0)},le=()=>{c(!0)},se=async()=>{if(o){k(!0);try{if(o.image_url&&typeof o.image_url=="string"&&o.image_url.includes("supabase")){const re=o.image_url.split("/"),ge=re.findIndex(ve=>ve==="model-images");if(ge!==-1){const ve=re.slice(ge+1).join("/");await Y.storage.from("model-images").remove([ve])}}const{error:Q}=await Y.from("boxes").delete().eq("id",o.id);if(Q)throw Q;c(!1),t(),n&&n()}catch(Q){console.error("Error deleting box:",Q)}finally{k(!1)}}};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:z,children:s.jsxs("div",{className:"bg-modal-bg max-w-2xl w-full overflow-y-auto md:rounded-lg md:max-w-2xl md:max-h-[90vh] fixed inset-0 md:relative md:inset-auto h-screen md:h-auto",children:[s.jsx("div",{className:"relative",children:s.jsx("img",{src:E(),alt:o.name,className:"w-full max-h-[60%] object-cover",loading:"lazy",onError:Q=>{const re=Q.target,ge="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg";re.src!==ge&&(console.log("Box modal image failed to load:",re.src,"Falling back to default"),re.src=ge)}})}),s.jsx("button",{onClick:t,className:"fixed top-4 right-4 md:absolute text-white hover:text-gray-300 transition-colors bg-black bg-opacity-50 rounded-full p-2 z-20",children:s.jsx(fe,{className:"w-6 h-6 text-icon"})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"text-center mb-6 relative",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[s.jsx("h2",{className:"text-2xl font-bold text-title",children:o.name}),s.jsx("button",{onClick:()=>f(!0),className:"p-1 text-secondary-text hover:text-text transition-colors rounded",children:s.jsx(Vs,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[(ae=o.game)!=null&&ae.icon?s.jsx("img",{src:o.game.icon,alt:`${o.game.name} icon`,className:"object-cover rounded max-h-[32px]",onError:Q=>{const re=Q.target;console.warn("Game icon failed to load:",re.src,"Falling back to letter icon"),re.style.display="none";const ge=re.nextElementSibling;ge&&ge.classList.contains("icon-fallback")&&(ge.style.display="flex")},onLoad:Q=>{const ge=Q.target.nextElementSibling;ge&&ge.classList.contains("icon-fallback")&&(ge.style.display="none")}}):null,s.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:(be=o.game)!=null&&be.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-xs font-bold",children:(((je=o.game)==null?void 0:je.name)||"Unknown Game").charAt(0)})}),s.jsx("span",{className:"text-lg font-semibold text-secondary-text",children:((Ie=o.game)==null?void 0:Ie.name)||"Unknown Game"})]})]}),s.jsx("div",{className:"space-y-3",children:o.purchase_date&&s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 flex items-center space-x-3",children:[s.jsx(Xe,{className:"w-5 h-5 text-secondary-text"}),s.jsxs("span",{className:"text-base text-text font-medium",children:["Purchased ",q(o.purchase_date)]})]})}),s.jsxs("div",{className:"mt-8",children:[s.jsx("h3",{className:"text-lg font-semibold text-title mb-4",children:"Models in this Collection"}),I?s.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((Q,re)=>s.jsx("div",{className:"bg-bg-secondary rounded-lg p-4 animate-pulse",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-12 h-12 bg-secondary-text opacity-20 rounded"}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-1/2"})]})]})},re))}):P?s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsx("p",{className:"text-red-600",children:P})}):C.length===0?s.jsxs("div",{className:"text-center py-8 bg-bg-secondary rounded-lg",children:[s.jsx(vn,{className:"w-12 h-12 text-secondary-text mx-auto mb-4"}),s.jsx("p",{className:"text-secondary-text",children:"No models in this collection yet."}),s.jsx("p",{className:"text-sm text-secondary-text mt-2",children:'Use the "Add Models to Collection" button to add some!'})]}):s.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:C.map(Q=>s.jsxs("div",{className:"bg-bg-secondary rounded-lg p-4 flex items-center justify-between hover:bg-bg-primary transition-colors",children:[s.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[(()=>{const re=G(Q);return s.jsx("img",{src:re.src,alt:Q.name,className:`w-12 h-12 object-cover rounded ${re.isGameFallback?"opacity-10":""}`,onError:ge=>{const ve=ge.target;ve.src="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"}})})(),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-medium text-text truncate",children:Q.name}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsxs("span",{className:"text-xs text-secondary-text",children:[Q.count," model",Q.count!==1?"s":""]}),Q.status!=="None"&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-xs text-secondary-text",children:""}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${K(Q.status)}`,children:Q.status})]})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>U(Q),className:"p-2 text-icon hover:text-icon-hover transition-colors",children:s.jsx(Hn,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>F(Q),className:"p-2 text-secondary-text hover:text-text transition-colors",children:s.jsx(Vt,{className:"w-4 h-4"})})]})]},Q.id))})]}),s.jsx("div",{className:"flex justify-center pt-6",children:s.jsxs("div",{className:"space-y-3 w-full",children:[s.jsxs("button",{onClick:()=>h(!0),className:"btn-primary btn-full btn-with-icon",children:[s.jsx(Pn,{className:"w-4 h-4"}),s.jsx("span",{children:"Add Models to Collection"})]}),s.jsxs("button",{onClick:W,className:"btn-secondary btn-full btn-with-icon",children:[s.jsx(sa,{className:"w-4 h-4"}),s.jsx("span",{children:"Share Collection"})]}),s.jsx("button",{onClick:le,className:"btn-danger-outline btn-full",children:"Delete Collection"})]})})]})]})}),s.jsx(HE,{isOpen:l,onClose:()=>c(!1),onConfirm:se,boxName:o.name,loading:x}),s.jsx(WE,{isOpen:u,onClose:()=>h(!1),onModelsAdded:O,onAddNewModel:M,box:o}),s.jsx(YE,{isOpen:d,onClose:()=>f(!1),onBoxUpdated:B,box:o}),s.jsx(KE,{isOpen:y.isOpen,onClose:()=>S({isOpen:!1,model:null}),onConfirm:H,modelName:((ne=y.model)==null?void 0:ne.name)||"",boxName:(o==null?void 0:o.name)||"",loading:N}),s.jsx(JE,{isOpen:m,onClose:()=>p(!1),onCollectionUpdated:_,box:o})]})}function XE({isOpen:e,onClose:t}){const[n,r]=j.useState(""),[i,a]=j.useState(""),[o,l]=j.useState(!1),[c,u]=j.useState(!1),[h,d]=j.useState(!1),[f,m]=j.useState(""),[p,y]=j.useState(!1),{updatePassword:S}=Ge(),g=async b=>{if(b.preventDefault(),d(!0),m(""),n.length<6){m("Password must be at least 6 characters long"),d(!1);return}if(n!==i){m("Passwords do not match"),d(!1);return}try{const{error:x}=await S(n);x?m(x.message):(y(!0),window.history.replaceState({},document.title,window.location.pathname),setTimeout(()=>{t(),r(""),a(""),y(!1)},2e3))}catch{m("An unexpected error occurred")}finally{d(!1)}};return e?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-modal-bg rounded-lg max-w-md w-full p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-2xl font-bold text-title",children:"Set New Password"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text",children:s.jsx(fe,{className:"w-6 h-6"})})]}),p?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"text-green-600 text-lg font-semibold mb-2",children:"Password updated successfully!"}),s.jsx("p",{className:"text-secondary-text",children:"You can now use your new password to log in."})]}):s.jsxs("form",{onSubmit:g,className:"space-y-4",children:[s.jsx("p",{className:"text-secondary-text text-sm",children:"Please set a new password for your account."}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-input-label font-overpass mb-1",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:o?"text":"password",id:"newPassword",value:n,onChange:b=>r(b.target.value),required:!0,className:"w-full px-3 py-2 pr-10 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text"}),s.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-icon hover:text-icon-hover",children:o?s.jsx(jm,{className:"w-4 h-4"}):s.jsx(tu,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-input-label font-overpass mb-1",children:"Confirm New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:c?"text":"password",id:"confirmPassword",value:i,onChange:b=>a(b.target.value),required:!0,className:"w-full px-3 py-2 pr-10 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text"}),s.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-icon hover:text-icon-hover",children:c?s.jsx(jm,{className:"w-4 h-4"}):s.jsx(tu,{className:"w-4 h-4"})})]})]}),f&&s.jsx("div",{className:"text-red-600 text-sm",children:f}),s.jsx("button",{type:"submit",disabled:h,className:"btn-primary btn-full",children:h?"Updating Password...":"Update Password"})]})]})}):null}function qf({isOpen:e,onClose:t,onBookingCreated:n,lastSelectedLocation:r="",onLocationSelected:i}){const[a,o]=j.useState([]),[l,c]=j.useState([]),[u,h]=j.useState([]),[d,f]=j.useState(r),[m,p]=j.useState(""),[y,S]=j.useState(""),[g,b]=j.useState(""),[x,k]=j.useState(""),[N,w]=j.useState(null),[C,T]=j.useState(!1),[I,v]=j.useState(0),[P,A]=j.useState(!1),[L,O]=j.useState(!1),[M,U]=j.useState(""),[H,F]=j.useState(null),[B,_]=j.useState(!1),{user:z}=Ge(),{recentGames:q,addRecentGame:E}=Hs(),K=()=>{try{return localStorage.getItem("mini-myths-last-location")||""}catch(V){return console.error("Error loading last selected location:",V),""}},G=V=>{try{V&&localStorage.setItem("mini-myths-last-location",V)}catch(X){console.error("Error saving last selected location:",X)}};Ne.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]),j.useEffect(()=>{if(e){ae(),je(),se();const V=K();f(V||r),z!=null&&z.user_name_public&&k(z.user_name_public)}},[e,r]),j.useEffect(()=>{d?(be(),G(d),i==null||i(d)):(c([]),S(""))},[d,i]),j.useEffect(()=>{m&&(S(""),w(null))},[m]),j.useEffect(()=>{d&&m?W():F(null)},[d,m]),j.useEffect(()=>{H&&S("")},[H]),j.useEffect(()=>{d&&m&&y?le():w(null)},[d,m,y]);const W=async()=>{if(!(!d||!m)){_(!0);try{console.log("Checking blocked date for:",{selectedLocation:d,selectedDate:m});const{data:V,error:X}=await Y.from("blocked_dates").select("description").eq("location_id",d).eq("date",m);if(console.log("Blocked date query result:",{data:V,error:X}),X){console.error("Error checking blocked date:",X),F(null);return}V&&V.length>0?(console.log("Found blocked date:",V[0]),F({description:V[0].description})):(console.log("No blocked date found for this location/date"),F(null))}catch(V){console.error("Error checking blocked date:",V),F(null)}finally{_(!1)}}},le=async()=>{if(!(!d||!m||!y)){T(!0);try{const{data:V,error:X}=await Y.from("locations").select("tables").eq("id",d).single();if(X)throw X;const oe=V.tables,Se=l.find($=>$.id===y),rt=(Se==null?void 0:Se.isAllDay)||!1;let D=0;if(rt){const{data:$,error:te}=await Y.from("bookings").select("timeslot_id").eq("location_id",d).eq("date",m);if(te)throw te;const ue={};$==null||$.forEach(he=>{const ce=he.timeslot_id;ue[ce]=(ue[ce]||0)+1}),D=Math.max(0,...Object.values(ue))}else{const{data:$,error:te}=await Y.from("bookings").select("id").eq("location_id",d).eq("date",m).eq("timeslot_id",y);if(te)throw te;const{data:ue,error:he}=await Y.from("bookings").select("timeslot:timeslots(id, name, start_time, end_time)").eq("location_id",d).eq("date",m);if(he)throw he;const ce=($==null?void 0:$.length)||0,de=(ue==null?void 0:ue.filter(ye=>{const Ce=ye.timeslot;return Ce&&(Ce.name==="All Day Booking"||Ce.start_time==="00:00:00"&&Ce.end_time==="23:59:59")}).length)||0;D=ce+de}const R=oe-D;w(Math.max(0,R))}catch(V){console.error("Error checking table availability:",V),w(null)}finally{T(!1)}}},se=async()=>{if(z){A(!0);try{const V=mu(),{data:X,error:oe}=await Y.from("bookings").select("id").eq("user_id",z.id).gte("date",V);if(oe)throw oe;v((X==null?void 0:X.length)||0)}catch(V){console.error("Error checking current bookings:",V),v(0)}finally{A(!1)}}},ae=async()=>{try{const{data:V,error:X}=await Y.from("locations").select("*").order("name");if(X)throw X;o(V||[])}catch(V){console.error("Error fetching locations:",V)}},be=async()=>{try{const{data:V,error:X}=await Y.from("timeslots").select("*").eq("location_id",d).order("start_time");if(X)throw X;const oe=(V||[]).map(Se=>({...Se,isAllDay:Se.name==="All Day Booking"||Se.start_time==="00:00:00"&&Se.end_time==="23:59:59"}));c(oe)}catch(V){console.error("Error fetching timeslots:",V)}},je=async()=>{try{const{data:V,error:X}=await Y.from("games").select("id, name, icon").order("name");if(X)throw X;h(V||[])}catch(V){console.error("Error fetching games:",V)}},Ie=()=>!(z!=null&&z.fav_games)||z.fav_games.length===0?[]:u.filter(V=>{var X;return(X=z.fav_games)==null?void 0:X.includes(V.id)}),ne=V=>{b(V);const X=u.find(oe=>oe.id===V);X&&E(X)},Q=()=>{if(!m)return null;const V=new Date(m);return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][V.getDay()]},re=()=>{const V=Q();return V?l.filter(X=>X.availability&&X.availability.includes(V)):[]},ge=V=>V==="00:00:00"?"All Day":new Date(`2000-01-01T${V}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),ve=async V=>{if(V.preventDefault(),!(!d||!m||!y||!z)){O(!0),U("");try{x.trim()&&z.user_name_public!==x.trim()&&await Y.from("users").update({user_name_public:x.trim()}).eq("id",z.id);const{error:X}=await Y.from("bookings").insert({location_id:d,timeslot_id:y,game_id:g||null,date:m,user_id:z.id,user_name:x.trim(),user_email:z.email});if(X)throw X;if(g){const oe=u.find(Se=>Se.id===g);oe&&E(oe)}f(""),p(""),S(""),b(""),k(""),F(null),n(),t(),v(oe=>oe+1)}catch(X){U(X instanceof Error?X.message:"Failed to create booking")}finally{O(!1)}}},we=d&&m&&y&&x.trim()&&I<4&&!H;if(!e)return null;const Ue=V=>{V.target===V.currentTarget&&t()},Fe=re();return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:Ue,children:s.jsxs("div",{className:`bg-modal-bg rounded-lg max-w-lg w-full p-6 overflow-y-auto transition-all duration-300 ease-out transform
        fixed inset-0 sm:relative sm:inset-auto sm:max-w-lg sm:h-auto sm:rounded-lg sm:max-h-[90vh] h-screen w-screen sm:w-full overflow-y-auto rounded-none sm:rounded-lg p-6 sm:p-6
        ${e?"translate-y-0 opacity-100":"translate-y-full opacity-0"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold text-text font-overpass",children:"New Booking"}),s.jsx("button",{onClick:t,className:"text-secondary-text hover:text-text transition-colors",children:s.jsx(fe,{className:"w-6 h-6"})})]}),P?s.jsx("div",{className:"p-4 rounded-lg border bg-blue-50 border-blue-200",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),s.jsx("span",{className:"text-blue-700 text-sm font-medium",children:"Checking booking limit..."})]})}):I>=4?s.jsx("div",{className:"p-4 rounded-lg border bg-red-50 border-red-200",children:s.jsx("span",{className:"text-red-700 text-sm font-medium",children:" You have reached the maximum of 4 active bookings. Cancel an existing booking to create a new one."})}):I>=3?s.jsx("div",{className:"p-4 rounded-lg border bg-yellow-50 border-yellow-200",children:s.jsxs("span",{className:"text-yellow-700 text-sm font-medium",children:[" You have ",I," active booking",I!==1?"s":"",". You can create ",4-I," more."]})}):null,s.jsxs("form",{onSubmit:ve,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"userName",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Your Name"}),s.jsxs("div",{className:"relative",children:[s.jsx($t,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"text",id:"userName",value:x,onChange:V=>k(V.target.value),placeholder:"Enter your full name",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0})]}),s.jsx("p",{className:"text-xs text-secondary-text mt-1",children:"This will be shared with the store for your booking."})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"game",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Game (Optional)"}),s.jsx(Yr,{games:u,selectedGame:g,onGameSelect:ne,placeholder:"Choose a Game (Optional)",favoriteGames:Ie()})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Location"}),s.jsxs("div",{className:"relative",children:[s.jsx(wr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsxs("select",{id:"location",value:d,onChange:V=>f(V.target.value),className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text",required:!0,children:[s.jsx("option",{value:"",children:"Select Location"}),a.map(V=>s.jsxs("option",{value:V.id,children:[V.name," - ",V.tables," table",V.tables!==1?"s":""]},V.id))]})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Date"}),s.jsx(Ki,{value:m,onChange:p,minDate:mu(),placeholder:"Select a date"})]}),!H&&s.jsxs("div",{children:[s.jsx("label",{htmlFor:"timeslot",className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Timeslot"}),s.jsxs("div",{className:"relative",children:[s.jsx(Us,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsxs("select",{id:"timeslot",value:y,onChange:V=>S(V.target.value),disabled:!d||!m,className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring---color-brand focus:border---color-brand bg-bg-primary text-text disabled:opacity-50 disabled:cursor-not-allowed",required:!0,children:[s.jsx("option",{value:"",children:d?m?Fe.length===0?"No timeslots available for this day":"Select Timeslot":"Select date first":"Select location first"}),Fe.map(V=>s.jsx("option",{value:V.id,children:V.isAllDay?`${V.name} (All Day)`:`${V.name} (${ge(V.start_time)} - ${ge(V.end_time)})`},V.id))]})]}),m&&Fe.length===0&&d&&s.jsxs("p",{className:"text-sm text-secondary-text mt-1",children:["No timeslots available for ",Q()," at this location."]})]}),B?s.jsx("div",{className:"p-4 rounded-lg border bg-blue-50 border-blue-200",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),s.jsx("span",{className:"text-blue-700 text-sm font-medium",children:"Checking date availability..."})]})}):H?s.jsxs("div",{className:"p-4 rounded-lg border bg-red-50 border-red-200",children:[s.jsx("div",{className:"flex items-start space-x-2",children:s.jsx("span",{className:"text-red-700 text-sm font-medium",children:" Location Unavailable"})}),s.jsxs("p",{className:"text-red-600 text-sm mt-1",children:["This location is blocked on the selected date.",H.description&&s.jsxs("span",{className:"block mt-1",children:[s.jsx("strong",{children:"Reason:"})," ",H.description]})]})]}):null,M&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:M}),!H&&d&&m&&y&&s.jsx("div",{className:`p-4 rounded-lg border ${C?"bg-blue-50 border-blue-200":N===null?"bg-gray-50 border-gray-200":N===0?"bg-red-50 border-red-200":N<=2?"bg-yellow-50 border-yellow-200":"bg-green-50 border-green-200"}`,children:C?s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),s.jsx("span",{className:"text-blue-700 text-sm font-medium",children:"Checking table availability..."})]}):N===null?s.jsx("span",{className:"text-gray-700 text-sm font-medium",children:"Unable to check table availability"}):N===0?s.jsx("span",{className:"text-red-700 text-sm font-medium",children:" No tables available for this timeslot"}):N<=2?s.jsxs("span",{className:"text-yellow-700 text-sm font-medium",children:[" Only ",N," table",N!==1?"s":""," remaining"]}):s.jsxs("span",{className:"text-green-700 text-sm font-medium",children:[" ",N," table",N!==1?"s":""," available"]})}),s.jsxs("div",{className:"flex flex-col space-y-3 pt-4",children:[s.jsx("button",{type:"submit",disabled:!we||L||N===0||I>=4||H,className:`btn-full ${we&&!L&&N!==0&&I<4&&!H?"btn-primary":"btn-disabled"}`,children:L?"Creating Booking...":I>=4?"Booking Limit Reached":N===0?"No Tables Available":H?"Location Unavailable":"Confirm Booking"}),s.jsx("button",{type:"button",onClick:t,className:"btn-danger-outline btn-full",children:"Cancel"})]})]})]})})}function ZE(){const[e,t]=j.useState(null),[n,r]=j.useState(!0),{user:i}=Ge();return j.useEffect(()=>{(async()=>{try{const o=window.location.hash,l=new URLSearchParams(window.location.search);if(o.includes("access_token")||l.has("code"))setTimeout(()=>{r(!1),window.location.href=Ni()},1e3);else if(o.includes("error")){const c=new URLSearchParams(o.substring(1)).get("error_description");t(c||"Authentication failed"),r(!1)}else t("Invalid authentication callback"),r(!1)}catch(o){console.error("Auth callback error:",o),t("Authentication failed"),r(!1)}})()},[]),j.useEffect(()=>{i&&!n&&(window.location.href=Ni())},[i,n]),n?s.jsx("div",{className:"min-h-screen bg-bg-primary flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--color-brand)] mx-auto mb-4"}),s.jsx("p",{className:"text-text",children:"Completing authentication..."})]})}):e?s.jsx("div",{className:"min-h-screen bg-bg-primary flex items-center justify-center",children:s.jsxs("div",{className:"text-center max-w-md mx-auto p-6",children:[s.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),s.jsx("h1",{className:"text-2xl font-bold text-title mb-4",children:"Authentication Failed"}),s.jsx("p",{className:"text-red-500 mb-6",children:e}),s.jsx("button",{onClick:()=>window.location.href=Ni(),className:"btn-primary",children:"Return to Home"})]})}):null}function sb({isExpanded:e,onClick:t}){return s.jsx("button",{onClick:t,className:`w-14 h-14 rounded-full shadow-lg transition-all duration-200 transform hover:scale-105 flex items-center justify-center ${e?"bg-brand-hover text-white":"bg-brand hover:bg-brand-hover text-white"}`,children:e?s.jsx(fe,{className:"w-6 h-6 transition-transform duration-200"}):s.jsx(Pn,{className:"w-6 h-6 transition-transform duration-200"})})}function Eu({icon:e,label:t,onClick:n,animationClass:r="animate-fab-slide-in"}){return s.jsxs("button",{onClick:n,className:`flex items-center space-x-3 bg-brand hover:bg-brand-hover text-white px-8 py-3 rounded-full shadow-lg transition-all duration-200 transform hover:scale-105 ${r}`,children:[s.jsx(e,{className:"w-8 h-8"}),s.jsx("span",{className:"text-sm font-medium",children:t})]})}function e4({onAddModel:e,onAddCollection:t}){const[n,r]=j.useState(!1),i=()=>{r(!n)},a=()=>{r(!1),e()},o=()=>{r(!1),t()};return s.jsxs("div",{className:"fixed bottom-20 right-6 z-40",children:[n&&s.jsxs("div",{className:"absolute bottom-16 right-0 flex flex-col space-y-3",children:[s.jsx(Eu,{icon:$t,label:"Add Model",onClick:a,animationClass:"animate-fab-slide-in-delayed"}),s.jsx(Eu,{icon:vn,label:"Add Collection",onClick:o,animationClass:"animate-fab-slide-in"})]}),s.jsx(sb,{isExpanded:n,onClick:i})]})}function t4({onNewBooking:e}){const[t,n]=j.useState(!1),r=()=>{n(!t)},i=()=>{n(!1),e()};return s.jsxs("div",{className:"fixed bottom-20 right-6 z-40",children:[t&&s.jsx("div",{className:"absolute bottom-16 right-0 flex flex-col space-y-3",children:s.jsx(Eu,{icon:Xe,label:"New Table Booking",onClick:i,animationClass:"animate-fab-slide-in"})}),s.jsx(sb,{isExpanded:t,onClick:r})]})}const ac="2025-08-28 05:45:04 UTC",Gf=()=>({timestamp:ac,date:new Date(ac).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),time:new Date(ac).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",timeZoneName:"short"})});function pr({options:e,selectedOptions:t,onSelectionChange:n,placeholder:r="Select options",maxSelections:i=5,searchable:a=!0,type:o="game"}){const[l,c]=j.useState(!1),[u,h]=j.useState(""),[d,f]=j.useState({top:0,left:0,width:0,maxHeight:400}),m=j.useRef(null),p=j.useRef(null),y=e.filter(N=>N.name.toLowerCase().includes(u.toLowerCase())||N.address&&N.address.toLowerCase().includes(u.toLowerCase()));j.useEffect(()=>{if(l&&m.current){const N=m.current.getBoundingClientRect(),w=window.innerHeight-N.bottom,T=Math.min(400,w-20);f({top:N.bottom,left:N.left,width:N.width,maxHeight:T})}},[l]),j.useEffect(()=>{const N=w=>{m.current&&!m.current.contains(w.target)&&p.current&&!p.current.contains(w.target)&&(c(!1),h(""))};if(l)return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[l]);const S=N=>{const w=t.includes(N)?t.filter(C=>C!==N):t.length<i?[...t,N]:t;n(w)},g=N=>{n(t.filter(w=>w!==N))},b=()=>t.map(N=>{var w;return(w=e.find(C=>C.id===N))==null?void 0:w.name}).filter(Boolean),x=N=>N.icon?s.jsx("img",{src:N.icon,alt:`${N.name} icon`,className:"w-6 h-6 rounded object-cover"}):s.jsx("div",{className:"w-6 h-6 rounded bg-bg-secondary flex items-center justify-center text-xs",children:o==="game"?"":""}),k=()=>s.jsxs("div",{ref:p,className:"absolute z-[9999] bg-bg-primary border border-border-custom rounded-lg shadow-lg overflow-hidden",style:{top:`${d.top}px`,left:`${d.left}px`,width:`${d.width}px`,maxHeight:`${d.maxHeight}px`},children:[a&&s.jsx("div",{className:"p-3 border-b border-border-custom",children:s.jsxs("div",{className:"relative",children:[s.jsx(Ko,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-4 h-4"}),s.jsx("input",{type:"text",value:u,onChange:N=>h(N.target.value),placeholder:"Search...",className:"w-full pl-10 pr-12 py-2 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text text-sm"}),s.jsx("button",{type:"button",onClick:()=>c(!1),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-icon hover:text-text transition-colors",children:s.jsx(fe,{className:"w-4 h-4"})})]})}),s.jsx("div",{className:"overflow-y-auto",style:{maxHeight:`${d.maxHeight-120}px`},children:y.length===0?s.jsx("div",{className:"p-4 text-center text-secondary-text text-sm",children:"No options found"}):y.map(N=>{const w=t.includes(N.id),C=!w&&t.length>=i;return s.jsxs("button",{type:"button",onClick:()=>S(N.id),disabled:C,className:`w-full p-3 flex items-center space-x-3 hover:bg-bg-secondary transition-colors ${w?"bg-bg-secondary":""} ${C?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[s.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[x(N),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:"text-text font-medium truncate",children:N.name}),N.address&&s.jsx("div",{className:"text-secondary-text text-sm truncate",children:N.address})]})]}),w&&s.jsx(eu,{className:"w-4 h-4 text-[var(--color-brand)] flex-shrink-0"})]},N.id)})}),t.length>0&&s.jsx("div",{className:"p-3 border-t border-border-custom",children:s.jsxs("div",{className:"text-xs text-secondary-text",children:[t.length," of ",i," selected"]})})]});return s.jsxs("div",{ref:m,className:"relative",children:[s.jsx("button",{type:"button",onClick:()=>c(!l),className:"w-full p-3 border border-border-custom rounded-lg bg-bg-primary text-left hover:border-[var(--color-brand)] transition-colors focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)]",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex-1 min-w-0",children:t.length>0?s.jsx("div",{className:"flex flex-wrap gap-1",children:b().map((N,w)=>s.jsxs("span",{className:"inline-flex items-center space-x-1 bg-bg-secondary px-2 py-1 rounded text-sm",children:[s.jsx("span",{className:"truncate max-w-20",children:N}),s.jsx("button",{type:"button",onClick:C=>{C.stopPropagation(),g(t[w])},className:"hover:text-red-500 transition-colors",children:s.jsx(fe,{className:"w-3 h-3"})})]},w))}):s.jsx("span",{className:"text-secondary-text",children:r})}),s.jsx(Bs,{className:`w-4 h-4 text-icon transition-transform ${l?"rotate-180":""}`})]})}),l&&sx.createPortal(k(),document.body)]})}function n4({games:e,boxes:t,models:n,selectedBoxes:r,selectedGames:i,selectedStatuses:a,searchQuery:o,onBoxesChange:l,onGamesChange:c,onStatusesChange:u,onSearchChange:h,onClearFilters:d}){const[f,m]=j.useState(!1),p=r.length>0||i.length>0||a.length>0||o.length>0,y=()=>{const P=new Map;return n.forEach(A=>{if(A.box){const L=A.box.id,O=A.box.name,M=P.get(L)||{name:O,count:0};M.count++,P.set(L,M)}}),Array.from(P.entries()).map(([A,{name:L,count:O}])=>({id:A,name:L,count:O})).sort((A,L)=>L.count-A.count)},S=()=>{const P=new Map;return n.forEach(A=>{var M,U,H,F,B,_;const L=((U=(M=A.box)==null?void 0:M.game)==null?void 0:U.id)||((H=A.game)==null?void 0:H.id),O=((B=(F=A.box)==null?void 0:F.game)==null?void 0:B.name)||((_=A.game)==null?void 0:_.name);if(L&&O){const z=P.get(L)||{name:O,count:0};z.count++,P.set(L,z)}}),Array.from(P.entries()).map(([A,{name:L,count:O}])=>({id:A,name:L,count:O})).sort((A,L)=>L.count-A.count)},g=()=>{const P=new Map;return n.forEach(A=>{const L=P.get(A.status)||0;P.set(A.status,L+1)}),Array.from(P.entries()).map(([A,L])=>({status:A,count:L})).sort((A,L)=>L.count-A.count)},b=y(),x=S(),k=g(),N=b.map(P=>{const A=t.find(L=>L.id===P.id);return{id:P.id,name:`${P.name} (${P.count})`,icon:(A==null?void 0:A.image_url)||null}}),w=x.map(P=>{const A=e.find(L=>L.id===P.id);return{id:P.id,name:`${P.name} (${P.count})`,icon:(A==null?void 0:A.icon)||null}}),C=k.map(({status:P,count:A})=>({id:P,name:`${P} (${A})`})),T=P=>{const A=r.includes(P)?r.filter(L=>L!==P):[...r,P];l(A)},I=P=>{const A=i.includes(P)?i.filter(L=>L!==P):[...i,P];c(A)},v=P=>{const A=a.includes(P)?a.filter(L=>L!==P):[...a,P];u(A)};return s.jsxs("div",{className:"bg-bg-card rounded-lg border border-border-custom p-4 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(hx,{className:"w-5 h-5 text-secondary-text"}),s.jsx("h3",{className:"text-lg font-semibold text-title",children:"Filters"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[p&&s.jsxs("button",{onClick:d,className:"flex items-center space-x-1 text-sm text-secondary-text hover:text-text transition-colors",children:[s.jsx(fe,{className:"w-4 h-4 text-icon"}),s.jsx("span",{children:"Clear all"})]}),s.jsxs("button",{onClick:()=>m(!f),className:"flex items-center space-x-1 text-sm text-secondary-text hover:text-text transition-colors",children:[f?s.jsx(Bs,{className:"w-4 h-4"}):s.jsx(Vt,{className:"w-4 h-4"}),s.jsx("span",{children:f?"Collapse":"Expand"})]})]})]}),f&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Search Models"}),s.jsx("input",{type:"text",value:o,onChange:P=>h(P.target.value),placeholder:"Search by model name...",className:"w-full px-3 py-2 border border-border-custom rounded-lg bg-bg-primary text-text placeholder-secondary-text focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Collections"}),s.jsx(pr,{options:N,selectedOptions:r,onSelectionChange:l,placeholder:"Select collections...",maxSelections:10,searchable:!0,type:"game"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Games"}),s.jsx(pr,{options:w,selectedOptions:i,onSelectionChange:c,placeholder:"Select games...",maxSelections:10,searchable:!0,type:"game"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Statuses"}),s.jsx(pr,{options:C,selectedOptions:a,onSelectionChange:u,placeholder:"Select statuses...",maxSelections:10,searchable:!0,type:"game"})]})]})]}),p&&s.jsx("div",{className:"mt-4 pt-4 border-t border-border-custom",children:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[o&&s.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm",children:[s.jsxs("span",{children:['Search: "',o,'"']}),s.jsx("button",{onClick:()=>h(""),className:"text-gray-600 hover:text-gray-800 transition-colors",children:s.jsx(fe,{className:"w-3 h-3 text-icon"})})]}),r.map(P=>{var L;const A=((L=b.find(O=>O.id===P))==null?void 0:L.name)||"";return s.jsxs("div",{className:"flex items-center space-x-2 bg-amber-100 text-amber-800 px-3 py-1 rounded-full text-sm",children:[s.jsxs("span",{children:["Collection: ",A]}),s.jsx("button",{onClick:()=>T(P),className:"text-amber-600 hover:text-amber-800 transition-colors",children:s.jsx(fe,{className:"w-3 h-3 text-icon"})})]},P)}),i.map(P=>{var L;const A=((L=x.find(O=>O.id===P))==null?void 0:L.name)||"";return s.jsxs("div",{className:"flex items-center space-x-2 bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:[s.jsxs("span",{children:["Game: ",A]}),s.jsx("button",{onClick:()=>I(P),className:"text-blue-600 hover:text-blue-800 transition-colors",children:s.jsx(fe,{className:"w-3 h-3 text-icon"})})]},P)}),a.map(P=>s.jsxs("div",{className:"flex items-center space-x-2 bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm",children:[s.jsxs("span",{children:["Status: ",P]}),s.jsx("button",{onClick:()=>v(P),className:"text-green-600 hover:text-green-800 transition-colors",children:s.jsx(fe,{className:"w-3 h-3 text-icon"})})]},P))]})})]})}function r4({games:e,boxes:t,selectedGames:n,searchQuery:r,onGamesChange:i,onSearchChange:a,onClearFilters:o}){const[l,c]=j.useState(!1),u=n.length>0||r.length>0,d=(()=>{const p=new Map;return t.forEach(y=>{if(y.game){const S=y.game.id,g=y.game.name,b=p.get(S)||{name:g,count:0};b.count++,p.set(S,b)}}),Array.from(p.entries()).map(([y,{name:S,count:g}])=>({id:y,name:S,count:g})).sort((y,S)=>S.count-y.count)})(),f=d.map(p=>{const y=e.find(S=>S.id===p.id);return{id:p.id,name:`${p.name} (${p.count})`,icon:(y==null?void 0:y.icon)||null}}),m=p=>{const y=n.includes(p)?n.filter(S=>S!==p):[...n,p];i(y)};return s.jsxs("div",{className:"bg-bg-card rounded-lg border border-border-custom p-4 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(hx,{className:"w-5 h-5 text-secondary-text"}),s.jsx("h3",{className:"text-lg font-semibold text-title",children:"Filters"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[u&&s.jsxs("button",{onClick:o,className:"flex items-center space-x-1 text-sm text-secondary-text hover:text-text transition-colors",children:[s.jsx(fe,{className:"w-4 h-4 text-icon"}),s.jsx("span",{children:"Clear all"})]}),s.jsxs("button",{onClick:()=>c(!l),className:"flex items-center space-x-1 text-sm text-secondary-text hover:text-text transition-colors",children:[l?s.jsx(Bs,{className:"w-4 h-4"}):s.jsx(Vt,{className:"w-4 h-4"}),s.jsx("span",{children:l?"Collapse":"Expand"})]})]})]}),l&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Search Collections"}),s.jsx("input",{type:"text",value:r,onChange:p=>a(p.target.value),placeholder:"Search by collection name...",className:"w-full px-3 py-2 border border-border-custom rounded-lg bg-bg-primary text-text placeholder-secondary-text focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label font-overpass mb-2",children:"Games"}),s.jsx(pr,{options:f,selectedOptions:n,onSelectionChange:i,placeholder:"Select games...",maxSelections:10,searchable:!0,type:"game"})]})})]}),u&&s.jsx("div",{className:"mt-4 pt-4 border-t border-border-custom",children:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[r&&s.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm",children:[s.jsxs("span",{children:['Search: "',r,'"']}),s.jsx("button",{onClick:()=>a(""),className:"text-gray-600 hover:text-gray-800 transition-colors",children:s.jsx(fe,{className:"w-3 h-3 text-icon"})})]}),n.map(p=>{var S;const y=((S=d.find(g=>g.id===p))==null?void 0:S.name)||"";return s.jsxs("div",{className:"flex items-center space-x-2 bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:[s.jsxs("span",{children:["Game: ",y]}),s.jsx("button",{onClick:()=>m(p),className:"text-blue-600 hover:text-blue-800 transition-colors",children:s.jsx(fe,{className:"w-3 h-3 text-icon"})})]},p)})]})})]})}function s4({isOpen:e,onClose:t,onComplete:n}){const{user:r}=Ge(),[i,a]=j.useState(1),[o,l]=j.useState(!1),[c,u]=j.useState(null),[h,d]=j.useState(""),[f,m]=j.useState([]),[p,y]=j.useState([]),[S,g]=j.useState([]),[b,x]=j.useState([]),k=["fuck","shit","bitch","ass","damn","hell","crap","piss","dick","cock","pussy","cunt","bastard","whore","slut","faggot","nigger","nigga","fag","dyke","retard","spic","kike","fuk","fuq","sh1t","sh!t","b!tch","b1tch","a$$","a55","d!ck","d1ck","p!ss","p1ss","noob","n00b","nub","scrub","get gud","git gud","uninstall","kys","kys","kys","f*ck","f**k","f***","s**t","s***","b***h","a**","d**k","p**s","c**t"],N=M=>{const U=M.toLowerCase();return k.some(H=>new RegExp(`\\b${H.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\b|${H.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}`,"i").test(U))},w=()=>h.length>=5&&h.length<=20&&!N(h)&&/^[a-zA-Z0-9\s]+$/.test(h);j.useEffect(()=>{e&&C()},[e]);const C=async()=>{try{const{data:M,error:U}=await Y.from("games").select("id, name, icon").order("name");if(U)throw U;g(M||[]);const{data:H,error:F}=await Y.from("locations").select("id, name, address, icon").order("name");if(F)throw F;x(H||[])}catch(M){console.error("Error fetching data:",M),u("Failed to load data")}},T=()=>{i<3&&(a(i+1),u(null))},I=()=>{i>1&&(a(i-1),u(null))},v=async()=>{if(r){l(!0),u(null);try{const{error:M}=await Y.from("users").update({user_name_public:h.trim(),fav_games:f.length>0?f:null,fav_locations:p.length>0?p:null,onboarded:!0}).eq("id",r.id);if(M)throw M;n()}catch(M){u(M instanceof Error?M.message:"Failed to save preferences")}finally{l(!1)}}},P=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-title mb-2",children:"Welcome to BattlePlan!"}),s.jsx("p",{className:"text-secondary-text",children:"Let's get you set up with your profile. First, let's set your display name."})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"userName",className:"block text-sm font-medium text-input-label mb-2",children:"Display Name"}),s.jsxs("div",{className:"relative",children:[s.jsx($t,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"text",id:"userName",value:h,onChange:M=>d(M.target.value),placeholder:"Enter your display name",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text"})]}),s.jsxs("div",{className:"mt-2 text-sm text-secondary-text",children:[s.jsx("p",{children:" Must be 5-20 characters long"}),s.jsx("p",{children:" Can contain letters, numbers, and spaces"}),s.jsx("p",{children:" Cannot contain inappropriate language"})]}),h&&!w()&&s.jsx("p",{className:"mt-2 text-sm text-red-500",children:N(h)?"Display name contains inappropriate language":"Please enter a valid display name (5-20 characters, letters, numbers, and spaces only)"})]})]}),A=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-title mb-2",children:"Favorite Games"}),s.jsx("p",{className:"text-secondary-text",children:"Select up to 5 of your favorite games (optional)"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label mb-2",children:"Select Games"}),s.jsx(pr,{options:S,selectedOptions:f,onSelectionChange:m,placeholder:"Choose your favorite games",maxSelections:5,type:"game"})]})]}),L=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-title mb-2",children:"Favorite Locations"}),s.jsx("p",{className:"text-secondary-text",children:"Select up to 5 of your favorite gaming locations (optional)"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label mb-2",children:"Select Locations"}),s.jsx(pr,{options:b,selectedOptions:p,onSelectionChange:y,placeholder:"Choose your favorite locations",maxSelections:5,type:"location"})]})]}),O=()=>{switch(i){case 1:return P();case 2:return A();case 3:return L();default:return null}};return e?s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-bg-primary rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-hidden",children:[s.jsx("div",{className:"flex items-center justify-between p-6 border-b border-border-custom",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[i>1&&s.jsx("button",{type:"button",onClick:I,className:"p-2 hover:bg-bg-secondary rounded-lg transition-colors",children:s.jsx(Tt,{className:"w-5 h-5 text-icon"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-lg font-semibold text-title",children:"Setup Profile"}),s.jsxs("p",{className:"text-sm text-secondary-text",children:["Step ",i," of 3"]})]})]})}),s.jsx("div",{className:"px-6 py-4",children:s.jsx("div",{className:"w-full bg-bg-secondary rounded-full h-2",children:s.jsx("div",{className:"bg-[var(--color-brand)] h-2 rounded-full transition-all duration-300",style:{width:`${i/3*100}%`}})})}),s.jsx("div",{className:"px-6 py-4 flex-1 overflow-y-auto",children:O()}),c&&s.jsx("div",{className:"px-6 py-3",children:s.jsx("p",{className:"text-sm text-red-500 text-center",children:c})}),s.jsx("div",{className:"p-6 border-t border-border-custom",children:s.jsx("div",{className:"flex justify-between",children:i<3?s.jsxs("button",{type:"button",onClick:T,disabled:i===1&&!w(),className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx("span",{children:"Next"}),s.jsx(wm,{className:"w-4 h-4"})]}):s.jsx("button",{type:"button",onClick:v,disabled:o,className:"btn-primary flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Saving..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"Complete Setup"}),s.jsx(wm,{className:"w-4 h-4"})]})})})})]})}):null}function i4({onBack:e}){const{user:t}=Ge(),[n,r]=j.useState(!1),[i,a]=j.useState(null),[o,l]=j.useState(null),[c,u]=j.useState(""),[h,d]=j.useState([]),[f,m]=j.useState([]),[p,y]=j.useState([]),[S,g]=j.useState([]),b=["fuck","shit","bitch","ass","damn","hell","crap","piss","dick","cock","pussy","cunt","bastard","whore","slut","faggot","nigger","nigga","fag","dyke","retard","spic","kike","fuk","fuq","sh1t","sh!t","b!tch","b1tch","a$$","a55","d!ck","d1ck","p!ss","p1ss","noob","n00b","nub","scrub","get gud","git gud","uninstall","kys","kys","kys","f*ck","f**k","f***","s**t","s***","b***h","a**","d**k","p**s","c**t"],x=I=>{const v=I.toLowerCase();return b.some(P=>new RegExp(`\\b${P.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\b|${P.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}`,"i").test(v))},k=()=>c?!(c.length<5||c.length>20||!/^[a-zA-Z0-9\s]+$/.test(c)||x(c)):!0;j.useEffect(()=>{t&&(u(t.user_name_public||""),d(t.fav_games||[]),m(t.fav_locations||[]),N(),w())},[t]);const N=async()=>{try{const{data:I,error:v}=await Y.from("games").select("id, name, icon").order("name");if(v)throw v;y(I||[])}catch(I){console.error("Error fetching games:",I),a("Failed to load games")}},w=async()=>{try{const{data:I,error:v}=await Y.from("locations").select("id, name, address, icon").order("name");if(v)throw v;g(I||[])}catch(I){console.error("Error fetching locations:",I),a("Failed to load locations")}},C=async()=>{if(t){if(c&&!k()){a("Please enter a valid display name (5-20 characters, letters, numbers, and spaces only)");return}r(!0),a(null),l(null);try{const{error:I}=await Y.from("users").update({user_name_public:c||null,fav_games:h.length>0?h:null,fav_locations:f.length>0?f:null}).eq("id",t.id);if(I)throw I;l("Settings saved successfully!"),t&&(t.user_name_public=c||null,t.fav_games=h.length>0?h:null,t.fav_locations=f.length>0?f:null)}catch(I){console.error("Error saving settings:",I),a("Failed to save settings. Please try again.")}finally{r(!1)}}},T=()=>{t&&(u(t.user_name_public||""),d(t.fav_games||[]),m(t.fav_locations||[])),a(null),l(null)};return s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(a4,{onBack:e}),s.jsx("main",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm p-6",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-2xl font-bold text-title mb-2",children:"Settings"}),s.jsx("p",{className:"text-secondary-text",children:"Manage your profile preferences and favorite games and locations."})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"userName",className:"block text-sm font-medium text-input-label mb-2",children:"Display Name"}),s.jsxs("div",{className:"relative",children:[s.jsx($t,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-icon w-5 h-5"}),s.jsx("input",{type:"text",id:"userName",value:c,onChange:I=>u(I.target.value),placeholder:"Enter your display name",className:"w-full pl-12 pr-4 py-3 border border-border-custom rounded-lg focus:ring-2 focus:ring-[var(--color-brand)] focus:border-[var(--color-brand)] bg-bg-primary text-text"})]}),s.jsxs("div",{className:"mt-2 text-sm text-secondary-text",children:[s.jsx("p",{children:" Must be 5-20 characters long"}),s.jsx("p",{children:" Can contain letters, numbers, and spaces"}),s.jsx("p",{children:" Cannot contain inappropriate language"}),s.jsx("p",{children:" Leave empty to hide your display name"})]}),c&&!k()&&s.jsx("p",{className:"mt-2 text-sm text-red-500",children:x(c)?"Display name contains inappropriate language":"Please enter a valid display name (5-20 characters, letters, numbers, and spaces only)"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label mb-2",children:"Favorite Games"}),s.jsx(pr,{options:p,selectedOptions:h,onSelectionChange:d,placeholder:"Select your favorite games",maxSelections:5,type:"game"}),s.jsx("p",{className:"mt-2 text-sm text-secondary-text",children:"Select up to 5 of your favorite games. These will be prioritized in dropdowns."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-input-label mb-2",children:"Favorite Locations"}),s.jsx(pr,{options:S,selectedOptions:f,onSelectionChange:m,placeholder:"Select your favorite locations",maxSelections:5,type:"location"}),s.jsx("p",{className:"mt-2 text-sm text-secondary-text",children:"Select up to 5 of your favorite locations. These will be prioritized in dropdowns."})]}),i&&s.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-red-600",children:i})}),o&&s.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:s.jsx("p",{className:"text-sm text-green-600",children:o})}),s.jsxs("div",{className:"flex space-x-4 pt-4",children:[s.jsxs("button",{onClick:T,disabled:n,className:"flex-1 flex items-center justify-center space-x-2 px-4 py-3 border border-border-custom rounded-lg bg-bg-primary text-text hover:bg-bg-secondary transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(fe,{className:"w-4 h-4"}),s.jsx("span",{children:"Cancel"})]}),s.jsxs("button",{onClick:C,disabled:n||c&&!k(),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-3 bg-[var(--color-brand)] text-white rounded-lg hover:bg-[var(--color-brand)]/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[n?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):s.jsx(xx,{className:"w-4 h-4"}),s.jsx("span",{children:n?"Saving...":"Save"})]})]})]})]})})]})}function a4({onBack:e}){return s.jsx("header",{className:"bg-bg-primary border-b border-border-custom",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex items-center justify-between h-16",children:[s.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-text hover:text-secondary-text transition-colors",children:[s.jsx(Tt,{className:"w-5 h-5"}),s.jsx("span",{children:"Back"})]}),s.jsx("h1",{className:"text-lg font-semibold text-title",children:"Settings"}),s.jsx("div",{className:"w-20"})," "]})})})}function o4(){const e=window.location.pathname.endsWith("/auth/callback"),t=window.location.pathname.match(/\/shared\/collection\/(.+)$/),n=t?t[1]:null,r=window.location.pathname.match(/\/shared\/model\/(.+)$/),i=r?r[1]:null;if(e)return s.jsx(ZE,{});if(n)return s.jsx(nb,{collectionId:n});if(i){const J=new URLSearchParams(window.location.search),xe=J.get("from"),et=J.get("collectionName");let it;return xe&&et&&(it={collectionId:xe,collectionName:decodeURIComponent(et)}),s.jsx(tb,{modelId:i,breadcrumbs:it})}const[a,o]=j.useState("collection"),[l,c]=j.useState("recent"),[u,h]=j.useState(1),[d,f]=j.useState(1),[m,p]=j.useState({selectedBoxes:[],selectedGames:[],selectedStatuses:[],searchQuery:""}),[y,S]=j.useState({selectedGames:[],searchQuery:""}),[g,b]=j.useState([]),[x,k]=j.useState({isOpen:!1,mode:"login"}),[N,w]=j.useState(!1),[C,T]=j.useState(!1),[I,v]=j.useState(!1),[P,A]=j.useState(!1),[L,O]=j.useState(!1),[M,U]=j.useState(!1),[H,F]=j.useState(null),[B,_]=j.useState({isOpen:!1,model:null}),[z,q]=j.useState(0),[E,K]=j.useState({isOpen:!1,box:null}),{user:G,loading:W,needsPasswordReset:le}=Ge(),{models:se,loading:ae,refetch:be}=Hx(),{boxes:je,loading:Ie,refetch:ne}=Wx();j.useEffect(()=>{G&&Q()},[G]);const Q=async()=>{try{const{data:J,error:xe}=await Y.from("games").select("id, name, icon").order("name");if(xe)throw xe;b(J||[])}catch(J){console.error("Error fetching games:",J)}},re=6,ge=J=>{p(xe=>({...xe,selectedBoxes:J})),h(1)},ve=J=>{p(xe=>({...xe,selectedGames:J})),h(1)},we=J=>{p(xe=>({...xe,selectedStatuses:J})),h(1)},Ue=()=>{p({selectedBoxes:[],selectedGames:[],selectedStatuses:[],searchQuery:""}),h(1)},Fe=J=>{S(xe=>({...xe,selectedGames:J})),f(1)},V=()=>{S({selectedGames:[],searchQuery:""}),f(1)},X=J=>{p(xe=>({...xe,searchQuery:J})),h(1)},oe=J=>{S(xe=>({...xe,searchQuery:J})),f(1)},Se=se.filter(J=>{var xe,et,it,sn;return!(m.searchQuery&&!J.name.toLowerCase().includes(m.searchQuery.toLowerCase())||m.selectedBoxes.length>0&&!m.selectedBoxes.includes(((xe=J.box)==null?void 0:xe.id)||"")||m.selectedGames.length>0&&!m.selectedGames.includes(((it=(et=J.box)==null?void 0:et.game)==null?void 0:it.id)||"")&&!m.selectedGames.includes(((sn=J.game)==null?void 0:sn.id)||"")||m.selectedStatuses.length>0&&!m.selectedStatuses.includes(J.status))}),rt=se.filter(J=>J.status==="Painted").sort((J,xe)=>J.painted_date&&xe.painted_date?new Date(xe.painted_date).getTime()-new Date(J.painted_date).getTime():J.painted_date&&!xe.painted_date?-1:!J.painted_date&&xe.painted_date?1:new Date(xe.created_at).getTime()-new Date(J.created_at).getTime()),D=je.filter(J=>{var xe;return!(y.searchQuery&&!J.name.toLowerCase().includes(y.searchQuery.toLowerCase())||y.selectedGames.length>0&&!y.selectedGames.includes(((xe=J.game)==null?void 0:xe.id)||""))}),R=Math.ceil(Se.length/re),$=Math.ceil(rt.length/re),te=Math.ceil(D.length/re),ue=Se.slice((u-1)*re,u*re),he=rt.slice((u-1)*re,u*re),ce=D.slice((d-1)*re,d*re),de=()=>{be(),ne();try{const J=localStorage.getItem("mini-myths-temp-box-context");if(J){const xe=JSON.parse(J),et=je.find(it=>it.id===xe.id);et&&K({isOpen:!0,box:et}),localStorage.removeItem("mini-myths-temp-box-context")}}catch(J){console.error("Error handling return to box modal:",J),localStorage.removeItem("mini-myths-temp-box-context")}F(null)},ye=J=>{_({isOpen:!0,model:J})},Ce=J=>{K({isOpen:!0,box:J})},Le=()=>{be(),ne()},Oe=async()=>{await be(),await ne()},st=()=>{ne(),be()},ib=()=>{ne(),be()},ab=J=>{F(J),w(!0)},ob=J=>{F(J),w(!0)},Jr=()=>{A(!0)},Nr=()=>{O(!0)};j.useEffect(()=>{le&&U(!0)},[le]);const[lb,ul]=j.useState(!1);j.useEffect(()=>{G&&!W&&G.onboarded===!1&&ul(!0)},[G,W]);const cb=()=>{ul(!1),window.location.reload()};return W?s.jsx("div",{className:"min-h-screen bg-bg-secondary flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--color-brand)] mx-auto mb-4"}),s.jsx("p",{className:"text-base text-secondary-text",children:"Loading..."})]})}):G?P?s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(EE,{onBack:()=>A(!1)}),s.jsx(cn,{})]}):L?s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(i4,{onBack:()=>O(!1)}),s.jsx(cn,{})]}):a==="about"?s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(Dn,{onAddModel:()=>w(!0),onAdminClick:Jr,onSettingsClick:Nr,activeTab:a,onTabChange:o}),s.jsx(PE,{onBack:()=>o("collection")}),s.jsx(cn,{}),s.jsx(tr,{activeTab:a,onTabChange:o})]}):a==="all-bookings"?s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(Dn,{onAddModel:()=>w(!0),onAdminClick:Jr,onSettingsClick:Nr,activeTab:a,onTabChange:o}),s.jsx(ME,{onBack:()=>o("collection")}),s.jsx(cn,{}),s.jsx(tr,{activeTab:a,onTabChange:o})]}):a==="blocked-dates"?s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(Dn,{onAddModel:()=>w(!0),onAdminClick:Jr,onSettingsClick:Nr,activeTab:a,onTabChange:o}),s.jsx(DE,{onBack:()=>o("collection")}),s.jsx(cn,{}),s.jsx(tr,{activeTab:a,onTabChange:o})]}):a==="battles"?s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(Dn,{onAddModel:()=>w(!0),onAdminClick:Jr,onSettingsClick:Nr,activeTab:a,onTabChange:o}),s.jsx(BE,{onBack:()=>o("collection")}),s.jsx(cn,{}),s.jsx(tr,{activeTab:a,onTabChange:o})]}):a==="battleplan"?s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(Dn,{onAddModel:()=>w(!0),onAdminClick:Jr,onSettingsClick:Nr,activeTab:a,onTabChange:o}),s.jsx(vj,{refreshTrigger:z,onNewBooking:()=>v(!0)}),s.jsx(cn,{}),s.jsx(tr,{activeTab:a,onTabChange:o}),s.jsx(t4,{onNewBooking:()=>v(!0)}),s.jsx(qf,{isOpen:I,onClose:()=>v(!1),onBookingCreated:()=>{q(J=>J+1),v(!1)},lastSelectedLocation:"",onLocationSelected:J=>{console.log("Location selected:",J)}})]}):s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(Dn,{onAddModel:()=>w(!0),onAdminClick:Jr,onSettingsClick:Nr,activeTab:a,onTabChange:o}),a==="collection"&&s.jsx(xj,{activeView:l,onViewChange:c}),s.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24",children:[l==="recent"&&s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:"mb-16",children:[rt.length>0&&s.jsx("div",{className:"flex flex-col items-center mb-8",children:s.jsx("h2",{className:"text-lg font-bold text-secondary-text text-center mb-4",children:"RECENTLY PAINTED MODELS"})}),ae?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((J,xe)=>s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm border border-border-custom overflow-hidden animate-pulse",children:[s.jsx("div",{className:"h-48 bg-secondary-text opacity-20"}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-2/3"}),s.jsx("div",{className:"h-8 bg-secondary-text opacity-20 rounded"})]})]},xe))}):rt.length===0?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-base text-secondary-text mb-4",children:"No painted models in your collection yet."})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:he.map(J=>{var xe,et,it,sn,ht,It,Jt;return s.jsx(wj,{model:J,name:J.name,boxName:((xe=J.box)==null?void 0:xe.name)||"Unknown Collection",gameName:((it=(et=J.box)==null?void 0:et.game)==null?void 0:it.name)||((sn=J.game)==null?void 0:sn.name)||"Unknown Game",gameIcon:((It=(ht=J.box)==null?void 0:ht.game)==null?void 0:It.icon)||((Jt=J.game)==null?void 0:Jt.icon)||null,status:J.status,count:J.count,imageUrl:J.image_url,paintedDate:J.painted_date,onViewModel:()=>ye(J),onViewBox:Ce},J.id)})}),$>1&&s.jsx(Ma,{currentPage:u,totalPages:$,onPageChange:h})]})]}),s.jsxs("section",{children:[je.length>0&&s.jsx("div",{className:"flex flex-col items-center mb-8",children:s.jsx("h2",{className:"text-lg font-bold text-secondary-text text-center mb-4",children:"RECENT COLLECTIONS"})}),Ie?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((J,xe)=>s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm border border-border-custom overflow-hidden animate-pulse",children:[s.jsx("div",{className:"h-48 bg-secondary-text opacity-20"}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-2/3"}),s.jsx("div",{className:"h-8 bg-secondary-text opacity-20 rounded"})]})]},xe))}):je.length===0?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-base text-secondary-text mb-4",children:"No collections in your collection yet."})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ce.map(J=>{var xe,et,it;return s.jsx(jj,{name:J.name,gameName:((xe=J.game)==null?void 0:xe.name)||"Unknown Game",modelCount:J.models_count||0,imageUrl:J.image_url||null,gameImage:((et=J.game)==null?void 0:et.image)||null,gameIcon:((it=J.game)==null?void 0:it.icon)||null,onViewBox:()=>Ce(J)},J.id)})}),te>1&&s.jsx(Ma,{currentPage:d,totalPages:te,onPageChange:f})]})]})]}),l==="collections"&&s.jsxs("section",{children:[je.length>0&&s.jsx(r4,{games:g,boxes:je,selectedGames:y.selectedGames,searchQuery:y.searchQuery,onGamesChange:Fe,onSearchChange:oe,onClearFilters:V}),Ie?s.jsx("div",{className:"space-y-3",children:Array.from({length:6}).map((J,xe)=>s.jsx("div",{className:"bg-bg-card rounded-lg border border-border-custom p-4 animate-pulse",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-16 h-16 bg-secondary-text opacity-20 rounded"}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-1/2"})]}),s.jsx("div",{className:"w-20 h-8 bg-secondary-text opacity-20 rounded"})]})},xe))}):je.length===0?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-base text-secondary-text mb-4",children:"No collections in your collection yet."})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-3",children:ce.map(J=>{var xe,et,it,sn;return s.jsx("div",{className:"bg-bg-card rounded-lg border border-border-custom p-4 hover:bg-bg-secondary transition-colors cursor-pointer",onClick:()=>Ce(J),children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("img",{src:(()=>{var It;if(J.image_url&&typeof J.image_url=="string"&&J.image_url.trim()!==""&&J.image_url!=="undefined"&&J.image_url!=="null"&&(J.image_url.startsWith("http")||J.image_url.startsWith("/")))return J.image_url;const ht=(It=J.game)==null?void 0:It.image;return ht&&typeof ht=="string"&&ht.trim()!==""&&ht!=="undefined"&&ht!=="null"&&ht.startsWith("http")?ht:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"})(),alt:J.name,className:"w-16 h-16 object-cover rounded",onError:ht=>{const It=ht.target,Jt="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg";It.src!==Jt&&(It.src=Jt)}}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"text-lg font-semibold text-title truncate",children:J.name}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[(xe=J.game)!=null&&xe.icon?s.jsx("img",{src:J.game.icon,alt:`${J.game.name} icon`,className:"w-4 h-4 object-contain rounded",onError:ht=>{const It=ht.target;It.style.display="none";const Jt=It.nextElementSibling;Jt&&Jt.classList.contains("icon-fallback")&&(Jt.style.display="flex")}}):null,s.jsx("div",{className:"w-4 h-4 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:(et=J.game)!=null&&et.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-xs font-bold",children:(((it=J.game)==null?void 0:it.name)||"Unknown Game").charAt(0)})}),s.jsx("span",{className:"text-sm text-secondary-text",children:((sn=J.game)==null?void 0:sn.name)||"Unknown Game"})]}),s.jsxs("p",{className:"text-xs text-secondary-text mt-1",children:[J.models_count||0," Model",(J.models_count||0)!==1?"s":""]})]})]})},J.id)})}),te>1&&s.jsx(Ma,{currentPage:d,totalPages:te,onPageChange:f})]})]}),l==="models"&&s.jsxs("section",{children:[se.length>0&&s.jsx(n4,{games:g,boxes:je,models:se,selectedBoxes:m.selectedBoxes,selectedGames:m.selectedGames,selectedStatuses:m.selectedStatuses,searchQuery:m.searchQuery,onBoxesChange:ge,onGamesChange:ve,onStatusesChange:we,onSearchChange:X,onClearFilters:Ue}),ae?s.jsx("div",{className:"space-y-3",children:Array.from({length:6}).map((J,xe)=>s.jsx("div",{className:"bg-bg-card rounded-lg border border-border-custom p-4 animate-pulse",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-16 h-16 bg-secondary-text opacity-20 rounded"}),s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("div",{className:"h-4 bg-secondary-text opacity-20 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-secondary-text opacity-20 rounded w-1/2"})]}),s.jsx("div",{className:"w-20 h-8 bg-secondary-text opacity-20 rounded"})]})},xe))}):se.length===0?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-base text-secondary-text mb-4",children:"No models in your collection yet."})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-3",children:ue.map(J=>{var xe,et,it,sn,ht,It,Jt,Zd,eh,th,nh,rh,sh,ih,ah,oh,lh,ch;return s.jsx("div",{className:"bg-bg-card rounded-lg border border-border-custom p-4 hover:bg-bg-secondary transition-colors cursor-pointer",onClick:()=>ye(J),children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("img",{src:(()=>{var Yn,In,uh;if(J.image_url&&typeof J.image_url=="string"&&J.image_url.trim()!==""&&J.image_url!=="undefined"&&J.image_url!=="null"&&(J.image_url.startsWith("http")||J.image_url.startsWith("/")))return J.image_url;const an=((In=(Yn=J.box)==null?void 0:Yn.game)==null?void 0:In.icon)||((uh=J.game)==null?void 0:uh.icon);return an&&typeof an=="string"&&an.trim()!==""&&an!=="undefined"&&an!=="null"&&an.startsWith("http")?an:"https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg"})(),alt:J.name,className:"w-16 h-16 object-cover rounded",onError:an=>{const Yn=an.target,In="https://images.pexels.com/photos/8088212/pexels-photo-8088212.jpeg";Yn.src!==In&&(Yn.src=In)}}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"text-lg font-semibold text-title truncate",children:J.name}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[(et=(xe=J.box)==null?void 0:xe.game)!=null&&et.icon||(it=J.game)!=null&&it.icon?s.jsx("img",{src:((ht=(sn=J.box)==null?void 0:sn.game)==null?void 0:ht.icon)||((It=J.game)==null?void 0:It.icon)||void 0,alt:`${((Zd=(Jt=J.box)==null?void 0:Jt.game)==null?void 0:Zd.name)||((eh=J.game)==null?void 0:eh.name)||"Unknown Game"} icon`,className:"w-4 h-4 object-contain rounded",onError:an=>{const Yn=an.target;Yn.style.display="none";const In=Yn.nextElementSibling;In&&In.classList.contains("icon-fallback")&&(In.style.display="flex")}}):null,s.jsx("div",{className:"w-4 h-4 bg-red-600 rounded-full flex items-center justify-center icon-fallback",style:{display:(nh=(th=J.box)==null?void 0:th.game)!=null&&nh.icon||(rh=J.game)!=null&&rh.icon?"none":"flex"},children:s.jsx("span",{className:"text-white text-xs font-bold",children:(((ih=(sh=J.box)==null?void 0:sh.game)==null?void 0:ih.name)||((ah=J.game)==null?void 0:ah.name)||"Unknown Game").charAt(0)})}),s.jsx("span",{className:"text-sm text-secondary-text",children:((lh=(oh=J.box)==null?void 0:oh.game)==null?void 0:lh.name)||((ch=J.game)==null?void 0:ch.name)||"Unknown Game"})]}),J.status!=="None"&&s.jsx("div",{className:"mt-1",children:s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${(()=>{switch(J.status){case"Painted":return"bg-green-100 text-green-800";case"Partially Painted":return"bg-yellow-100 text-yellow-800";case"Primed":return"bg-blue-100 text-blue-800";case"Assembled":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})()}`,children:J.status})})]})]})},J.id)})}),R>1&&s.jsx(Ma,{currentPage:u,totalPages:R,onPageChange:h})]})]})]}),s.jsx(cn,{}),s.jsx(tr,{activeTab:a,onTabChange:o}),s.jsx(Vm,{isOpen:x.isOpen,onClose:()=>k({isOpen:!1,mode:"login"}),mode:x.mode}),s.jsx(kj,{isOpen:N,onClose:()=>w(!1),onSuccess:de,preselectedBoxId:H}),s.jsx(Nj,{isOpen:C,onClose:()=>T(!1),onSuccess:de,onAddModelsToBox:ab}),s.jsx(GE,{isOpen:B.isOpen,onClose:()=>_({isOpen:!1,model:null}),onModelDeleted:Le,onModelUpdated:Oe,onViewBox:Ce,model:B.model}),s.jsx(QE,{isOpen:E.isOpen,onClose:()=>K({isOpen:!1,box:null}),onBoxDeleted:st,onModelsUpdated:ib,onViewModel:ye,onAddNewModel:ob,box:E.box}),s.jsx(XE,{isOpen:M,onClose:()=>U(!1)}),s.jsx(qf,{isOpen:I,onClose:()=>v(!1),onBookingCreated:()=>{q(J=>J+1),v(!1)},lastSelectedLocation:"",onLocationSelected:J=>{console.log("Location selected:",J)}}),a==="collection"&&s.jsx(e4,{onAddModel:()=>w(!0),onAddCollection:()=>T(!0)}),s.jsx(s4,{isOpen:lb,onClose:()=>ul(!1),onComplete:cb})]}):s.jsxs("div",{className:"min-h-screen bg-bg-secondary",children:[s.jsx(Dn,{onSettingsClick:Nr}),s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-16 text-center",children:s.jsxs("div",{className:"bg-bg-card rounded-lg shadow-sm p-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-title mb-4",children:"Welcome to the Battleplan App Beta"}),s.jsxs("p",{className:"text-xs text-secondary-text mb-2",children:["Last updated: ",Gf().date," at ",Gf().time]}),s.jsxs("p",{className:"text-base text-secondary-text mb-8",children:["Track your miniatures and book a table at your favourite gaming store.",s.jsx("br",{}),s.jsx("br",{}),"Make sure to report any bugs and issues on the Discord!"]}),s.jsxs("div",{className:"flex justify-center space-x-4",children:[s.jsx("button",{onClick:()=>k({isOpen:!0,mode:"login"}),className:"btn-secondary",children:"Log In"}),s.jsx("button",{onClick:()=>k({isOpen:!0,mode:"signup"}),className:"btn-primary",children:"Sign Up"})]})]})}),s.jsx(cn,{}),s.jsx(Vm,{isOpen:x.isOpen,onClose:()=>k({isOpen:!1,mode:"login"}),mode:x.mode})]})}ix(document.getElementById("root")).render(s.jsx(j.StrictMode,{children:s.jsx(o4,{})}));
